[2024-01-06 17:45:08,676] {logger:50} INFO - 
[2024-01-06 17:45:08,676] {logger:51} INFO - ================================================================================
[2024-01-06 17:45:08,676] {logger:52} INFO - start training with model: model_8conv_2fc
[2024-01-06 17:45:08,677] {logger:53} INFO - ================================================================================
[2024-01-06 17:45:08,677] {logger:54} INFO - 
[2024-01-06 17:45:28,439] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 17:45:28,505] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 17:45:31,603] {dataloader:107} INFO - data distribution in database for dataset valid:
	WAKE                : 48319
	NREM                : 35104
	REM                 : 5341
	ARTIFACT            : 835
[2024-01-06 17:45:31,611] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 48319
	NREM                : 35104
	REM                 : 5341
	ARTIFACT            : 835
[2024-01-06 17:45:32,847] {run_experiment:47} INFO - classifier:
Model(
  (feature_extractor): Sequential(
    (0): BatchNorm1d(3, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (1): Conv1d(3, 96, kernel_size=(5,), stride=(1,))
    (2): ReLU(inplace=True)
    (3): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (4): Dropout(p=0.0, inplace=False)
    (5): Conv1d(96, 96, kernel_size=(5,), stride=(2,))
    (6): ReLU(inplace=True)
    (7): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (8): Dropout(p=0.2, inplace=False)
    (9): Conv1d(96, 96, kernel_size=(5,), stride=(1,))
    (10): ReLU(inplace=True)
    (11): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (12): Dropout(p=0.0, inplace=False)
    (13): Conv1d(96, 96, kernel_size=(5,), stride=(2,))
    (14): ReLU(inplace=True)
    (15): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (16): Dropout(p=0.2, inplace=False)
    (17): Conv1d(96, 96, kernel_size=(5,), stride=(1,))
    (18): ReLU(inplace=True)
    (19): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (20): Dropout(p=0.0, inplace=False)
    (21): Conv1d(96, 96, kernel_size=(5,), stride=(2,))
    (22): ReLU(inplace=True)
    (23): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (24): Dropout(p=0.2, inplace=False)
    (25): Conv1d(96, 96, kernel_size=(5,), stride=(1,))
    (26): ReLU(inplace=True)
    (27): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (28): Dropout(p=0.0, inplace=False)
    (29): Conv1d(96, 96, kernel_size=(5,), stride=(2,))
    (30): ReLU(inplace=True)
    (31): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (32): Dropout(p=0.2, inplace=False)
  )
  (classifier): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=3936, out_features=80, bias=True)
    (2): ReLU(inplace=True)
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=80, out_features=4, bias=True)
  )
)
[2024-01-06 17:46:08,437] {train_model:86} INFO - Train Epoch: 1 [60928/612104 (10%)]	lr:2.56e-05	Loss: 38.031639
[2024-01-06 17:47:06,659] {train_model:86} INFO - Train Epoch: 1 [122112/612104 (20%)]	lr:2.56e-05	Loss: 27.646271
[2024-01-06 17:47:27,088] {train_model:86} INFO - Train Epoch: 1 [183296/612104 (30%)]	lr:2.56e-05	Loss: 20.383509
[2024-01-06 17:47:38,109] {train_model:86} INFO - Train Epoch: 1 [244480/612104 (40%)]	lr:2.56e-05	Loss: 32.758038
[2024-01-06 17:47:49,659] {train_model:86} INFO - Train Epoch: 1 [305664/612104 (50%)]	lr:2.56e-05	Loss: 16.491602
[2024-01-06 17:48:01,479] {train_model:86} INFO - Train Epoch: 1 [366848/612104 (60%)]	lr:2.56e-05	Loss: 11.055062
[2024-01-06 17:48:12,921] {train_model:86} INFO - Train Epoch: 1 [428032/612104 (70%)]	lr:2.56e-05	Loss: 12.240538
[2024-01-06 17:48:24,835] {train_model:86} INFO - Train Epoch: 1 [489216/612104 (80%)]	lr:2.56e-05	Loss: 17.393356
[2024-01-06 17:48:36,256] {train_model:86} INFO - Train Epoch: 1 [550400/612104 (90%)]	lr:2.56e-05	Loss: 16.825783
[2024-01-06 17:48:47,765] {train_model:86} INFO - Train Epoch: 1 [611584/612104 (100%)]	lr:2.56e-05	Loss: 6.776272
[2024-01-06 17:49:00,411] {run_experiment:78} INFO - 
[2024-01-06 17:49:00,418] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 17:49:01,658] {result_logger:108} INFO - precision on WAKE: 0.683
[2024-01-06 17:49:02,455] {result_logger:109} INFO - recall on WAKE: 0.374
[2024-01-06 17:49:03,266] {result_logger:112} INFO - F1-score on WAKE: 0.483
[2024-01-06 17:49:03,266] {result_logger:113} INFO - 
[2024-01-06 17:49:04,493] {result_logger:108} INFO - precision on NREM: 0.683
[2024-01-06 17:49:05,293] {result_logger:109} INFO - recall on NREM: 0.489
[2024-01-06 17:49:06,110] {result_logger:112} INFO - F1-score on NREM: 0.570
[2024-01-06 17:49:06,110] {result_logger:113} INFO - 
[2024-01-06 17:49:07,284] {result_logger:108} INFO - precision on REM: 0.077
[2024-01-06 17:49:08,023] {result_logger:109} INFO - recall on REM: 0.423
[2024-01-06 17:49:08,780] {result_logger:112} INFO - F1-score on REM: 0.131
[2024-01-06 17:49:08,780] {result_logger:113} INFO - 
[2024-01-06 17:49:08,984] {result_logger:116} INFO - average precision on sleep stages: 0.481
[2024-01-06 17:49:09,187] {result_logger:118} INFO - average recall on sleep stages: 0.429
[2024-01-06 17:49:09,394] {result_logger:120} INFO - average F1-score on sleep stages: 0.394
[2024-01-06 17:49:09,908] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.429
[2024-01-06 17:49:09,936] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.422
[2024-01-06 17:49:09,941] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 17:49:10,109] {result_logger:108} INFO - precision on WAKE: 0.722
[2024-01-06 17:49:10,210] {result_logger:109} INFO - recall on WAKE: 0.619
[2024-01-06 17:49:10,315] {result_logger:112} INFO - F1-score on WAKE: 0.667
[2024-01-06 17:49:10,315] {result_logger:113} INFO - 
[2024-01-06 17:49:10,481] {result_logger:108} INFO - precision on NREM: 0.923
[2024-01-06 17:49:10,582] {result_logger:109} INFO - recall on NREM: 0.542
[2024-01-06 17:49:10,682] {result_logger:112} INFO - F1-score on NREM: 0.683
[2024-01-06 17:49:10,682] {result_logger:113} INFO - 
[2024-01-06 17:49:10,843] {result_logger:108} INFO - precision on REM: 0.064
[2024-01-06 17:49:10,949] {result_logger:109} INFO - recall on REM: 0.321
[2024-01-06 17:49:11,056] {result_logger:112} INFO - F1-score on REM: 0.107
[2024-01-06 17:49:11,056] {result_logger:113} INFO - 
[2024-01-06 17:49:11,077] {result_logger:116} INFO - average precision on sleep stages: 0.570
[2024-01-06 17:49:11,099] {result_logger:118} INFO - average recall on sleep stages: 0.494
[2024-01-06 17:49:11,120] {result_logger:120} INFO - average F1-score on sleep stages: 0.485
[2024-01-06 17:49:11,192] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.494
[2024-01-06 17:49:11,195] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.570
[2024-01-06 17:49:11,196] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 17:49:11,760] {result_logger:143} INFO - 
[[124059  48498 137225  22273]
 [ 43646 116873  58233  20438]
 [ 14020   5767  16375   2509]
 [   642    579    725    242]]
[2024-01-06 17:49:12,300] {result_logger:150} INFO - 
[[ 37.36%  14.61%  41.33%   6.71%]
 [ 18.25%  48.86%  24.35%   8.54%]
 [ 36.25%  14.91%  42.34%   6.49%]
 [ 29.34%  26.46%  33.14%  11.06%]]
[2024-01-06 17:49:12,854] {result_logger:154} INFO - 
[[ 68.03%  28.24%  64.56%  48.99%]
 [ 23.93%  68.06%  27.40%  44.96%]
 [  7.69%   3.36%   7.70%   5.52%]
 [  0.35%   0.34%   0.34%   0.53%]]
[2024-01-06 17:49:12,854] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 17:49:12,930] {result_logger:143} INFO - 
[[29903  1556 16843    17]
 [ 7906 19011  8187     1]
 [ 3593    31  1716     1]
 [  415   127   270    22]]
[2024-01-06 17:49:13,158] {result_logger:150} INFO - 
[[ 61.89%   3.22%  34.86%   0.04%]
 [ 22.52%  54.15%  23.32%   0.00%]
 [ 67.27%   0.58%  32.13%   0.02%]
 [ 49.76%  15.23%  32.37%   2.64%]]
[2024-01-06 17:49:13,349] {result_logger:154} INFO - 
[[ 71.51%   7.51%  62.34%  41.46%]
 [ 18.91%  91.73%  30.30%   2.44%]
 [  8.59%   0.15%   6.35%   2.44%]
 [  0.99%   0.61%   1.00%  53.66%]]
[2024-01-06 17:49:13,850] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 17:49:13,850] {result_logger:77} INFO - actual:
[2024-01-06 17:49:13,850] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 17:49:13,850] {result_logger:79} INFO - predicted:
[2024-01-06 17:49:13,850] {result_logger:80} INFO - 
[[61.18%  3.88% 34.90%  0.04%]
 [ 6.64% 80.82% 12.52%  0.01%]
 [54.94%  8.68% 36.31%  0.07%]
 [39.02% 17.07% 39.02%  4.88%]]
[2024-01-06 17:49:13,885] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it3/model_8conv_2fc-best.pth
[2024-01-06 17:49:13,885] {run_experiment:113} INFO - [epoch   1] execution time: 221.04s	 avg f1-score: 0.4854

[2024-01-06 17:49:13,885] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 17:49:13,941] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 17:49:39,850] {train_model:86} INFO - Train Epoch: 2 [60928/612104 (10%)]	lr:1.41e-04	Loss: 8.396222
[2024-01-06 17:50:19,172] {train_model:86} INFO - Train Epoch: 2 [122112/612104 (20%)]	lr:1.41e-04	Loss: 4.536373
[2024-01-06 17:50:47,547] {train_model:86} INFO - Train Epoch: 2 [183296/612104 (30%)]	lr:1.41e-04	Loss: 2.873923
[2024-01-06 17:50:59,118] {train_model:86} INFO - Train Epoch: 2 [244480/612104 (40%)]	lr:1.41e-04	Loss: 2.061094
[2024-01-06 17:51:10,566] {train_model:86} INFO - Train Epoch: 2 [305664/612104 (50%)]	lr:1.41e-04	Loss: 1.775620
[2024-01-06 17:51:22,151] {train_model:86} INFO - Train Epoch: 2 [366848/612104 (60%)]	lr:1.41e-04	Loss: 2.960857
[2024-01-06 17:51:33,519] {train_model:86} INFO - Train Epoch: 2 [428032/612104 (70%)]	lr:1.41e-04	Loss: 2.757865
[2024-01-06 17:51:44,966] {train_model:86} INFO - Train Epoch: 2 [489216/612104 (80%)]	lr:1.41e-04	Loss: 2.372805
[2024-01-06 17:51:56,891] {train_model:86} INFO - Train Epoch: 2 [550400/612104 (90%)]	lr:1.41e-04	Loss: 1.614852
[2024-01-06 17:52:08,351] {train_model:86} INFO - Train Epoch: 2 [611584/612104 (100%)]	lr:1.41e-04	Loss: 0.970009
[2024-01-06 17:52:20,942] {run_experiment:78} INFO - 
[2024-01-06 17:52:20,948] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 17:52:22,216] {result_logger:108} INFO - precision on WAKE: 0.898
[2024-01-06 17:52:23,021] {result_logger:109} INFO - recall on WAKE: 0.672
[2024-01-06 17:52:23,823] {result_logger:112} INFO - F1-score on WAKE: 0.769
[2024-01-06 17:52:23,823] {result_logger:113} INFO - 
[2024-01-06 17:52:25,061] {result_logger:108} INFO - precision on NREM: 0.833
[2024-01-06 17:52:25,845] {result_logger:109} INFO - recall on NREM: 0.752
[2024-01-06 17:52:26,621] {result_logger:112} INFO - F1-score on NREM: 0.790
[2024-01-06 17:52:26,622] {result_logger:113} INFO - 
[2024-01-06 17:52:27,771] {result_logger:108} INFO - precision on REM: 0.159
[2024-01-06 17:52:28,499] {result_logger:109} INFO - recall on REM: 0.593
[2024-01-06 17:52:29,219] {result_logger:112} INFO - F1-score on REM: 0.251
[2024-01-06 17:52:29,219] {result_logger:113} INFO - 
[2024-01-06 17:52:29,408] {result_logger:116} INFO - average precision on sleep stages: 0.630
[2024-01-06 17:52:29,601] {result_logger:118} INFO - average recall on sleep stages: 0.672
[2024-01-06 17:52:29,789] {result_logger:120} INFO - average F1-score on sleep stages: 0.603
[2024-01-06 17:52:30,290] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.672
[2024-01-06 17:52:30,315] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.698
[2024-01-06 17:52:30,318] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 17:52:30,472] {result_logger:108} INFO - precision on WAKE: 0.592
[2024-01-06 17:52:30,569] {result_logger:109} INFO - recall on WAKE: 0.998
[2024-01-06 17:52:30,667] {result_logger:112} INFO - F1-score on WAKE: 0.743
[2024-01-06 17:52:30,667] {result_logger:113} INFO - 
[2024-01-06 17:52:30,826] {result_logger:108} INFO - precision on NREM: 0.976
[2024-01-06 17:52:30,920] {result_logger:109} INFO - recall on NREM: 0.007
[2024-01-06 17:52:31,013] {result_logger:112} INFO - F1-score on NREM: 0.014
[2024-01-06 17:52:31,013] {result_logger:113} INFO - 
[2024-01-06 17:52:31,169] {result_logger:108} INFO - precision on REM: 0.000
[2024-01-06 17:52:31,265] {result_logger:109} INFO - recall on REM: 0.001
[2024-01-06 17:52:31,361] {result_logger:112} INFO - F1-score on REM: 0.000
[2024-01-06 17:52:31,361] {result_logger:113} INFO - 
[2024-01-06 17:52:31,378] {result_logger:116} INFO - average precision on sleep stages: 0.523
[2024-01-06 17:52:31,395] {result_logger:118} INFO - average recall on sleep stages: 0.335
[2024-01-06 17:52:31,413] {result_logger:120} INFO - average F1-score on sleep stages: 0.252
[2024-01-06 17:52:31,479] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.335
[2024-01-06 17:52:31,481] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.546
[2024-01-06 17:52:31,482] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 17:52:32,030] {result_logger:143} INFO - 
[[223181  29134  78736   1004]
 [ 16587 179791  42251    561]
 [  8661   6989  22932     89]
 [   852    570    737     29]]
[2024-01-06 17:52:32,580] {result_logger:150} INFO - 
[[ 67.21%   8.77%  23.71%   0.30%]
 [  6.93%  75.17%  17.66%   0.23%]
 [ 22.40%  18.07%  59.30%   0.23%]
 [ 38.94%  26.05%  33.68%   1.33%]]
[2024-01-06 17:52:33,129] {result_logger:154} INFO - 
[[ 89.53%  13.46%  54.43%  59.66%]
 [  6.65%  83.05%  29.21%  33.33%]
 [  3.47%   3.23%  15.85%   5.29%]
 [  0.34%   0.26%   0.51%   1.72%]]
[2024-01-06 17:52:33,129] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 17:52:33,201] {result_logger:143} INFO - 
[[48228     6    85     0]
 [27952   243  6910     0]
 [ 5338     0     3     0]
 [  818     5    11     0]]
[2024-01-06 17:52:33,391] {result_logger:150} INFO - 
[[ 99.81%   0.01%   0.18%   0.00%]
 [ 79.62%   0.69%  19.68%   0.00%]
 [ 99.94%   0.00%   0.06%   0.00%]
 [ 98.08%   0.60%   1.32%   0.00%]]
[2024-01-06 17:52:33,580] {result_logger:154} INFO - 
[[ 58.57%   2.36%   1.21%    nan%]
 [ 33.95%  95.67%  98.59%    nan%]
 [  6.48%   0.00%   0.04%    nan%]
 [  0.99%   1.97%   0.16%    nan%]]
[2024-01-06 17:52:33,985] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 17:52:33,985] {result_logger:77} INFO - actual:
[2024-01-06 17:52:33,985] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 17:52:33,985] {result_logger:79} INFO - predicted:
[2024-01-06 17:52:33,986] {result_logger:80} INFO - 
[[97.38%  0.07%  2.55%  0.00%]
 [13.39% 27.17% 59.45%  0.00%]
 [30.29%  1.78% 67.93%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 17:52:34,020] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it3/model_8conv_2fc-best.pth
[2024-01-06 17:52:34,020] {run_experiment:113} INFO - [epoch   2] execution time: 200.13s	 avg f1-score: 0.2524

[2024-01-06 17:52:34,020] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 17:52:34,073] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 17:53:00,214] {train_model:86} INFO - Train Epoch: 3 [60928/612104 (10%)]	lr:2.56e-04	Loss: 0.978861
[2024-01-06 17:53:27,287] {train_model:86} INFO - Train Epoch: 3 [122112/612104 (20%)]	lr:2.56e-04	Loss: 0.575918
[2024-01-06 17:53:55,537] {train_model:86} INFO - Train Epoch: 3 [183296/612104 (30%)]	lr:2.56e-04	Loss: 0.406628
[2024-01-06 17:54:21,734] {train_model:86} INFO - Train Epoch: 3 [244480/612104 (40%)]	lr:2.56e-04	Loss: 0.725198
[2024-01-06 17:54:33,048] {train_model:86} INFO - Train Epoch: 3 [305664/612104 (50%)]	lr:2.56e-04	Loss: 0.234238
[2024-01-06 17:54:44,421] {train_model:86} INFO - Train Epoch: 3 [366848/612104 (60%)]	lr:2.56e-04	Loss: 0.264564
[2024-01-06 17:54:56,330] {train_model:86} INFO - Train Epoch: 3 [428032/612104 (70%)]	lr:2.56e-04	Loss: 0.296927
[2024-01-06 17:55:07,659] {train_model:86} INFO - Train Epoch: 3 [489216/612104 (80%)]	lr:2.56e-04	Loss: 0.583698
[2024-01-06 17:55:18,985] {train_model:86} INFO - Train Epoch: 3 [550400/612104 (90%)]	lr:2.56e-04	Loss: 0.256067
[2024-01-06 17:55:30,442] {train_model:86} INFO - Train Epoch: 3 [611584/612104 (100%)]	lr:2.56e-04	Loss: 0.175933
[2024-01-06 17:55:42,768] {run_experiment:78} INFO - 
[2024-01-06 17:55:42,775] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 17:55:44,042] {result_logger:108} INFO - precision on WAKE: 0.960
[2024-01-06 17:55:44,845] {result_logger:109} INFO - recall on WAKE: 0.849
[2024-01-06 17:55:45,659] {result_logger:112} INFO - F1-score on WAKE: 0.901
[2024-01-06 17:55:45,659] {result_logger:113} INFO - 
[2024-01-06 17:55:46,889] {result_logger:108} INFO - precision on NREM: 0.880
[2024-01-06 17:55:47,680] {result_logger:109} INFO - recall on NREM: 0.853
[2024-01-06 17:55:48,485] {result_logger:112} INFO - F1-score on NREM: 0.867
[2024-01-06 17:55:48,485] {result_logger:113} INFO - 
[2024-01-06 17:55:49,633] {result_logger:108} INFO - precision on REM: 0.378
[2024-01-06 17:55:50,346] {result_logger:109} INFO - recall on REM: 0.824
[2024-01-06 17:55:51,059] {result_logger:112} INFO - F1-score on REM: 0.519
[2024-01-06 17:55:51,059] {result_logger:113} INFO - 
[2024-01-06 17:55:51,253] {result_logger:116} INFO - average precision on sleep stages: 0.740
[2024-01-06 17:55:51,445] {result_logger:118} INFO - average recall on sleep stages: 0.842
[2024-01-06 17:55:51,636] {result_logger:120} INFO - average F1-score on sleep stages: 0.762
[2024-01-06 17:55:52,144] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.842
[2024-01-06 17:55:52,171] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.849
[2024-01-06 17:55:52,176] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 17:55:52,333] {result_logger:108} INFO - precision on WAKE: 0.726
[2024-01-06 17:55:52,429] {result_logger:109} INFO - recall on WAKE: 0.951
[2024-01-06 17:55:52,526] {result_logger:112} INFO - F1-score on WAKE: 0.824
[2024-01-06 17:55:52,526] {result_logger:113} INFO - 
[2024-01-06 17:55:52,685] {result_logger:108} INFO - precision on NREM: 0.985
[2024-01-06 17:55:52,785] {result_logger:109} INFO - recall on NREM: 0.215
[2024-01-06 17:55:52,886] {result_logger:112} INFO - F1-score on NREM: 0.353
[2024-01-06 17:55:52,886] {result_logger:113} INFO - 
[2024-01-06 17:55:53,046] {result_logger:108} INFO - precision on REM: 0.286
[2024-01-06 17:55:53,143] {result_logger:109} INFO - recall on REM: 0.954
[2024-01-06 17:55:53,243] {result_logger:112} INFO - F1-score on REM: 0.440
[2024-01-06 17:55:53,243] {result_logger:113} INFO - 
[2024-01-06 17:55:53,262] {result_logger:116} INFO - average precision on sleep stages: 0.666
[2024-01-06 17:55:53,281] {result_logger:118} INFO - average recall on sleep stages: 0.707
[2024-01-06 17:55:53,300] {result_logger:120} INFO - average F1-score on sleep stages: 0.539
[2024-01-06 17:55:53,371] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.707
[2024-01-06 17:55:53,374] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.660
[2024-01-06 17:55:53,375] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 17:55:53,945] {result_logger:143} INFO - 
[[281970  23395  26571    119]
 [  9191 204128  25769    102]
 [  2443   4361  31860      7]
 [  1338    510    336      4]]
[2024-01-06 17:55:54,517] {result_logger:150} INFO - 
[[ 84.92%   7.05%   8.00%   0.04%]
 [  3.84%  85.34%  10.77%   0.04%]
 [  6.32%  11.28%  82.39%   0.02%]
 [ 61.15%  23.31%  15.36%   0.18%]]
[2024-01-06 17:55:55,093] {result_logger:154} INFO - 
[[ 95.60%  10.07%  31.43%  51.29%]
 [  3.12%  87.84%  30.48%  43.97%]
 [  0.83%   1.88%  37.69%   3.02%]
 [  0.45%   0.22%   0.40%   1.72%]]
[2024-01-06 17:55:55,093] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 17:55:55,170] {result_logger:143} INFO - 
[[45949   111  2259     0]
 [17069  7559 10477     0]
 [  240     5  5096     0]
 [  616    33   185     0]]
[2024-01-06 17:55:55,370] {result_logger:150} INFO - 
[[ 95.10%   0.23%   4.68%   0.00%]
 [ 48.62%  21.53%  29.84%   0.00%]
 [  4.49%   0.09%  95.41%   0.00%]
 [ 73.86%   3.96%  22.18%   0.00%]]
[2024-01-06 17:55:55,565] {result_logger:154} INFO - 
[[ 71.94%   1.44%  12.54%    nan%]
 [ 26.72%  98.07%  58.15%    nan%]
 [  0.38%   0.06%  28.28%    nan%]
 [  0.96%   0.43%   1.03%    nan%]]
[2024-01-06 17:55:55,985] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 17:55:55,985] {result_logger:77} INFO - actual:
[2024-01-06 17:55:55,985] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 17:55:55,985] {result_logger:79} INFO - predicted:
[2024-01-06 17:55:55,986] {result_logger:80} INFO - 
[[93.52%  2.40%  4.08%  0.00%]
 [19.62% 69.62% 10.77%  0.00%]
 [14.58%  4.50% 80.93%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 17:55:56,022] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it3/model_8conv_2fc-best.pth
[2024-01-06 17:55:56,022] {run_experiment:113} INFO - [epoch   3] execution time: 202.00s	 avg f1-score: 0.5389

[2024-01-06 17:55:56,022] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 17:55:56,076] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 17:56:22,043] {train_model:86} INFO - Train Epoch: 4 [60928/612104 (10%)]	lr:2.41e-04	Loss: 0.376908
[2024-01-06 17:56:33,467] {train_model:86} INFO - Train Epoch: 4 [122112/612104 (20%)]	lr:2.41e-04	Loss: 0.203719
[2024-01-06 17:57:00,664] {train_model:86} INFO - Train Epoch: 4 [183296/612104 (30%)]	lr:2.41e-04	Loss: 0.212446
[2024-01-06 17:57:40,461] {train_model:86} INFO - Train Epoch: 4 [244480/612104 (40%)]	lr:2.41e-04	Loss: 0.245551
[2024-01-06 17:58:00,887] {train_model:86} INFO - Train Epoch: 4 [305664/612104 (50%)]	lr:2.41e-04	Loss: 0.375101
[2024-01-06 17:58:18,417] {train_model:86} INFO - Train Epoch: 4 [366848/612104 (60%)]	lr:2.41e-04	Loss: 0.201047
[2024-01-06 17:58:29,972] {train_model:86} INFO - Train Epoch: 4 [428032/612104 (70%)]	lr:2.41e-04	Loss: 0.186389
[2024-01-06 17:58:41,785] {train_model:86} INFO - Train Epoch: 4 [489216/612104 (80%)]	lr:2.41e-04	Loss: 0.239584
[2024-01-06 17:58:53,250] {train_model:86} INFO - Train Epoch: 4 [550400/612104 (90%)]	lr:2.41e-04	Loss: 0.160805
[2024-01-06 17:59:04,703] {train_model:86} INFO - Train Epoch: 4 [611584/612104 (100%)]	lr:2.41e-04	Loss: 0.361109
[2024-01-06 17:59:17,175] {run_experiment:78} INFO - 
[2024-01-06 17:59:17,181] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 17:59:18,465] {result_logger:108} INFO - precision on WAKE: 0.965
[2024-01-06 17:59:19,307] {result_logger:109} INFO - recall on WAKE: 0.902
[2024-01-06 17:59:20,150] {result_logger:112} INFO - F1-score on WAKE: 0.933
[2024-01-06 17:59:20,150] {result_logger:113} INFO - 
[2024-01-06 17:59:21,388] {result_logger:108} INFO - precision on NREM: 0.908
[2024-01-06 17:59:22,204] {result_logger:109} INFO - recall on NREM: 0.882
[2024-01-06 17:59:23,013] {result_logger:112} INFO - F1-score on NREM: 0.895
[2024-01-06 17:59:23,013] {result_logger:113} INFO - 
[2024-01-06 17:59:24,135] {result_logger:108} INFO - precision on REM: 0.507
[2024-01-06 17:59:24,847] {result_logger:109} INFO - recall on REM: 0.881
[2024-01-06 17:59:25,568] {result_logger:112} INFO - F1-score on REM: 0.644
[2024-01-06 17:59:25,568] {result_logger:113} INFO - 
[2024-01-06 17:59:25,766] {result_logger:116} INFO - average precision on sleep stages: 0.794
[2024-01-06 17:59:25,963] {result_logger:118} INFO - average recall on sleep stages: 0.889
[2024-01-06 17:59:26,153] {result_logger:120} INFO - average F1-score on sleep stages: 0.824
[2024-01-06 17:59:26,663] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.889
[2024-01-06 17:59:26,690] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.893
[2024-01-06 17:59:26,694] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 17:59:26,852] {result_logger:108} INFO - precision on WAKE: 0.994
[2024-01-06 17:59:26,950] {result_logger:109} INFO - recall on WAKE: 0.693
[2024-01-06 17:59:27,050] {result_logger:112} INFO - F1-score on WAKE: 0.817
[2024-01-06 17:59:27,050] {result_logger:113} INFO - 
[2024-01-06 17:59:27,211] {result_logger:108} INFO - precision on NREM: 0.792
[2024-01-06 17:59:27,310] {result_logger:109} INFO - recall on NREM: 0.958
[2024-01-06 17:59:27,410] {result_logger:112} INFO - F1-score on NREM: 0.867
[2024-01-06 17:59:27,410] {result_logger:113} INFO - 
[2024-01-06 17:59:27,570] {result_logger:108} INFO - precision on REM: 0.376
[2024-01-06 17:59:27,671] {result_logger:109} INFO - recall on REM: 0.893
[2024-01-06 17:59:27,770] {result_logger:112} INFO - F1-score on REM: 0.529
[2024-01-06 17:59:27,771] {result_logger:113} INFO - 
[2024-01-06 17:59:27,789] {result_logger:116} INFO - average precision on sleep stages: 0.721
[2024-01-06 17:59:27,807] {result_logger:118} INFO - average recall on sleep stages: 0.848
[2024-01-06 17:59:27,825] {result_logger:120} INFO - average F1-score on sleep stages: 0.738
[2024-01-06 17:59:27,894] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.848
[2024-01-06 17:59:27,897] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.809
[2024-01-06 17:59:27,897] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 17:59:28,480] {result_logger:143} INFO - 
[[299676  18359  13991     29]
 [  9091 210983  19089     27]
 [  1680   2907  34083      1]
 [  1702    317    168      1]]
[2024-01-06 17:59:29,059] {result_logger:150} INFO - 
[[ 90.25%   5.53%   4.21%   0.01%]
 [  3.80%  88.21%   7.98%   0.01%]
 [  4.34%   7.52%  88.14%   0.00%]
 [ 77.79%  14.49%   7.68%   0.05%]]
[2024-01-06 17:59:29,638] {result_logger:154} INFO - 
[[ 96.00%   7.89%  20.78%  50.00%]
 [  2.91%  90.72%  28.35%  46.55%]
 [  0.54%   1.25%  50.62%   1.72%]
 [  0.55%   0.14%   0.25%   1.72%]]
[2024-01-06 17:59:29,638] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 17:59:29,716] {result_logger:143} INFO - 
[[33470  8238  6611     0]
 [  189 33614  1302     0]
 [    5   566  4770     0]
 [   74   362   398     0]]
[2024-01-06 17:59:29,910] {result_logger:150} INFO - 
[[ 69.27%  17.05%  13.68%   0.00%]
 [  0.54%  95.75%   3.71%   0.00%]
 [  0.09%  10.60%  89.31%   0.00%]
 [  8.87%  43.41%  47.72%   0.00%]]
[2024-01-06 17:59:30,103] {result_logger:154} INFO - 
[[ 99.21%  19.26%  50.54%    nan%]
 [  0.56%  78.57%   9.95%    nan%]
 [  0.01%   1.32%  36.47%    nan%]
 [  0.22%   0.85%   3.04%    nan%]]
[2024-01-06 17:59:30,514] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 17:59:30,514] {result_logger:77} INFO - actual:
[2024-01-06 17:59:30,514] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 17:59:30,514] {result_logger:79} INFO - predicted:
[2024-01-06 17:59:30,514] {result_logger:80} INFO - 
[[95.94%  2.50%  1.56%  0.00%]
 [ 1.65% 93.63%  4.72%  0.00%]
 [ 5.08% 14.39% 80.54%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 17:59:30,550] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it3/model_8conv_2fc-best.pth
[2024-01-06 17:59:30,551] {run_experiment:113} INFO - [epoch   4] execution time: 214.53s	 avg f1-score: 0.7377

[2024-01-06 17:59:30,551] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 17:59:30,604] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 17:59:56,757] {train_model:86} INFO - Train Epoch: 5 [60928/612104 (10%)]	lr:2.27e-04	Loss: 0.205640
[2024-01-06 18:00:08,077] {train_model:86} INFO - Train Epoch: 5 [122112/612104 (20%)]	lr:2.27e-04	Loss: 2.137350
[2024-01-06 18:00:19,532] {train_model:86} INFO - Train Epoch: 5 [183296/612104 (30%)]	lr:2.27e-04	Loss: 0.153942
[2024-01-06 18:00:46,780] {train_model:86} INFO - Train Epoch: 5 [244480/612104 (40%)]	lr:2.27e-04	Loss: 0.174447
[2024-01-06 18:01:22,133] {train_model:86} INFO - Train Epoch: 5 [305664/612104 (50%)]	lr:2.27e-04	Loss: 0.210830
[2024-01-06 18:01:39,089] {train_model:86} INFO - Train Epoch: 5 [366848/612104 (60%)]	lr:2.27e-04	Loss: 0.124638
[2024-01-06 18:02:04,368] {train_model:86} INFO - Train Epoch: 5 [428032/612104 (70%)]	lr:2.27e-04	Loss: 0.370030
[2024-01-06 18:02:16,091] {train_model:86} INFO - Train Epoch: 5 [489216/612104 (80%)]	lr:2.27e-04	Loss: 0.065477
[2024-01-06 18:02:28,146] {train_model:86} INFO - Train Epoch: 5 [550400/612104 (90%)]	lr:2.27e-04	Loss: 0.177284
[2024-01-06 18:02:40,229] {train_model:86} INFO - Train Epoch: 5 [611584/612104 (100%)]	lr:2.27e-04	Loss: 0.127180
[2024-01-06 18:02:52,800] {run_experiment:78} INFO - 
[2024-01-06 18:02:52,806] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 18:02:54,123] {result_logger:108} INFO - precision on WAKE: 0.982
[2024-01-06 18:02:54,969] {result_logger:109} INFO - recall on WAKE: 0.929
[2024-01-06 18:02:55,805] {result_logger:112} INFO - F1-score on WAKE: 0.955
[2024-01-06 18:02:55,806] {result_logger:113} INFO - 
[2024-01-06 18:02:57,081] {result_logger:108} INFO - precision on NREM: 0.921
[2024-01-06 18:02:57,867] {result_logger:109} INFO - recall on NREM: 0.906
[2024-01-06 18:02:58,698] {result_logger:112} INFO - F1-score on NREM: 0.914
[2024-01-06 18:02:58,698] {result_logger:113} INFO - 
[2024-01-06 18:02:59,907] {result_logger:108} INFO - precision on REM: 0.578
[2024-01-06 18:03:00,653] {result_logger:109} INFO - recall on REM: 0.904
[2024-01-06 18:03:01,355] {result_logger:112} INFO - F1-score on REM: 0.705
[2024-01-06 18:03:01,355] {result_logger:113} INFO - 
[2024-01-06 18:03:01,546] {result_logger:116} INFO - average precision on sleep stages: 0.827
[2024-01-06 18:03:01,741] {result_logger:118} INFO - average recall on sleep stages: 0.913
[2024-01-06 18:03:01,925] {result_logger:120} INFO - average F1-score on sleep stages: 0.858
[2024-01-06 18:03:02,429] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.913
[2024-01-06 18:03:02,455] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.919
[2024-01-06 18:03:02,460] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 18:03:02,616] {result_logger:108} INFO - precision on WAKE: 0.907
[2024-01-06 18:03:02,712] {result_logger:109} INFO - recall on WAKE: 0.783
[2024-01-06 18:03:02,809] {result_logger:112} INFO - F1-score on WAKE: 0.841
[2024-01-06 18:03:02,810] {result_logger:113} INFO - 
[2024-01-06 18:03:02,964] {result_logger:108} INFO - precision on NREM: 0.953
[2024-01-06 18:03:03,058] {result_logger:109} INFO - recall on NREM: 0.775
[2024-01-06 18:03:03,155] {result_logger:112} INFO - F1-score on NREM: 0.855
[2024-01-06 18:03:03,155] {result_logger:113} INFO - 
[2024-01-06 18:03:03,311] {result_logger:108} INFO - precision on REM: 0.276
[2024-01-06 18:03:03,409] {result_logger:109} INFO - recall on REM: 0.958
[2024-01-06 18:03:03,504] {result_logger:112} INFO - F1-score on REM: 0.429
[2024-01-06 18:03:03,504] {result_logger:113} INFO - 
[2024-01-06 18:03:03,522] {result_logger:116} INFO - average precision on sleep stages: 0.712
[2024-01-06 18:03:03,539] {result_logger:118} INFO - average recall on sleep stages: 0.839
[2024-01-06 18:03:03,556] {result_logger:120} INFO - average F1-score on sleep stages: 0.708
[2024-01-06 18:03:03,625] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.839
[2024-01-06 18:03:03,628] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.790
[2024-01-06 18:03:03,629] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 18:03:04,206] {result_logger:143} INFO - 
[[308555  15677   7821      2]
 [  4698 216809  17676      7]
 [   853   2868  34950      0]
 [  1841    264     83      0]]
[2024-01-06 18:03:04,782] {result_logger:150} INFO - 
[[ 92.92%   4.72%   2.36%   0.00%]
 [  1.96%  90.64%   7.39%   0.00%]
 [  2.21%   7.42%  90.38%   0.00%]
 [ 84.14%  12.07%   3.79%   0.00%]]
[2024-01-06 18:03:05,353] {result_logger:154} INFO - 
[[ 97.66%   6.65%  12.92%  22.22%]
 [  1.49%  92.02%  29.20%  77.78%]
 [  0.27%   1.22%  57.74%   0.00%]
 [  0.58%   0.11%   0.14%   0.00%]]
[2024-01-06 18:03:05,353] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 18:03:05,431] {result_logger:143} INFO - 
[[37837  1293  9189     0]
 [ 3687 27208  4210     0]
 [  181    44  5116     0]
 [  128    41   665     0]]
[2024-01-06 18:03:05,628] {result_logger:150} INFO - 
[[ 78.31%   2.68%  19.02%   0.00%]
 [ 10.50%  77.50%  11.99%   0.00%]
 [  3.39%   0.82%  95.79%   0.00%]
 [ 15.35%   4.92%  79.74%   0.00%]]
[2024-01-06 18:03:05,810] {result_logger:154} INFO - 
[[ 90.45%   4.52%  47.91%    nan%]
 [  8.81%  95.18%  21.95%    nan%]
 [  0.43%   0.15%  26.67%    nan%]
 [  0.31%   0.14%   3.47%    nan%]]
[2024-01-06 18:03:06,308] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 18:03:06,308] {result_logger:77} INFO - actual:
[2024-01-06 18:03:06,308] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 18:03:06,308] {result_logger:79} INFO - predicted:
[2024-01-06 18:03:06,308] {result_logger:80} INFO - 
[[94.33%  1.97%  3.70%  0.00%]
 [ 2.70% 93.05%  4.24%  0.00%]
 [ 8.34%  6.06% 85.60%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 18:03:06,346] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it3/model_8conv_2fc-best.pth
[2024-01-06 18:03:06,347] {run_experiment:113} INFO - [epoch   5] execution time: 215.80s	 avg f1-score: 0.7081

[2024-01-06 18:03:06,347] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 18:03:06,403] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 18:03:32,462] {train_model:86} INFO - Train Epoch: 6 [60928/612104 (10%)]	lr:2.14e-04	Loss: 0.157452
[2024-01-06 18:03:43,871] {train_model:86} INFO - Train Epoch: 6 [122112/612104 (20%)]	lr:2.14e-04	Loss: 0.178497
[2024-01-06 18:03:55,102] {train_model:86} INFO - Train Epoch: 6 [183296/612104 (30%)]	lr:2.14e-04	Loss: 0.128192
[2024-01-06 18:04:21,530] {train_model:86} INFO - Train Epoch: 6 [244480/612104 (40%)]	lr:2.14e-04	Loss: 0.194162
[2024-01-06 18:04:46,426] {train_model:86} INFO - Train Epoch: 6 [305664/612104 (50%)]	lr:2.14e-04	Loss: 0.112782
[2024-01-06 18:04:59,674] {train_model:86} INFO - Train Epoch: 6 [366848/612104 (60%)]	lr:2.14e-04	Loss: 0.121337
[2024-01-06 18:05:26,831] {train_model:86} INFO - Train Epoch: 6 [428032/612104 (70%)]	lr:2.14e-04	Loss: 0.226663
[2024-01-06 18:05:52,229] {train_model:86} INFO - Train Epoch: 6 [489216/612104 (80%)]	lr:2.14e-04	Loss: 0.309505
[2024-01-06 18:06:03,966] {train_model:86} INFO - Train Epoch: 6 [550400/612104 (90%)]	lr:2.14e-04	Loss: 0.212583
[2024-01-06 18:06:15,960] {train_model:86} INFO - Train Epoch: 6 [611584/612104 (100%)]	lr:2.14e-04	Loss: 0.224483
[2024-01-06 18:06:28,893] {run_experiment:78} INFO - 
[2024-01-06 18:06:28,900] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 18:06:30,181] {result_logger:108} INFO - precision on WAKE: 0.987
[2024-01-06 18:06:30,990] {result_logger:109} INFO - recall on WAKE: 0.945
[2024-01-06 18:06:31,801] {result_logger:112} INFO - F1-score on WAKE: 0.965
[2024-01-06 18:06:31,801] {result_logger:113} INFO - 
[2024-01-06 18:06:33,052] {result_logger:108} INFO - precision on NREM: 0.936
[2024-01-06 18:06:33,837] {result_logger:109} INFO - recall on NREM: 0.926
[2024-01-06 18:06:34,626] {result_logger:112} INFO - F1-score on NREM: 0.931
[2024-01-06 18:06:34,627] {result_logger:113} INFO - 
[2024-01-06 18:06:35,755] {result_logger:108} INFO - precision on REM: 0.640
[2024-01-06 18:06:36,447] {result_logger:109} INFO - recall on REM: 0.916
[2024-01-06 18:06:37,137] {result_logger:112} INFO - F1-score on REM: 0.753
[2024-01-06 18:06:37,137] {result_logger:113} INFO - 
[2024-01-06 18:06:37,322] {result_logger:116} INFO - average precision on sleep stages: 0.854
[2024-01-06 18:06:37,504] {result_logger:118} INFO - average recall on sleep stages: 0.929
[2024-01-06 18:06:37,689] {result_logger:120} INFO - average F1-score on sleep stages: 0.883
[2024-01-06 18:06:38,207] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.929
[2024-01-06 18:06:38,234] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.935
[2024-01-06 18:06:38,237] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 18:06:38,397] {result_logger:108} INFO - precision on WAKE: 0.832
[2024-01-06 18:06:38,496] {result_logger:109} INFO - recall on WAKE: 0.934
[2024-01-06 18:06:38,594] {result_logger:112} INFO - F1-score on WAKE: 0.880
[2024-01-06 18:06:38,594] {result_logger:113} INFO - 
[2024-01-06 18:06:38,752] {result_logger:108} INFO - precision on NREM: 0.961
[2024-01-06 18:06:38,847] {result_logger:109} INFO - recall on NREM: 0.560
[2024-01-06 18:06:38,945] {result_logger:112} INFO - F1-score on NREM: 0.708
[2024-01-06 18:06:38,946] {result_logger:113} INFO - 
[2024-01-06 18:06:39,105] {result_logger:108} INFO - precision on REM: 0.344
[2024-01-06 18:06:39,202] {result_logger:109} INFO - recall on REM: 0.905
[2024-01-06 18:06:39,299] {result_logger:112} INFO - F1-score on REM: 0.498
[2024-01-06 18:06:39,300] {result_logger:113} INFO - 
[2024-01-06 18:06:39,318] {result_logger:116} INFO - average precision on sleep stages: 0.712
[2024-01-06 18:06:39,336] {result_logger:118} INFO - average recall on sleep stages: 0.800
[2024-01-06 18:06:39,353] {result_logger:120} INFO - average F1-score on sleep stages: 0.695
[2024-01-06 18:06:39,425] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.800
[2024-01-06 18:06:39,428] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.785
[2024-01-06 18:06:39,428] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 18:06:40,008] {result_logger:143} INFO - 
[[313654  12681   5716      4]
 [  3564 221415  14206      5]
 [   701   2556  35414      0]
 [  1877    257     54      0]]
[2024-01-06 18:06:40,600] {result_logger:150} INFO - 
[[ 94.46%   3.82%   1.72%   0.00%]
 [  1.49%  92.57%   5.94%   0.00%]
 [  1.81%   6.61%  91.58%   0.00%]
 [ 85.79%  11.75%   2.47%   0.00%]]
[2024-01-06 18:06:41,187] {result_logger:154} INFO - 
[[ 98.08%   5.35%  10.32%  44.44%]
 [  1.11%  93.46%  25.65%  55.56%]
 [  0.22%   1.08%  63.94%   0.00%]
 [  0.59%   0.11%   0.10%   0.00%]]
[2024-01-06 18:06:41,187] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 18:06:41,267] {result_logger:143} INFO - 
[[45148   770  2401     0]
 [ 8627 19659  6819     0]
 [  484    23  4834     0]
 [  521     9   304     0]]
[2024-01-06 18:06:41,466] {result_logger:150} INFO - 
[[ 93.44%   1.59%   4.97%   0.00%]
 [ 24.57%  56.00%  19.42%   0.00%]
 [  9.06%   0.43%  90.51%   0.00%]
 [ 62.47%   1.08%  36.45%   0.00%]]
[2024-01-06 18:06:41,662] {result_logger:154} INFO - 
[[ 82.42%   3.76%  16.72%    nan%]
 [ 15.75%  96.08%  47.49%    nan%]
 [  0.88%   0.11%  33.67%    nan%]
 [  0.95%   0.04%   2.12%    nan%]]
[2024-01-06 18:06:42,084] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 18:06:42,084] {result_logger:77} INFO - actual:
[2024-01-06 18:06:42,085] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 18:06:42,085] {result_logger:79} INFO - predicted:
[2024-01-06 18:06:42,085] {result_logger:80} INFO - 
[[96.26%  1.27%  2.47%  0.00%]
 [ 3.09% 88.73%  8.17%  0.00%]
 [ 9.86% 11.22% 78.92%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 18:06:42,119] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it3/model_8conv_2fc-best.pth
[2024-01-06 18:06:42,119] {run_experiment:113} INFO - [epoch   6] execution time: 215.77s	 avg f1-score: 0.6955

[2024-01-06 18:06:42,119] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 18:06:42,174] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 18:07:08,369] {train_model:86} INFO - Train Epoch: 7 [60928/612104 (10%)]	lr:2.01e-04	Loss: 0.123329
[2024-01-06 18:07:19,763] {train_model:86} INFO - Train Epoch: 7 [122112/612104 (20%)]	lr:2.01e-04	Loss: 0.149109
[2024-01-06 18:07:31,362] {train_model:86} INFO - Train Epoch: 7 [183296/612104 (30%)]	lr:2.01e-04	Loss: 0.104688
[2024-01-06 18:07:43,230] {train_model:86} INFO - Train Epoch: 7 [244480/612104 (40%)]	lr:2.01e-04	Loss: 0.078115
[2024-01-06 18:08:10,407] {train_model:86} INFO - Train Epoch: 7 [305664/612104 (50%)]	lr:2.01e-04	Loss: 0.099974
[2024-01-06 18:08:35,696] {train_model:86} INFO - Train Epoch: 7 [366848/612104 (60%)]	lr:2.01e-04	Loss: 0.196068
[2024-01-06 18:08:47,144] {train_model:86} INFO - Train Epoch: 7 [428032/612104 (70%)]	lr:2.01e-04	Loss: 0.302369
[2024-01-06 18:09:14,211] {train_model:86} INFO - Train Epoch: 7 [489216/612104 (80%)]	lr:2.01e-04	Loss: 0.140716
[2024-01-06 18:09:39,636] {train_model:86} INFO - Train Epoch: 7 [550400/612104 (90%)]	lr:2.01e-04	Loss: 0.182733
[2024-01-06 18:09:51,053] {train_model:86} INFO - Train Epoch: 7 [611584/612104 (100%)]	lr:2.01e-04	Loss: 0.121887
[2024-01-06 18:10:03,698] {run_experiment:78} INFO - 
[2024-01-06 18:10:03,704] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 18:10:04,965] {result_logger:108} INFO - precision on WAKE: 0.988
[2024-01-06 18:10:05,801] {result_logger:109} INFO - recall on WAKE: 0.950
[2024-01-06 18:10:06,627] {result_logger:112} INFO - F1-score on WAKE: 0.968
[2024-01-06 18:10:06,627] {result_logger:113} INFO - 
[2024-01-06 18:10:07,866] {result_logger:108} INFO - precision on NREM: 0.942
[2024-01-06 18:10:08,678] {result_logger:109} INFO - recall on NREM: 0.935
[2024-01-06 18:10:09,487] {result_logger:112} INFO - F1-score on NREM: 0.939
[2024-01-06 18:10:09,487] {result_logger:113} INFO - 
[2024-01-06 18:10:10,630] {result_logger:108} INFO - precision on REM: 0.674
[2024-01-06 18:10:11,367] {result_logger:109} INFO - recall on REM: 0.930
[2024-01-06 18:10:12,096] {result_logger:112} INFO - F1-score on REM: 0.781
[2024-01-06 18:10:12,096] {result_logger:113} INFO - 
[2024-01-06 18:10:12,289] {result_logger:116} INFO - average precision on sleep stages: 0.868
[2024-01-06 18:10:12,482] {result_logger:118} INFO - average recall on sleep stages: 0.938
[2024-01-06 18:10:12,680] {result_logger:120} INFO - average F1-score on sleep stages: 0.896
[2024-01-06 18:10:13,205] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.938
[2024-01-06 18:10:13,232] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.943
[2024-01-06 18:10:13,237] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 18:10:13,400] {result_logger:108} INFO - precision on WAKE: 0.940
[2024-01-06 18:10:13,500] {result_logger:109} INFO - recall on WAKE: 0.873
[2024-01-06 18:10:13,597] {result_logger:112} INFO - F1-score on WAKE: 0.905
[2024-01-06 18:10:13,597] {result_logger:113} INFO - 
[2024-01-06 18:10:13,755] {result_logger:108} INFO - precision on NREM: 0.933
[2024-01-06 18:10:13,854] {result_logger:109} INFO - recall on NREM: 0.864
[2024-01-06 18:10:13,954] {result_logger:112} INFO - F1-score on NREM: 0.897
[2024-01-06 18:10:13,955] {result_logger:113} INFO - 
[2024-01-06 18:10:14,114] {result_logger:108} INFO - precision on REM: 0.435
[2024-01-06 18:10:14,213] {result_logger:109} INFO - recall on REM: 0.929
[2024-01-06 18:10:14,311] {result_logger:112} INFO - F1-score on REM: 0.593
[2024-01-06 18:10:14,311] {result_logger:113} INFO - 
[2024-01-06 18:10:14,330] {result_logger:116} INFO - average precision on sleep stages: 0.770
[2024-01-06 18:10:14,348] {result_logger:118} INFO - average recall on sleep stages: 0.889
[2024-01-06 18:10:14,366] {result_logger:120} INFO - average F1-score on sleep stages: 0.798
[2024-01-06 18:10:14,436] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.889
[2024-01-06 18:10:14,439] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.873
[2024-01-06 18:10:14,439] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 18:10:15,015] {result_logger:143} INFO - 
[[315311  11688   5056      0]
 [  3160 223696  12334      0]
 [   620   2105  35946      0]
 [  1880    261     47      0]]
[2024-01-06 18:10:15,591] {result_logger:150} INFO - 
[[ 94.96%   3.52%   1.52%   0.00%]
 [  1.32%  93.52%   5.16%   0.00%]
 [  1.60%   5.44%  92.95%   0.00%]
 [ 85.92%  11.93%   2.15%   0.00%]]
[2024-01-06 18:10:16,176] {result_logger:154} INFO - 
[[ 98.24%   4.92%   9.47%    nan%]
 [  0.98%  94.09%  23.10%    nan%]
 [  0.19%   0.89%  67.34%    nan%]
 [  0.59%   0.11%   0.09%    nan%]]
[2024-01-06 18:10:16,176] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 18:10:16,251] {result_logger:143} INFO - 
[[42186  2027  4106     0]
 [ 2449 30323  2333     0]
 [  237   140  4964     0]
 [  325   135   374     0]]
[2024-01-06 18:10:16,444] {result_logger:150} INFO - 
[[ 87.31%   4.20%   8.50%   0.00%]
 [  6.98%  86.38%   6.65%   0.00%]
 [  4.44%   2.62%  92.94%   0.00%]
 [ 38.97%  16.19%  44.84%   0.00%]]
[2024-01-06 18:10:16,636] {result_logger:154} INFO - 
[[ 93.34%   6.21%  34.86%    nan%]
 [  5.42%  92.94%  19.81%    nan%]
 [  0.52%   0.43%  42.15%    nan%]
 [  0.72%   0.41%   3.18%    nan%]]
[2024-01-06 18:10:17,052] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 18:10:17,052] {result_logger:77} INFO - actual:
[2024-01-06 18:10:17,052] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 18:10:17,052] {result_logger:79} INFO - predicted:
[2024-01-06 18:10:17,053] {result_logger:80} INFO - 
[[94.60%  2.53%  2.87%  0.00%]
 [ 2.91% 94.46%  2.63%  0.00%]
 [12.64%  5.64% 81.72%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 18:10:17,087] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it3/model_8conv_2fc-best.pth
[2024-01-06 18:10:17,088] {run_experiment:113} INFO - [epoch   7] execution time: 214.97s	 avg f1-score: 0.7985

[2024-01-06 18:10:17,088] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 18:10:17,145] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 18:10:43,306] {train_model:86} INFO - Train Epoch: 8 [60928/612104 (10%)]	lr:1.90e-04	Loss: 0.091434
[2024-01-06 18:10:55,440] {train_model:86} INFO - Train Epoch: 8 [122112/612104 (20%)]	lr:1.90e-04	Loss: 0.279810
[2024-01-06 18:11:06,997] {train_model:86} INFO - Train Epoch: 8 [183296/612104 (30%)]	lr:1.90e-04	Loss: 0.262203
[2024-01-06 18:11:18,633] {train_model:86} INFO - Train Epoch: 8 [244480/612104 (40%)]	lr:1.90e-04	Loss: 0.088985
[2024-01-06 18:11:30,042] {train_model:86} INFO - Train Epoch: 8 [305664/612104 (50%)]	lr:1.90e-04	Loss: 0.217690
[2024-01-06 18:11:56,938] {train_model:86} INFO - Train Epoch: 8 [366848/612104 (60%)]	lr:1.90e-04	Loss: 0.118107
[2024-01-06 18:12:22,313] {train_model:86} INFO - Train Epoch: 8 [428032/612104 (70%)]	lr:1.90e-04	Loss: 0.066347
[2024-01-06 18:12:33,468] {train_model:86} INFO - Train Epoch: 8 [489216/612104 (80%)]	lr:1.90e-04	Loss: 0.114827
[2024-01-06 18:13:00,368] {train_model:86} INFO - Train Epoch: 8 [550400/612104 (90%)]	lr:1.90e-04	Loss: 0.136078
[2024-01-06 18:13:25,384] {train_model:86} INFO - Train Epoch: 8 [611584/612104 (100%)]	lr:1.90e-04	Loss: 0.156874
[2024-01-06 18:13:38,175] {run_experiment:78} INFO - 
[2024-01-06 18:13:38,181] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 18:13:39,444] {result_logger:108} INFO - precision on WAKE: 0.988
[2024-01-06 18:13:40,252] {result_logger:109} INFO - recall on WAKE: 0.953
[2024-01-06 18:13:41,048] {result_logger:112} INFO - F1-score on WAKE: 0.970
[2024-01-06 18:13:41,048] {result_logger:113} INFO - 
[2024-01-06 18:13:42,268] {result_logger:108} INFO - precision on NREM: 0.945
[2024-01-06 18:13:43,050] {result_logger:109} INFO - recall on NREM: 0.940
[2024-01-06 18:13:43,845] {result_logger:112} INFO - F1-score on NREM: 0.942
[2024-01-06 18:13:43,845] {result_logger:113} INFO - 
[2024-01-06 18:13:44,959] {result_logger:108} INFO - precision on REM: 0.699
[2024-01-06 18:13:45,661] {result_logger:109} INFO - recall on REM: 0.934
[2024-01-06 18:13:46,368] {result_logger:112} INFO - F1-score on REM: 0.799
[2024-01-06 18:13:46,368] {result_logger:113} INFO - 
[2024-01-06 18:13:46,554] {result_logger:116} INFO - average precision on sleep stages: 0.877
[2024-01-06 18:13:46,741] {result_logger:118} INFO - average recall on sleep stages: 0.942
[2024-01-06 18:13:46,925] {result_logger:120} INFO - average F1-score on sleep stages: 0.904
[2024-01-06 18:13:47,443] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.942
[2024-01-06 18:13:47,468] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.947
[2024-01-06 18:13:47,472] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 18:13:47,635] {result_logger:108} INFO - precision on WAKE: 0.945
[2024-01-06 18:13:47,730] {result_logger:109} INFO - recall on WAKE: 0.660
[2024-01-06 18:13:47,827] {result_logger:112} INFO - F1-score on WAKE: 0.777
[2024-01-06 18:13:47,827] {result_logger:113} INFO - 
[2024-01-06 18:13:47,988] {result_logger:108} INFO - precision on NREM: 0.878
[2024-01-06 18:13:48,087] {result_logger:109} INFO - recall on NREM: 0.863
[2024-01-06 18:13:48,187] {result_logger:112} INFO - F1-score on NREM: 0.870
[2024-01-06 18:13:48,187] {result_logger:113} INFO - 
[2024-01-06 18:13:48,353] {result_logger:108} INFO - precision on REM: 0.252
[2024-01-06 18:13:48,457] {result_logger:109} INFO - recall on REM: 0.969
[2024-01-06 18:13:48,560] {result_logger:112} INFO - F1-score on REM: 0.401
[2024-01-06 18:13:48,560] {result_logger:113} INFO - 
[2024-01-06 18:13:48,579] {result_logger:116} INFO - average precision on sleep stages: 0.692
[2024-01-06 18:13:48,597] {result_logger:118} INFO - average recall on sleep stages: 0.831
[2024-01-06 18:13:48,616] {result_logger:120} INFO - average F1-score on sleep stages: 0.683
[2024-01-06 18:13:48,689] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.831
[2024-01-06 18:13:48,692] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.759
[2024-01-06 18:13:48,693] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 18:13:49,254] {result_logger:143} INFO - 
[[316401  11168   4483      3]
 [  3207 224913  11070      0]
 [   521   2040  36110      0]
 [  1892    249     47      0]]
[2024-01-06 18:13:49,822] {result_logger:150} INFO - 
[[ 95.29%   3.36%   1.35%   0.00%]
 [  1.34%  94.03%   4.63%   0.00%]
 [  1.35%   5.28%  93.38%   0.00%]
 [ 86.47%  11.38%   2.15%   0.00%]]
[2024-01-06 18:13:50,382] {result_logger:154} INFO - 
[[ 98.25%   4.69%   8.67% 100.00%]
 [  1.00%  94.35%  21.41%   0.00%]
 [  0.16%   0.86%  69.83%   0.00%]
 [  0.59%   0.10%   0.09%   0.00%]]
[2024-01-06 18:13:50,383] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 18:13:50,458] {result_logger:143} INFO - 
[[31888  4090 12341     0]
 [ 1828 30294  2983     0]
 [   36   129  5176     0]
 [   87   224   523     0]]
[2024-01-06 18:13:50,645] {result_logger:150} INFO - 
[[ 65.99%   8.46%  25.54%   0.00%]
 [  5.21%  86.30%   8.50%   0.00%]
 [  0.67%   2.42%  96.91%   0.00%]
 [ 10.43%  26.86%  62.71%   0.00%]]
[2024-01-06 18:13:50,832] {result_logger:154} INFO - 
[[ 94.23%  11.77%  58.70%    nan%]
 [  5.40%  87.21%  14.19%    nan%]
 [  0.11%   0.37%  24.62%    nan%]
 [  0.26%   0.64%   2.49%    nan%]]
[2024-01-06 18:13:51,233] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 18:13:51,233] {result_logger:77} INFO - actual:
[2024-01-06 18:13:51,233] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 18:13:51,233] {result_logger:79} INFO - predicted:
[2024-01-06 18:13:51,233] {result_logger:80} INFO - 
[[92.00%  2.89%  5.12%  0.00%]
 [ 2.27% 92.41%  5.32%  0.00%]
 [ 9.13%  7.90% 82.98%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 18:13:51,267] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it3/model_8conv_2fc-best.pth
[2024-01-06 18:13:51,268] {run_experiment:113} INFO - [epoch   8] execution time: 214.18s	 avg f1-score: 0.6827

[2024-01-06 18:13:51,268] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 18:13:51,320] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 18:14:17,089] {train_model:86} INFO - Train Epoch: 9 [60928/612104 (10%)]	lr:1.79e-04	Loss: 0.166148
[2024-01-06 18:14:28,165] {train_model:86} INFO - Train Epoch: 9 [122112/612104 (20%)]	lr:1.79e-04	Loss: 0.249048
[2024-01-06 18:14:39,567] {train_model:86} INFO - Train Epoch: 9 [183296/612104 (30%)]	lr:1.79e-04	Loss: 0.071822
[2024-01-06 18:14:50,753] {train_model:86} INFO - Train Epoch: 9 [244480/612104 (40%)]	lr:1.79e-04	Loss: 0.115266
[2024-01-06 18:15:02,325] {train_model:86} INFO - Train Epoch: 9 [305664/612104 (50%)]	lr:1.79e-04	Loss: 0.132836
[2024-01-06 18:15:27,867] {train_model:86} INFO - Train Epoch: 9 [366848/612104 (60%)]	lr:1.79e-04	Loss: 0.071018
[2024-01-06 18:15:52,253] {train_model:86} INFO - Train Epoch: 9 [428032/612104 (70%)]	lr:1.79e-04	Loss: 0.150893
[2024-01-06 18:16:06,338] {train_model:86} INFO - Train Epoch: 9 [489216/612104 (80%)]	lr:1.79e-04	Loss: 0.060482
[2024-01-06 18:16:17,894] {train_model:86} INFO - Train Epoch: 9 [550400/612104 (90%)]	lr:1.79e-04	Loss: 0.165799
[2024-01-06 18:16:29,614] {train_model:86} INFO - Train Epoch: 9 [611584/612104 (100%)]	lr:1.79e-04	Loss: 0.069050
[2024-01-06 18:16:42,001] {run_experiment:78} INFO - 
[2024-01-06 18:16:42,008] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 18:16:43,301] {result_logger:108} INFO - precision on WAKE: 0.988
[2024-01-06 18:16:44,152] {result_logger:109} INFO - recall on WAKE: 0.955
[2024-01-06 18:16:44,987] {result_logger:112} INFO - F1-score on WAKE: 0.971
[2024-01-06 18:16:44,987] {result_logger:113} INFO - 
[2024-01-06 18:16:46,208] {result_logger:108} INFO - precision on NREM: 0.947
[2024-01-06 18:16:47,031] {result_logger:109} INFO - recall on NREM: 0.943
[2024-01-06 18:16:47,861] {result_logger:112} INFO - F1-score on NREM: 0.945
[2024-01-06 18:16:47,861] {result_logger:113} INFO - 
[2024-01-06 18:16:48,976] {result_logger:108} INFO - precision on REM: 0.713
[2024-01-06 18:16:49,694] {result_logger:109} INFO - recall on REM: 0.937
[2024-01-06 18:16:50,411] {result_logger:112} INFO - F1-score on REM: 0.810
[2024-01-06 18:16:50,412] {result_logger:113} INFO - 
[2024-01-06 18:16:50,607] {result_logger:116} INFO - average precision on sleep stages: 0.883
[2024-01-06 18:16:50,803] {result_logger:118} INFO - average recall on sleep stages: 0.945
[2024-01-06 18:16:51,002] {result_logger:120} INFO - average F1-score on sleep stages: 0.909
[2024-01-06 18:16:51,531] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.945
[2024-01-06 18:16:51,559] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.949
[2024-01-06 18:16:51,563] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 18:16:51,722] {result_logger:108} INFO - precision on WAKE: 0.968
[2024-01-06 18:16:51,823] {result_logger:109} INFO - recall on WAKE: 0.775
[2024-01-06 18:16:51,925] {result_logger:112} INFO - F1-score on WAKE: 0.861
[2024-01-06 18:16:51,925] {result_logger:113} INFO - 
[2024-01-06 18:16:52,088] {result_logger:108} INFO - precision on NREM: 0.867
[2024-01-06 18:16:52,186] {result_logger:109} INFO - recall on NREM: 0.917
[2024-01-06 18:16:52,280] {result_logger:112} INFO - F1-score on NREM: 0.891
[2024-01-06 18:16:52,280] {result_logger:113} INFO - 
[2024-01-06 18:16:52,433] {result_logger:108} INFO - precision on REM: 0.386
[2024-01-06 18:16:52,530] {result_logger:109} INFO - recall on REM: 0.936
[2024-01-06 18:16:52,630] {result_logger:112} INFO - F1-score on REM: 0.547
[2024-01-06 18:16:52,630] {result_logger:113} INFO - 
[2024-01-06 18:16:52,648] {result_logger:116} INFO - average precision on sleep stages: 0.740
[2024-01-06 18:16:52,667] {result_logger:118} INFO - average recall on sleep stages: 0.876
[2024-01-06 18:16:52,686] {result_logger:120} INFO - average F1-score on sleep stages: 0.766
[2024-01-06 18:16:52,756] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.876
[2024-01-06 18:16:52,759] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.841
[2024-01-06 18:16:52,760] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 18:16:53,323] {result_logger:143} INFO - 
[[317077  10738   4239      1]
 [  3196 225667  10327      0]
 [   502   1932  36237      0]
 [  1892    254     42      0]]
[2024-01-06 18:16:53,876] {result_logger:150} INFO - 
[[ 95.49%   3.23%   1.28%   0.00%]
 [  1.34%  94.35%   4.32%   0.00%]
 [  1.30%   5.00%  93.71%   0.00%]
 [ 86.47%  11.61%   1.92%   0.00%]]
[2024-01-06 18:16:54,428] {result_logger:154} INFO - 
[[ 98.27%   4.50%   8.34% 100.00%]
 [  0.99%  94.58%  20.31%   0.00%]
 [  0.16%   0.81%  71.27%   0.00%]
 [  0.59%   0.11%   0.08%   0.00%]]
[2024-01-06 18:16:54,428] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 18:16:54,501] {result_logger:143} INFO - 
[[37441  4606  6272     0]
 [ 1228 32195  1682     0]
 [   15   325  5001     0]
 [  178   365   291     0]]
[2024-01-06 18:16:54,733] {result_logger:150} INFO - 
[[ 77.49%   9.53%  12.98%   0.00%]
 [  3.50%  91.71%   4.79%   0.00%]
 [  0.28%   6.09%  93.63%   0.00%]
 [ 21.34%  43.76%  34.89%   0.00%]]
[2024-01-06 18:16:55,036] {result_logger:154} INFO - 
[[ 96.34%  12.29%  47.35%    nan%]
 [  3.16%  85.87%  12.70%    nan%]
 [  0.04%   0.87%  37.75%    nan%]
 [  0.46%   0.97%   2.20%    nan%]]
[2024-01-06 18:16:55,474] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 18:16:55,474] {result_logger:77} INFO - actual:
[2024-01-06 18:16:55,474] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 18:16:55,474] {result_logger:79} INFO - predicted:
[2024-01-06 18:16:55,474] {result_logger:80} INFO - 
[[93.32%  3.48%  3.21%  0.00%]
 [ 2.96% 93.40%  3.64%  0.00%]
 [11.23%  8.48% 80.30%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 18:16:55,530] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it3/model_8conv_2fc-best.pth
[2024-01-06 18:16:55,530] {run_experiment:113} INFO - [epoch   9] execution time: 184.26s	 avg f1-score: 0.7663

[2024-01-06 18:16:55,530] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 18:16:55,587] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 18:17:35,816] {train_model:86} INFO - Train Epoch: 10 [60928/612104 (10%)]	lr:1.68e-04	Loss: 0.223512
[2024-01-06 18:17:47,513] {train_model:86} INFO - Train Epoch: 10 [122112/612104 (20%)]	lr:1.68e-04	Loss: 0.172598
[2024-01-06 18:17:58,712] {train_model:86} INFO - Train Epoch: 10 [183296/612104 (30%)]	lr:1.68e-04	Loss: 0.074804
[2024-01-06 18:18:10,121] {train_model:86} INFO - Train Epoch: 10 [244480/612104 (40%)]	lr:1.68e-04	Loss: 0.115969
[2024-01-06 18:18:21,428] {train_model:86} INFO - Train Epoch: 10 [305664/612104 (50%)]	lr:1.68e-04	Loss: 0.051247
[2024-01-06 18:18:32,998] {train_model:86} INFO - Train Epoch: 10 [366848/612104 (60%)]	lr:1.68e-04	Loss: 0.145074
[2024-01-06 18:18:44,519] {train_model:86} INFO - Train Epoch: 10 [428032/612104 (70%)]	lr:1.68e-04	Loss: 0.416022
[2024-01-06 18:19:11,576] {train_model:86} INFO - Train Epoch: 10 [489216/612104 (80%)]	lr:1.68e-04	Loss: 0.177350
[2024-01-06 18:19:36,986] {train_model:86} INFO - Train Epoch: 10 [550400/612104 (90%)]	lr:1.68e-04	Loss: 0.114259
[2024-01-06 18:19:48,839] {train_model:86} INFO - Train Epoch: 10 [611584/612104 (100%)]	lr:1.68e-04	Loss: 0.426415
[2024-01-06 18:20:01,171] {run_experiment:78} INFO - 
[2024-01-06 18:20:01,178] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 18:20:02,437] {result_logger:108} INFO - precision on WAKE: 0.989
[2024-01-06 18:20:03,261] {result_logger:109} INFO - recall on WAKE: 0.956
[2024-01-06 18:20:04,096] {result_logger:112} INFO - F1-score on WAKE: 0.972
[2024-01-06 18:20:04,097] {result_logger:113} INFO - 
[2024-01-06 18:20:05,333] {result_logger:108} INFO - precision on NREM: 0.949
[2024-01-06 18:20:06,129] {result_logger:109} INFO - recall on NREM: 0.944
[2024-01-06 18:20:06,936] {result_logger:112} INFO - F1-score on NREM: 0.946
[2024-01-06 18:20:06,936] {result_logger:113} INFO - 
[2024-01-06 18:20:08,062] {result_logger:108} INFO - precision on REM: 0.718
[2024-01-06 18:20:08,773] {result_logger:109} INFO - recall on REM: 0.942
[2024-01-06 18:20:09,495] {result_logger:112} INFO - F1-score on REM: 0.815
[2024-01-06 18:20:09,495] {result_logger:113} INFO - 
[2024-01-06 18:20:09,687] {result_logger:116} INFO - average precision on sleep stages: 0.885
[2024-01-06 18:20:09,877] {result_logger:118} INFO - average recall on sleep stages: 0.947
[2024-01-06 18:20:10,071] {result_logger:120} INFO - average F1-score on sleep stages: 0.911
[2024-01-06 18:20:10,608] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.947
[2024-01-06 18:20:10,636] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.951
[2024-01-06 18:20:10,640] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 18:20:10,809] {result_logger:108} INFO - precision on WAKE: 0.890
[2024-01-06 18:20:10,909] {result_logger:109} INFO - recall on WAKE: 0.933
[2024-01-06 18:20:11,004] {result_logger:112} INFO - F1-score on WAKE: 0.911
[2024-01-06 18:20:11,005] {result_logger:113} INFO - 
[2024-01-06 18:20:11,172] {result_logger:108} INFO - precision on NREM: 0.931
[2024-01-06 18:20:11,272] {result_logger:109} INFO - recall on NREM: 0.812
[2024-01-06 18:20:11,370] {result_logger:112} INFO - F1-score on NREM: 0.867
[2024-01-06 18:20:11,370] {result_logger:113} INFO - 
[2024-01-06 18:20:11,531] {result_logger:108} INFO - precision on REM: 0.609
[2024-01-06 18:20:11,625] {result_logger:109} INFO - recall on REM: 0.850
[2024-01-06 18:20:11,723] {result_logger:112} INFO - F1-score on REM: 0.710
[2024-01-06 18:20:11,723] {result_logger:113} INFO - 
[2024-01-06 18:20:11,741] {result_logger:116} INFO - average precision on sleep stages: 0.810
[2024-01-06 18:20:11,760] {result_logger:118} INFO - average recall on sleep stages: 0.865
[2024-01-06 18:20:11,778] {result_logger:120} INFO - average F1-score on sleep stages: 0.829
[2024-01-06 18:20:11,849] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.865
[2024-01-06 18:20:11,852] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.880
[2024-01-06 18:20:11,852] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 18:20:12,425] {result_logger:143} INFO - 
[[317607  10396   4052      0]
 [  3181 225749  10260      0]
 [   468   1788  36415      0]
 [  1900    246     42      0]]
[2024-01-06 18:20:13,004] {result_logger:150} INFO - 
[[ 95.65%   3.13%   1.22%   0.00%]
 [  1.33%  94.38%   4.29%   0.00%]
 [  1.21%   4.62%  94.17%   0.00%]
 [ 86.84%  11.24%   1.92%   0.00%]]
[2024-01-06 18:20:13,585] {result_logger:154} INFO - 
[[ 98.28%   4.36%   7.98%    nan%]
 [  0.98%  94.78%  20.21%    nan%]
 [  0.14%   0.75%  71.73%    nan%]
 [  0.59%   0.10%   0.08%    nan%]]
[2024-01-06 18:20:13,585] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 18:20:13,664] {result_logger:143} INFO - 
[[45094  1909  1316     0]
 [ 5004 28503  1598     0]
 [  585   217  4539     0]
 [  606   126   102     0]]
[2024-01-06 18:20:13,858] {result_logger:150} INFO - 
[[ 93.33%   3.95%   2.72%   0.00%]
 [ 14.25%  81.19%   4.55%   0.00%]
 [ 10.95%   4.06%  84.98%   0.00%]
 [ 72.66%  15.11%  12.23%   0.00%]]
[2024-01-06 18:20:14,045] {result_logger:154} INFO - 
[[ 87.92%   6.21%  17.42%    nan%]
 [  9.76%  92.68%  21.15%    nan%]
 [  1.14%   0.71%  60.08%    nan%]
 [  1.18%   0.41%   1.35%    nan%]]
[2024-01-06 18:20:14,455] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 18:20:14,455] {result_logger:77} INFO - actual:
[2024-01-06 18:20:14,456] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 18:20:14,456] {result_logger:79} INFO - predicted:
[2024-01-06 18:20:14,456] {result_logger:80} INFO - 
[[95.59%  3.10%  1.31%  0.00%]
 [ 4.43% 93.32%  2.25%  0.00%]
 [11.93%  6.13% 81.95%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 18:20:14,491] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it3/model_8conv_2fc-best.pth
[2024-01-06 18:20:14,491] {run_experiment:113} INFO - [epoch  10] execution time: 198.96s	 avg f1-score: 0.8292

[2024-01-06 18:20:14,491] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 18:20:14,542] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 18:20:56,234] {train_model:86} INFO - Train Epoch: 11 [60928/612104 (10%)]	lr:1.58e-04	Loss: 0.246721
[2024-01-06 18:21:12,204] {train_model:86} INFO - Train Epoch: 11 [122112/612104 (20%)]	lr:1.58e-04	Loss: 0.219695
[2024-01-06 18:21:33,232] {train_model:86} INFO - Train Epoch: 11 [183296/612104 (30%)]	lr:1.58e-04	Loss: 0.167406
[2024-01-06 18:21:44,826] {train_model:86} INFO - Train Epoch: 11 [244480/612104 (40%)]	lr:1.58e-04	Loss: 0.099636
[2024-01-06 18:21:56,436] {train_model:86} INFO - Train Epoch: 11 [305664/612104 (50%)]	lr:1.58e-04	Loss: 0.084765
[2024-01-06 18:22:07,821] {train_model:86} INFO - Train Epoch: 11 [366848/612104 (60%)]	lr:1.58e-04	Loss: 0.257501
[2024-01-06 18:22:19,175] {train_model:86} INFO - Train Epoch: 11 [428032/612104 (70%)]	lr:1.58e-04	Loss: 0.119852
[2024-01-06 18:22:40,610] {train_model:86} INFO - Train Epoch: 11 [489216/612104 (80%)]	lr:1.58e-04	Loss: 0.076140
[2024-01-06 18:23:03,047] {train_model:86} INFO - Train Epoch: 11 [550400/612104 (90%)]	lr:1.58e-04	Loss: 0.100425
[2024-01-06 18:23:23,539] {train_model:86} INFO - Train Epoch: 11 [611584/612104 (100%)]	lr:1.58e-04	Loss: 0.082302
[2024-01-06 18:23:36,144] {run_experiment:78} INFO - 
[2024-01-06 18:23:36,150] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 18:23:37,406] {result_logger:108} INFO - precision on WAKE: 0.988
[2024-01-06 18:23:38,230] {result_logger:109} INFO - recall on WAKE: 0.958
[2024-01-06 18:23:39,060] {result_logger:112} INFO - F1-score on WAKE: 0.973
[2024-01-06 18:23:39,060] {result_logger:113} INFO - 
[2024-01-06 18:23:40,283] {result_logger:108} INFO - precision on NREM: 0.950
[2024-01-06 18:23:41,087] {result_logger:109} INFO - recall on NREM: 0.946
[2024-01-06 18:23:41,905] {result_logger:112} INFO - F1-score on NREM: 0.948
[2024-01-06 18:23:41,905] {result_logger:113} INFO - 
[2024-01-06 18:23:43,026] {result_logger:108} INFO - precision on REM: 0.731
[2024-01-06 18:23:43,738] {result_logger:109} INFO - recall on REM: 0.944
[2024-01-06 18:23:44,450] {result_logger:112} INFO - F1-score on REM: 0.824
[2024-01-06 18:23:44,450] {result_logger:113} INFO - 
[2024-01-06 18:23:44,626] {result_logger:116} INFO - average precision on sleep stages: 0.890
[2024-01-06 18:23:44,808] {result_logger:118} INFO - average recall on sleep stages: 0.949
[2024-01-06 18:23:44,995] {result_logger:120} INFO - average F1-score on sleep stages: 0.915
[2024-01-06 18:23:45,519] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.949
[2024-01-06 18:23:45,546] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.952
[2024-01-06 18:23:45,550] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 18:23:45,711] {result_logger:108} INFO - precision on WAKE: 0.915
[2024-01-06 18:23:45,810] {result_logger:109} INFO - recall on WAKE: 0.933
[2024-01-06 18:23:45,909] {result_logger:112} INFO - F1-score on WAKE: 0.924
[2024-01-06 18:23:45,909] {result_logger:113} INFO - 
[2024-01-06 18:23:46,074] {result_logger:108} INFO - precision on NREM: 0.918
[2024-01-06 18:23:46,174] {result_logger:109} INFO - recall on NREM: 0.847
[2024-01-06 18:23:46,276] {result_logger:112} INFO - F1-score on NREM: 0.881
[2024-01-06 18:23:46,277] {result_logger:113} INFO - 
[2024-01-06 18:23:46,439] {result_logger:108} INFO - precision on REM: 0.621
[2024-01-06 18:23:46,537] {result_logger:109} INFO - recall on REM: 0.826
[2024-01-06 18:23:46,637] {result_logger:112} INFO - F1-score on REM: 0.709
[2024-01-06 18:23:46,637] {result_logger:113} INFO - 
[2024-01-06 18:23:46,655] {result_logger:116} INFO - average precision on sleep stages: 0.818
[2024-01-06 18:23:46,674] {result_logger:118} INFO - average recall on sleep stages: 0.869
[2024-01-06 18:23:46,693] {result_logger:120} INFO - average F1-score on sleep stages: 0.838
[2024-01-06 18:23:46,767] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.869
[2024-01-06 18:23:46,770] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.893
[2024-01-06 18:23:46,771] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 18:23:47,349] {result_logger:143} INFO - 
[[318043  10285   3725      2]
 [  3254 226201   9735      0]
 [   461   1705  36504      1]
 [  1904    247     37      0]]
[2024-01-06 18:23:47,934] {result_logger:150} INFO - 
[[ 95.78%   3.10%   1.12%   0.00%]
 [  1.36%  94.57%   4.07%   0.00%]
 [  1.19%   4.41%  94.40%   0.00%]
 [ 87.02%  11.29%   1.69%   0.00%]]
[2024-01-06 18:23:48,530] {result_logger:154} INFO - 
[[ 98.26%   4.31%   7.45%  66.67%]
 [  1.01%  94.87%  19.47%   0.00%]
 [  0.14%   0.72%  73.01%  33.33%]
 [  0.59%   0.10%   0.07%   0.00%]]
[2024-01-06 18:23:48,531] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 18:23:48,610] {result_logger:143} INFO - 
[[45096  2351   872     0]
 [ 3537 29749  1819     0]
 [  631   298  4412     0]
 [  531   110   193     0]]
[2024-01-06 18:23:48,806] {result_logger:150} INFO - 
[[ 93.33%   4.87%   1.80%   0.00%]
 [ 10.08%  84.74%   5.18%   0.00%]
 [ 11.81%   5.58%  82.61%   0.00%]
 [ 63.67%  13.19%  23.14%   0.00%]]
[2024-01-06 18:23:49,005] {result_logger:154} INFO - 
[[ 90.56%   7.23%  11.95%    nan%]
 [  7.10%  91.51%  24.93%    nan%]
 [  1.27%   0.92%  60.47%    nan%]
 [  1.07%   0.34%   2.65%    nan%]]
[2024-01-06 18:23:49,404] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 18:23:49,404] {result_logger:77} INFO - actual:
[2024-01-06 18:23:49,405] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 18:23:49,405] {result_logger:79} INFO - predicted:
[2024-01-06 18:23:49,405] {result_logger:80} INFO - 
[[95.08%  3.79%  1.13%  0.00%]
 [ 4.82% 92.64%  2.53%  0.00%]
 [12.09%  6.89% 81.02%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 18:23:49,440] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it3/model_8conv_2fc-best.pth
[2024-01-06 18:23:49,441] {run_experiment:113} INFO - [epoch  11] execution time: 214.95s	 avg f1-score: 0.8383

[2024-01-06 18:23:49,441] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 18:23:49,495] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 18:24:15,171] {train_model:86} INFO - Train Epoch: 12 [60928/612104 (10%)]	lr:1.49e-04	Loss: 0.123521
[2024-01-06 18:24:26,407] {train_model:86} INFO - Train Epoch: 12 [122112/612104 (20%)]	lr:1.49e-04	Loss: 0.079842
[2024-01-06 18:24:53,468] {train_model:86} INFO - Train Epoch: 12 [183296/612104 (30%)]	lr:1.49e-04	Loss: 0.154272
[2024-01-06 18:25:19,152] {train_model:86} INFO - Train Epoch: 12 [244480/612104 (40%)]	lr:1.49e-04	Loss: 0.090682
[2024-01-06 18:25:31,007] {train_model:86} INFO - Train Epoch: 12 [305664/612104 (50%)]	lr:1.49e-04	Loss: 0.081301
[2024-01-06 18:25:43,339] {train_model:86} INFO - Train Epoch: 12 [366848/612104 (60%)]	lr:1.49e-04	Loss: 0.146322
[2024-01-06 18:25:54,807] {train_model:86} INFO - Train Epoch: 12 [428032/612104 (70%)]	lr:1.49e-04	Loss: 0.150536
[2024-01-06 18:26:06,312] {train_model:86} INFO - Train Epoch: 12 [489216/612104 (80%)]	lr:1.49e-04	Loss: 0.118570
[2024-01-06 18:26:33,608] {train_model:86} INFO - Train Epoch: 12 [550400/612104 (90%)]	lr:1.49e-04	Loss: 0.141165
[2024-01-06 18:26:59,327] {train_model:86} INFO - Train Epoch: 12 [611584/612104 (100%)]	lr:1.49e-04	Loss: 0.069708
[2024-01-06 18:27:11,887] {run_experiment:78} INFO - 
[2024-01-06 18:27:11,893] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 18:27:13,185] {result_logger:108} INFO - precision on WAKE: 0.989
[2024-01-06 18:27:14,030] {result_logger:109} INFO - recall on WAKE: 0.958
[2024-01-06 18:27:14,866] {result_logger:112} INFO - F1-score on WAKE: 0.973
[2024-01-06 18:27:14,866] {result_logger:113} INFO - 
[2024-01-06 18:27:16,135] {result_logger:108} INFO - precision on NREM: 0.951
[2024-01-06 18:27:16,939] {result_logger:109} INFO - recall on NREM: 0.946
[2024-01-06 18:27:17,779] {result_logger:112} INFO - F1-score on NREM: 0.948
[2024-01-06 18:27:17,779] {result_logger:113} INFO - 
[2024-01-06 18:27:18,985] {result_logger:108} INFO - precision on REM: 0.732
[2024-01-06 18:27:19,743] {result_logger:109} INFO - recall on REM: 0.946
[2024-01-06 18:27:20,497] {result_logger:112} INFO - F1-score on REM: 0.826
[2024-01-06 18:27:20,497] {result_logger:113} INFO - 
[2024-01-06 18:27:20,699] {result_logger:116} INFO - average precision on sleep stages: 0.890
[2024-01-06 18:27:20,903] {result_logger:118} INFO - average recall on sleep stages: 0.950
[2024-01-06 18:27:21,107] {result_logger:120} INFO - average F1-score on sleep stages: 0.916
[2024-01-06 18:27:21,669] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.950
[2024-01-06 18:27:21,698] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.953
[2024-01-06 18:27:21,702] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 18:27:21,874] {result_logger:108} INFO - precision on WAKE: 0.935
[2024-01-06 18:27:21,980] {result_logger:109} INFO - recall on WAKE: 0.907
[2024-01-06 18:27:22,083] {result_logger:112} INFO - F1-score on WAKE: 0.921
[2024-01-06 18:27:22,083] {result_logger:113} INFO - 
[2024-01-06 18:27:22,249] {result_logger:108} INFO - precision on NREM: 0.877
[2024-01-06 18:27:22,353] {result_logger:109} INFO - recall on NREM: 0.890
[2024-01-06 18:27:22,456] {result_logger:112} INFO - F1-score on NREM: 0.883
[2024-01-06 18:27:22,456] {result_logger:113} INFO - 
[2024-01-06 18:27:22,622] {result_logger:108} INFO - precision on REM: 0.710
[2024-01-06 18:27:22,723] {result_logger:109} INFO - recall on REM: 0.829
[2024-01-06 18:27:22,829] {result_logger:112} INFO - F1-score on REM: 0.765
[2024-01-06 18:27:22,829] {result_logger:113} INFO - 
[2024-01-06 18:27:22,848] {result_logger:116} INFO - average precision on sleep stages: 0.841
[2024-01-06 18:27:22,868] {result_logger:118} INFO - average recall on sleep stages: 0.876
[2024-01-06 18:27:22,888] {result_logger:120} INFO - average F1-score on sleep stages: 0.856
[2024-01-06 18:27:22,966] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.876
[2024-01-06 18:27:22,969] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.896
[2024-01-06 18:27:22,970] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 18:27:23,576] {result_logger:143} INFO - 
[[318270  10100   3684      1]
 [  3234 226250   9704      2]
 [   436   1634  36599      2]
 [  1913    238     37      0]]
[2024-01-06 18:27:24,166] {result_logger:150} INFO - 
[[ 95.85%   3.04%   1.11%   0.00%]
 [  1.35%  94.59%   4.06%   0.00%]
 [  1.13%   4.23%  94.64%   0.01%]
 [ 87.43%  10.88%   1.69%   0.00%]]
[2024-01-06 18:27:24,751] {result_logger:154} INFO - 
[[ 98.28%   4.24%   7.36%  20.00%]
 [  1.00%  94.97%  19.40%  40.00%]
 [  0.13%   0.69%  73.16%  40.00%]
 [  0.59%   0.10%   0.07%   0.00%]]
[2024-01-06 18:27:24,751] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 18:27:24,827] {result_logger:143} INFO - 
[[43839  3880   600     0]
 [ 2643 31256  1206     0]
 [  399   515  4427     0]
 [  434   360    40     0]]
[2024-01-06 18:27:25,027] {result_logger:150} INFO - 
[[ 90.73%   8.03%   1.24%   0.00%]
 [  7.53%  89.04%   3.44%   0.00%]
 [  7.47%   9.64%  82.89%   0.00%]
 [ 52.04%  43.17%   4.80%   0.00%]]
[2024-01-06 18:27:25,226] {result_logger:154} INFO - 
[[ 92.65%  10.77%   9.56%    nan%]
 [  5.59%  86.80%  19.23%    nan%]
 [  0.84%   1.43%  70.57%    nan%]
 [  0.92%   1.00%   0.64%    nan%]]
[2024-01-06 18:27:25,663] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 18:27:25,663] {result_logger:77} INFO - actual:
[2024-01-06 18:27:25,663] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 18:27:25,663] {result_logger:79} INFO - predicted:
[2024-01-06 18:27:25,663] {result_logger:80} INFO - 
[[94.94%  4.43%  0.63%  0.00%]
 [ 5.00% 92.98%  2.03%  0.00%]
 [ 9.49%  6.92% 83.60%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 18:27:25,699] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it3/model_8conv_2fc-best.pth
[2024-01-06 18:27:25,699] {run_experiment:113} INFO - [epoch  12] execution time: 216.26s	 avg f1-score: 0.8565

[2024-01-06 18:27:25,699] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 18:27:25,752] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 18:27:51,985] {train_model:86} INFO - Train Epoch: 13 [60928/612104 (10%)]	lr:1.40e-04	Loss: 0.073485
[2024-01-06 18:28:03,254] {train_model:86} INFO - Train Epoch: 13 [122112/612104 (20%)]	lr:1.40e-04	Loss: 0.090947
[2024-01-06 18:28:14,690] {train_model:86} INFO - Train Epoch: 13 [183296/612104 (30%)]	lr:1.40e-04	Loss: 0.094339
[2024-01-06 18:28:41,676] {train_model:86} INFO - Train Epoch: 13 [244480/612104 (40%)]	lr:1.40e-04	Loss: 0.072089
[2024-01-06 18:28:53,371] {train_model:86} INFO - Train Epoch: 13 [305664/612104 (50%)]	lr:1.40e-04	Loss: 0.115790
[2024-01-06 18:29:18,875] {train_model:86} INFO - Train Epoch: 13 [366848/612104 (60%)]	lr:1.40e-04	Loss: 0.069424
[2024-01-06 18:29:30,147] {train_model:86} INFO - Train Epoch: 13 [428032/612104 (70%)]	lr:1.40e-04	Loss: 0.065228
[2024-01-06 18:29:41,691] {train_model:86} INFO - Train Epoch: 13 [489216/612104 (80%)]	lr:1.40e-04	Loss: 0.085805
[2024-01-06 18:29:53,201] {train_model:86} INFO - Train Epoch: 13 [550400/612104 (90%)]	lr:1.40e-04	Loss: 0.119473
[2024-01-06 18:30:20,635] {train_model:86} INFO - Train Epoch: 13 [611584/612104 (100%)]	lr:1.40e-04	Loss: 0.252949
[2024-01-06 18:30:33,066] {run_experiment:78} INFO - 
[2024-01-06 18:30:33,073] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 18:30:34,338] {result_logger:108} INFO - precision on WAKE: 0.989
[2024-01-06 18:30:35,179] {result_logger:109} INFO - recall on WAKE: 0.959
[2024-01-06 18:30:36,022] {result_logger:112} INFO - F1-score on WAKE: 0.974
[2024-01-06 18:30:36,022] {result_logger:113} INFO - 
[2024-01-06 18:30:37,285] {result_logger:108} INFO - precision on NREM: 0.951
[2024-01-06 18:30:38,096] {result_logger:109} INFO - recall on NREM: 0.948
[2024-01-06 18:30:38,915] {result_logger:112} INFO - F1-score on NREM: 0.949
[2024-01-06 18:30:38,915] {result_logger:113} INFO - 
[2024-01-06 18:30:40,052] {result_logger:108} INFO - precision on REM: 0.743
[2024-01-06 18:30:40,758] {result_logger:109} INFO - recall on REM: 0.948
[2024-01-06 18:30:41,479] {result_logger:112} INFO - F1-score on REM: 0.833
[2024-01-06 18:30:41,479] {result_logger:113} INFO - 
[2024-01-06 18:30:41,669] {result_logger:116} INFO - average precision on sleep stages: 0.894
[2024-01-06 18:30:41,859] {result_logger:118} INFO - average recall on sleep stages: 0.952
[2024-01-06 18:30:42,043] {result_logger:120} INFO - average F1-score on sleep stages: 0.919
[2024-01-06 18:30:42,567] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.952
[2024-01-06 18:30:42,593] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.954
[2024-01-06 18:30:42,597] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 18:30:42,761] {result_logger:108} INFO - precision on WAKE: 0.850
[2024-01-06 18:30:42,860] {result_logger:109} INFO - recall on WAKE: 0.978
[2024-01-06 18:30:42,961] {result_logger:112} INFO - F1-score on WAKE: 0.909
[2024-01-06 18:30:42,961] {result_logger:113} INFO - 
[2024-01-06 18:30:43,129] {result_logger:108} INFO - precision on NREM: 0.956
[2024-01-06 18:30:43,229] {result_logger:109} INFO - recall on NREM: 0.757
[2024-01-06 18:30:43,330] {result_logger:112} INFO - F1-score on NREM: 0.845
[2024-01-06 18:30:43,330] {result_logger:113} INFO - 
[2024-01-06 18:30:43,498] {result_logger:108} INFO - precision on REM: 0.644
[2024-01-06 18:30:43,597] {result_logger:109} INFO - recall on REM: 0.649
[2024-01-06 18:30:43,694] {result_logger:112} INFO - F1-score on REM: 0.646
[2024-01-06 18:30:43,694] {result_logger:113} INFO - 
[2024-01-06 18:30:43,711] {result_logger:116} INFO - average precision on sleep stages: 0.816
[2024-01-06 18:30:43,729] {result_logger:118} INFO - average recall on sleep stages: 0.794
[2024-01-06 18:30:43,746] {result_logger:120} INFO - average F1-score on sleep stages: 0.800
[2024-01-06 18:30:43,816] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.794
[2024-01-06 18:30:43,818] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.870
[2024-01-06 18:30:43,819] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 18:30:44,399] {result_logger:143} INFO - 
[[318586  10072   3393      4]
 [  3253 226651   9284      2]
 [   431   1585  36652      3]
 [  1914    238     36      0]]
[2024-01-06 18:30:44,964] {result_logger:150} INFO - 
[[ 95.94%   3.03%   1.02%   0.00%]
 [  1.36%  94.76%   3.88%   0.00%]
 [  1.11%   4.10%  94.78%   0.01%]
 [ 87.48%  10.88%   1.65%   0.00%]]
[2024-01-06 18:30:45,557] {result_logger:154} INFO - 
[[ 98.27%   4.22%   6.87%  44.44%]
 [  1.00%  95.01%  18.81%  22.22%]
 [  0.13%   0.66%  74.25%  33.33%]
 [  0.59%   0.10%   0.07%   0.00%]]
[2024-01-06 18:30:45,557] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 18:30:45,631] {result_logger:143} INFO - 
[[47239   970   110     0]
 [ 6732 26564  1809     0]
 [ 1629   246  3466     0]
 [  766    45    23     0]]
[2024-01-06 18:30:45,943] {result_logger:150} INFO - 
[[ 97.76%   2.01%   0.23%   0.00%]
 [ 19.18%  75.67%   5.15%   0.00%]
 [ 30.50%   4.61%  64.89%   0.00%]
 [ 91.85%   5.40%   2.76%   0.00%]]
[2024-01-06 18:30:46,144] {result_logger:154} INFO - 
[[ 83.81%   3.49%   2.03%    nan%]
 [ 11.94%  95.47%  33.45%    nan%]
 [  2.89%   0.88%  64.09%    nan%]
 [  1.36%   0.16%   0.43%    nan%]]
[2024-01-06 18:30:46,552] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 18:30:46,552] {result_logger:77} INFO - actual:
[2024-01-06 18:30:46,553] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 18:30:46,553] {result_logger:79} INFO - predicted:
[2024-01-06 18:30:46,553] {result_logger:80} INFO - 
[[96.34%  3.00%  0.66%  0.00%]
 [ 5.07% 92.40%  2.53%  0.00%]
 [12.00%  7.90% 80.10%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 18:30:46,589] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it3/model_8conv_2fc-best.pth
[2024-01-06 18:30:46,589] {run_experiment:113} INFO - [epoch  13] execution time: 200.89s	 avg f1-score: 0.8001

[2024-01-06 18:30:46,589] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 18:30:46,643] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 18:31:12,529] {train_model:86} INFO - Train Epoch: 14 [60928/612104 (10%)]	lr:1.32e-04	Loss: 0.117458
[2024-01-06 18:31:23,939] {train_model:86} INFO - Train Epoch: 14 [122112/612104 (20%)]	lr:1.32e-04	Loss: 0.059385
[2024-01-06 18:31:35,259] {train_model:86} INFO - Train Epoch: 14 [183296/612104 (30%)]	lr:1.32e-04	Loss: 0.198800
[2024-01-06 18:31:47,230] {train_model:86} INFO - Train Epoch: 14 [244480/612104 (40%)]	lr:1.32e-04	Loss: 0.071984
[2024-01-06 18:31:59,143] {train_model:86} INFO - Train Epoch: 14 [305664/612104 (50%)]	lr:1.32e-04	Loss: 0.106331
[2024-01-06 18:32:26,696] {train_model:86} INFO - Train Epoch: 14 [366848/612104 (60%)]	lr:1.32e-04	Loss: 0.256873
[2024-01-06 18:32:52,525] {train_model:86} INFO - Train Epoch: 14 [428032/612104 (70%)]	lr:1.32e-04	Loss: 0.377371
[2024-01-06 18:33:04,251] {train_model:86} INFO - Train Epoch: 14 [489216/612104 (80%)]	lr:1.32e-04	Loss: 0.133430
[2024-01-06 18:33:16,249] {train_model:86} INFO - Train Epoch: 14 [550400/612104 (90%)]	lr:1.32e-04	Loss: 0.151483
[2024-01-06 18:33:43,507] {train_model:86} INFO - Train Epoch: 14 [611584/612104 (100%)]	lr:1.32e-04	Loss: 0.108976
[2024-01-06 18:33:55,870] {run_experiment:78} INFO - 
[2024-01-06 18:33:55,876] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 18:33:57,159] {result_logger:108} INFO - precision on WAKE: 0.989
[2024-01-06 18:33:57,996] {result_logger:109} INFO - recall on WAKE: 0.960
[2024-01-06 18:33:58,836] {result_logger:112} INFO - F1-score on WAKE: 0.974
[2024-01-06 18:33:58,836] {result_logger:113} INFO - 
[2024-01-06 18:34:00,072] {result_logger:108} INFO - precision on NREM: 0.952
[2024-01-06 18:34:00,885] {result_logger:109} INFO - recall on NREM: 0.949
[2024-01-06 18:34:01,701] {result_logger:112} INFO - F1-score on NREM: 0.950
[2024-01-06 18:34:01,701] {result_logger:113} INFO - 
[2024-01-06 18:34:02,842] {result_logger:108} INFO - precision on REM: 0.748
[2024-01-06 18:34:03,585] {result_logger:109} INFO - recall on REM: 0.951
[2024-01-06 18:34:04,329] {result_logger:112} INFO - F1-score on REM: 0.838
[2024-01-06 18:34:04,330] {result_logger:113} INFO - 
[2024-01-06 18:34:04,520] {result_logger:116} INFO - average precision on sleep stages: 0.896
[2024-01-06 18:34:04,713] {result_logger:118} INFO - average recall on sleep stages: 0.953
[2024-01-06 18:34:04,903] {result_logger:120} INFO - average F1-score on sleep stages: 0.921
[2024-01-06 18:34:05,428] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.953
[2024-01-06 18:34:05,454] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.955
[2024-01-06 18:34:05,459] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 18:34:05,624] {result_logger:108} INFO - precision on WAKE: 0.916
[2024-01-06 18:34:05,726] {result_logger:109} INFO - recall on WAKE: 0.818
[2024-01-06 18:34:05,828] {result_logger:112} INFO - F1-score on WAKE: 0.864
[2024-01-06 18:34:05,829] {result_logger:113} INFO - 
[2024-01-06 18:34:05,996] {result_logger:108} INFO - precision on NREM: 0.947
[2024-01-06 18:34:06,091] {result_logger:109} INFO - recall on NREM: 0.780
[2024-01-06 18:34:06,187] {result_logger:112} INFO - F1-score on NREM: 0.855
[2024-01-06 18:34:06,188] {result_logger:113} INFO - 
[2024-01-06 18:34:06,350] {result_logger:108} INFO - precision on REM: 0.307
[2024-01-06 18:34:06,451] {result_logger:109} INFO - recall on REM: 0.960
[2024-01-06 18:34:06,556] {result_logger:112} INFO - F1-score on REM: 0.465
[2024-01-06 18:34:06,556] {result_logger:113} INFO - 
[2024-01-06 18:34:06,575] {result_logger:116} INFO - average precision on sleep stages: 0.723
[2024-01-06 18:34:06,595] {result_logger:118} INFO - average recall on sleep stages: 0.853
[2024-01-06 18:34:06,615] {result_logger:120} INFO - average F1-score on sleep stages: 0.728
[2024-01-06 18:34:06,688] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.853
[2024-01-06 18:34:06,691] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.812
[2024-01-06 18:34:06,691] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 18:34:07,282] {result_logger:143} INFO - 
[[318865   9908   3276      6]
 [  3217 226895   9077      1]
 [   389   1521  36760      1]
 [  1909    241     38      0]]
[2024-01-06 18:34:07,856] {result_logger:150} INFO - 
[[ 96.03%   2.98%   0.99%   0.00%]
 [  1.34%  94.86%   3.79%   0.00%]
 [  1.01%   3.93%  95.06%   0.00%]
 [ 87.25%  11.01%   1.74%   0.00%]]
[2024-01-06 18:34:08,428] {result_logger:154} INFO - 
[[ 98.30%   4.15%   6.67%  75.00%]
 [  0.99%  95.11%  18.47%  12.50%]
 [  0.12%   0.64%  74.79%  12.50%]
 [  0.59%   0.10%   0.08%   0.00%]]
[2024-01-06 18:34:08,428] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 18:34:08,506] {result_logger:143} INFO - 
[[39537  1433  7349     0]
 [ 3507 27386  4212     0]
 [  111   105  5125     0]
 [  266    95   473     0]]
[2024-01-06 18:34:08,740] {result_logger:150} INFO - 
[[ 81.82%   2.97%  15.21%   0.00%]
 [  9.99%  78.01%  12.00%   0.00%]
 [  2.08%   1.97%  95.96%   0.00%]
 [ 31.89%  11.39%  56.71%   0.00%]]
[2024-01-06 18:34:08,952] {result_logger:154} INFO - 
[[ 91.06%   4.94%  42.83%    nan%]
 [  8.08%  94.37%  24.55%    nan%]
 [  0.26%   0.36%  29.87%    nan%]
 [  0.61%   0.33%   2.76%    nan%]]
[2024-01-06 18:34:09,410] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 18:34:09,410] {result_logger:77} INFO - actual:
[2024-01-06 18:34:09,410] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 18:34:09,410] {result_logger:79} INFO - predicted:
[2024-01-06 18:34:09,411] {result_logger:80} INFO - 
[[93.60%  2.43%  3.97%  0.00%]
 [ 3.03% 92.40%  4.56%  0.00%]
 [11.06%  6.70% 82.24%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 18:34:09,464] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it3/model_8conv_2fc-best.pth
[2024-01-06 18:34:09,464] {run_experiment:113} INFO - [epoch  14] execution time: 202.87s	 avg f1-score: 0.7284

[2024-01-06 18:34:09,465] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 18:34:09,519] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 18:34:35,345] {train_model:86} INFO - Train Epoch: 15 [60928/612104 (10%)]	lr:1.25e-04	Loss: 0.160994
[2024-01-06 18:34:46,959] {train_model:86} INFO - Train Epoch: 15 [122112/612104 (20%)]	lr:1.25e-04	Loss: 0.093280
[2024-01-06 18:34:58,329] {train_model:86} INFO - Train Epoch: 15 [183296/612104 (30%)]	lr:1.25e-04	Loss: 0.070792
[2024-01-06 18:35:10,062] {train_model:86} INFO - Train Epoch: 15 [244480/612104 (40%)]	lr:1.25e-04	Loss: 0.096002
[2024-01-06 18:35:21,733] {train_model:86} INFO - Train Epoch: 15 [305664/612104 (50%)]	lr:1.25e-04	Loss: 0.211915
[2024-01-06 18:35:33,815] {train_model:86} INFO - Train Epoch: 15 [366848/612104 (60%)]	lr:1.25e-04	Loss: 0.099777
[2024-01-06 18:35:45,521] {train_model:86} INFO - Train Epoch: 15 [428032/612104 (70%)]	lr:1.25e-04	Loss: 0.137182
[2024-01-06 18:36:12,786] {train_model:86} INFO - Train Epoch: 15 [489216/612104 (80%)]	lr:1.25e-04	Loss: 0.058029
[2024-01-06 18:36:38,742] {train_model:86} INFO - Train Epoch: 15 [550400/612104 (90%)]	lr:1.25e-04	Loss: 0.200833
[2024-01-06 18:36:50,361] {train_model:86} INFO - Train Epoch: 15 [611584/612104 (100%)]	lr:1.25e-04	Loss: 0.076339
[2024-01-06 18:37:03,016] {run_experiment:78} INFO - 
[2024-01-06 18:37:03,023] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 18:37:04,311] {result_logger:108} INFO - precision on WAKE: 0.989
[2024-01-06 18:37:05,151] {result_logger:109} INFO - recall on WAKE: 0.961
[2024-01-06 18:37:05,982] {result_logger:112} INFO - F1-score on WAKE: 0.975
[2024-01-06 18:37:05,982] {result_logger:113} INFO - 
[2024-01-06 18:37:07,215] {result_logger:108} INFO - precision on NREM: 0.952
[2024-01-06 18:37:08,031] {result_logger:109} INFO - recall on NREM: 0.950
[2024-01-06 18:37:08,859] {result_logger:112} INFO - F1-score on NREM: 0.951
[2024-01-06 18:37:08,859] {result_logger:113} INFO - 
[2024-01-06 18:37:09,999] {result_logger:108} INFO - precision on REM: 0.756
[2024-01-06 18:37:10,732] {result_logger:109} INFO - recall on REM: 0.951
[2024-01-06 18:37:11,448] {result_logger:112} INFO - F1-score on REM: 0.842
[2024-01-06 18:37:11,448] {result_logger:113} INFO - 
[2024-01-06 18:37:11,639] {result_logger:116} INFO - average precision on sleep stages: 0.899
[2024-01-06 18:37:11,829] {result_logger:118} INFO - average recall on sleep stages: 0.954
[2024-01-06 18:37:12,023] {result_logger:120} INFO - average F1-score on sleep stages: 0.923
[2024-01-06 18:37:12,569] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.954
[2024-01-06 18:37:12,597] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.956
[2024-01-06 18:37:12,601] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 18:37:12,764] {result_logger:108} INFO - precision on WAKE: 0.819
[2024-01-06 18:37:12,865] {result_logger:109} INFO - recall on WAKE: 0.984
[2024-01-06 18:37:12,965] {result_logger:112} INFO - F1-score on WAKE: 0.894
[2024-01-06 18:37:12,965] {result_logger:113} INFO - 
[2024-01-06 18:37:13,127] {result_logger:108} INFO - precision on NREM: 0.964
[2024-01-06 18:37:13,228] {result_logger:109} INFO - recall on NREM: 0.722
[2024-01-06 18:37:13,327] {result_logger:112} INFO - F1-score on NREM: 0.826
[2024-01-06 18:37:13,327] {result_logger:113} INFO - 
[2024-01-06 18:37:13,488] {result_logger:108} INFO - precision on REM: 0.667
[2024-01-06 18:37:13,586] {result_logger:109} INFO - recall on REM: 0.552
[2024-01-06 18:37:13,685] {result_logger:112} INFO - F1-score on REM: 0.604
[2024-01-06 18:37:13,685] {result_logger:113} INFO - 
[2024-01-06 18:37:13,703] {result_logger:116} INFO - average precision on sleep stages: 0.817
[2024-01-06 18:37:13,721] {result_logger:118} INFO - average recall on sleep stages: 0.753
[2024-01-06 18:37:13,739] {result_logger:120} INFO - average F1-score on sleep stages: 0.774
[2024-01-06 18:37:13,813] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.753
[2024-01-06 18:37:13,815] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.854
[2024-01-06 18:37:13,816] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 18:37:14,408] {result_logger:143} INFO - 
[[319046   9866   3140      3]
 [  3176 227270   8743      1]
 [   382   1497  36791      1]
 [  1912    239     37      0]]
[2024-01-06 18:37:14,990] {result_logger:150} INFO - 
[[ 96.08%   2.97%   0.95%   0.00%]
 [  1.33%  95.02%   3.66%   0.00%]
 [  0.99%   3.87%  95.14%   0.00%]
 [ 87.39%  10.92%   1.69%   0.00%]]
[2024-01-06 18:37:15,557] {result_logger:154} INFO - 
[[ 98.31%   4.13%   6.45%  60.00%]
 [  0.98%  95.14%  17.95%  20.00%]
 [  0.12%   0.63%  75.53%  20.00%]
 [  0.59%   0.10%   0.08%   0.00%]]
[2024-01-06 18:37:15,557] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 18:37:15,633] {result_logger:143} INFO - 
[[47554   709    56     0]
 [ 8350 25340  1415     0]
 [ 2157   238  2946     0]
 [  795    29    10     0]]
[2024-01-06 18:37:15,868] {result_logger:150} INFO - 
[[ 98.42%   1.47%   0.12%   0.00%]
 [ 23.79%  72.18%   4.03%   0.00%]
 [ 40.39%   4.46%  55.16%   0.00%]
 [ 95.32%   3.48%   1.20%   0.00%]]
[2024-01-06 18:37:16,072] {result_logger:154} INFO - 
[[ 80.80%   2.69%   1.26%    nan%]
 [ 14.19%  96.29%  31.96%    nan%]
 [  3.66%   0.90%  66.55%    nan%]
 [  1.35%   0.11%   0.23%    nan%]]
[2024-01-06 18:37:16,524] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 18:37:16,524] {result_logger:77} INFO - actual:
[2024-01-06 18:37:16,524] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 18:37:16,524] {result_logger:79} INFO - predicted:
[2024-01-06 18:37:16,525] {result_logger:80} INFO - 
[[96.88%  2.71%  0.40%  0.00%]
 [ 5.12% 92.95%  1.93%  0.00%]
 [10.98%  5.85% 83.17%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 18:37:16,572] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it3/model_8conv_2fc-best.pth
[2024-01-06 18:37:16,572] {run_experiment:113} INFO - [epoch  15] execution time: 187.11s	 avg f1-score: 0.7745

[2024-01-06 18:37:16,573] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 18:37:16,626] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 18:37:56,943] {train_model:86} INFO - Train Epoch: 16 [60928/612104 (10%)]	lr:1.17e-04	Loss: 0.121141
[2024-01-06 18:38:08,375] {train_model:86} INFO - Train Epoch: 16 [122112/612104 (20%)]	lr:1.17e-04	Loss: 0.118458
[2024-01-06 18:38:20,482] {train_model:86} INFO - Train Epoch: 16 [183296/612104 (30%)]	lr:1.17e-04	Loss: 0.089326
[2024-01-06 18:38:31,924] {train_model:86} INFO - Train Epoch: 16 [244480/612104 (40%)]	lr:1.17e-04	Loss: 0.148872
[2024-01-06 18:38:43,557] {train_model:86} INFO - Train Epoch: 16 [305664/612104 (50%)]	lr:1.17e-04	Loss: 0.075728
[2024-01-06 18:38:54,886] {train_model:86} INFO - Train Epoch: 16 [366848/612104 (60%)]	lr:1.17e-04	Loss: 0.099222
[2024-01-06 18:39:06,364] {train_model:86} INFO - Train Epoch: 16 [428032/612104 (70%)]	lr:1.17e-04	Loss: 0.097758
[2024-01-06 18:39:18,172] {train_model:86} INFO - Train Epoch: 16 [489216/612104 (80%)]	lr:1.17e-04	Loss: 0.158988
[2024-01-06 18:39:30,388] {train_model:86} INFO - Train Epoch: 16 [550400/612104 (90%)]	lr:1.17e-04	Loss: 0.059631
[2024-01-06 18:39:58,035] {train_model:86} INFO - Train Epoch: 16 [611584/612104 (100%)]	lr:1.17e-04	Loss: 0.120367
[2024-01-06 18:40:10,350] {run_experiment:78} INFO - 
[2024-01-06 18:40:10,357] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 18:40:11,632] {result_logger:108} INFO - precision on WAKE: 0.989
[2024-01-06 18:40:12,455] {result_logger:109} INFO - recall on WAKE: 0.961
[2024-01-06 18:40:13,283] {result_logger:112} INFO - F1-score on WAKE: 0.975
[2024-01-06 18:40:13,283] {result_logger:113} INFO - 
[2024-01-06 18:40:14,519] {result_logger:108} INFO - precision on NREM: 0.952
[2024-01-06 18:40:15,301] {result_logger:109} INFO - recall on NREM: 0.951
[2024-01-06 18:40:16,090] {result_logger:112} INFO - F1-score on NREM: 0.952
[2024-01-06 18:40:16,090] {result_logger:113} INFO - 
[2024-01-06 18:40:17,264] {result_logger:108} INFO - precision on REM: 0.762
[2024-01-06 18:40:17,988] {result_logger:109} INFO - recall on REM: 0.953
[2024-01-06 18:40:18,718] {result_logger:112} INFO - F1-score on REM: 0.847
[2024-01-06 18:40:18,718] {result_logger:113} INFO - 
[2024-01-06 18:40:18,897] {result_logger:116} INFO - average precision on sleep stages: 0.901
[2024-01-06 18:40:19,086] {result_logger:118} INFO - average recall on sleep stages: 0.955
[2024-01-06 18:40:19,273] {result_logger:120} INFO - average F1-score on sleep stages: 0.924
[2024-01-06 18:40:19,799] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.955
[2024-01-06 18:40:19,824] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.957
[2024-01-06 18:40:19,827] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 18:40:19,988] {result_logger:108} INFO - precision on WAKE: 0.921
[2024-01-06 18:40:20,085] {result_logger:109} INFO - recall on WAKE: 0.824
[2024-01-06 18:40:20,183] {result_logger:112} INFO - F1-score on WAKE: 0.869
[2024-01-06 18:40:20,183] {result_logger:113} INFO - 
[2024-01-06 18:40:20,347] {result_logger:108} INFO - precision on NREM: 0.946
[2024-01-06 18:40:20,444] {result_logger:109} INFO - recall on NREM: 0.834
[2024-01-06 18:40:20,544] {result_logger:112} INFO - F1-score on NREM: 0.886
[2024-01-06 18:40:20,544] {result_logger:113} INFO - 
[2024-01-06 18:40:20,708] {result_logger:108} INFO - precision on REM: 0.341
[2024-01-06 18:40:20,806] {result_logger:109} INFO - recall on REM: 0.932
[2024-01-06 18:40:20,899] {result_logger:112} INFO - F1-score on REM: 0.499
[2024-01-06 18:40:20,899] {result_logger:113} INFO - 
[2024-01-06 18:40:20,917] {result_logger:116} INFO - average precision on sleep stages: 0.736
[2024-01-06 18:40:20,934] {result_logger:118} INFO - average recall on sleep stages: 0.863
[2024-01-06 18:40:20,953] {result_logger:120} INFO - average F1-score on sleep stages: 0.752
[2024-01-06 18:40:21,025] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.863
[2024-01-06 18:40:21,027] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.834
[2024-01-06 18:40:21,028] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 18:40:21,591] {result_logger:143} INFO - 
[[319041   9987   3027      0]
 [  3156 227560   8473      1]
 [   351   1474  36846      0]
 [  1909    246     33      0]]
[2024-01-06 18:40:22,156] {result_logger:150} INFO - 
[[ 96.08%   3.01%   0.91%   0.00%]
 [  1.32%  95.14%   3.54%   0.00%]
 [  0.91%   3.81%  95.28%   0.00%]
 [ 87.25%  11.24%   1.51%   0.00%]]
[2024-01-06 18:40:22,721] {result_logger:154} INFO - 
[[ 98.33%   4.17%   6.26%   0.00%]
 [  0.97%  95.11%  17.51% 100.00%]
 [  0.11%   0.62%  76.16%   0.00%]
 [  0.59%   0.10%   0.07%   0.00%]]
[2024-01-06 18:40:22,722] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 18:40:22,795] {result_logger:143} INFO - 
[[39799  1509  7011     0]
 [ 3237 29270  2598     0]
 [  194   171  4976     0]
 [  277    72   485     0]]
[2024-01-06 18:40:22,983] {result_logger:150} INFO - 
[[ 82.37%   3.12%  14.51%   0.00%]
 [  9.22%  83.38%   7.40%   0.00%]
 [  3.63%   3.20%  93.17%   0.00%]
 [ 33.21%   8.63%  58.15%   0.00%]]
[2024-01-06 18:40:23,183] {result_logger:154} INFO - 
[[ 91.48%   4.86%  46.52%    nan%]
 [  7.44%  94.35%  17.24%    nan%]
 [  0.45%   0.55%  33.02%    nan%]
 [  0.64%   0.23%   3.22%    nan%]]
[2024-01-06 18:40:23,691] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 18:40:23,691] {result_logger:77} INFO - actual:
[2024-01-06 18:40:23,691] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 18:40:23,691] {result_logger:79} INFO - predicted:
[2024-01-06 18:40:23,691] {result_logger:80} INFO - 
[[93.42%  3.00%  3.58%  0.00%]
 [ 3.64% 93.30%  3.06%  0.00%]
 [11.51%  5.12% 83.36%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 18:40:23,727] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it3/model_8conv_2fc-best.pth
[2024-01-06 18:40:23,728] {run_experiment:113} INFO - [epoch  16] execution time: 187.16s	 avg f1-score: 0.7517

[2024-01-06 18:40:23,728] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 18:40:23,784] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 18:41:05,721] {train_model:86} INFO - Train Epoch: 17 [60928/612104 (10%)]	lr:1.11e-04	Loss: 0.150060
[2024-01-06 18:41:31,121] {train_model:86} INFO - Train Epoch: 17 [122112/612104 (20%)]	lr:1.11e-04	Loss: 0.047867
[2024-01-06 18:41:42,545] {train_model:86} INFO - Train Epoch: 17 [183296/612104 (30%)]	lr:1.11e-04	Loss: 0.127240
[2024-01-06 18:41:53,811] {train_model:86} INFO - Train Epoch: 17 [244480/612104 (40%)]	lr:1.11e-04	Loss: 0.191982
[2024-01-06 18:42:05,519] {train_model:86} INFO - Train Epoch: 17 [305664/612104 (50%)]	lr:1.11e-04	Loss: 0.142218
[2024-01-06 18:42:17,046] {train_model:86} INFO - Train Epoch: 17 [366848/612104 (60%)]	lr:1.11e-04	Loss: 0.115106
[2024-01-06 18:42:28,331] {train_model:86} INFO - Train Epoch: 17 [428032/612104 (70%)]	lr:1.11e-04	Loss: 0.064786
[2024-01-06 18:42:39,966] {train_model:86} INFO - Train Epoch: 17 [489216/612104 (80%)]	lr:1.11e-04	Loss: 0.081271
[2024-01-06 18:42:51,524] {train_model:86} INFO - Train Epoch: 17 [550400/612104 (90%)]	lr:1.11e-04	Loss: 0.082306
[2024-01-06 18:43:03,126] {train_model:86} INFO - Train Epoch: 17 [611584/612104 (100%)]	lr:1.11e-04	Loss: 0.169058
[2024-01-06 18:43:15,919] {run_experiment:78} INFO - 
[2024-01-06 18:43:15,926] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 18:43:17,186] {result_logger:108} INFO - precision on WAKE: 0.989
[2024-01-06 18:43:18,009] {result_logger:109} INFO - recall on WAKE: 0.962
[2024-01-06 18:43:18,843] {result_logger:112} INFO - F1-score on WAKE: 0.975
[2024-01-06 18:43:18,844] {result_logger:113} INFO - 
[2024-01-06 18:43:20,119] {result_logger:108} INFO - precision on NREM: 0.953
[2024-01-06 18:43:20,952] {result_logger:109} INFO - recall on NREM: 0.952
[2024-01-06 18:43:21,784] {result_logger:112} INFO - F1-score on NREM: 0.952
[2024-01-06 18:43:21,784] {result_logger:113} INFO - 
[2024-01-06 18:43:22,965] {result_logger:108} INFO - precision on REM: 0.767
[2024-01-06 18:43:23,693] {result_logger:109} INFO - recall on REM: 0.956
[2024-01-06 18:43:24,431] {result_logger:112} INFO - F1-score on REM: 0.851
[2024-01-06 18:43:24,431] {result_logger:113} INFO - 
[2024-01-06 18:43:24,620] {result_logger:116} INFO - average precision on sleep stages: 0.903
[2024-01-06 18:43:24,812] {result_logger:118} INFO - average recall on sleep stages: 0.956
[2024-01-06 18:43:25,008] {result_logger:120} INFO - average F1-score on sleep stages: 0.926
[2024-01-06 18:43:25,542] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.956
[2024-01-06 18:43:25,570] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.957
[2024-01-06 18:43:25,575] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 18:43:25,736] {result_logger:108} INFO - precision on WAKE: 0.929
[2024-01-06 18:43:25,835] {result_logger:109} INFO - recall on WAKE: 0.933
[2024-01-06 18:43:25,935] {result_logger:112} INFO - F1-score on WAKE: 0.931
[2024-01-06 18:43:25,935] {result_logger:113} INFO - 
[2024-01-06 18:43:26,094] {result_logger:108} INFO - precision on NREM: 0.932
[2024-01-06 18:43:26,198] {result_logger:109} INFO - recall on NREM: 0.852
[2024-01-06 18:43:26,300] {result_logger:112} INFO - F1-score on NREM: 0.890
[2024-01-06 18:43:26,300] {result_logger:113} INFO - 
[2024-01-06 18:43:26,461] {result_logger:108} INFO - precision on REM: 0.610
[2024-01-06 18:43:26,556] {result_logger:109} INFO - recall on REM: 0.935
[2024-01-06 18:43:26,651] {result_logger:112} INFO - F1-score on REM: 0.739
[2024-01-06 18:43:26,651] {result_logger:113} INFO - 
[2024-01-06 18:43:26,668] {result_logger:116} INFO - average precision on sleep stages: 0.824
[2024-01-06 18:43:26,686] {result_logger:118} INFO - average recall on sleep stages: 0.906
[2024-01-06 18:43:26,704] {result_logger:120} INFO - average F1-score on sleep stages: 0.853
[2024-01-06 18:43:26,771] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.906
[2024-01-06 18:43:26,774] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.901
[2024-01-06 18:43:26,775] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 18:43:27,343] {result_logger:143} INFO - 
[[319301   9847   2902      5]
 [  3183 227673   8332      2]
 [   368   1346  36953      4]
 [  1925    232     31      0]]
[2024-01-06 18:43:27,934] {result_logger:150} INFO - 
[[ 96.16%   2.97%   0.87%   0.00%]
 [  1.33%  95.18%   3.48%   0.00%]
 [  0.95%   3.48%  95.56%   0.01%]
 [ 87.98%  10.60%   1.42%   0.00%]]
[2024-01-06 18:43:28,525] {result_logger:154} INFO - 
[[ 98.31%   4.12%   6.02%  45.45%]
 [  0.98%  95.22%  17.28%  18.18%]
 [  0.11%   0.56%  76.64%  36.36%]
 [  0.59%   0.10%   0.06%   0.00%]]
[2024-01-06 18:43:28,525] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 18:43:28,606] {result_logger:143} INFO - 
[[45067  1982  1270     0]
 [ 3285 29902  1918     0]
 [  163   185  4993     0]
 [  587   124   123     0]]
[2024-01-06 18:43:28,808] {result_logger:150} INFO - 
[[ 93.27%   4.10%   2.63%   0.00%]
 [  9.36%  85.18%   5.46%   0.00%]
 [  3.05%   3.46%  93.48%   0.00%]
 [ 70.38%  14.87%  14.75%   0.00%]]
[2024-01-06 18:43:29,007] {result_logger:154} INFO - 
[[ 91.78%   6.16%  15.29%    nan%]
 [  6.69%  92.88%  23.10%    nan%]
 [  0.33%   0.57%  60.13%    nan%]
 [  1.20%   0.39%   1.48%    nan%]]
[2024-01-06 18:43:29,424] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 18:43:29,425] {result_logger:77} INFO - actual:
[2024-01-06 18:43:29,425] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 18:43:29,425] {result_logger:79} INFO - predicted:
[2024-01-06 18:43:29,425] {result_logger:80} INFO - 
[[94.90%  3.75%  1.35%  0.00%]
 [ 4.84% 92.88%  2.29%  0.00%]
 [11.39%  5.47% 83.14%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 18:43:29,460] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it3/model_8conv_2fc-best.pth
[2024-01-06 18:43:29,460] {run_experiment:113} INFO - [epoch  17] execution time: 185.73s	 avg f1-score: 0.8532

[2024-01-06 18:43:29,460] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 18:43:29,513] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 18:43:57,010] {train_model:86} INFO - Train Epoch: 18 [60928/612104 (10%)]	lr:1.04e-04	Loss: 0.064609
[2024-01-06 18:44:24,000] {train_model:86} INFO - Train Epoch: 18 [122112/612104 (20%)]	lr:1.04e-04	Loss: 0.195743
[2024-01-06 18:44:49,785] {train_model:86} INFO - Train Epoch: 18 [183296/612104 (30%)]	lr:1.04e-04	Loss: 0.072217
[2024-01-06 18:45:01,130] {train_model:86} INFO - Train Epoch: 18 [244480/612104 (40%)]	lr:1.04e-04	Loss: 0.104426
[2024-01-06 18:45:13,009] {train_model:86} INFO - Train Epoch: 18 [305664/612104 (50%)]	lr:1.04e-04	Loss: 0.243974
[2024-01-06 18:45:24,447] {train_model:86} INFO - Train Epoch: 18 [366848/612104 (60%)]	lr:1.04e-04	Loss: 0.084461
[2024-01-06 18:45:35,844] {train_model:86} INFO - Train Epoch: 18 [428032/612104 (70%)]	lr:1.04e-04	Loss: 0.069448
[2024-01-06 18:45:47,223] {train_model:86} INFO - Train Epoch: 18 [489216/612104 (80%)]	lr:1.04e-04	Loss: 0.154238
[2024-01-06 18:45:59,258] {train_model:86} INFO - Train Epoch: 18 [550400/612104 (90%)]	lr:1.04e-04	Loss: 0.190915
[2024-01-06 18:46:11,159] {train_model:86} INFO - Train Epoch: 18 [611584/612104 (100%)]	lr:1.04e-04	Loss: 0.055891
[2024-01-06 18:46:23,486] {run_experiment:78} INFO - 
[2024-01-06 18:46:23,493] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 18:46:24,716] {result_logger:108} INFO - precision on WAKE: 0.989
[2024-01-06 18:46:25,530] {result_logger:109} INFO - recall on WAKE: 0.962
[2024-01-06 18:46:26,341] {result_logger:112} INFO - F1-score on WAKE: 0.975
[2024-01-06 18:46:26,341] {result_logger:113} INFO - 
[2024-01-06 18:46:27,584] {result_logger:108} INFO - precision on NREM: 0.954
[2024-01-06 18:46:28,380] {result_logger:109} INFO - recall on NREM: 0.953
[2024-01-06 18:46:29,181] {result_logger:112} INFO - F1-score on NREM: 0.953
[2024-01-06 18:46:29,181] {result_logger:113} INFO - 
[2024-01-06 18:46:30,300] {result_logger:108} INFO - precision on REM: 0.771
[2024-01-06 18:46:31,000] {result_logger:109} INFO - recall on REM: 0.957
[2024-01-06 18:46:31,701] {result_logger:112} INFO - F1-score on REM: 0.854
[2024-01-06 18:46:31,701] {result_logger:113} INFO - 
[2024-01-06 18:46:31,890] {result_logger:116} INFO - average precision on sleep stages: 0.905
[2024-01-06 18:46:32,073] {result_logger:118} INFO - average recall on sleep stages: 0.957
[2024-01-06 18:46:32,253] {result_logger:120} INFO - average F1-score on sleep stages: 0.928
[2024-01-06 18:46:32,772] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.957
[2024-01-06 18:46:32,797] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.958
[2024-01-06 18:46:32,800] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 18:46:32,952] {result_logger:108} INFO - precision on WAKE: 0.895
[2024-01-06 18:46:33,048] {result_logger:109} INFO - recall on WAKE: 0.943
[2024-01-06 18:46:33,147] {result_logger:112} INFO - F1-score on WAKE: 0.918
[2024-01-06 18:46:33,147] {result_logger:113} INFO - 
[2024-01-06 18:46:33,316] {result_logger:108} INFO - precision on NREM: 0.924
[2024-01-06 18:46:33,415] {result_logger:109} INFO - recall on NREM: 0.822
[2024-01-06 18:46:33,509] {result_logger:112} INFO - F1-score on NREM: 0.870
[2024-01-06 18:46:33,510] {result_logger:113} INFO - 
[2024-01-06 18:46:33,665] {result_logger:108} INFO - precision on REM: 0.699
[2024-01-06 18:46:33,763] {result_logger:109} INFO - recall on REM: 0.863
[2024-01-06 18:46:33,862] {result_logger:112} INFO - F1-score on REM: 0.772
[2024-01-06 18:46:33,862] {result_logger:113} INFO - 
[2024-01-06 18:46:33,881] {result_logger:116} INFO - average precision on sleep stages: 0.839
[2024-01-06 18:46:33,899] {result_logger:118} INFO - average recall on sleep stages: 0.876
[2024-01-06 18:46:33,917] {result_logger:120} INFO - average F1-score on sleep stages: 0.853
[2024-01-06 18:46:33,989] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.876
[2024-01-06 18:46:33,991] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.890
[2024-01-06 18:46:33,992] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 18:46:34,571] {result_logger:143} INFO - 
[[319398   9744   2908      5]
 [  3194 227912   8083      1]
 [   325   1318  37024      4]
 [  1915    241     32      0]]
[2024-01-06 18:46:35,158] {result_logger:150} INFO - 
[[ 96.19%   2.93%   0.88%   0.00%]
 [  1.34%  95.28%   3.38%   0.00%]
 [  0.84%   3.41%  95.74%   0.01%]
 [ 87.52%  11.01%   1.46%   0.00%]]
[2024-01-06 18:46:35,736] {result_logger:154} INFO - 
[[ 98.33%   4.07%   6.05%  50.00%]
 [  0.98%  95.27%  16.82%  10.00%]
 [  0.10%   0.55%  77.06%  40.00%]
 [  0.59%   0.10%   0.07%   0.00%]]
[2024-01-06 18:46:35,736] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 18:46:35,815] {result_logger:143} INFO - 
[[45572  2087   660     0]
 [ 4934 28847  1324     0]
 [  438   294  4609     0]
 [  632   131    71     0]]
[2024-01-06 18:46:36,015] {result_logger:150} INFO - 
[[ 94.31%   4.32%   1.37%   0.00%]
 [ 14.05%  82.17%   3.77%   0.00%]
 [  8.20%   5.50%  86.29%   0.00%]
 [ 75.78%  15.71%   8.51%   0.00%]]
[2024-01-06 18:46:36,208] {result_logger:154} INFO - 
[[ 88.36%   6.66%   9.90%    nan%]
 [  9.57%  91.99%  19.87%    nan%]
 [  0.85%   0.94%  69.16%    nan%]
 [  1.23%   0.42%   1.07%    nan%]]
[2024-01-06 18:46:36,621] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 18:46:36,622] {result_logger:77} INFO - actual:
[2024-01-06 18:46:36,622] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 18:46:36,622] {result_logger:79} INFO - predicted:
[2024-01-06 18:46:36,622] {result_logger:80} INFO - 
[[95.41%  3.63%  0.96%  0.00%]
 [ 5.23% 92.86%  1.92%  0.00%]
 [10.92%  5.51% 83.57%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 18:46:36,657] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it3/model_8conv_2fc-best.pth
[2024-01-06 18:46:36,658] {run_experiment:113} INFO - [epoch  18] execution time: 187.20s	 avg f1-score: 0.8535

[2024-01-06 18:46:36,658] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 18:46:36,713] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 18:47:02,838] {train_model:86} INFO - Train Epoch: 19 [60928/612104 (10%)]	lr:9.80e-05	Loss: 0.123453
[2024-01-06 18:47:32,184] {train_model:86} INFO - Train Epoch: 19 [122112/612104 (20%)]	lr:9.80e-05	Loss: 0.292608
[2024-01-06 18:48:15,627] {train_model:86} INFO - Train Epoch: 19 [183296/612104 (30%)]	lr:9.80e-05	Loss: 0.081813
[2024-01-06 18:48:26,828] {train_model:86} INFO - Train Epoch: 19 [244480/612104 (40%)]	lr:9.80e-05	Loss: 0.074853
[2024-01-06 18:48:38,064] {train_model:86} INFO - Train Epoch: 19 [305664/612104 (50%)]	lr:9.80e-05	Loss: 0.138811
[2024-01-06 18:48:49,691] {train_model:86} INFO - Train Epoch: 19 [366848/612104 (60%)]	lr:9.80e-05	Loss: 0.083566
[2024-01-06 18:49:01,192] {train_model:86} INFO - Train Epoch: 19 [428032/612104 (70%)]	lr:9.80e-05	Loss: 0.063999
[2024-01-06 18:49:12,795] {train_model:86} INFO - Train Epoch: 19 [489216/612104 (80%)]	lr:9.80e-05	Loss: 0.140662
[2024-01-06 18:49:24,434] {train_model:86} INFO - Train Epoch: 19 [550400/612104 (90%)]	lr:9.80e-05	Loss: 0.088398
[2024-01-06 18:49:36,134] {train_model:86} INFO - Train Epoch: 19 [611584/612104 (100%)]	lr:9.80e-05	Loss: 0.141879
[2024-01-06 18:49:48,951] {run_experiment:78} INFO - 
[2024-01-06 18:49:48,957] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 18:49:50,238] {result_logger:108} INFO - precision on WAKE: 0.989
[2024-01-06 18:49:51,086] {result_logger:109} INFO - recall on WAKE: 0.963
[2024-01-06 18:49:51,920] {result_logger:112} INFO - F1-score on WAKE: 0.976
[2024-01-06 18:49:51,920] {result_logger:113} INFO - 
[2024-01-06 18:49:53,130] {result_logger:108} INFO - precision on NREM: 0.954
[2024-01-06 18:49:53,928] {result_logger:109} INFO - recall on NREM: 0.954
[2024-01-06 18:49:54,738] {result_logger:112} INFO - F1-score on NREM: 0.954
[2024-01-06 18:49:54,738] {result_logger:113} INFO - 
[2024-01-06 18:49:55,857] {result_logger:108} INFO - precision on REM: 0.779
[2024-01-06 18:49:56,575] {result_logger:109} INFO - recall on REM: 0.958
[2024-01-06 18:49:57,297] {result_logger:112} INFO - F1-score on REM: 0.859
[2024-01-06 18:49:57,298] {result_logger:113} INFO - 
[2024-01-06 18:49:57,486] {result_logger:116} INFO - average precision on sleep stages: 0.907
[2024-01-06 18:49:57,671] {result_logger:118} INFO - average recall on sleep stages: 0.958
[2024-01-06 18:49:57,865] {result_logger:120} INFO - average F1-score on sleep stages: 0.930
[2024-01-06 18:49:58,388] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.958
[2024-01-06 18:49:58,414] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.959
[2024-01-06 18:49:58,419] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 18:49:58,576] {result_logger:108} INFO - precision on WAKE: 0.916
[2024-01-06 18:49:58,674] {result_logger:109} INFO - recall on WAKE: 0.933
[2024-01-06 18:49:58,774] {result_logger:112} INFO - F1-score on WAKE: 0.924
[2024-01-06 18:49:58,774] {result_logger:113} INFO - 
[2024-01-06 18:49:58,935] {result_logger:108} INFO - precision on NREM: 0.913
[2024-01-06 18:49:59,033] {result_logger:109} INFO - recall on NREM: 0.846
[2024-01-06 18:49:59,133] {result_logger:112} INFO - F1-score on NREM: 0.878
[2024-01-06 18:49:59,133] {result_logger:113} INFO - 
[2024-01-06 18:49:59,289] {result_logger:108} INFO - precision on REM: 0.678
[2024-01-06 18:49:59,389] {result_logger:109} INFO - recall on REM: 0.894
[2024-01-06 18:49:59,488] {result_logger:112} INFO - F1-score on REM: 0.771
[2024-01-06 18:49:59,489] {result_logger:113} INFO - 
[2024-01-06 18:49:59,506] {result_logger:116} INFO - average precision on sleep stages: 0.836
[2024-01-06 18:49:59,524] {result_logger:118} INFO - average recall on sleep stages: 0.891
[2024-01-06 18:49:59,542] {result_logger:120} INFO - average F1-score on sleep stages: 0.858
[2024-01-06 18:49:59,611] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.891
[2024-01-06 18:49:59,614] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.896
[2024-01-06 18:49:59,614] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 18:50:00,179] {result_logger:143} INFO - 
[[319668   9700   2682      5]
 [  3213 228129   7847      1]
 [   334   1294  37040      3]
 [  1914    238     36      0]]
[2024-01-06 18:50:00,756] {result_logger:150} INFO - 
[[ 96.27%   2.92%   0.81%   0.00%]
 [  1.34%  95.38%   3.28%   0.00%]
 [  0.86%   3.35%  95.78%   0.01%]
 [ 87.48%  10.88%   1.65%   0.00%]]
[2024-01-06 18:50:01,336] {result_logger:154} INFO - 
[[ 98.32%   4.05%   5.63%  55.56%]
 [  0.99%  95.31%  16.48%  11.11%]
 [  0.10%   0.54%  77.81%  33.33%]
 [  0.59%   0.10%   0.08%   0.00%]]
[2024-01-06 18:50:01,336] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 18:50:01,410] {result_logger:143} INFO - 
[[45064  2592   663     0]
 [ 3790 29710  1605     0]
 [  331   236  4774     0]
 [  577   222    35     0]]
[2024-01-06 18:50:01,606] {result_logger:150} INFO - 
[[ 93.26%   5.36%   1.37%   0.00%]
 [ 10.80%  84.63%   4.57%   0.00%]
 [  6.20%   4.42%  89.38%   0.00%]
 [ 69.18%  26.62%   4.20%   0.00%]]
[2024-01-06 18:50:01,799] {result_logger:154} INFO - 
[[ 90.56%   7.91%   9.37%    nan%]
 [  7.62%  90.69%  22.68%    nan%]
 [  0.67%   0.72%  67.46%    nan%]
 [  1.16%   0.68%   0.49%    nan%]]
[2024-01-06 18:50:02,196] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 18:50:02,196] {result_logger:77} INFO - actual:
[2024-01-06 18:50:02,196] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 18:50:02,196] {result_logger:79} INFO - predicted:
[2024-01-06 18:50:02,196] {result_logger:80} INFO - 
[[95.01%  4.03%  0.96%  0.00%]
 [ 5.36% 92.60%  2.04%  0.00%]
 [10.24%  5.95% 83.81%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 18:50:02,233] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it3/model_8conv_2fc-best.pth
[2024-01-06 18:50:02,233] {run_experiment:113} INFO - [epoch  19] execution time: 205.58s	 avg f1-score: 0.8579

[2024-01-06 18:50:02,233] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 18:50:02,288] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 18:50:28,634] {train_model:86} INFO - Train Epoch: 20 [60928/612104 (10%)]	lr:9.23e-05	Loss: 0.087732
[2024-01-06 18:50:40,036] {train_model:86} INFO - Train Epoch: 20 [122112/612104 (20%)]	lr:9.23e-05	Loss: 0.108576
[2024-01-06 18:51:44,129] {train_model:86} INFO - Train Epoch: 20 [183296/612104 (30%)]	lr:9.23e-05	Loss: 0.134998
[2024-01-06 18:51:56,017] {train_model:86} INFO - Train Epoch: 20 [244480/612104 (40%)]	lr:9.23e-05	Loss: 0.060841
[2024-01-06 18:52:07,527] {train_model:86} INFO - Train Epoch: 20 [305664/612104 (50%)]	lr:9.23e-05	Loss: 0.081896
[2024-01-06 18:52:18,825] {train_model:86} INFO - Train Epoch: 20 [366848/612104 (60%)]	lr:9.23e-05	Loss: 0.112107
[2024-01-06 18:52:30,725] {train_model:86} INFO - Train Epoch: 20 [428032/612104 (70%)]	lr:9.23e-05	Loss: 0.078193
[2024-01-06 18:52:42,364] {train_model:86} INFO - Train Epoch: 20 [489216/612104 (80%)]	lr:9.23e-05	Loss: 0.085948
[2024-01-06 18:52:53,714] {train_model:86} INFO - Train Epoch: 20 [550400/612104 (90%)]	lr:9.23e-05	Loss: 0.133894
[2024-01-06 18:53:04,990] {train_model:86} INFO - Train Epoch: 20 [611584/612104 (100%)]	lr:9.23e-05	Loss: 0.169545
[2024-01-06 18:53:17,540] {run_experiment:78} INFO - 
[2024-01-06 18:53:17,547] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 18:53:18,785] {result_logger:108} INFO - precision on WAKE: 0.989
[2024-01-06 18:53:19,602] {result_logger:109} INFO - recall on WAKE: 0.963
[2024-01-06 18:53:20,423] {result_logger:112} INFO - F1-score on WAKE: 0.976
[2024-01-06 18:53:20,423] {result_logger:113} INFO - 
[2024-01-06 18:53:21,637] {result_logger:108} INFO - precision on NREM: 0.955
[2024-01-06 18:53:22,442] {result_logger:109} INFO - recall on NREM: 0.954
[2024-01-06 18:53:23,235] {result_logger:112} INFO - F1-score on NREM: 0.955
[2024-01-06 18:53:23,235] {result_logger:113} INFO - 
[2024-01-06 18:53:24,346] {result_logger:108} INFO - precision on REM: 0.781
[2024-01-06 18:53:25,057] {result_logger:109} INFO - recall on REM: 0.959
[2024-01-06 18:53:25,762] {result_logger:112} INFO - F1-score on REM: 0.861
[2024-01-06 18:53:25,763] {result_logger:113} INFO - 
[2024-01-06 18:53:25,957] {result_logger:116} INFO - average precision on sleep stages: 0.908
[2024-01-06 18:53:26,154] {result_logger:118} INFO - average recall on sleep stages: 0.959
[2024-01-06 18:53:26,334] {result_logger:120} INFO - average F1-score on sleep stages: 0.931
[2024-01-06 18:53:26,852] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.959
[2024-01-06 18:53:26,878] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.959
[2024-01-06 18:53:26,881] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 18:53:27,044] {result_logger:108} INFO - precision on WAKE: 0.916
[2024-01-06 18:53:27,142] {result_logger:109} INFO - recall on WAKE: 0.945
[2024-01-06 18:53:27,240] {result_logger:112} INFO - F1-score on WAKE: 0.930
[2024-01-06 18:53:27,241] {result_logger:113} INFO - 
[2024-01-06 18:53:27,402] {result_logger:108} INFO - precision on NREM: 0.915
[2024-01-06 18:53:27,500] {result_logger:109} INFO - recall on NREM: 0.839
[2024-01-06 18:53:27,596] {result_logger:112} INFO - F1-score on NREM: 0.875
[2024-01-06 18:53:27,596] {result_logger:113} INFO - 
[2024-01-06 18:53:27,758] {result_logger:108} INFO - precision on REM: 0.686
[2024-01-06 18:53:27,856] {result_logger:109} INFO - recall on REM: 0.861
[2024-01-06 18:53:27,951] {result_logger:112} INFO - F1-score on REM: 0.763
[2024-01-06 18:53:27,952] {result_logger:113} INFO - 
[2024-01-06 18:53:27,969] {result_logger:116} INFO - average precision on sleep stages: 0.839
[2024-01-06 18:53:27,987] {result_logger:118} INFO - average recall on sleep stages: 0.881
[2024-01-06 18:53:28,004] {result_logger:120} INFO - average F1-score on sleep stages: 0.856
[2024-01-06 18:53:28,074] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.881
[2024-01-06 18:53:28,077] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.898
[2024-01-06 18:53:28,077] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 18:53:28,649] {result_logger:143} INFO - 
[[319846   9571   2638      0]
 [  3184 228274   7730      2]
 [   346   1252  37071      2]
 [  1911    243     34      0]]
[2024-01-06 18:53:29,223] {result_logger:150} INFO - 
[[ 96.32%   2.88%   0.79%   0.00%]
 [  1.33%  95.44%   3.23%   0.00%]
 [  0.89%   3.24%  95.86%   0.01%]
 [ 87.34%  11.11%   1.55%   0.00%]]
[2024-01-06 18:53:29,794] {result_logger:154} INFO - 
[[ 98.33%   4.00%   5.56%   0.00%]
 [  0.98%  95.38%  16.28%  50.00%]
 [  0.11%   0.52%  78.09%  50.00%]
 [  0.59%   0.10%   0.07%   0.00%]]
[2024-01-06 18:53:29,794] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 18:53:29,869] {result_logger:143} INFO - 
[[45645  2450   224     0]
 [ 3762 29464  1879     0]
 [  446   299  4596     0]
 [  624   175    35     0]]
[2024-01-06 18:53:30,064] {result_logger:150} INFO - 
[[ 94.47%   5.07%   0.46%   0.00%]
 [ 10.72%  83.93%   5.35%   0.00%]
 [  8.35%   5.60%  86.05%   0.00%]
 [ 74.82%  20.98%   4.20%   0.00%]]
[2024-01-06 18:53:30,253] {result_logger:154} INFO - 
[[ 90.43%   7.56%   3.33%    nan%]
 [  7.45%  90.97%  27.90%    nan%]
 [  0.88%   0.92%  68.25%    nan%]
 [  1.24%   0.54%   0.52%    nan%]]
[2024-01-06 18:53:30,752] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 18:53:30,752] {result_logger:77} INFO - actual:
[2024-01-06 18:53:30,752] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 18:53:30,752] {result_logger:79} INFO - predicted:
[2024-01-06 18:53:30,752] {result_logger:80} INFO - 
[[95.65%  3.80%  0.55%  0.00%]
 [ 5.11% 92.71%  2.17%  0.00%]
 [ 8.02%  6.55% 85.43%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 18:53:30,788] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it3/model_8conv_2fc-best.pth
[2024-01-06 18:53:30,788] {run_experiment:113} INFO - [epoch  20] execution time: 208.56s	 avg f1-score: 0.8562

[2024-01-06 18:53:30,788] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 18:53:30,843] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 18:53:56,880] {train_model:86} INFO - Train Epoch: 21 [60928/612104 (10%)]	lr:8.69e-05	Loss: 0.131366
[2024-01-06 18:54:08,113] {train_model:86} INFO - Train Epoch: 21 [122112/612104 (20%)]	lr:8.69e-05	Loss: 0.144348
[2024-01-06 18:55:10,788] {train_model:86} INFO - Train Epoch: 21 [183296/612104 (30%)]	lr:8.69e-05	Loss: 0.176317
[2024-01-06 18:55:22,084] {train_model:86} INFO - Train Epoch: 21 [244480/612104 (40%)]	lr:8.69e-05	Loss: 0.148258
[2024-01-06 18:55:33,430] {train_model:86} INFO - Train Epoch: 21 [305664/612104 (50%)]	lr:8.69e-05	Loss: 0.059448
[2024-01-06 18:55:44,610] {train_model:86} INFO - Train Epoch: 21 [366848/612104 (60%)]	lr:8.69e-05	Loss: 0.068455
[2024-01-06 18:55:55,845] {train_model:86} INFO - Train Epoch: 21 [428032/612104 (70%)]	lr:8.69e-05	Loss: 0.062517
[2024-01-06 18:56:07,244] {train_model:86} INFO - Train Epoch: 21 [489216/612104 (80%)]	lr:8.69e-05	Loss: 0.112329
[2024-01-06 18:56:18,887] {train_model:86} INFO - Train Epoch: 21 [550400/612104 (90%)]	lr:8.69e-05	Loss: 0.111804
[2024-01-06 18:56:31,111] {train_model:86} INFO - Train Epoch: 21 [611584/612104 (100%)]	lr:8.69e-05	Loss: 0.118755
[2024-01-06 18:56:43,616] {run_experiment:78} INFO - 
[2024-01-06 18:56:43,622] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 18:56:44,890] {result_logger:108} INFO - precision on WAKE: 0.989
[2024-01-06 18:56:45,720] {result_logger:109} INFO - recall on WAKE: 0.963
[2024-01-06 18:56:46,546] {result_logger:112} INFO - F1-score on WAKE: 0.976
[2024-01-06 18:56:46,546] {result_logger:113} INFO - 
[2024-01-06 18:56:47,770] {result_logger:108} INFO - precision on NREM: 0.955
[2024-01-06 18:56:48,558] {result_logger:109} INFO - recall on NREM: 0.955
[2024-01-06 18:56:49,372] {result_logger:112} INFO - F1-score on NREM: 0.955
[2024-01-06 18:56:49,372] {result_logger:113} INFO - 
[2024-01-06 18:56:50,531] {result_logger:108} INFO - precision on REM: 0.787
[2024-01-06 18:56:51,260] {result_logger:109} INFO - recall on REM: 0.961
[2024-01-06 18:56:51,959] {result_logger:112} INFO - F1-score on REM: 0.865
[2024-01-06 18:56:51,959] {result_logger:113} INFO - 
[2024-01-06 18:56:52,148] {result_logger:116} INFO - average precision on sleep stages: 0.910
[2024-01-06 18:56:52,337] {result_logger:118} INFO - average recall on sleep stages: 0.960
[2024-01-06 18:56:52,526] {result_logger:120} INFO - average F1-score on sleep stages: 0.932
[2024-01-06 18:56:53,038] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.960
[2024-01-06 18:56:53,064] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.960
[2024-01-06 18:56:53,068] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 18:56:53,226] {result_logger:108} INFO - precision on WAKE: 0.894
[2024-01-06 18:56:53,324] {result_logger:109} INFO - recall on WAKE: 0.636
[2024-01-06 18:56:53,423] {result_logger:112} INFO - F1-score on WAKE: 0.744
[2024-01-06 18:56:53,424] {result_logger:113} INFO - 
[2024-01-06 18:56:53,580] {result_logger:108} INFO - precision on NREM: 0.884
[2024-01-06 18:56:53,679] {result_logger:109} INFO - recall on NREM: 0.817
[2024-01-06 18:56:53,778] {result_logger:112} INFO - F1-score on NREM: 0.849
[2024-01-06 18:56:53,779] {result_logger:113} INFO - 
[2024-01-06 18:56:53,938] {result_logger:108} INFO - precision on REM: 0.197
[2024-01-06 18:56:54,035] {result_logger:109} INFO - recall on REM: 0.810
[2024-01-06 18:56:54,131] {result_logger:112} INFO - F1-score on REM: 0.317
[2024-01-06 18:56:54,131] {result_logger:113} INFO - 
[2024-01-06 18:56:54,149] {result_logger:116} INFO - average precision on sleep stages: 0.658
[2024-01-06 18:56:54,167] {result_logger:118} INFO - average recall on sleep stages: 0.754
[2024-01-06 18:56:54,185] {result_logger:120} INFO - average F1-score on sleep stages: 0.637
[2024-01-06 18:56:54,258] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.754
[2024-01-06 18:56:54,261] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.718
[2024-01-06 18:56:54,261] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 18:56:54,827] {result_logger:143} INFO - 
[[319839   9641   2567      8]
 [  3198 228526   7464      2]
 [   317   1197  37152      5]
 [  1915    237     36      0]]
[2024-01-06 18:56:55,393] {result_logger:150} INFO - 
[[ 96.32%   2.90%   0.77%   0.00%]
 [  1.34%  95.54%   3.12%   0.00%]
 [  0.82%   3.10%  96.07%   0.01%]
 [ 87.52%  10.83%   1.65%   0.00%]]
[2024-01-06 18:56:55,966] {result_logger:154} INFO - 
[[ 98.33%   4.02%   5.44%  53.33%]
 [  0.98%  95.38%  15.81%  13.33%]
 [  0.10%   0.50%  78.68%  33.33%]
 [  0.59%   0.10%   0.08%   0.00%]]
[2024-01-06 18:56:55,966] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 18:56:56,042] {result_logger:143} INFO - 
[[30749  2817 14753     0]
 [ 3576 28685  2844     0]
 [   60   957  4324     0]
 [   42    72   720     0]]
[2024-01-06 18:56:56,235] {result_logger:150} INFO - 
[[ 63.64%   5.83%  30.53%   0.00%]
 [ 10.19%  81.71%   8.10%   0.00%]
 [  1.12%  17.92%  80.96%   0.00%]
 [  5.04%   8.63%  86.33%   0.00%]]
[2024-01-06 18:56:56,421] {result_logger:154} INFO - 
[[ 89.32%   8.66%  65.16%    nan%]
 [ 10.39%  88.18%  12.56%    nan%]
 [  0.17%   2.94%  19.10%    nan%]
 [  0.12%   0.22%   3.18%    nan%]]
[2024-01-06 18:56:56,815] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 18:56:56,815] {result_logger:77} INFO - actual:
[2024-01-06 18:56:56,816] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 18:56:56,816] {result_logger:79} INFO - predicted:
[2024-01-06 18:56:56,816] {result_logger:80} INFO - 
[[93.37%  3.53%  3.09%  0.00%]
 [ 3.40% 92.64%  3.96%  0.00%]
 [ 5.18%  5.21% 89.61%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 18:56:56,852] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it3/model_8conv_2fc-best.pth
[2024-01-06 18:56:56,853] {run_experiment:113} INFO - [epoch  21] execution time: 206.06s	 avg f1-score: 0.6366

[2024-01-06 18:56:56,853] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 18:56:56,906] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 18:57:22,805] {train_model:86} INFO - Train Epoch: 22 [60928/612104 (10%)]	lr:8.19e-05	Loss: 0.097563
[2024-01-06 18:57:48,658] {train_model:86} INFO - Train Epoch: 22 [122112/612104 (20%)]	lr:8.19e-05	Loss: 0.202440
[2024-01-06 18:58:20,141] {train_model:86} INFO - Train Epoch: 22 [183296/612104 (30%)]	lr:8.19e-05	Loss: 0.049020
[2024-01-06 18:58:45,584] {train_model:86} INFO - Train Epoch: 22 [244480/612104 (40%)]	lr:8.19e-05	Loss: 0.056832
[2024-01-06 18:58:57,168] {train_model:86} INFO - Train Epoch: 22 [305664/612104 (50%)]	lr:8.19e-05	Loss: 0.098767
[2024-01-06 18:59:08,362] {train_model:86} INFO - Train Epoch: 22 [366848/612104 (60%)]	lr:8.19e-05	Loss: 0.101951
[2024-01-06 18:59:19,521] {train_model:86} INFO - Train Epoch: 22 [428032/612104 (70%)]	lr:8.19e-05	Loss: 0.132140
[2024-01-06 18:59:30,861] {train_model:86} INFO - Train Epoch: 22 [489216/612104 (80%)]	lr:8.19e-05	Loss: 0.148350
[2024-01-06 18:59:42,829] {train_model:86} INFO - Train Epoch: 22 [550400/612104 (90%)]	lr:8.19e-05	Loss: 0.193530
[2024-01-06 18:59:54,227] {train_model:86} INFO - Train Epoch: 22 [611584/612104 (100%)]	lr:8.19e-05	Loss: 0.087922
[2024-01-06 19:00:06,738] {run_experiment:78} INFO - 
[2024-01-06 19:00:06,744] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 19:00:08,000] {result_logger:108} INFO - precision on WAKE: 0.989
[2024-01-06 19:00:08,809] {result_logger:109} INFO - recall on WAKE: 0.963
[2024-01-06 19:00:09,668] {result_logger:112} INFO - F1-score on WAKE: 0.976
[2024-01-06 19:00:09,669] {result_logger:113} INFO - 
[2024-01-06 19:00:10,924] {result_logger:108} INFO - precision on NREM: 0.955
[2024-01-06 19:00:11,728] {result_logger:109} INFO - recall on NREM: 0.957
[2024-01-06 19:00:12,525] {result_logger:112} INFO - F1-score on NREM: 0.956
[2024-01-06 19:00:12,525] {result_logger:113} INFO - 
[2024-01-06 19:00:13,665] {result_logger:108} INFO - precision on REM: 0.792
[2024-01-06 19:00:14,379] {result_logger:109} INFO - recall on REM: 0.963
[2024-01-06 19:00:15,098] {result_logger:112} INFO - F1-score on REM: 0.869
[2024-01-06 19:00:15,098] {result_logger:113} INFO - 
[2024-01-06 19:00:15,288] {result_logger:116} INFO - average precision on sleep stages: 0.912
[2024-01-06 19:00:15,478] {result_logger:118} INFO - average recall on sleep stages: 0.961
[2024-01-06 19:00:15,668] {result_logger:120} INFO - average F1-score on sleep stages: 0.934
[2024-01-06 19:00:16,189] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.961
[2024-01-06 19:00:16,215] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.961
[2024-01-06 19:00:16,218] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 19:00:16,374] {result_logger:108} INFO - precision on WAKE: 0.929
[2024-01-06 19:00:16,469] {result_logger:109} INFO - recall on WAKE: 0.858
[2024-01-06 19:00:16,568] {result_logger:112} INFO - F1-score on WAKE: 0.892
[2024-01-06 19:00:16,568] {result_logger:113} INFO - 
[2024-01-06 19:00:16,730] {result_logger:108} INFO - precision on NREM: 0.915
[2024-01-06 19:00:16,829] {result_logger:109} INFO - recall on NREM: 0.843
[2024-01-06 19:00:16,927] {result_logger:112} INFO - F1-score on NREM: 0.878
[2024-01-06 19:00:16,927] {result_logger:113} INFO - 
[2024-01-06 19:00:17,081] {result_logger:108} INFO - precision on REM: 0.427
[2024-01-06 19:00:17,180] {result_logger:109} INFO - recall on REM: 0.942
[2024-01-06 19:00:17,281] {result_logger:112} INFO - F1-score on REM: 0.588
[2024-01-06 19:00:17,281] {result_logger:113} INFO - 
[2024-01-06 19:00:17,300] {result_logger:116} INFO - average precision on sleep stages: 0.757
[2024-01-06 19:00:17,319] {result_logger:118} INFO - average recall on sleep stages: 0.881
[2024-01-06 19:00:17,338] {result_logger:120} INFO - average F1-score on sleep stages: 0.786
[2024-01-06 19:00:17,412] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.881
[2024-01-06 19:00:17,415] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.857
[2024-01-06 19:00:17,415] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 19:00:17,997] {result_logger:143} INFO - 
[[319874   9628   2551      2]
 [  3114 228826   7247      3]
 [   305   1131  37232      3]
 [  1918    235     35      0]]
[2024-01-06 19:00:18,593] {result_logger:150} INFO - 
[[ 96.33%   2.90%   0.77%   0.00%]
 [  1.30%  95.67%   3.03%   0.00%]
 [  0.79%   2.92%  96.28%   0.01%]
 [ 87.66%  10.74%   1.60%   0.00%]]
[2024-01-06 19:00:19,187] {result_logger:154} INFO - 
[[ 98.36%   4.01%   5.42%  25.00%]
 [  0.96%  95.42%  15.40%  37.50%]
 [  0.09%   0.47%  79.11%  37.50%]
 [  0.59%   0.10%   0.07%   0.00%]]
[2024-01-06 19:00:19,187] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 19:00:19,267] {result_logger:143} INFO - 
[[41471  2564  4284     0]
 [ 3019 29611  2475     0]
 [  132   176  5033     0]
 [  344   219   271     0]]
[2024-01-06 19:00:19,464] {result_logger:150} INFO - 
[[ 85.83%   5.31%   8.87%   0.00%]
 [  8.60%  84.35%   7.05%   0.00%]
 [  2.47%   3.30%  94.23%   0.00%]
 [ 41.25%  26.26%  32.49%   0.00%]]
[2024-01-06 19:00:19,657] {result_logger:154} INFO - 
[[ 92.23%   7.87%  35.51%    nan%]
 [  6.71%  90.91%  20.52%    nan%]
 [  0.29%   0.54%  41.72%    nan%]
 [  0.77%   0.67%   2.25%    nan%]]
[2024-01-06 19:00:20,067] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 19:00:20,067] {result_logger:77} INFO - actual:
[2024-01-06 19:00:20,068] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 19:00:20,068] {result_logger:79} INFO - predicted:
[2024-01-06 19:00:20,068] {result_logger:80} INFO - 
[[93.70%  3.72%  2.59%  0.00%]
 [ 4.36% 91.85%  3.79%  0.00%]
 [11.71%  8.15% 80.14%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 19:00:20,102] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it3/model_8conv_2fc-best.pth
[2024-01-06 19:00:20,103] {run_experiment:113} INFO - [epoch  22] execution time: 203.25s	 avg f1-score: 0.7860

[2024-01-06 19:00:20,103] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 19:00:20,156] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 19:00:45,899] {train_model:86} INFO - Train Epoch: 23 [60928/612104 (10%)]	lr:7.71e-05	Loss: 0.089249
[2024-01-06 19:01:06,112] {train_model:86} INFO - Train Epoch: 23 [122112/612104 (20%)]	lr:7.71e-05	Loss: 0.074801
[2024-01-06 19:01:39,212] {train_model:86} INFO - Train Epoch: 23 [183296/612104 (30%)]	lr:7.71e-05	Loss: 0.043337
[2024-01-06 19:02:06,439] {train_model:86} INFO - Train Epoch: 23 [244480/612104 (40%)]	lr:7.71e-05	Loss: 0.072274
[2024-01-06 19:02:31,866] {train_model:86} INFO - Train Epoch: 23 [305664/612104 (50%)]	lr:7.71e-05	Loss: 0.104575
[2024-01-06 19:02:43,159] {train_model:86} INFO - Train Epoch: 23 [366848/612104 (60%)]	lr:7.71e-05	Loss: 0.061458
[2024-01-06 19:02:54,616] {train_model:86} INFO - Train Epoch: 23 [428032/612104 (70%)]	lr:7.71e-05	Loss: 0.115948
[2024-01-06 19:03:06,035] {train_model:86} INFO - Train Epoch: 23 [489216/612104 (80%)]	lr:7.71e-05	Loss: 0.070886
[2024-01-06 19:03:17,177] {train_model:86} INFO - Train Epoch: 23 [550400/612104 (90%)]	lr:7.71e-05	Loss: 0.096390
[2024-01-06 19:03:28,651] {train_model:86} INFO - Train Epoch: 23 [611584/612104 (100%)]	lr:7.71e-05	Loss: 0.079246
[2024-01-06 19:03:40,926] {run_experiment:78} INFO - 
[2024-01-06 19:03:40,932] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 19:03:42,156] {result_logger:108} INFO - precision on WAKE: 0.989
[2024-01-06 19:03:42,970] {result_logger:109} INFO - recall on WAKE: 0.963
[2024-01-06 19:03:43,790] {result_logger:112} INFO - F1-score on WAKE: 0.976
[2024-01-06 19:03:43,790] {result_logger:113} INFO - 
[2024-01-06 19:03:45,024] {result_logger:108} INFO - precision on NREM: 0.955
[2024-01-06 19:03:45,844] {result_logger:109} INFO - recall on NREM: 0.956
[2024-01-06 19:03:46,656] {result_logger:112} INFO - F1-score on NREM: 0.956
[2024-01-06 19:03:46,656] {result_logger:113} INFO - 
[2024-01-06 19:03:47,776] {result_logger:108} INFO - precision on REM: 0.793
[2024-01-06 19:03:48,484] {result_logger:109} INFO - recall on REM: 0.962
[2024-01-06 19:03:49,195] {result_logger:112} INFO - F1-score on REM: 0.869
[2024-01-06 19:03:49,195] {result_logger:113} INFO - 
[2024-01-06 19:03:49,387] {result_logger:116} INFO - average precision on sleep stages: 0.912
[2024-01-06 19:03:49,577] {result_logger:118} INFO - average recall on sleep stages: 0.961
[2024-01-06 19:03:49,768] {result_logger:120} INFO - average F1-score on sleep stages: 0.934
[2024-01-06 19:03:50,282] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.961
[2024-01-06 19:03:50,308] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.961
[2024-01-06 19:03:50,311] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 19:03:50,469] {result_logger:108} INFO - precision on WAKE: 0.896
[2024-01-06 19:03:50,568] {result_logger:109} INFO - recall on WAKE: 0.804
[2024-01-06 19:03:50,667] {result_logger:112} INFO - F1-score on WAKE: 0.847
[2024-01-06 19:03:50,667] {result_logger:113} INFO - 
[2024-01-06 19:03:50,826] {result_logger:108} INFO - precision on NREM: 0.937
[2024-01-06 19:03:50,926] {result_logger:109} INFO - recall on NREM: 0.785
[2024-01-06 19:03:51,024] {result_logger:112} INFO - F1-score on NREM: 0.854
[2024-01-06 19:03:51,024] {result_logger:113} INFO - 
[2024-01-06 19:03:51,186] {result_logger:108} INFO - precision on REM: 0.315
[2024-01-06 19:03:51,285] {result_logger:109} INFO - recall on REM: 0.942
[2024-01-06 19:03:51,384] {result_logger:112} INFO - F1-score on REM: 0.472
[2024-01-06 19:03:51,384] {result_logger:113} INFO - 
[2024-01-06 19:03:51,403] {result_logger:116} INFO - average precision on sleep stages: 0.716
[2024-01-06 19:03:51,422] {result_logger:118} INFO - average recall on sleep stages: 0.844
[2024-01-06 19:03:51,441] {result_logger:120} INFO - average F1-score on sleep stages: 0.724
[2024-01-06 19:03:51,515] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.844
[2024-01-06 19:03:51,518] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.805
[2024-01-06 19:03:51,518] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 19:03:52,083] {result_logger:143} INFO - 
[[319922   9632   2495      6]
 [  3219 228749   7219      3]
 [   318   1145  37206      2]
 [  1915    239     34      0]]
[2024-01-06 19:03:52,655] {result_logger:150} INFO - 
[[ 96.35%   2.90%   0.75%   0.00%]
 [  1.35%  95.63%   3.02%   0.00%]
 [  0.82%   2.96%  96.21%   0.01%]
 [ 87.52%  10.92%   1.55%   0.00%]]
[2024-01-06 19:03:53,230] {result_logger:154} INFO - 
[[ 98.32%   4.02%   5.31%  54.55%]
 [  0.99%  95.41%  15.37%  27.27%]
 [  0.10%   0.48%  79.24%  18.18%]
 [  0.59%   0.10%   0.07%   0.00%]]
[2024-01-06 19:03:53,231] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 19:03:53,305] {result_logger:143} INFO - 
[[38827  1668  7824     0]
 [ 4404 27569  3132     0]
 [  117   194  5030     0]
 [  240    97   497     0]]
[2024-01-06 19:03:53,501] {result_logger:150} INFO - 
[[ 80.36%   3.45%  16.19%   0.00%]
 [ 12.55%  78.53%   8.92%   0.00%]
 [  2.19%   3.63%  94.18%   0.00%]
 [ 28.78%  11.63%  59.59%   0.00%]]
[2024-01-06 19:03:53,695] {result_logger:154} INFO - 
[[ 89.08%   5.65%  47.47%    nan%]
 [ 10.10%  93.37%  19.00%    nan%]
 [  0.27%   0.66%  30.52%    nan%]
 [  0.55%   0.33%   3.02%    nan%]]
[2024-01-06 19:03:54,103] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 19:03:54,103] {result_logger:77} INFO - actual:
[2024-01-06 19:03:54,103] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 19:03:54,103] {result_logger:79} INFO - predicted:
[2024-01-06 19:03:54,104] {result_logger:80} INFO - 
[[93.29%  3.19%  3.53%  0.00%]
 [ 4.10% 91.73%  4.17%  0.00%]
 [10.40%  6.40% 83.20%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 19:03:54,140] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it3/model_8conv_2fc-best.pth
[2024-01-06 19:03:54,140] {run_experiment:113} INFO - [epoch  23] execution time: 214.04s	 avg f1-score: 0.7244

[2024-01-06 19:03:54,140] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 19:03:54,194] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 19:04:20,496] {train_model:86} INFO - Train Epoch: 24 [60928/612104 (10%)]	lr:7.26e-05	Loss: 0.130466
[2024-01-06 19:04:31,857] {train_model:86} INFO - Train Epoch: 24 [122112/612104 (20%)]	lr:7.26e-05	Loss: 0.091823
[2024-01-06 19:04:59,205] {train_model:86} INFO - Train Epoch: 24 [183296/612104 (30%)]	lr:7.26e-05	Loss: 0.099704
[2024-01-06 19:05:27,280] {train_model:86} INFO - Train Epoch: 24 [244480/612104 (40%)]	lr:7.26e-05	Loss: 0.075878
[2024-01-06 19:05:52,122] {train_model:86} INFO - Train Epoch: 24 [305664/612104 (50%)]	lr:7.26e-05	Loss: 0.071980
[2024-01-06 19:06:17,997] {train_model:86} INFO - Train Epoch: 24 [366848/612104 (60%)]	lr:7.26e-05	Loss: 0.069095
[2024-01-06 19:06:29,206] {train_model:86} INFO - Train Epoch: 24 [428032/612104 (70%)]	lr:7.26e-05	Loss: 0.071910
[2024-01-06 19:06:40,549] {train_model:86} INFO - Train Epoch: 24 [489216/612104 (80%)]	lr:7.26e-05	Loss: 0.133896
[2024-01-06 19:06:52,039] {train_model:86} INFO - Train Epoch: 24 [550400/612104 (90%)]	lr:7.26e-05	Loss: 0.222706
[2024-01-06 19:07:03,460] {train_model:86} INFO - Train Epoch: 24 [611584/612104 (100%)]	lr:7.26e-05	Loss: 0.039439
[2024-01-06 19:07:16,255] {run_experiment:78} INFO - 
[2024-01-06 19:07:16,263] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 19:07:17,534] {result_logger:108} INFO - precision on WAKE: 0.989
[2024-01-06 19:07:18,362] {result_logger:109} INFO - recall on WAKE: 0.964
[2024-01-06 19:07:19,193] {result_logger:112} INFO - F1-score on WAKE: 0.976
[2024-01-06 19:07:19,193] {result_logger:113} INFO - 
[2024-01-06 19:07:20,420] {result_logger:108} INFO - precision on NREM: 0.956
[2024-01-06 19:07:21,223] {result_logger:109} INFO - recall on NREM: 0.957
[2024-01-06 19:07:22,028] {result_logger:112} INFO - F1-score on NREM: 0.956
[2024-01-06 19:07:22,028] {result_logger:113} INFO - 
[2024-01-06 19:07:23,174] {result_logger:108} INFO - precision on REM: 0.795
[2024-01-06 19:07:23,890] {result_logger:109} INFO - recall on REM: 0.963
[2024-01-06 19:07:24,602] {result_logger:112} INFO - F1-score on REM: 0.871
[2024-01-06 19:07:24,602] {result_logger:113} INFO - 
[2024-01-06 19:07:24,793] {result_logger:116} INFO - average precision on sleep stages: 0.913
[2024-01-06 19:07:24,980] {result_logger:118} INFO - average recall on sleep stages: 0.961
[2024-01-06 19:07:25,168] {result_logger:120} INFO - average F1-score on sleep stages: 0.935
[2024-01-06 19:07:25,685] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.961
[2024-01-06 19:07:25,712] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.961
[2024-01-06 19:07:25,717] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 19:07:25,874] {result_logger:108} INFO - precision on WAKE: 0.939
[2024-01-06 19:07:25,973] {result_logger:109} INFO - recall on WAKE: 0.729
[2024-01-06 19:07:26,069] {result_logger:112} INFO - F1-score on WAKE: 0.820
[2024-01-06 19:07:26,069] {result_logger:113} INFO - 
[2024-01-06 19:07:26,229] {result_logger:108} INFO - precision on NREM: 0.918
[2024-01-06 19:07:26,324] {result_logger:109} INFO - recall on NREM: 0.861
[2024-01-06 19:07:26,421] {result_logger:112} INFO - F1-score on NREM: 0.888
[2024-01-06 19:07:26,421] {result_logger:113} INFO - 
[2024-01-06 19:07:26,581] {result_logger:108} INFO - precision on REM: 0.280
[2024-01-06 19:07:26,678] {result_logger:109} INFO - recall on REM: 0.959
[2024-01-06 19:07:26,775] {result_logger:112} INFO - F1-score on REM: 0.433
[2024-01-06 19:07:26,775] {result_logger:113} INFO - 
[2024-01-06 19:07:26,793] {result_logger:116} INFO - average precision on sleep stages: 0.712
[2024-01-06 19:07:26,811] {result_logger:118} INFO - average recall on sleep stages: 0.850
[2024-01-06 19:07:26,829] {result_logger:120} INFO - average F1-score on sleep stages: 0.714
[2024-01-06 19:07:26,898] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.850
[2024-01-06 19:07:26,901] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.795
[2024-01-06 19:07:26,901] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 19:07:27,465] {result_logger:143} INFO - 
[[320040   9539   2470      6]
 [  3212 228857   7120      1]
 [   306   1109  37256      0]
 [  1912    241     35      0]]
[2024-01-06 19:07:28,032] {result_logger:150} INFO - 
[[ 96.38%   2.87%   0.74%   0.00%]
 [  1.34%  95.68%   2.98%   0.00%]
 [  0.79%   2.87%  96.34%   0.00%]
 [ 87.39%  11.01%   1.60%   0.00%]]
[2024-01-06 19:07:28,591] {result_logger:154} INFO - 
[[ 98.33%   3.98%   5.27%  85.71%]
 [  0.99%  95.46%  15.19%  14.29%]
 [  0.09%   0.46%  79.47%   0.00%]
 [  0.59%   0.10%   0.07%   0.00%]]
[2024-01-06 19:07:28,592] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 19:07:28,667] {result_logger:143} INFO - 
[[35205  2520 10594     0]
 [ 2272 30231  2602     0]
 [   21   196  5124     0]
 [  127   159   548     0]]
[2024-01-06 19:07:28,855] {result_logger:150} INFO - 
[[ 72.86%   5.22%  21.93%   0.00%]
 [  6.47%  86.12%   7.41%   0.00%]
 [  0.39%   3.67%  95.94%   0.00%]
 [ 15.23%  19.06%  65.71%   0.00%]]
[2024-01-06 19:07:29,145] {result_logger:154} INFO - 
[[ 93.57%   7.61%  56.15%    nan%]
 [  6.04%  91.32%  13.79%    nan%]
 [  0.06%   0.59%  27.16%    nan%]
 [  0.34%   0.48%   2.90%    nan%]]
[2024-01-06 19:07:29,548] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 19:07:29,549] {result_logger:77} INFO - actual:
[2024-01-06 19:07:29,549] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 19:07:29,549] {result_logger:79} INFO - predicted:
[2024-01-06 19:07:29,549] {result_logger:80} INFO - 
[[94.00%  3.54%  2.45%  0.00%]
 [ 3.42% 92.58%  3.99%  0.00%]
 [ 5.95%  5.95% 88.10%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 19:07:29,583] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it3/model_8conv_2fc-best.pth
[2024-01-06 19:07:29,583] {run_experiment:113} INFO - [epoch  24] execution time: 215.44s	 avg f1-score: 0.7140

[2024-01-06 19:07:29,584] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 19:07:29,638] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 19:07:56,203] {train_model:86} INFO - Train Epoch: 25 [60928/612104 (10%)]	lr:6.84e-05	Loss: 0.102928
[2024-01-06 19:08:08,059] {train_model:86} INFO - Train Epoch: 25 [122112/612104 (20%)]	lr:6.84e-05	Loss: 0.548678
[2024-01-06 19:08:35,234] {train_model:86} INFO - Train Epoch: 25 [183296/612104 (30%)]	lr:6.84e-05	Loss: 0.090415
[2024-01-06 19:09:00,842] {train_model:86} INFO - Train Epoch: 25 [244480/612104 (40%)]	lr:6.84e-05	Loss: 0.085954
[2024-01-06 19:09:15,104] {train_model:86} INFO - Train Epoch: 25 [305664/612104 (50%)]	lr:6.84e-05	Loss: 0.109995
[2024-01-06 19:09:39,704] {train_model:86} INFO - Train Epoch: 25 [366848/612104 (60%)]	lr:6.84e-05	Loss: 0.085459
[2024-01-06 19:10:04,562] {train_model:86} INFO - Train Epoch: 25 [428032/612104 (70%)]	lr:6.84e-05	Loss: 0.082485
[2024-01-06 19:10:15,963] {train_model:86} INFO - Train Epoch: 25 [489216/612104 (80%)]	lr:6.84e-05	Loss: 0.098896
[2024-01-06 19:10:27,441] {train_model:86} INFO - Train Epoch: 25 [550400/612104 (90%)]	lr:6.84e-05	Loss: 0.060866
[2024-01-06 19:10:39,005] {train_model:86} INFO - Train Epoch: 25 [611584/612104 (100%)]	lr:6.84e-05	Loss: 0.140540
[2024-01-06 19:10:51,392] {run_experiment:78} INFO - 
[2024-01-06 19:10:51,398] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 19:10:52,635] {result_logger:108} INFO - precision on WAKE: 0.989
[2024-01-06 19:10:53,432] {result_logger:109} INFO - recall on WAKE: 0.965
[2024-01-06 19:10:54,254] {result_logger:112} INFO - F1-score on WAKE: 0.977
[2024-01-06 19:10:54,254] {result_logger:113} INFO - 
[2024-01-06 19:10:55,472] {result_logger:108} INFO - precision on NREM: 0.956
[2024-01-06 19:10:56,302] {result_logger:109} INFO - recall on NREM: 0.959
[2024-01-06 19:10:57,162] {result_logger:112} INFO - F1-score on NREM: 0.957
[2024-01-06 19:10:57,162] {result_logger:113} INFO - 
[2024-01-06 19:10:58,293] {result_logger:108} INFO - precision on REM: 0.806
[2024-01-06 19:10:59,003] {result_logger:109} INFO - recall on REM: 0.964
[2024-01-06 19:10:59,715] {result_logger:112} INFO - F1-score on REM: 0.878
[2024-01-06 19:10:59,715] {result_logger:113} INFO - 
[2024-01-06 19:10:59,890] {result_logger:116} INFO - average precision on sleep stages: 0.917
[2024-01-06 19:11:00,073] {result_logger:118} INFO - average recall on sleep stages: 0.962
[2024-01-06 19:11:00,258] {result_logger:120} INFO - average F1-score on sleep stages: 0.937
[2024-01-06 19:11:00,756] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.962
[2024-01-06 19:11:00,781] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.962
[2024-01-06 19:11:00,787] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 19:11:00,938] {result_logger:108} INFO - precision on WAKE: 0.904
[2024-01-06 19:11:01,034] {result_logger:109} INFO - recall on WAKE: 0.955
[2024-01-06 19:11:01,134] {result_logger:112} INFO - F1-score on WAKE: 0.929
[2024-01-06 19:11:01,134] {result_logger:113} INFO - 
[2024-01-06 19:11:01,293] {result_logger:108} INFO - precision on NREM: 0.928
[2024-01-06 19:11:01,392] {result_logger:109} INFO - recall on NREM: 0.817
[2024-01-06 19:11:01,490] {result_logger:112} INFO - F1-score on NREM: 0.869
[2024-01-06 19:11:01,490] {result_logger:113} INFO - 
[2024-01-06 19:11:01,648] {result_logger:108} INFO - precision on REM: 0.673
[2024-01-06 19:11:01,746] {result_logger:109} INFO - recall on REM: 0.856
[2024-01-06 19:11:01,844] {result_logger:112} INFO - F1-score on REM: 0.753
[2024-01-06 19:11:01,845] {result_logger:113} INFO - 
[2024-01-06 19:11:01,863] {result_logger:116} INFO - average precision on sleep stages: 0.835
[2024-01-06 19:11:01,881] {result_logger:118} INFO - average recall on sleep stages: 0.876
[2024-01-06 19:11:01,899] {result_logger:120} INFO - average F1-score on sleep stages: 0.850
[2024-01-06 19:11:01,971] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.876
[2024-01-06 19:11:01,974] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.895
[2024-01-06 19:11:01,974] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 19:11:02,533] {result_logger:143} INFO - 
[[320329   9471   2254      1]
 [  3153 229328   6706      3]
 [   291   1102  37277      1]
 [  1909    245     34      0]]
[2024-01-06 19:11:03,092] {result_logger:150} INFO - 
[[ 96.47%   2.85%   0.68%   0.00%]
 [  1.32%  95.88%   2.80%   0.00%]
 [  0.75%   2.85%  96.40%   0.00%]
 [ 87.25%  11.20%   1.55%   0.00%]]
[2024-01-06 19:11:03,643] {result_logger:154} INFO - 
[[ 98.36%   3.94%   4.87%  20.00%]
 [  0.97%  95.50%  14.49%  60.00%]
 [  0.09%   0.46%  80.56%  20.00%]
 [  0.59%   0.10%   0.07%   0.00%]]
[2024-01-06 19:11:03,643] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 19:11:03,716] {result_logger:143} INFO - 
[[46151  1946   222     0]
 [ 4419 28682  2004     0]
 [  483   284  4574     0]
 [  621   200    13     0]]
[2024-01-06 19:11:03,907] {result_logger:150} INFO - 
[[ 95.51%   4.03%   0.46%   0.00%]
 [ 12.59%  81.70%   5.71%   0.00%]
 [  9.04%   5.32%  85.64%   0.00%]
 [ 74.46%  23.98%   1.56%   0.00%]]
[2024-01-06 19:11:04,097] {result_logger:154} INFO - 
[[ 89.31%   6.25%   3.26%    nan%]
 [  8.55%  92.19%  29.41%    nan%]
 [  0.93%   0.91%  67.14%    nan%]
 [  1.20%   0.64%   0.19%    nan%]]
[2024-01-06 19:11:04,506] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 19:11:04,506] {result_logger:77} INFO - actual:
[2024-01-06 19:11:04,506] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 19:11:04,506] {result_logger:79} INFO - predicted:
[2024-01-06 19:11:04,506] {result_logger:80} INFO - 
[[95.66%  3.78%  0.56%  0.00%]
 [ 5.40% 92.27%  2.33%  0.00%]
 [ 8.22%  6.66% 85.12%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 19:11:04,541] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it3/model_8conv_2fc-best.pth
[2024-01-06 19:11:04,541] {run_experiment:113} INFO - [epoch  25] execution time: 214.96s	 avg f1-score: 0.8504

[2024-01-06 19:11:04,541] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 19:11:04,596] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 19:11:30,432] {train_model:86} INFO - Train Epoch: 26 [60928/612104 (10%)]	lr:6.44e-05	Loss: 0.075362
[2024-01-06 19:11:42,315] {train_model:86} INFO - Train Epoch: 26 [122112/612104 (20%)]	lr:6.44e-05	Loss: 0.141282
[2024-01-06 19:12:10,030] {train_model:86} INFO - Train Epoch: 26 [183296/612104 (30%)]	lr:6.44e-05	Loss: 0.031621
[2024-01-06 19:12:35,553] {train_model:86} INFO - Train Epoch: 26 [244480/612104 (40%)]	lr:6.44e-05	Loss: 0.075400
[2024-01-06 19:12:47,374] {train_model:86} INFO - Train Epoch: 26 [305664/612104 (50%)]	lr:6.44e-05	Loss: 0.088121
[2024-01-06 19:13:14,552] {train_model:86} INFO - Train Epoch: 26 [366848/612104 (60%)]	lr:6.44e-05	Loss: 0.075478
[2024-01-06 19:13:40,019] {train_model:86} INFO - Train Epoch: 26 [428032/612104 (70%)]	lr:6.44e-05	Loss: 0.157857
[2024-01-06 19:13:51,511] {train_model:86} INFO - Train Epoch: 26 [489216/612104 (80%)]	lr:6.44e-05	Loss: 0.099101
[2024-01-06 19:14:02,918] {train_model:86} INFO - Train Epoch: 26 [550400/612104 (90%)]	lr:6.44e-05	Loss: 0.069033
[2024-01-06 19:14:14,285] {train_model:86} INFO - Train Epoch: 26 [611584/612104 (100%)]	lr:6.44e-05	Loss: 0.079313
[2024-01-06 19:14:26,783] {run_experiment:78} INFO - 
[2024-01-06 19:14:26,790] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 19:14:28,060] {result_logger:108} INFO - precision on WAKE: 0.990
[2024-01-06 19:14:28,888] {result_logger:109} INFO - recall on WAKE: 0.964
[2024-01-06 19:14:29,723] {result_logger:112} INFO - F1-score on WAKE: 0.977
[2024-01-06 19:14:29,723] {result_logger:113} INFO - 
[2024-01-06 19:14:30,970] {result_logger:108} INFO - precision on NREM: 0.955
[2024-01-06 19:14:31,775] {result_logger:109} INFO - recall on NREM: 0.959
[2024-01-06 19:14:32,587] {result_logger:112} INFO - F1-score on NREM: 0.957
[2024-01-06 19:14:32,587] {result_logger:113} INFO - 
[2024-01-06 19:14:33,740] {result_logger:108} INFO - precision on REM: 0.807
[2024-01-06 19:14:34,466] {result_logger:109} INFO - recall on REM: 0.964
[2024-01-06 19:14:35,189] {result_logger:112} INFO - F1-score on REM: 0.879
[2024-01-06 19:14:35,189] {result_logger:113} INFO - 
[2024-01-06 19:14:35,382] {result_logger:116} INFO - average precision on sleep stages: 0.917
[2024-01-06 19:14:35,579] {result_logger:118} INFO - average recall on sleep stages: 0.962
[2024-01-06 19:14:35,780] {result_logger:120} INFO - average F1-score on sleep stages: 0.938
[2024-01-06 19:14:36,302] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.962
[2024-01-06 19:14:36,328] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.962
[2024-01-06 19:14:36,332] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 19:14:36,495] {result_logger:108} INFO - precision on WAKE: 0.897
[2024-01-06 19:14:36,594] {result_logger:109} INFO - recall on WAKE: 0.731
[2024-01-06 19:14:36,695] {result_logger:112} INFO - F1-score on WAKE: 0.805
[2024-01-06 19:14:36,696] {result_logger:113} INFO - 
[2024-01-06 19:14:36,863] {result_logger:108} INFO - precision on NREM: 0.918
[2024-01-06 19:14:36,964] {result_logger:109} INFO - recall on NREM: 0.822
[2024-01-06 19:14:37,063] {result_logger:112} INFO - F1-score on NREM: 0.868
[2024-01-06 19:14:37,063] {result_logger:113} INFO - 
[2024-01-06 19:14:37,229] {result_logger:108} INFO - precision on REM: 0.267
[2024-01-06 19:14:37,328] {result_logger:109} INFO - recall on REM: 0.898
[2024-01-06 19:14:37,428] {result_logger:112} INFO - F1-score on REM: 0.412
[2024-01-06 19:14:37,428] {result_logger:113} INFO - 
[2024-01-06 19:14:37,446] {result_logger:116} INFO - average precision on sleep stages: 0.694
[2024-01-06 19:14:37,465] {result_logger:118} INFO - average recall on sleep stages: 0.817
[2024-01-06 19:14:37,484] {result_logger:120} INFO - average F1-score on sleep stages: 0.695
[2024-01-06 19:14:37,557] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.817
[2024-01-06 19:14:37,560] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.777
[2024-01-06 19:14:37,561] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 19:14:38,131] {result_logger:143} INFO - 
[[320194   9629   2228      4]
 [  3084 229429   6674      3]
 [   309   1091  37269      2]
 [  1919    241     28      0]]
[2024-01-06 19:14:38,707] {result_logger:150} INFO - 
[[ 96.43%   2.90%   0.67%   0.00%]
 [  1.29%  95.92%   2.79%   0.00%]
 [  0.80%   2.82%  96.37%   0.01%]
 [ 87.71%  11.01%   1.28%   0.00%]]
[2024-01-06 19:14:39,272] {result_logger:154} INFO - 
[[ 98.37%   4.01%   4.82%  44.44%]
 [  0.95%  95.44%  14.45%  33.33%]
 [  0.09%   0.45%  80.67%  22.22%]
 [  0.59%   0.10%   0.06%   0.00%]]
[2024-01-06 19:14:39,272] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 19:14:39,348] {result_logger:143} INFO - 
[[35311  2138 10870     0]
 [ 3973 28871  2261     0]
 [  102   445  4794     0]
 [  143   102   589     0]]
[2024-01-06 19:14:39,542] {result_logger:150} INFO - 
[[ 73.08%   4.42%  22.50%   0.00%]
 [ 11.32%  82.24%   6.44%   0.00%]
 [  1.91%   8.33%  89.76%   0.00%]
 [ 17.15%  12.23%  70.62%   0.00%]]
[2024-01-06 19:14:39,734] {result_logger:154} INFO - 
[[ 89.33%   6.78%  58.71%    nan%]
 [ 10.05%  91.49%  12.21%    nan%]
 [  0.26%   1.41%  25.89%    nan%]
 [  0.36%   0.32%   3.18%    nan%]]
[2024-01-06 19:14:40,142] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 19:14:40,142] {result_logger:77} INFO - actual:
[2024-01-06 19:14:40,142] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 19:14:40,142] {result_logger:79} INFO - predicted:
[2024-01-06 19:14:40,142] {result_logger:80} INFO - 
[[93.68%  3.64%  2.68%  0.00%]
 [ 4.08% 92.48%  3.44%  0.00%]
 [ 6.52%  5.06% 88.42%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 19:14:40,177] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it3/model_8conv_2fc-best.pth
[2024-01-06 19:14:40,177] {run_experiment:113} INFO - [epoch  26] execution time: 215.64s	 avg f1-score: 0.6950

[2024-01-06 19:14:40,177] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 19:14:40,236] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 19:15:06,135] {train_model:86} INFO - Train Epoch: 27 [60928/612104 (10%)]	lr:6.07e-05	Loss: 0.058700
[2024-01-06 19:15:18,503] {train_model:86} INFO - Train Epoch: 27 [122112/612104 (20%)]	lr:6.07e-05	Loss: 0.087282
[2024-01-06 19:15:30,314] {train_model:86} INFO - Train Epoch: 27 [183296/612104 (30%)]	lr:6.07e-05	Loss: 0.079548
[2024-01-06 19:15:57,494] {train_model:86} INFO - Train Epoch: 27 [244480/612104 (40%)]	lr:6.07e-05	Loss: 0.046399
[2024-01-06 19:16:22,778] {train_model:86} INFO - Train Epoch: 27 [305664/612104 (50%)]	lr:6.07e-05	Loss: 0.173661
[2024-01-06 19:16:34,118] {train_model:86} INFO - Train Epoch: 27 [366848/612104 (60%)]	lr:6.07e-05	Loss: 0.135173
[2024-01-06 19:17:01,038] {train_model:86} INFO - Train Epoch: 27 [428032/612104 (70%)]	lr:6.07e-05	Loss: 0.048490
[2024-01-06 19:17:26,719] {train_model:86} INFO - Train Epoch: 27 [489216/612104 (80%)]	lr:6.07e-05	Loss: 0.088899
[2024-01-06 19:17:38,314] {train_model:86} INFO - Train Epoch: 27 [550400/612104 (90%)]	lr:6.07e-05	Loss: 0.099170
[2024-01-06 19:17:50,008] {train_model:86} INFO - Train Epoch: 27 [611584/612104 (100%)]	lr:6.07e-05	Loss: 0.087534
[2024-01-06 19:18:02,621] {run_experiment:78} INFO - 
[2024-01-06 19:18:02,629] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 19:18:03,856] {result_logger:108} INFO - precision on WAKE: 0.989
[2024-01-06 19:18:04,663] {result_logger:109} INFO - recall on WAKE: 0.965
[2024-01-06 19:18:05,480] {result_logger:112} INFO - F1-score on WAKE: 0.977
[2024-01-06 19:18:05,481] {result_logger:113} INFO - 
[2024-01-06 19:18:06,705] {result_logger:108} INFO - precision on NREM: 0.956
[2024-01-06 19:18:07,489] {result_logger:109} INFO - recall on NREM: 0.960
[2024-01-06 19:18:08,280] {result_logger:112} INFO - F1-score on NREM: 0.958
[2024-01-06 19:18:08,280] {result_logger:113} INFO - 
[2024-01-06 19:18:09,420] {result_logger:108} INFO - precision on REM: 0.813
[2024-01-06 19:18:10,114] {result_logger:109} INFO - recall on REM: 0.966
[2024-01-06 19:18:10,814] {result_logger:112} INFO - F1-score on REM: 0.883
[2024-01-06 19:18:10,815] {result_logger:113} INFO - 
[2024-01-06 19:18:11,000] {result_logger:116} INFO - average precision on sleep stages: 0.920
[2024-01-06 19:18:11,182] {result_logger:118} INFO - average recall on sleep stages: 0.964
[2024-01-06 19:18:11,363] {result_logger:120} INFO - average F1-score on sleep stages: 0.939
[2024-01-06 19:18:11,879] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.964
[2024-01-06 19:18:11,905] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.963
[2024-01-06 19:18:11,909] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 19:18:12,065] {result_logger:108} INFO - precision on WAKE: 0.915
[2024-01-06 19:18:12,163] {result_logger:109} INFO - recall on WAKE: 0.920
[2024-01-06 19:18:12,261] {result_logger:112} INFO - F1-score on WAKE: 0.917
[2024-01-06 19:18:12,261] {result_logger:113} INFO - 
[2024-01-06 19:18:12,413] {result_logger:108} INFO - precision on NREM: 0.933
[2024-01-06 19:18:12,511] {result_logger:109} INFO - recall on NREM: 0.840
[2024-01-06 19:18:12,608] {result_logger:112} INFO - F1-score on NREM: 0.884
[2024-01-06 19:18:12,608] {result_logger:113} INFO - 
[2024-01-06 19:18:12,764] {result_logger:108} INFO - precision on REM: 0.572
[2024-01-06 19:18:12,857] {result_logger:109} INFO - recall on REM: 0.922
[2024-01-06 19:18:12,951] {result_logger:112} INFO - F1-score on REM: 0.706
[2024-01-06 19:18:12,952] {result_logger:113} INFO - 
[2024-01-06 19:18:12,970] {result_logger:116} INFO - average precision on sleep stages: 0.807
[2024-01-06 19:18:12,988] {result_logger:118} INFO - average recall on sleep stages: 0.894
[2024-01-06 19:18:13,006] {result_logger:120} INFO - average F1-score on sleep stages: 0.836
[2024-01-06 19:18:13,074] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.894
[2024-01-06 19:18:13,077] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.888
[2024-01-06 19:18:13,077] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 19:18:13,643] {result_logger:143} INFO - 
[[320473   9441   2138      3]
 [  3140 229584   6464      2]
 [   295   1032  37342      2]
 [  1916    239     33      0]]
[2024-01-06 19:18:14,211] {result_logger:150} INFO - 
[[ 96.51%   2.84%   0.64%   0.00%]
 [  1.31%  95.98%   2.70%   0.00%]
 [  0.76%   2.67%  96.56%   0.01%]
 [ 87.57%  10.92%   1.51%   0.00%]]
[2024-01-06 19:18:14,773] {result_logger:154} INFO - 
[[ 98.36%   3.93%   4.65%  42.86%]
 [  0.96%  95.54%  14.06%  28.57%]
 [  0.09%   0.43%  81.22%  28.57%]
 [  0.59%   0.10%   0.07%   0.00%]]
[2024-01-06 19:18:14,773] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 19:18:14,848] {result_logger:143} INFO - 
[[44434  1979  1906     0]
 [ 3839 29482  1784     0]
 [  274   144  4923     0]
 [  539   141   154     0]]
[2024-01-06 19:18:15,040] {result_logger:150} INFO - 
[[ 91.96%   4.10%   3.94%   0.00%]
 [ 10.94%  83.98%   5.08%   0.00%]
 [  5.13%   2.70%  92.17%   0.00%]
 [ 64.63%  16.91%  18.47%   0.00%]]
[2024-01-06 19:18:15,227] {result_logger:154} INFO - 
[[ 90.52%   6.23%  21.74%    nan%]
 [  7.82%  92.87%  20.35%    nan%]
 [  0.56%   0.45%  56.15%    nan%]
 [  1.10%   0.44%   1.76%    nan%]]
[2024-01-06 19:18:15,624] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 19:18:15,625] {result_logger:77} INFO - actual:
[2024-01-06 19:18:15,625] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 19:18:15,625] {result_logger:79} INFO - predicted:
[2024-01-06 19:18:15,625] {result_logger:80} INFO - 
[[94.63%  3.63%  1.74%  0.00%]
 [ 4.90% 92.74%  2.36%  0.00%]
 [12.32%  5.99% 81.69%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 19:18:15,660] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it3/model_8conv_2fc-best.pth
[2024-01-06 19:18:15,661] {run_experiment:113} INFO - [epoch  27] execution time: 215.48s	 avg f1-score: 0.8356

[2024-01-06 19:18:15,661] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 19:18:15,714] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 19:18:41,523] {train_model:86} INFO - Train Epoch: 28 [60928/612104 (10%)]	lr:5.71e-05	Loss: 0.095298
[2024-01-06 19:18:52,682] {train_model:86} INFO - Train Epoch: 28 [122112/612104 (20%)]	lr:5.71e-05	Loss: 0.060008
[2024-01-06 19:19:03,967] {train_model:86} INFO - Train Epoch: 28 [183296/612104 (30%)]	lr:5.71e-05	Loss: 0.172548
[2024-01-06 19:19:30,999] {train_model:86} INFO - Train Epoch: 28 [244480/612104 (40%)]	lr:5.71e-05	Loss: 0.028863
[2024-01-06 19:19:56,649] {train_model:86} INFO - Train Epoch: 28 [305664/612104 (50%)]	lr:5.71e-05	Loss: 0.037774
[2024-01-06 19:20:08,194] {train_model:86} INFO - Train Epoch: 28 [366848/612104 (60%)]	lr:5.71e-05	Loss: 0.055491
[2024-01-06 19:20:19,727] {train_model:86} INFO - Train Epoch: 28 [428032/612104 (70%)]	lr:5.71e-05	Loss: 0.088299
[2024-01-06 19:20:46,916] {train_model:86} INFO - Train Epoch: 28 [489216/612104 (80%)]	lr:5.71e-05	Loss: 0.061478
[2024-01-06 19:21:12,503] {train_model:86} INFO - Train Epoch: 28 [550400/612104 (90%)]	lr:5.71e-05	Loss: 0.077082
[2024-01-06 19:21:23,955] {train_model:86} INFO - Train Epoch: 28 [611584/612104 (100%)]	lr:5.71e-05	Loss: 0.066487
[2024-01-06 19:21:36,685] {run_experiment:78} INFO - 
[2024-01-06 19:21:36,692] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 19:21:37,943] {result_logger:108} INFO - precision on WAKE: 0.990
[2024-01-06 19:21:38,760] {result_logger:109} INFO - recall on WAKE: 0.965
[2024-01-06 19:21:39,580] {result_logger:112} INFO - F1-score on WAKE: 0.977
[2024-01-06 19:21:39,580] {result_logger:113} INFO - 
[2024-01-06 19:21:40,813] {result_logger:108} INFO - precision on NREM: 0.956
[2024-01-06 19:21:41,623] {result_logger:109} INFO - recall on NREM: 0.960
[2024-01-06 19:21:42,436] {result_logger:112} INFO - F1-score on NREM: 0.958
[2024-01-06 19:21:42,437] {result_logger:113} INFO - 
[2024-01-06 19:21:43,571] {result_logger:108} INFO - precision on REM: 0.812
[2024-01-06 19:21:44,297] {result_logger:109} INFO - recall on REM: 0.966
[2024-01-06 19:21:45,015] {result_logger:112} INFO - F1-score on REM: 0.882
[2024-01-06 19:21:45,015] {result_logger:113} INFO - 
[2024-01-06 19:21:45,202] {result_logger:116} INFO - average precision on sleep stages: 0.919
[2024-01-06 19:21:45,389] {result_logger:118} INFO - average recall on sleep stages: 0.963
[2024-01-06 19:21:45,579] {result_logger:120} INFO - average F1-score on sleep stages: 0.939
[2024-01-06 19:21:46,088] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.963
[2024-01-06 19:21:46,114] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.963
[2024-01-06 19:21:46,117] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 19:21:46,280] {result_logger:108} INFO - precision on WAKE: 0.923
[2024-01-06 19:21:46,376] {result_logger:109} INFO - recall on WAKE: 0.865
[2024-01-06 19:21:46,474] {result_logger:112} INFO - F1-score on WAKE: 0.893
[2024-01-06 19:21:46,475] {result_logger:113} INFO - 
[2024-01-06 19:21:46,640] {result_logger:108} INFO - precision on NREM: 0.931
[2024-01-06 19:21:46,738] {result_logger:109} INFO - recall on NREM: 0.843
[2024-01-06 19:21:46,840] {result_logger:112} INFO - F1-score on NREM: 0.885
[2024-01-06 19:21:46,840] {result_logger:113} INFO - 
[2024-01-06 19:21:47,002] {result_logger:108} INFO - precision on REM: 0.424
[2024-01-06 19:21:47,103] {result_logger:109} INFO - recall on REM: 0.928
[2024-01-06 19:21:47,203] {result_logger:112} INFO - F1-score on REM: 0.582
[2024-01-06 19:21:47,203] {result_logger:113} INFO - 
[2024-01-06 19:21:47,222] {result_logger:116} INFO - average precision on sleep stages: 0.759
[2024-01-06 19:21:47,240] {result_logger:118} INFO - average recall on sleep stages: 0.879
[2024-01-06 19:21:47,258] {result_logger:120} INFO - average F1-score on sleep stages: 0.787
[2024-01-06 19:21:47,329] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.879
[2024-01-06 19:21:47,332] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.860
[2024-01-06 19:21:47,332] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 19:21:47,917] {result_logger:143} INFO - 
[[320309   9529   2214      3]
 [  3119 229609   6461      1]
 [   266   1053  37349      3]
 [  1918    238     31      1]]
[2024-01-06 19:21:48,489] {result_logger:150} INFO - 
[[ 96.46%   2.87%   0.67%   0.00%]
 [  1.30%  95.99%   2.70%   0.00%]
 [  0.69%   2.72%  96.58%   0.01%]
 [ 87.66%  10.88%   1.42%   0.05%]]
[2024-01-06 19:21:49,078] {result_logger:154} INFO - 
[[ 98.37%   3.96%   4.81%  37.50%]
 [  0.96%  95.50%  14.03%  12.50%]
 [  0.08%   0.44%  81.10%  37.50%]
 [  0.59%   0.10%   0.07%  12.50%]]
[2024-01-06 19:21:49,079] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 19:21:49,155] {result_logger:143} INFO - 
[[41794  1964  4561     0]
 [ 3346 29585  2174     0]
 [  162   220  4959     0]
 [  367   129   338     0]]
[2024-01-06 19:21:49,459] {result_logger:150} INFO - 
[[ 86.50%   4.06%   9.44%   0.00%]
 [  9.53%  84.28%   6.19%   0.00%]
 [  3.03%   4.12%  92.85%   0.00%]
 [ 44.00%  15.47%  40.53%   0.00%]]
[2024-01-06 19:21:49,654] {result_logger:154} INFO - 
[[ 91.52%   6.16%  37.91%    nan%]
 [  7.33%  92.75%  18.07%    nan%]
 [  0.35%   0.69%  41.22%    nan%]
 [  0.80%   0.40%   2.81%    nan%]]
[2024-01-06 19:21:50,060] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 19:21:50,060] {result_logger:77} INFO - actual:
[2024-01-06 19:21:50,060] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 19:21:50,060] {result_logger:79} INFO - predicted:
[2024-01-06 19:21:50,060] {result_logger:80} INFO - 
[[93.74%  3.48%  2.78%  0.00%]
 [ 4.23% 92.35%  3.42%  0.00%]
 [12.53%  7.09% 80.38%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 19:21:50,096] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it3/model_8conv_2fc-best.pth
[2024-01-06 19:21:50,096] {run_experiment:113} INFO - [epoch  28] execution time: 214.44s	 avg f1-score: 0.7866

[2024-01-06 19:21:50,096] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 19:21:50,151] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 19:22:16,007] {train_model:86} INFO - Train Epoch: 29 [60928/612104 (10%)]	lr:5.38e-05	Loss: 0.061214
[2024-01-06 19:22:27,371] {train_model:86} INFO - Train Epoch: 29 [122112/612104 (20%)]	lr:5.38e-05	Loss: 0.076851
[2024-01-06 19:22:38,827] {train_model:86} INFO - Train Epoch: 29 [183296/612104 (30%)]	lr:5.38e-05	Loss: 0.072081
[2024-01-06 19:23:02,731] {train_model:86} INFO - Train Epoch: 29 [244480/612104 (40%)]	lr:5.38e-05	Loss: 0.097206
[2024-01-06 19:23:30,538] {train_model:86} INFO - Train Epoch: 29 [305664/612104 (50%)]	lr:5.38e-05	Loss: 0.103295
[2024-01-06 19:23:43,465] {train_model:86} INFO - Train Epoch: 29 [366848/612104 (60%)]	lr:5.38e-05	Loss: 0.033223
[2024-01-06 19:23:55,146] {train_model:86} INFO - Train Epoch: 29 [428032/612104 (70%)]	lr:5.38e-05	Loss: 0.060843
[2024-01-06 19:24:06,490] {train_model:86} INFO - Train Epoch: 29 [489216/612104 (80%)]	lr:5.38e-05	Loss: 0.109375
[2024-01-06 19:24:33,523] {train_model:86} INFO - Train Epoch: 29 [550400/612104 (90%)]	lr:5.38e-05	Loss: 0.037846
[2024-01-06 19:24:59,252] {train_model:86} INFO - Train Epoch: 29 [611584/612104 (100%)]	lr:5.38e-05	Loss: 0.093530
[2024-01-06 19:25:11,713] {run_experiment:78} INFO - 
[2024-01-06 19:25:11,719] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 19:25:12,964] {result_logger:108} INFO - precision on WAKE: 0.989
[2024-01-06 19:25:13,781] {result_logger:109} INFO - recall on WAKE: 0.965
[2024-01-06 19:25:14,619] {result_logger:112} INFO - F1-score on WAKE: 0.977
[2024-01-06 19:25:14,619] {result_logger:113} INFO - 
[2024-01-06 19:25:15,865] {result_logger:108} INFO - precision on NREM: 0.956
[2024-01-06 19:25:16,655] {result_logger:109} INFO - recall on NREM: 0.961
[2024-01-06 19:25:17,447] {result_logger:112} INFO - F1-score on NREM: 0.959
[2024-01-06 19:25:17,448] {result_logger:113} INFO - 
[2024-01-06 19:25:18,550] {result_logger:108} INFO - precision on REM: 0.816
[2024-01-06 19:25:19,247] {result_logger:109} INFO - recall on REM: 0.967
[2024-01-06 19:25:19,960] {result_logger:112} INFO - F1-score on REM: 0.885
[2024-01-06 19:25:19,960] {result_logger:113} INFO - 
[2024-01-06 19:25:20,141] {result_logger:116} INFO - average precision on sleep stages: 0.921
[2024-01-06 19:25:20,321] {result_logger:118} INFO - average recall on sleep stages: 0.964
[2024-01-06 19:25:20,499] {result_logger:120} INFO - average F1-score on sleep stages: 0.940
[2024-01-06 19:25:20,997] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.964
[2024-01-06 19:25:21,023] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.963
[2024-01-06 19:25:21,027] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 19:25:21,182] {result_logger:108} INFO - precision on WAKE: 0.921
[2024-01-06 19:25:21,278] {result_logger:109} INFO - recall on WAKE: 0.917
[2024-01-06 19:25:21,372] {result_logger:112} INFO - F1-score on WAKE: 0.919
[2024-01-06 19:25:21,373] {result_logger:113} INFO - 
[2024-01-06 19:25:21,529] {result_logger:108} INFO - precision on NREM: 0.915
[2024-01-06 19:25:21,627] {result_logger:109} INFO - recall on NREM: 0.845
[2024-01-06 19:25:21,722] {result_logger:112} INFO - F1-score on NREM: 0.878
[2024-01-06 19:25:21,723] {result_logger:113} INFO - 
[2024-01-06 19:25:21,877] {result_logger:108} INFO - precision on REM: 0.602
[2024-01-06 19:25:21,971] {result_logger:109} INFO - recall on REM: 0.931
[2024-01-06 19:25:22,067] {result_logger:112} INFO - F1-score on REM: 0.731
[2024-01-06 19:25:22,067] {result_logger:113} INFO - 
[2024-01-06 19:25:22,085] {result_logger:116} INFO - average precision on sleep stages: 0.813
[2024-01-06 19:25:22,102] {result_logger:118} INFO - average recall on sleep stages: 0.897
[2024-01-06 19:25:22,120] {result_logger:120} INFO - average F1-score on sleep stages: 0.843
[2024-01-06 19:25:22,188] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.897
[2024-01-06 19:25:22,190] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.889
[2024-01-06 19:25:22,191] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 19:25:22,746] {result_logger:143} INFO - 
[[320421   9454   2178      2]
 [  3202 229755   6226      7]
 [   280   1005  37384      2]
 [  1915    235     38      0]]
[2024-01-06 19:25:23,298] {result_logger:150} INFO - 
[[ 96.50%   2.85%   0.66%   0.00%]
 [  1.34%  96.06%   2.60%   0.00%]
 [  0.72%   2.60%  96.67%   0.01%]
 [ 87.52%  10.74%   1.74%   0.00%]]
[2024-01-06 19:25:23,852] {result_logger:154} INFO - 
[[ 98.34%   3.93%   4.75%  18.18%]
 [  0.98%  95.55%  13.59%  63.64%]
 [  0.09%   0.42%  81.58%  18.18%]
 [  0.59%   0.10%   0.08%   0.00%]]
[2024-01-06 19:25:23,853] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 19:25:23,927] {result_logger:143} INFO - 
[[44288  2627  1404     0]
 [ 3569 29652  1884     0]
 [  229   141  4971     0]
 [  484   241   109     0]]
[2024-01-06 19:25:24,115] {result_logger:150} INFO - 
[[ 91.66%   5.44%   2.91%   0.00%]
 [ 10.17%  84.47%   5.37%   0.00%]
 [  4.29%   2.64%  93.07%   0.00%]
 [ 58.03%  28.90%  13.07%   0.00%]]
[2024-01-06 19:25:24,303] {result_logger:154} INFO - 
[[ 91.18%   8.04%  16.78%    nan%]
 [  7.35%  90.79%  22.51%    nan%]
 [  0.47%   0.43%  59.40%    nan%]
 [  1.00%   0.74%   1.30%    nan%]]
[2024-01-06 19:25:24,706] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 19:25:24,707] {result_logger:77} INFO - actual:
[2024-01-06 19:25:24,707] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 19:25:24,707] {result_logger:79} INFO - predicted:
[2024-01-06 19:25:24,707] {result_logger:80} INFO - 
[[94.85%  3.96%  1.19%  0.00%]
 [ 5.03% 92.27%  2.70%  0.00%]
 [10.25%  7.18% 82.56%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 19:25:24,743] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it3/model_8conv_2fc-best.pth
[2024-01-06 19:25:24,743] {run_experiment:113} INFO - [epoch  29] execution time: 214.65s	 avg f1-score: 0.8427

[2024-01-06 19:25:24,744] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 19:25:24,795] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 19:25:50,681] {train_model:86} INFO - Train Epoch: 30 [60928/612104 (10%)]	lr:5.07e-05	Loss: 0.083431
[2024-01-06 19:26:01,943] {train_model:86} INFO - Train Epoch: 30 [122112/612104 (20%)]	lr:5.07e-05	Loss: 0.062516
[2024-01-06 19:26:13,548] {train_model:86} INFO - Train Epoch: 30 [183296/612104 (30%)]	lr:5.07e-05	Loss: 0.062713
[2024-01-06 19:26:24,917] {train_model:86} INFO - Train Epoch: 30 [244480/612104 (40%)]	lr:5.07e-05	Loss: 0.139500
[2024-01-06 19:26:52,288] {train_model:86} INFO - Train Epoch: 30 [305664/612104 (50%)]	lr:5.07e-05	Loss: 0.074029
[2024-01-06 19:27:17,723] {train_model:86} INFO - Train Epoch: 30 [366848/612104 (60%)]	lr:5.07e-05	Loss: 0.111726
[2024-01-06 19:27:28,979] {train_model:86} INFO - Train Epoch: 30 [428032/612104 (70%)]	lr:5.07e-05	Loss: 0.072819
[2024-01-06 19:27:40,283] {train_model:86} INFO - Train Epoch: 30 [489216/612104 (80%)]	lr:5.07e-05	Loss: 0.042295
[2024-01-06 19:27:51,657] {train_model:86} INFO - Train Epoch: 30 [550400/612104 (90%)]	lr:5.07e-05	Loss: 0.047102
[2024-01-06 19:28:18,939] {train_model:86} INFO - Train Epoch: 30 [611584/612104 (100%)]	lr:5.07e-05	Loss: 0.081986
[2024-01-06 19:28:30,943] {run_experiment:78} INFO - 
[2024-01-06 19:28:30,949] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 19:28:32,139] {result_logger:108} INFO - precision on WAKE: 0.990
[2024-01-06 19:28:32,922] {result_logger:109} INFO - recall on WAKE: 0.966
[2024-01-06 19:28:33,732] {result_logger:112} INFO - F1-score on WAKE: 0.977
[2024-01-06 19:28:33,732] {result_logger:113} INFO - 
[2024-01-06 19:28:34,944] {result_logger:108} INFO - precision on NREM: 0.957
[2024-01-06 19:28:35,740] {result_logger:109} INFO - recall on NREM: 0.961
[2024-01-06 19:28:36,527] {result_logger:112} INFO - F1-score on NREM: 0.959
[2024-01-06 19:28:36,527] {result_logger:113} INFO - 
[2024-01-06 19:28:37,629] {result_logger:108} INFO - precision on REM: 0.820
[2024-01-06 19:28:38,336] {result_logger:109} INFO - recall on REM: 0.967
[2024-01-06 19:28:39,040] {result_logger:112} INFO - F1-score on REM: 0.887
[2024-01-06 19:28:39,040] {result_logger:113} INFO - 
[2024-01-06 19:28:39,222] {result_logger:116} INFO - average precision on sleep stages: 0.922
[2024-01-06 19:28:39,408] {result_logger:118} INFO - average recall on sleep stages: 0.965
[2024-01-06 19:28:39,596] {result_logger:120} INFO - average F1-score on sleep stages: 0.941
[2024-01-06 19:28:40,112] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.965
[2024-01-06 19:28:40,138] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.964
[2024-01-06 19:28:40,142] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 19:28:40,296] {result_logger:108} INFO - precision on WAKE: 0.898
[2024-01-06 19:28:40,390] {result_logger:109} INFO - recall on WAKE: 0.698
[2024-01-06 19:28:40,488] {result_logger:112} INFO - F1-score on WAKE: 0.786
[2024-01-06 19:28:40,488] {result_logger:113} INFO - 
[2024-01-06 19:28:40,646] {result_logger:108} INFO - precision on NREM: 0.913
[2024-01-06 19:28:40,744] {result_logger:109} INFO - recall on NREM: 0.801
[2024-01-06 19:28:40,841] {result_logger:112} INFO - F1-score on NREM: 0.854
[2024-01-06 19:28:40,841] {result_logger:113} INFO - 
[2024-01-06 19:28:40,996] {result_logger:108} INFO - precision on REM: 0.226
[2024-01-06 19:28:41,092] {result_logger:109} INFO - recall on REM: 0.861
[2024-01-06 19:28:41,188] {result_logger:112} INFO - F1-score on REM: 0.357
[2024-01-06 19:28:41,188] {result_logger:113} INFO - 
[2024-01-06 19:28:41,205] {result_logger:116} INFO - average precision on sleep stages: 0.679
[2024-01-06 19:28:41,223] {result_logger:118} INFO - average recall on sleep stages: 0.787
[2024-01-06 19:28:41,240] {result_logger:120} INFO - average F1-score on sleep stages: 0.666
[2024-01-06 19:28:41,310] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.787
[2024-01-06 19:28:41,313] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.749
[2024-01-06 19:28:41,313] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 19:28:41,876] {result_logger:143} INFO - 
[[320600   9372   2079      4]
 [  3124 229910   6156      0]
 [   271   1000  37393      7]
 [  1921    238     29      0]]
[2024-01-06 19:28:42,424] {result_logger:150} INFO - 
[[ 96.55%   2.82%   0.63%   0.00%]
 [  1.31%  96.12%   2.57%   0.00%]
 [  0.70%   2.59%  96.70%   0.02%]
 [ 87.80%  10.88%   1.33%   0.00%]]
[2024-01-06 19:28:42,985] {result_logger:154} INFO - 
[[ 98.37%   3.90%   4.55%  36.36%]
 [  0.96%  95.59%  13.48%   0.00%]
 [  0.08%   0.42%  81.90%  63.64%]
 [  0.59%   0.10%   0.06%   0.00%]]
[2024-01-06 19:28:42,985] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 19:28:43,057] {result_logger:143} INFO - 
[[33748  2027 12544     0]
 [ 3735 28125  3245     0]
 [  105   638  4598     0]
 [   84    56   694     0]]
[2024-01-06 19:28:43,264] {result_logger:150} INFO - 
[[ 69.84%   4.20%  25.96%   0.00%]
 [ 10.64%  80.12%   9.24%   0.00%]
 [  1.97%  11.95%  86.09%   0.00%]
 [ 10.07%   6.71%  83.21%   0.00%]]
[2024-01-06 19:28:43,464] {result_logger:154} INFO - 
[[ 89.58%   6.57%  59.50%    nan%]
 [  9.91%  91.18%  15.39%    nan%]
 [  0.28%   2.07%  21.81%    nan%]
 [  0.22%   0.18%   3.29%    nan%]]
[2024-01-06 19:28:43,879] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 19:28:43,879] {result_logger:77} INFO - actual:
[2024-01-06 19:28:43,879] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 19:28:43,879] {result_logger:79} INFO - predicted:
[2024-01-06 19:28:43,880] {result_logger:80} INFO - 
[[94.13%  3.33%  2.54%  0.00%]
 [ 3.67% 92.59%  3.74%  0.00%]
 [ 5.11%  4.90% 89.99%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 19:28:43,922] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it3/model_8conv_2fc-best.pth
[2024-01-06 19:28:43,923] {run_experiment:113} INFO - [epoch  30] execution time: 199.18s	 avg f1-score: 0.6656

[2024-01-06 19:28:43,923] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 19:28:43,975] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 19:29:10,018] {train_model:86} INFO - Train Epoch: 31 [60928/612104 (10%)]	lr:4.77e-05	Loss: 0.054558
[2024-01-06 19:29:21,336] {train_model:86} INFO - Train Epoch: 31 [122112/612104 (20%)]	lr:4.77e-05	Loss: 0.060536
[2024-01-06 19:29:32,829] {train_model:86} INFO - Train Epoch: 31 [183296/612104 (30%)]	lr:4.77e-05	Loss: 0.173516
[2024-01-06 19:29:44,708] {train_model:86} INFO - Train Epoch: 31 [244480/612104 (40%)]	lr:4.77e-05	Loss: 0.028554
[2024-01-06 19:29:56,281] {train_model:86} INFO - Train Epoch: 31 [305664/612104 (50%)]	lr:4.77e-05	Loss: 0.071350
[2024-01-06 19:30:23,291] {train_model:86} INFO - Train Epoch: 31 [366848/612104 (60%)]	lr:4.77e-05	Loss: 0.090655
[2024-01-06 19:30:48,713] {train_model:86} INFO - Train Epoch: 31 [428032/612104 (70%)]	lr:4.77e-05	Loss: 0.067916
[2024-01-06 19:31:00,163] {train_model:86} INFO - Train Epoch: 31 [489216/612104 (80%)]	lr:4.77e-05	Loss: 0.177873
[2024-01-06 19:31:11,707] {train_model:86} INFO - Train Epoch: 31 [550400/612104 (90%)]	lr:4.77e-05	Loss: 0.028411
[2024-01-06 19:31:22,928] {train_model:86} INFO - Train Epoch: 31 [611584/612104 (100%)]	lr:4.77e-05	Loss: 0.087226
[2024-01-06 19:31:35,229] {run_experiment:78} INFO - 
[2024-01-06 19:31:35,236] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 19:31:36,497] {result_logger:108} INFO - precision on WAKE: 0.990
[2024-01-06 19:31:37,327] {result_logger:109} INFO - recall on WAKE: 0.966
[2024-01-06 19:31:38,143] {result_logger:112} INFO - F1-score on WAKE: 0.978
[2024-01-06 19:31:38,144] {result_logger:113} INFO - 
[2024-01-06 19:31:39,410] {result_logger:108} INFO - precision on NREM: 0.957
[2024-01-06 19:31:40,218] {result_logger:109} INFO - recall on NREM: 0.962
[2024-01-06 19:31:41,027] {result_logger:112} INFO - F1-score on NREM: 0.959
[2024-01-06 19:31:41,028] {result_logger:113} INFO - 
[2024-01-06 19:31:42,160] {result_logger:108} INFO - precision on REM: 0.822
[2024-01-06 19:31:42,876] {result_logger:109} INFO - recall on REM: 0.969
[2024-01-06 19:31:43,593] {result_logger:112} INFO - F1-score on REM: 0.890
[2024-01-06 19:31:43,594] {result_logger:113} INFO - 
[2024-01-06 19:31:43,785] {result_logger:116} INFO - average precision on sleep stages: 0.923
[2024-01-06 19:31:43,972] {result_logger:118} INFO - average recall on sleep stages: 0.965
[2024-01-06 19:31:44,158] {result_logger:120} INFO - average F1-score on sleep stages: 0.942
[2024-01-06 19:31:44,682] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.965
[2024-01-06 19:31:44,707] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.964
[2024-01-06 19:31:44,711] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 19:31:44,869] {result_logger:108} INFO - precision on WAKE: 0.862
[2024-01-06 19:31:44,971] {result_logger:109} INFO - recall on WAKE: 0.971
[2024-01-06 19:31:45,071] {result_logger:112} INFO - F1-score on WAKE: 0.913
[2024-01-06 19:31:45,071] {result_logger:113} INFO - 
[2024-01-06 19:31:45,232] {result_logger:108} INFO - precision on NREM: 0.904
[2024-01-06 19:31:45,329] {result_logger:109} INFO - recall on NREM: 0.807
[2024-01-06 19:31:45,429] {result_logger:112} INFO - F1-score on NREM: 0.853
[2024-01-06 19:31:45,429] {result_logger:113} INFO - 
[2024-01-06 19:31:45,588] {result_logger:108} INFO - precision on REM: 0.608
[2024-01-06 19:31:45,685] {result_logger:109} INFO - recall on REM: 0.339
[2024-01-06 19:31:45,783] {result_logger:112} INFO - F1-score on REM: 0.435
[2024-01-06 19:31:45,783] {result_logger:113} INFO - 
[2024-01-06 19:31:45,801] {result_logger:116} INFO - average precision on sleep stages: 0.791
[2024-01-06 19:31:45,819] {result_logger:118} INFO - average recall on sleep stages: 0.706
[2024-01-06 19:31:45,837] {result_logger:120} INFO - average F1-score on sleep stages: 0.734
[2024-01-06 19:31:45,907] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.706
[2024-01-06 19:31:45,910] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.868
[2024-01-06 19:31:45,910] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 19:31:46,474] {result_logger:143} INFO - 
[[320708   9290   2055      2]
 [  3148 230000   6041      1]
 [   240    965  37465      1]
 [  1919    236     33      0]]
[2024-01-06 19:31:47,059] {result_logger:150} INFO - 
[[ 96.58%   2.80%   0.62%   0.00%]
 [  1.32%  96.16%   2.53%   0.00%]
 [  0.62%   2.50%  96.88%   0.00%]
 [ 87.71%  10.79%   1.51%   0.00%]]
[2024-01-06 19:31:47,641] {result_logger:154} INFO - 
[[ 98.37%   3.86%   4.51%  50.00%]
 [  0.97%  95.64%  13.25%  25.00%]
 [  0.07%   0.40%  82.17%  25.00%]
 [  0.59%   0.10%   0.07%   0.00%]]
[2024-01-06 19:31:47,642] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 19:31:47,717] {result_logger:143} INFO - 
[[46917  1375    27     0]
 [ 5641 28325  1139     0]
 [ 1901  1630  1810     0]
 [  712   118     4     0]]
[2024-01-06 19:31:47,959] {result_logger:150} INFO - 
[[ 97.10%   2.85%   0.06%   0.00%]
 [ 16.07%  80.69%   3.24%   0.00%]
 [ 35.59%  30.52%  33.89%   0.00%]
 [ 85.37%  14.15%   0.48%   0.00%]]
[2024-01-06 19:31:48,168] {result_logger:154} INFO - 
[[ 85.04%   4.37%   0.91%    nan%]
 [ 10.22%  90.07%  38.22%    nan%]
 [  3.45%   5.18%  60.74%    nan%]
 [  1.29%   0.38%   0.13%    nan%]]
[2024-01-06 19:31:48,724] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 19:31:48,724] {result_logger:77} INFO - actual:
[2024-01-06 19:31:48,725] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 19:31:48,725] {result_logger:79} INFO - predicted:
[2024-01-06 19:31:48,725] {result_logger:80} INFO - 
[[96.12%  3.51%  0.37%  0.00%]
 [ 5.72% 93.10%  1.18%  0.00%]
 [11.48%  7.85% 80.67%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 19:31:48,781] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it3/model_8conv_2fc-best.pth
[2024-01-06 19:31:48,781] {run_experiment:113} INFO - [epoch  31] execution time: 184.86s	 avg f1-score: 0.7336

[2024-01-06 19:31:48,781] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 19:31:48,835] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 19:32:22,070] {train_model:86} INFO - Train Epoch: 32 [60928/612104 (10%)]	lr:4.49e-05	Loss: 0.102094
[2024-01-06 19:32:42,003] {train_model:86} INFO - Train Epoch: 32 [122112/612104 (20%)]	lr:4.49e-05	Loss: 0.091574
[2024-01-06 19:32:53,394] {train_model:86} INFO - Train Epoch: 32 [183296/612104 (30%)]	lr:4.49e-05	Loss: 0.038250
[2024-01-06 19:33:04,710] {train_model:86} INFO - Train Epoch: 32 [244480/612104 (40%)]	lr:4.49e-05	Loss: 0.064187
[2024-01-06 19:33:16,192] {train_model:86} INFO - Train Epoch: 32 [305664/612104 (50%)]	lr:4.49e-05	Loss: 0.078501
[2024-01-06 19:33:27,978] {train_model:86} INFO - Train Epoch: 32 [366848/612104 (60%)]	lr:4.49e-05	Loss: 0.104431
[2024-01-06 19:33:54,847] {train_model:86} INFO - Train Epoch: 32 [428032/612104 (70%)]	lr:4.49e-05	Loss: 0.141306
[2024-01-06 19:34:20,392] {train_model:86} INFO - Train Epoch: 32 [489216/612104 (80%)]	lr:4.49e-05	Loss: 0.139045
[2024-01-06 19:34:31,518] {train_model:86} INFO - Train Epoch: 32 [550400/612104 (90%)]	lr:4.49e-05	Loss: 0.133675
[2024-01-06 19:34:43,179] {train_model:86} INFO - Train Epoch: 32 [611584/612104 (100%)]	lr:4.49e-05	Loss: 0.050406
[2024-01-06 19:34:55,578] {run_experiment:78} INFO - 
[2024-01-06 19:34:55,585] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 19:34:56,867] {result_logger:108} INFO - precision on WAKE: 0.990
[2024-01-06 19:34:57,685] {result_logger:109} INFO - recall on WAKE: 0.966
[2024-01-06 19:34:58,507] {result_logger:112} INFO - F1-score on WAKE: 0.977
[2024-01-06 19:34:58,507] {result_logger:113} INFO - 
[2024-01-06 19:34:59,759] {result_logger:108} INFO - precision on NREM: 0.957
[2024-01-06 19:35:00,574] {result_logger:109} INFO - recall on NREM: 0.963
[2024-01-06 19:35:01,384] {result_logger:112} INFO - F1-score on NREM: 0.960
[2024-01-06 19:35:01,385] {result_logger:113} INFO - 
[2024-01-06 19:35:02,534] {result_logger:108} INFO - precision on REM: 0.827
[2024-01-06 19:35:03,246] {result_logger:109} INFO - recall on REM: 0.968
[2024-01-06 19:35:03,956] {result_logger:112} INFO - F1-score on REM: 0.892
[2024-01-06 19:35:03,957] {result_logger:113} INFO - 
[2024-01-06 19:35:04,145] {result_logger:116} INFO - average precision on sleep stages: 0.924
[2024-01-06 19:35:04,335] {result_logger:118} INFO - average recall on sleep stages: 0.965
[2024-01-06 19:35:04,525] {result_logger:120} INFO - average F1-score on sleep stages: 0.943
[2024-01-06 19:35:05,038] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.965
[2024-01-06 19:35:05,064] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.965
[2024-01-06 19:35:05,068] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 19:35:05,234] {result_logger:108} INFO - precision on WAKE: 0.892
[2024-01-06 19:35:05,333] {result_logger:109} INFO - recall on WAKE: 0.958
[2024-01-06 19:35:05,432] {result_logger:112} INFO - F1-score on WAKE: 0.924
[2024-01-06 19:35:05,432] {result_logger:113} INFO - 
[2024-01-06 19:35:05,593] {result_logger:108} INFO - precision on NREM: 0.940
[2024-01-06 19:35:05,690] {result_logger:109} INFO - recall on NREM: 0.809
[2024-01-06 19:35:05,791] {result_logger:112} INFO - F1-score on NREM: 0.870
[2024-01-06 19:35:05,791] {result_logger:113} INFO - 
[2024-01-06 19:35:05,952] {result_logger:108} INFO - precision on REM: 0.696
[2024-01-06 19:35:06,052] {result_logger:109} INFO - recall on REM: 0.867
[2024-01-06 19:35:06,151] {result_logger:112} INFO - F1-score on REM: 0.772
[2024-01-06 19:35:06,151] {result_logger:113} INFO - 
[2024-01-06 19:35:06,169] {result_logger:116} INFO - average precision on sleep stages: 0.843
[2024-01-06 19:35:06,187] {result_logger:118} INFO - average recall on sleep stages: 0.878
[2024-01-06 19:35:06,205] {result_logger:120} INFO - average F1-score on sleep stages: 0.855
[2024-01-06 19:35:06,275] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.878
[2024-01-06 19:35:06,279] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.894
[2024-01-06 19:35:06,279] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 19:35:06,850] {result_logger:143} INFO - 
[[320607   9411   2033      4]
 [  3090 230276   5818      6]
 [   259    975  37435      2]
 [  1925    236     27      0]]
[2024-01-06 19:35:07,420] {result_logger:150} INFO - 
[[ 96.55%   2.83%   0.61%   0.00%]
 [  1.29%  96.27%   2.43%   0.00%]
 [  0.67%   2.52%  96.80%   0.01%]
 [ 87.98%  10.79%   1.23%   0.00%]]
[2024-01-06 19:35:07,989] {result_logger:154} INFO - 
[[ 98.38%   3.91%   4.49%  33.33%]
 [  0.95%  95.59%  12.84%  50.00%]
 [  0.08%   0.40%  82.61%  16.67%]
 [  0.59%   0.10%   0.06%   0.00%]]
[2024-01-06 19:35:07,989] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 19:35:08,064] {result_logger:143} INFO - 
[[46292  1627   400     0]
 [ 5075 28407  1623     0]
 [  517   193  4631     0]
 [  687   119    28     0]]
[2024-01-06 19:35:08,256] {result_logger:150} INFO - 
[[ 95.80%   3.37%   0.83%   0.00%]
 [ 14.46%  80.92%   4.62%   0.00%]
 [  9.68%   3.61%  86.71%   0.00%]
 [ 82.37%  14.27%   3.36%   0.00%]]
[2024-01-06 19:35:08,444] {result_logger:154} INFO - 
[[ 88.06%   5.36%   5.99%    nan%]
 [  9.65%  93.61%  24.29%    nan%]
 [  0.98%   0.64%  69.31%    nan%]
 [  1.31%   0.39%   0.42%    nan%]]
[2024-01-06 19:35:08,854] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 19:35:08,854] {result_logger:77} INFO - actual:
[2024-01-06 19:35:08,854] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 19:35:08,854] {result_logger:79} INFO - predicted:
[2024-01-06 19:35:08,854] {result_logger:80} INFO - 
[[95.71%  3.64%  0.64%  0.00%]
 [ 5.47% 92.34%  2.18%  0.00%]
 [ 8.86%  6.11% 85.03%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 19:35:08,892] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it3/model_8conv_2fc-best.pth
[2024-01-06 19:35:08,892] {run_experiment:113} INFO - [epoch  32] execution time: 200.11s	 avg f1-score: 0.8552

[2024-01-06 19:35:08,892] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 19:35:08,946] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 19:35:39,579] {train_model:86} INFO - Train Epoch: 33 [60928/612104 (10%)]	lr:4.23e-05	Loss: 0.053577
[2024-01-06 19:36:02,518] {train_model:86} INFO - Train Epoch: 33 [122112/612104 (20%)]	lr:4.23e-05	Loss: 0.061410
[2024-01-06 19:36:28,063] {train_model:86} INFO - Train Epoch: 33 [183296/612104 (30%)]	lr:4.23e-05	Loss: 0.047719
[2024-01-06 19:36:39,704] {train_model:86} INFO - Train Epoch: 33 [244480/612104 (40%)]	lr:4.23e-05	Loss: 0.046504
[2024-01-06 19:36:51,206] {train_model:86} INFO - Train Epoch: 33 [305664/612104 (50%)]	lr:4.23e-05	Loss: 0.093200
[2024-01-06 19:37:02,330] {train_model:86} INFO - Train Epoch: 33 [366848/612104 (60%)]	lr:4.23e-05	Loss: 0.143806
[2024-01-06 19:37:29,414] {train_model:86} INFO - Train Epoch: 33 [428032/612104 (70%)]	lr:4.23e-05	Loss: 0.066254
[2024-01-06 19:37:55,258] {train_model:86} INFO - Train Epoch: 33 [489216/612104 (80%)]	lr:4.23e-05	Loss: 0.197973
[2024-01-06 19:38:07,061] {train_model:86} INFO - Train Epoch: 33 [550400/612104 (90%)]	lr:4.23e-05	Loss: 0.067462
[2024-01-06 19:38:18,597] {train_model:86} INFO - Train Epoch: 33 [611584/612104 (100%)]	lr:4.23e-05	Loss: 0.059167
[2024-01-06 19:38:30,939] {run_experiment:78} INFO - 
[2024-01-06 19:38:30,946] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 19:38:32,174] {result_logger:108} INFO - precision on WAKE: 0.990
[2024-01-06 19:38:32,974] {result_logger:109} INFO - recall on WAKE: 0.966
[2024-01-06 19:38:33,776] {result_logger:112} INFO - F1-score on WAKE: 0.978
[2024-01-06 19:38:33,776] {result_logger:113} INFO - 
[2024-01-06 19:38:34,958] {result_logger:108} INFO - precision on NREM: 0.957
[2024-01-06 19:38:35,737] {result_logger:109} INFO - recall on NREM: 0.963
[2024-01-06 19:38:36,512] {result_logger:112} INFO - F1-score on NREM: 0.960
[2024-01-06 19:38:36,512] {result_logger:113} INFO - 
[2024-01-06 19:38:37,632] {result_logger:108} INFO - precision on REM: 0.827
[2024-01-06 19:38:38,329] {result_logger:109} INFO - recall on REM: 0.969
[2024-01-06 19:38:39,029] {result_logger:112} INFO - F1-score on REM: 0.892
[2024-01-06 19:38:39,029] {result_logger:113} INFO - 
[2024-01-06 19:38:39,216] {result_logger:116} INFO - average precision on sleep stages: 0.925
[2024-01-06 19:38:39,403] {result_logger:118} INFO - average recall on sleep stages: 0.966
[2024-01-06 19:38:39,587] {result_logger:120} INFO - average F1-score on sleep stages: 0.943
[2024-01-06 19:38:40,095] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.966
[2024-01-06 19:38:40,121] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.965
[2024-01-06 19:38:40,124] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 19:38:40,285] {result_logger:108} INFO - precision on WAKE: 0.895
[2024-01-06 19:38:40,384] {result_logger:109} INFO - recall on WAKE: 0.806
[2024-01-06 19:38:40,482] {result_logger:112} INFO - F1-score on WAKE: 0.848
[2024-01-06 19:38:40,482] {result_logger:113} INFO - 
[2024-01-06 19:38:40,644] {result_logger:108} INFO - precision on NREM: 0.925
[2024-01-06 19:38:40,739] {result_logger:109} INFO - recall on NREM: 0.817
[2024-01-06 19:38:40,838] {result_logger:112} INFO - F1-score on NREM: 0.868
[2024-01-06 19:38:40,838] {result_logger:113} INFO - 
[2024-01-06 19:38:40,999] {result_logger:108} INFO - precision on REM: 0.337
[2024-01-06 19:38:41,096] {result_logger:109} INFO - recall on REM: 0.897
[2024-01-06 19:38:41,195] {result_logger:112} INFO - F1-score on REM: 0.490
[2024-01-06 19:38:41,195] {result_logger:113} INFO - 
[2024-01-06 19:38:41,213] {result_logger:116} INFO - average precision on sleep stages: 0.719
[2024-01-06 19:38:41,231] {result_logger:118} INFO - average recall on sleep stages: 0.840
[2024-01-06 19:38:41,249] {result_logger:120} INFO - average F1-score on sleep stages: 0.735
[2024-01-06 19:38:41,318] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.840
[2024-01-06 19:38:41,321] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.816
[2024-01-06 19:38:41,322] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 19:38:41,873] {result_logger:143} INFO - 
[[320664   9380   2004      7]
 [  3075 230269   5845      1]
 [   237    963  37468      3]
 [  1922    237     29      0]]
[2024-01-06 19:38:42,430] {result_logger:150} INFO - 
[[ 96.57%   2.82%   0.60%   0.00%]
 [  1.29%  96.27%   2.44%   0.00%]
 [  0.61%   2.49%  96.89%   0.01%]
 [ 87.84%  10.83%   1.33%   0.00%]]
[2024-01-06 19:38:42,990] {result_logger:154} INFO - 
[[ 98.39%   3.89%   4.42%  63.64%]
 [  0.94%  95.61%  12.89%   9.09%]
 [  0.07%   0.40%  82.63%  27.27%]
 [  0.59%   0.10%   0.06%   0.00%]]
[2024-01-06 19:38:42,990] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 19:38:43,063] {result_logger:143} INFO - 
[[38961  1909  7449     0]
 [ 4435 28683  1987     0]
 [  150   400  4791     0]
 [  274   108   452     0]]
[2024-01-06 19:38:43,255] {result_logger:150} INFO - 
[[ 80.63%   3.95%  15.42%   0.00%]
 [ 12.63%  81.71%   5.66%   0.00%]
 [  2.81%   7.49%  89.70%   0.00%]
 [ 32.85%  12.95%  54.20%   0.00%]]
[2024-01-06 19:38:43,446] {result_logger:154} INFO - 
[[ 88.91%   6.14%  50.75%    nan%]
 [ 10.12%  92.23%  13.54%    nan%]
 [  0.34%   1.29%  32.64%    nan%]
 [  0.63%   0.35%   3.08%    nan%]]
[2024-01-06 19:38:43,836] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 19:38:43,837] {result_logger:77} INFO - actual:
[2024-01-06 19:38:43,837] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 19:38:43,837] {result_logger:79} INFO - predicted:
[2024-01-06 19:38:43,837] {result_logger:80} INFO - 
[[93.03%  3.54%  3.44%  0.00%]
 [ 4.36% 92.31%  3.32%  0.00%]
 [11.57%  5.74% 82.70%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 19:38:43,874] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it3/model_8conv_2fc-best.pth
[2024-01-06 19:38:43,874] {run_experiment:113} INFO - [epoch  33] execution time: 214.98s	 avg f1-score: 0.7353

[2024-01-06 19:38:43,874] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 19:38:43,927] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 19:39:09,984] {train_model:86} INFO - Train Epoch: 34 [60928/612104 (10%)]	lr:3.99e-05	Loss: 0.030282
[2024-01-06 19:39:34,711] {train_model:86} INFO - Train Epoch: 34 [122112/612104 (20%)]	lr:3.99e-05	Loss: 0.077690
[2024-01-06 19:39:48,535] {train_model:86} INFO - Train Epoch: 34 [183296/612104 (30%)]	lr:3.99e-05	Loss: 0.061127
[2024-01-06 19:40:13,885] {train_model:86} INFO - Train Epoch: 34 [244480/612104 (40%)]	lr:3.99e-05	Loss: 0.065174
[2024-01-06 19:40:25,304] {train_model:86} INFO - Train Epoch: 34 [305664/612104 (50%)]	lr:3.99e-05	Loss: 0.074226
[2024-01-06 19:40:36,653] {train_model:86} INFO - Train Epoch: 34 [366848/612104 (60%)]	lr:3.99e-05	Loss: 0.034741
[2024-01-06 19:41:03,536] {train_model:86} INFO - Train Epoch: 34 [428032/612104 (70%)]	lr:3.99e-05	Loss: 0.194916
[2024-01-06 19:41:28,942] {train_model:86} INFO - Train Epoch: 34 [489216/612104 (80%)]	lr:3.99e-05	Loss: 0.063689
[2024-01-06 19:41:40,471] {train_model:86} INFO - Train Epoch: 34 [550400/612104 (90%)]	lr:3.99e-05	Loss: 0.093563
[2024-01-06 19:41:51,924] {train_model:86} INFO - Train Epoch: 34 [611584/612104 (100%)]	lr:3.99e-05	Loss: 0.069000
[2024-01-06 19:42:04,831] {run_experiment:78} INFO - 
[2024-01-06 19:42:04,838] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 19:42:06,101] {result_logger:108} INFO - precision on WAKE: 0.990
[2024-01-06 19:42:06,902] {result_logger:109} INFO - recall on WAKE: 0.966
[2024-01-06 19:42:07,706] {result_logger:112} INFO - F1-score on WAKE: 0.978
[2024-01-06 19:42:07,706] {result_logger:113} INFO - 
[2024-01-06 19:42:08,919] {result_logger:108} INFO - precision on NREM: 0.957
[2024-01-06 19:42:09,714] {result_logger:109} INFO - recall on NREM: 0.963
[2024-01-06 19:42:10,514] {result_logger:112} INFO - F1-score on NREM: 0.960
[2024-01-06 19:42:10,515] {result_logger:113} INFO - 
[2024-01-06 19:42:11,678] {result_logger:108} INFO - precision on REM: 0.831
[2024-01-06 19:42:12,383] {result_logger:109} INFO - recall on REM: 0.970
[2024-01-06 19:42:13,098] {result_logger:112} INFO - F1-score on REM: 0.895
[2024-01-06 19:42:13,099] {result_logger:113} INFO - 
[2024-01-06 19:42:13,298] {result_logger:116} INFO - average precision on sleep stages: 0.926
[2024-01-06 19:42:13,495] {result_logger:118} INFO - average recall on sleep stages: 0.966
[2024-01-06 19:42:13,692] {result_logger:120} INFO - average F1-score on sleep stages: 0.944
[2024-01-06 19:42:14,212] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.966
[2024-01-06 19:42:14,240] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.965
[2024-01-06 19:42:14,243] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 19:42:14,407] {result_logger:108} INFO - precision on WAKE: 0.906
[2024-01-06 19:42:14,505] {result_logger:109} INFO - recall on WAKE: 0.940
[2024-01-06 19:42:14,603] {result_logger:112} INFO - F1-score on WAKE: 0.923
[2024-01-06 19:42:14,603] {result_logger:113} INFO - 
[2024-01-06 19:42:14,771] {result_logger:108} INFO - precision on NREM: 0.905
[2024-01-06 19:42:14,871] {result_logger:109} INFO - recall on NREM: 0.829
[2024-01-06 19:42:14,970] {result_logger:112} INFO - F1-score on NREM: 0.866
[2024-01-06 19:42:14,971] {result_logger:113} INFO - 
[2024-01-06 19:42:15,135] {result_logger:108} INFO - precision on REM: 0.710
[2024-01-06 19:42:15,235] {result_logger:109} INFO - recall on REM: 0.864
[2024-01-06 19:42:15,336] {result_logger:112} INFO - F1-score on REM: 0.779
[2024-01-06 19:42:15,336] {result_logger:113} INFO - 
[2024-01-06 19:42:15,356] {result_logger:116} INFO - average precision on sleep stages: 0.840
[2024-01-06 19:42:15,374] {result_logger:118} INFO - average recall on sleep stages: 0.878
[2024-01-06 19:42:15,392] {result_logger:120} INFO - average F1-score on sleep stages: 0.856
[2024-01-06 19:42:15,463] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.878
[2024-01-06 19:42:15,466] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.892
[2024-01-06 19:42:15,467] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 19:42:16,046] {result_logger:143} INFO - 
[[320645   9518   1886      6]
 [  3011 230444   5735      0]
 [   247    924  37500      0]
 [  1917    239     32      0]]
[2024-01-06 19:42:16,625] {result_logger:150} INFO - 
[[ 96.56%   2.87%   0.57%   0.00%]
 [  1.26%  96.34%   2.40%   0.00%]
 [  0.64%   2.39%  96.97%   0.00%]
 [ 87.61%  10.92%   1.46%   0.00%]]
[2024-01-06 19:42:17,208] {result_logger:154} INFO - 
[[ 98.41%   3.95%   4.18% 100.00%]
 [  0.92%  95.57%  12.70%   0.00%]
 [  0.08%   0.38%  83.05%   0.00%]
 [  0.59%   0.10%   0.07%   0.00%]]
[2024-01-06 19:42:17,208] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 19:42:17,286] {result_logger:143} INFO - 
[[45412  2655   252     0]
 [ 4358 29113  1634     0]
 [  339   388  4614     0]
 [  572   251    11     0]]
[2024-01-06 19:42:17,480] {result_logger:150} INFO - 
[[ 93.98%   5.49%   0.52%   0.00%]
 [ 12.41%  82.93%   4.65%   0.00%]
 [  6.35%   7.26%  86.39%   0.00%]
 [ 68.59%  30.10%   1.32%   0.00%]]
[2024-01-06 19:42:17,671] {result_logger:154} INFO - 
[[ 89.60%   8.19%   3.87%    nan%]
 [  8.60%  89.84%  25.10%    nan%]
 [  0.67%   1.20%  70.86%    nan%]
 [  1.13%   0.77%   0.17%    nan%]]
[2024-01-06 19:42:18,078] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 19:42:18,078] {result_logger:77} INFO - actual:
[2024-01-06 19:42:18,078] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 19:42:18,078] {result_logger:79} INFO - predicted:
[2024-01-06 19:42:18,078] {result_logger:80} INFO - 
[[95.37%  4.10%  0.52%  0.00%]
 [ 5.71% 92.22%  2.06%  0.00%]
 [ 7.56%  6.77% 85.67%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 19:42:18,115] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it3/model_8conv_2fc-best.pth
[2024-01-06 19:42:18,115] {run_experiment:113} INFO - [epoch  34] execution time: 214.24s	 avg f1-score: 0.8559

[2024-01-06 19:42:18,115] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 19:42:18,168] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 19:42:44,385] {train_model:86} INFO - Train Epoch: 35 [60928/612104 (10%)]	lr:3.75e-05	Loss: 0.084482
[2024-01-06 19:42:55,808] {train_model:86} INFO - Train Epoch: 35 [122112/612104 (20%)]	lr:3.75e-05	Loss: 0.249172
[2024-01-06 19:43:19,126] {train_model:86} INFO - Train Epoch: 35 [183296/612104 (30%)]	lr:3.75e-05	Loss: 0.045127
[2024-01-06 19:43:34,593] {train_model:86} INFO - Train Epoch: 35 [244480/612104 (40%)]	lr:3.75e-05	Loss: 0.052681
[2024-01-06 19:44:00,612] {train_model:86} INFO - Train Epoch: 35 [305664/612104 (50%)]	lr:3.75e-05	Loss: 0.068806
[2024-01-06 19:44:11,893] {train_model:86} INFO - Train Epoch: 35 [366848/612104 (60%)]	lr:3.75e-05	Loss: 0.137632
[2024-01-06 19:44:23,273] {train_model:86} INFO - Train Epoch: 35 [428032/612104 (70%)]	lr:3.75e-05	Loss: 0.118601
[2024-01-06 19:44:50,131] {train_model:86} INFO - Train Epoch: 35 [489216/612104 (80%)]	lr:3.75e-05	Loss: 0.121162
[2024-01-06 19:45:15,794] {train_model:86} INFO - Train Epoch: 35 [550400/612104 (90%)]	lr:3.75e-05	Loss: 0.098023
[2024-01-06 19:45:27,061] {train_model:86} INFO - Train Epoch: 35 [611584/612104 (100%)]	lr:3.75e-05	Loss: 0.050498
[2024-01-06 19:45:39,686] {run_experiment:78} INFO - 
[2024-01-06 19:45:39,694] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 19:45:40,937] {result_logger:108} INFO - precision on WAKE: 0.990
[2024-01-06 19:45:41,756] {result_logger:109} INFO - recall on WAKE: 0.966
[2024-01-06 19:45:42,584] {result_logger:112} INFO - F1-score on WAKE: 0.978
[2024-01-06 19:45:42,584] {result_logger:113} INFO - 
[2024-01-06 19:45:43,824] {result_logger:108} INFO - precision on NREM: 0.957
[2024-01-06 19:45:44,640] {result_logger:109} INFO - recall on NREM: 0.963
[2024-01-06 19:45:45,443] {result_logger:112} INFO - F1-score on NREM: 0.960
[2024-01-06 19:45:45,444] {result_logger:113} INFO - 
[2024-01-06 19:45:46,575] {result_logger:108} INFO - precision on REM: 0.832
[2024-01-06 19:45:47,286] {result_logger:109} INFO - recall on REM: 0.971
[2024-01-06 19:45:48,003] {result_logger:112} INFO - F1-score on REM: 0.896
[2024-01-06 19:45:48,004] {result_logger:113} INFO - 
[2024-01-06 19:45:48,191] {result_logger:116} INFO - average precision on sleep stages: 0.926
[2024-01-06 19:45:48,386] {result_logger:118} INFO - average recall on sleep stages: 0.967
[2024-01-06 19:45:48,583] {result_logger:120} INFO - average F1-score on sleep stages: 0.945
[2024-01-06 19:45:49,115] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.967
[2024-01-06 19:45:49,143] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.965
[2024-01-06 19:45:49,148] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 19:45:49,312] {result_logger:108} INFO - precision on WAKE: 0.901
[2024-01-06 19:45:49,409] {result_logger:109} INFO - recall on WAKE: 0.952
[2024-01-06 19:45:49,510] {result_logger:112} INFO - F1-score on WAKE: 0.926
[2024-01-06 19:45:49,510] {result_logger:113} INFO - 
[2024-01-06 19:45:49,676] {result_logger:108} INFO - precision on NREM: 0.903
[2024-01-06 19:45:49,777] {result_logger:109} INFO - recall on NREM: 0.837
[2024-01-06 19:45:49,877] {result_logger:112} INFO - F1-score on NREM: 0.869
[2024-01-06 19:45:49,878] {result_logger:113} INFO - 
[2024-01-06 19:45:50,040] {result_logger:108} INFO - precision on REM: 0.738
[2024-01-06 19:45:50,139] {result_logger:109} INFO - recall on REM: 0.716
[2024-01-06 19:45:50,239] {result_logger:112} INFO - F1-score on REM: 0.726
[2024-01-06 19:45:50,240] {result_logger:113} INFO - 
[2024-01-06 19:45:50,258] {result_logger:116} INFO - average precision on sleep stages: 0.847
[2024-01-06 19:45:50,276] {result_logger:118} INFO - average recall on sleep stages: 0.835
[2024-01-06 19:45:50,294] {result_logger:120} INFO - average F1-score on sleep stages: 0.840
[2024-01-06 19:45:50,364] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.835
[2024-01-06 19:45:50,366] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.892
[2024-01-06 19:45:50,367] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 19:45:50,932] {result_logger:143} INFO - 
[[320675   9410   1967      3]
 [  3097 230454   5638      1]
 [   248    854  37565      4]
 [  1920    239     29      0]]
[2024-01-06 19:45:51,501] {result_logger:150} INFO - 
[[ 96.57%   2.83%   0.59%   0.00%]
 [  1.29%  96.35%   2.36%   0.00%]
 [  0.64%   2.21%  97.14%   0.01%]
 [ 87.75%  10.92%   1.33%   0.00%]]
[2024-01-06 19:45:52,070] {result_logger:154} INFO - 
[[ 98.38%   3.91%   4.35%  37.50%]
 [  0.95%  95.64%  12.47%  12.50%]
 [  0.08%   0.35%  83.11%  50.00%]
 [  0.59%   0.10%   0.06%   0.00%]]
[2024-01-06 19:45:52,070] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 19:45:52,147] {result_logger:143} INFO - 
[[46013  2198   108     0]
 [ 4476 29378  1251     0]
 [  552   967  3822     0]
 [  646   180     8     0]]
[2024-01-06 19:45:52,345] {result_logger:150} INFO - 
[[ 95.23%   4.55%   0.22%   0.00%]
 [ 12.75%  83.69%   3.56%   0.00%]
 [ 10.34%  18.11%  71.56%   0.00%]
 [ 77.46%  21.58%   0.96%   0.00%]]
[2024-01-06 19:45:52,537] {result_logger:154} INFO - 
[[ 89.02%   6.72%   2.08%    nan%]
 [  8.66%  89.78%  24.11%    nan%]
 [  1.07%   2.96%  73.66%    nan%]
 [  1.25%   0.55%   0.15%    nan%]]
[2024-01-06 19:45:53,052] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 19:45:53,053] {result_logger:77} INFO - actual:
[2024-01-06 19:45:53,053] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 19:45:53,053] {result_logger:79} INFO - predicted:
[2024-01-06 19:45:53,053] {result_logger:80} INFO - 
[[95.52%  3.94%  0.54%  0.00%]
 [ 5.60% 92.72%  1.67%  0.00%]
 [ 9.31%  6.65% 84.04%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 19:45:53,089] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it3/model_8conv_2fc-best.pth
[2024-01-06 19:45:53,089] {run_experiment:113} INFO - [epoch  35] execution time: 214.97s	 avg f1-score: 0.8404

[2024-01-06 19:45:53,089] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 19:45:53,144] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 19:46:19,048] {train_model:86} INFO - Train Epoch: 36 [60928/612104 (10%)]	lr:3.53e-05	Loss: 0.049608
[2024-01-06 19:46:30,375] {train_model:86} INFO - Train Epoch: 36 [122112/612104 (20%)]	lr:3.53e-05	Loss: 0.050248
[2024-01-06 19:46:41,933] {train_model:86} INFO - Train Epoch: 36 [183296/612104 (30%)]	lr:3.53e-05	Loss: 0.038684
[2024-01-06 19:46:57,792] {train_model:86} INFO - Train Epoch: 36 [244480/612104 (40%)]	lr:3.53e-05	Loss: 0.096256
[2024-01-06 19:47:20,465] {train_model:86} INFO - Train Epoch: 36 [305664/612104 (50%)]	lr:3.53e-05	Loss: 0.066733
[2024-01-06 19:47:45,881] {train_model:86} INFO - Train Epoch: 36 [366848/612104 (60%)]	lr:3.53e-05	Loss: 0.115835
[2024-01-06 19:47:57,070] {train_model:86} INFO - Train Epoch: 36 [428032/612104 (70%)]	lr:3.53e-05	Loss: 0.228713
[2024-01-06 19:48:24,091] {train_model:86} INFO - Train Epoch: 36 [489216/612104 (80%)]	lr:3.53e-05	Loss: 0.068952
[2024-01-06 19:48:49,651] {train_model:86} INFO - Train Epoch: 36 [550400/612104 (90%)]	lr:3.53e-05	Loss: 0.070533
[2024-01-06 19:49:01,521] {train_model:86} INFO - Train Epoch: 36 [611584/612104 (100%)]	lr:3.53e-05	Loss: 0.078119
[2024-01-06 19:49:14,092] {run_experiment:78} INFO - 
[2024-01-06 19:49:14,098] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 19:49:15,335] {result_logger:108} INFO - precision on WAKE: 0.990
[2024-01-06 19:49:16,136] {result_logger:109} INFO - recall on WAKE: 0.966
[2024-01-06 19:49:16,945] {result_logger:112} INFO - F1-score on WAKE: 0.978
[2024-01-06 19:49:16,946] {result_logger:113} INFO - 
[2024-01-06 19:49:18,158] {result_logger:108} INFO - precision on NREM: 0.957
[2024-01-06 19:49:18,937] {result_logger:109} INFO - recall on NREM: 0.963
[2024-01-06 19:49:19,714] {result_logger:112} INFO - F1-score on NREM: 0.960
[2024-01-06 19:49:19,714] {result_logger:113} INFO - 
[2024-01-06 19:49:20,829] {result_logger:108} INFO - precision on REM: 0.831
[2024-01-06 19:49:21,544] {result_logger:109} INFO - recall on REM: 0.970
[2024-01-06 19:49:22,262] {result_logger:112} INFO - F1-score on REM: 0.895
[2024-01-06 19:49:22,262] {result_logger:113} INFO - 
[2024-01-06 19:49:22,451] {result_logger:116} INFO - average precision on sleep stages: 0.926
[2024-01-06 19:49:22,640] {result_logger:118} INFO - average recall on sleep stages: 0.966
[2024-01-06 19:49:22,828] {result_logger:120} INFO - average F1-score on sleep stages: 0.944
[2024-01-06 19:49:23,354] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.966
[2024-01-06 19:49:23,381] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.965
[2024-01-06 19:49:23,385] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 19:49:23,553] {result_logger:108} INFO - precision on WAKE: 0.909
[2024-01-06 19:49:23,657] {result_logger:109} INFO - recall on WAKE: 0.938
[2024-01-06 19:49:23,760] {result_logger:112} INFO - F1-score on WAKE: 0.923
[2024-01-06 19:49:23,760] {result_logger:113} INFO - 
[2024-01-06 19:49:23,923] {result_logger:108} INFO - precision on NREM: 0.924
[2024-01-06 19:49:24,026] {result_logger:109} INFO - recall on NREM: 0.833
[2024-01-06 19:49:24,128] {result_logger:112} INFO - F1-score on NREM: 0.876
[2024-01-06 19:49:24,129] {result_logger:113} INFO - 
[2024-01-06 19:49:24,294] {result_logger:108} INFO - precision on REM: 0.667
[2024-01-06 19:49:24,394] {result_logger:109} INFO - recall on REM: 0.906
[2024-01-06 19:49:24,493] {result_logger:112} INFO - F1-score on REM: 0.769
[2024-01-06 19:49:24,494] {result_logger:113} INFO - 
[2024-01-06 19:49:24,512] {result_logger:116} INFO - average precision on sleep stages: 0.833
[2024-01-06 19:49:24,530] {result_logger:118} INFO - average recall on sleep stages: 0.892
[2024-01-06 19:49:24,548] {result_logger:120} INFO - average F1-score on sleep stages: 0.856
[2024-01-06 19:49:24,619] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.892
[2024-01-06 19:49:24,622] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.894
[2024-01-06 19:49:24,622] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 19:49:25,201] {result_logger:143} INFO - 
[[320806   9342   1906      1]
 [  3111 230350   5729      0]
 [   235    921  37511      4]
 [  1916    240     32      0]]
[2024-01-06 19:49:25,765] {result_logger:150} INFO - 
[[ 96.61%   2.81%   0.57%   0.00%]
 [  1.30%  96.30%   2.40%   0.00%]
 [  0.61%   2.38%  97.00%   0.01%]
 [ 87.57%  10.97%   1.46%   0.00%]]
[2024-01-06 19:49:26,343] {result_logger:154} INFO - 
[[ 98.39%   3.88%   4.22%  20.00%]
 [  0.95%  95.64%  12.68%   0.00%]
 [  0.07%   0.38%  83.03%  80.00%]
 [  0.59%   0.10%   0.07%   0.00%]]
[2024-01-06 19:49:26,343] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 19:49:26,422] {result_logger:143} INFO - 
[[45310  2205   804     0]
 [ 4269 29225  1611     0]
 [  291   209  4841     0]
 [  609   174    51     0]]
[2024-01-06 19:49:26,622] {result_logger:150} INFO - 
[[ 93.77%   4.56%   1.66%   0.00%]
 [ 12.16%  83.25%   4.59%   0.00%]
 [  5.45%   3.91%  90.64%   0.00%]
 [ 73.02%  20.86%   6.12%   0.00%]]
[2024-01-06 19:49:26,817] {result_logger:154} INFO - 
[[ 89.76%   6.93%  11.00%    nan%]
 [  8.46%  91.86%  22.05%    nan%]
 [  0.58%   0.66%  66.25%    nan%]
 [  1.21%   0.55%   0.70%    nan%]]
[2024-01-06 19:49:27,236] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 19:49:27,236] {result_logger:77} INFO - actual:
[2024-01-06 19:49:27,236] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 19:49:27,236] {result_logger:79} INFO - predicted:
[2024-01-06 19:49:27,236] {result_logger:80} INFO - 
[[95.23%  3.83%  0.94%  0.00%]
 [ 5.30% 92.35%  2.36%  0.00%]
 [ 9.88%  6.90% 83.22%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 19:49:27,272] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it3/model_8conv_2fc-best.pth
[2024-01-06 19:49:27,273] {run_experiment:113} INFO - [epoch  36] execution time: 214.18s	 avg f1-score: 0.8557

[2024-01-06 19:49:27,273] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 19:49:27,327] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 19:49:53,545] {train_model:86} INFO - Train Epoch: 37 [60928/612104 (10%)]	lr:3.33e-05	Loss: 0.123828
[2024-01-06 19:50:05,174] {train_model:86} INFO - Train Epoch: 37 [122112/612104 (20%)]	lr:3.33e-05	Loss: 0.043177
[2024-01-06 19:50:16,670] {train_model:86} INFO - Train Epoch: 37 [183296/612104 (30%)]	lr:3.33e-05	Loss: 0.051923
[2024-01-06 19:50:27,946] {train_model:86} INFO - Train Epoch: 37 [244480/612104 (40%)]	lr:3.33e-05	Loss: 0.105986
[2024-01-06 19:50:53,356] {train_model:86} INFO - Train Epoch: 37 [305664/612104 (50%)]	lr:3.33e-05	Loss: 0.055379
[2024-01-06 19:51:06,148] {train_model:86} INFO - Train Epoch: 37 [366848/612104 (60%)]	lr:3.33e-05	Loss: 0.081790
[2024-01-06 19:51:31,349] {train_model:86} INFO - Train Epoch: 37 [428032/612104 (70%)]	lr:3.33e-05	Loss: 0.059658
[2024-01-06 19:51:58,109] {train_model:86} INFO - Train Epoch: 37 [489216/612104 (80%)]	lr:3.33e-05	Loss: 0.031275
[2024-01-06 19:52:23,676] {train_model:86} INFO - Train Epoch: 37 [550400/612104 (90%)]	lr:3.33e-05	Loss: 0.075381
[2024-01-06 19:52:35,722] {train_model:86} INFO - Train Epoch: 37 [611584/612104 (100%)]	lr:3.33e-05	Loss: 0.049923
[2024-01-06 19:52:48,032] {run_experiment:78} INFO - 
[2024-01-06 19:52:48,039] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 19:52:49,319] {result_logger:108} INFO - precision on WAKE: 0.990
[2024-01-06 19:52:50,136] {result_logger:109} INFO - recall on WAKE: 0.966
[2024-01-06 19:52:50,946] {result_logger:112} INFO - F1-score on WAKE: 0.978
[2024-01-06 19:52:50,946] {result_logger:113} INFO - 
[2024-01-06 19:52:52,166] {result_logger:108} INFO - precision on NREM: 0.957
[2024-01-06 19:52:52,975] {result_logger:109} INFO - recall on NREM: 0.964
[2024-01-06 19:52:53,776] {result_logger:112} INFO - F1-score on NREM: 0.961
[2024-01-06 19:52:53,776] {result_logger:113} INFO - 
[2024-01-06 19:52:54,915] {result_logger:108} INFO - precision on REM: 0.836
[2024-01-06 19:52:55,637] {result_logger:109} INFO - recall on REM: 0.972
[2024-01-06 19:52:56,352] {result_logger:112} INFO - F1-score on REM: 0.899
[2024-01-06 19:52:56,353] {result_logger:113} INFO - 
[2024-01-06 19:52:56,544] {result_logger:116} INFO - average precision on sleep stages: 0.928
[2024-01-06 19:52:56,729] {result_logger:118} INFO - average recall on sleep stages: 0.967
[2024-01-06 19:52:56,912] {result_logger:120} INFO - average F1-score on sleep stages: 0.946
[2024-01-06 19:52:57,420] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.967
[2024-01-06 19:52:57,446] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.966
[2024-01-06 19:52:57,451] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 19:52:57,613] {result_logger:108} INFO - precision on WAKE: 0.931
[2024-01-06 19:52:57,711] {result_logger:109} INFO - recall on WAKE: 0.899
[2024-01-06 19:52:57,811] {result_logger:112} INFO - F1-score on WAKE: 0.915
[2024-01-06 19:52:57,811] {result_logger:113} INFO - 
[2024-01-06 19:52:57,976] {result_logger:108} INFO - precision on NREM: 0.862
[2024-01-06 19:52:58,076] {result_logger:109} INFO - recall on NREM: 0.861
[2024-01-06 19:52:58,176] {result_logger:112} INFO - F1-score on NREM: 0.862
[2024-01-06 19:52:58,176] {result_logger:113} INFO - 
[2024-01-06 19:52:58,337] {result_logger:108} INFO - precision on REM: 0.675
[2024-01-06 19:52:58,437] {result_logger:109} INFO - recall on REM: 0.888
[2024-01-06 19:52:58,535] {result_logger:112} INFO - F1-score on REM: 0.767
[2024-01-06 19:52:58,535] {result_logger:113} INFO - 
[2024-01-06 19:52:58,554] {result_logger:116} INFO - average precision on sleep stages: 0.823
[2024-01-06 19:52:58,573] {result_logger:118} INFO - average recall on sleep stages: 0.883
[2024-01-06 19:52:58,592] {result_logger:120} INFO - average F1-score on sleep stages: 0.848
[2024-01-06 19:52:58,665] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.883
[2024-01-06 19:52:58,668] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.884
[2024-01-06 19:52:58,669] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 19:52:59,246] {result_logger:143} INFO - 
[[320702   9456   1895      2]
 [  2997 230698   5490      5]
 [   249    848  37573      1]
 [  1922    234     32      0]]
[2024-01-06 19:52:59,823] {result_logger:150} INFO - 
[[ 96.58%   2.85%   0.57%   0.00%]
 [  1.25%  96.45%   2.30%   0.00%]
 [  0.64%   2.19%  97.16%   0.00%]
 [ 87.84%  10.69%   1.46%   0.00%]]
[2024-01-06 19:53:00,399] {result_logger:154} INFO - 
[[ 98.41%   3.92%   4.21%  25.00%]
 [  0.92%  95.63%  12.20%  62.50%]
 [  0.08%   0.35%  83.51%  12.50%]
 [  0.59%   0.10%   0.07%   0.00%]]
[2024-01-06 19:53:00,399] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 19:53:00,475] {result_logger:143} INFO - 
[[43440  4438   441     0]
 [ 3024 30240  1841     0]
 [  210   386  4745     0]
 [  391   426    17     0]]
[2024-01-06 19:53:00,669] {result_logger:150} INFO - 
[[ 89.90%   9.18%   0.91%   0.00%]
 [  8.61%  86.14%   5.24%   0.00%]
 [  3.93%   7.23%  88.84%   0.00%]
 [ 46.88%  51.08%   2.04%   0.00%]]
[2024-01-06 19:53:00,860] {result_logger:154} INFO - 
[[ 92.30%  12.50%   6.26%    nan%]
 [  6.43%  85.21%  26.14%    nan%]
 [  0.45%   1.09%  67.36%    nan%]
 [  0.83%   1.20%   0.24%    nan%]]
[2024-01-06 19:53:01,262] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 19:53:01,262] {result_logger:77} INFO - actual:
[2024-01-06 19:53:01,262] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 19:53:01,262] {result_logger:79} INFO - predicted:
[2024-01-06 19:53:01,263] {result_logger:80} INFO - 
[[94.49%  4.88%  0.63%  0.00%]
 [ 5.84% 91.96%  2.20%  0.00%]
 [ 7.37%  7.95% 84.68%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 19:53:01,299] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it3/model_8conv_2fc-best.pth
[2024-01-06 19:53:01,299] {run_experiment:113} INFO - [epoch  37] execution time: 214.03s	 avg f1-score: 0.8479

[2024-01-06 19:53:01,299] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 19:53:01,353] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 19:53:27,299] {train_model:86} INFO - Train Epoch: 38 [60928/612104 (10%)]	lr:3.13e-05	Loss: 0.143536
[2024-01-06 19:53:38,645] {train_model:86} INFO - Train Epoch: 38 [122112/612104 (20%)]	lr:3.13e-05	Loss: 0.090370
[2024-01-06 19:53:49,951] {train_model:86} INFO - Train Epoch: 38 [183296/612104 (30%)]	lr:3.13e-05	Loss: 0.026165
[2024-01-06 19:54:01,773] {train_model:86} INFO - Train Epoch: 38 [244480/612104 (40%)]	lr:3.13e-05	Loss: 0.104254
[2024-01-06 19:54:13,248] {train_model:86} INFO - Train Epoch: 38 [305664/612104 (50%)]	lr:3.13e-05	Loss: 0.108993
[2024-01-06 19:54:26,124] {train_model:86} INFO - Train Epoch: 38 [366848/612104 (60%)]	lr:3.13e-05	Loss: 0.085996
[2024-01-06 19:54:51,736] {train_model:86} INFO - Train Epoch: 38 [428032/612104 (70%)]	lr:3.13e-05	Loss: 0.103175
[2024-01-06 19:55:17,426] {train_model:86} INFO - Train Epoch: 38 [489216/612104 (80%)]	lr:3.13e-05	Loss: 0.068382
[2024-01-06 19:55:44,572] {train_model:86} INFO - Train Epoch: 38 [550400/612104 (90%)]	lr:3.13e-05	Loss: 0.079177
[2024-01-06 19:56:10,416] {train_model:86} INFO - Train Epoch: 38 [611584/612104 (100%)]	lr:3.13e-05	Loss: 0.124398
[2024-01-06 19:56:22,788] {run_experiment:78} INFO - 
[2024-01-06 19:56:22,794] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 19:56:24,073] {result_logger:108} INFO - precision on WAKE: 0.990
[2024-01-06 19:56:24,893] {result_logger:109} INFO - recall on WAKE: 0.966
[2024-01-06 19:56:25,706] {result_logger:112} INFO - F1-score on WAKE: 0.978
[2024-01-06 19:56:25,706] {result_logger:113} INFO - 
[2024-01-06 19:56:26,951] {result_logger:108} INFO - precision on NREM: 0.957
[2024-01-06 19:56:27,760] {result_logger:109} INFO - recall on NREM: 0.965
[2024-01-06 19:56:28,580] {result_logger:112} INFO - F1-score on NREM: 0.961
[2024-01-06 19:56:28,580] {result_logger:113} INFO - 
[2024-01-06 19:56:29,730] {result_logger:108} INFO - precision on REM: 0.839
[2024-01-06 19:56:30,440] {result_logger:109} INFO - recall on REM: 0.971
[2024-01-06 19:56:31,155] {result_logger:112} INFO - F1-score on REM: 0.900
[2024-01-06 19:56:31,155] {result_logger:113} INFO - 
[2024-01-06 19:56:31,349] {result_logger:116} INFO - average precision on sleep stages: 0.929
[2024-01-06 19:56:31,543] {result_logger:118} INFO - average recall on sleep stages: 0.967
[2024-01-06 19:56:31,737] {result_logger:120} INFO - average F1-score on sleep stages: 0.946
[2024-01-06 19:56:32,270] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.967
[2024-01-06 19:56:32,298] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.966
[2024-01-06 19:56:32,301] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 19:56:32,461] {result_logger:108} INFO - precision on WAKE: 0.900
[2024-01-06 19:56:32,561] {result_logger:109} INFO - recall on WAKE: 0.952
[2024-01-06 19:56:32,660] {result_logger:112} INFO - F1-score on WAKE: 0.926
[2024-01-06 19:56:32,660] {result_logger:113} INFO - 
[2024-01-06 19:56:32,818] {result_logger:108} INFO - precision on NREM: 0.914
[2024-01-06 19:56:32,914] {result_logger:109} INFO - recall on NREM: 0.831
[2024-01-06 19:56:33,012] {result_logger:112} INFO - F1-score on NREM: 0.871
[2024-01-06 19:56:33,012] {result_logger:113} INFO - 
[2024-01-06 19:56:33,164] {result_logger:108} INFO - precision on REM: 0.753
[2024-01-06 19:56:33,262] {result_logger:109} INFO - recall on REM: 0.809
[2024-01-06 19:56:33,360] {result_logger:112} INFO - F1-score on REM: 0.780
[2024-01-06 19:56:33,360] {result_logger:113} INFO - 
[2024-01-06 19:56:33,378] {result_logger:116} INFO - average precision on sleep stages: 0.856
[2024-01-06 19:56:33,395] {result_logger:118} INFO - average recall on sleep stages: 0.864
[2024-01-06 19:56:33,412] {result_logger:120} INFO - average F1-score on sleep stages: 0.859
[2024-01-06 19:56:33,483] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.864
[2024-01-06 19:56:33,486] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.896
[2024-01-06 19:56:33,486] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 19:56:34,055] {result_logger:143} INFO - 
[[320880   9396   1774      5]
 [  3014 230726   5449      1]
 [   257    879  37533      2]
 [  1916    243     29      0]]
[2024-01-06 19:56:34,634] {result_logger:150} INFO - 
[[ 96.63%   2.83%   0.53%   0.00%]
 [  1.26%  96.46%   2.28%   0.00%]
 [  0.66%   2.27%  97.06%   0.01%]
 [ 87.57%  11.11%   1.33%   0.00%]]
[2024-01-06 19:56:35,211] {result_logger:154} INFO - 
[[ 98.41%   3.89%   3.96%  62.50%]
 [  0.92%  95.64%  12.17%  12.50%]
 [  0.08%   0.36%  83.81%  25.00%]
 [  0.59%   0.10%   0.06%   0.00%]]
[2024-01-06 19:56:35,211] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 19:56:35,288] {result_logger:143} INFO - 
[[46013  2178   128     0]
 [ 4634 29179  1292     0]
 [  467   552  4322     0]
 [  637   188     9     0]]
[2024-01-06 19:56:35,475] {result_logger:150} INFO - 
[[ 95.23%   4.51%   0.26%   0.00%]
 [ 13.20%  83.12%   3.68%   0.00%]
 [  8.74%  10.34%  80.92%   0.00%]
 [ 76.38%  22.54%   1.08%   0.00%]]
[2024-01-06 19:56:35,662] {result_logger:154} INFO - 
[[ 88.91%   6.79%   2.23%    nan%]
 [  8.95%  90.91%  22.47%    nan%]
 [  0.90%   1.72%  75.15%    nan%]
 [  1.23%   0.59%   0.16%    nan%]]
[2024-01-06 19:56:36,068] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 19:56:36,068] {result_logger:77} INFO - actual:
[2024-01-06 19:56:36,068] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 19:56:36,068] {result_logger:79} INFO - predicted:
[2024-01-06 19:56:36,068] {result_logger:80} INFO - 
[[95.59%  3.97%  0.44%  0.00%]
 [ 5.65% 92.52%  1.83%  0.00%]
 [ 8.09%  6.10% 85.81%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 19:56:36,105] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it3/model_8conv_2fc-best.pth
[2024-01-06 19:56:36,105] {run_experiment:113} INFO - [epoch  38] execution time: 214.81s	 avg f1-score: 0.8588

[2024-01-06 19:56:36,105] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 19:56:36,159] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 19:57:02,268] {train_model:86} INFO - Train Epoch: 39 [60928/612104 (10%)]	lr:2.95e-05	Loss: 0.076123
[2024-01-06 19:57:13,812] {train_model:86} INFO - Train Epoch: 39 [122112/612104 (20%)]	lr:2.95e-05	Loss: 0.107508
[2024-01-06 19:57:25,007] {train_model:86} INFO - Train Epoch: 39 [183296/612104 (30%)]	lr:2.95e-05	Loss: 0.133041
[2024-01-06 19:57:36,041] {train_model:86} INFO - Train Epoch: 39 [244480/612104 (40%)]	lr:2.95e-05	Loss: 0.046910
[2024-01-06 19:57:47,439] {train_model:86} INFO - Train Epoch: 39 [305664/612104 (50%)]	lr:2.95e-05	Loss: 0.057130
[2024-01-06 19:57:58,735] {train_model:86} INFO - Train Epoch: 39 [366848/612104 (60%)]	lr:2.95e-05	Loss: 0.070601
[2024-01-06 19:58:25,598] {train_model:86} INFO - Train Epoch: 39 [428032/612104 (70%)]	lr:2.95e-05	Loss: 0.061557
[2024-01-06 19:58:37,376] {train_model:86} INFO - Train Epoch: 39 [489216/612104 (80%)]	lr:2.95e-05	Loss: 0.048077
[2024-01-06 19:59:18,585] {train_model:86} INFO - Train Epoch: 39 [550400/612104 (90%)]	lr:2.95e-05	Loss: 0.078830
[2024-01-06 19:59:43,955] {train_model:86} INFO - Train Epoch: 39 [611584/612104 (100%)]	lr:2.95e-05	Loss: 0.051542
[2024-01-06 19:59:56,116] {run_experiment:78} INFO - 
[2024-01-06 19:59:56,123] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 19:59:57,395] {result_logger:108} INFO - precision on WAKE: 0.990
[2024-01-06 19:59:58,226] {result_logger:109} INFO - recall on WAKE: 0.967
[2024-01-06 19:59:59,060] {result_logger:112} INFO - F1-score on WAKE: 0.978
[2024-01-06 19:59:59,060] {result_logger:113} INFO - 
[2024-01-06 20:00:00,319] {result_logger:108} INFO - precision on NREM: 0.958
[2024-01-06 20:00:01,122] {result_logger:109} INFO - recall on NREM: 0.965
[2024-01-06 20:00:01,944] {result_logger:112} INFO - F1-score on NREM: 0.961
[2024-01-06 20:00:01,944] {result_logger:113} INFO - 
[2024-01-06 20:00:03,080] {result_logger:108} INFO - precision on REM: 0.841
[2024-01-06 20:00:03,780] {result_logger:109} INFO - recall on REM: 0.972
[2024-01-06 20:00:04,492] {result_logger:112} INFO - F1-score on REM: 0.902
[2024-01-06 20:00:04,493] {result_logger:113} INFO - 
[2024-01-06 20:00:04,680] {result_logger:116} INFO - average precision on sleep stages: 0.930
[2024-01-06 20:00:04,868] {result_logger:118} INFO - average recall on sleep stages: 0.968
[2024-01-06 20:00:05,057] {result_logger:120} INFO - average F1-score on sleep stages: 0.947
[2024-01-06 20:00:05,561] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.968
[2024-01-06 20:00:05,586] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.966
[2024-01-06 20:00:05,590] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 20:00:05,748] {result_logger:108} INFO - precision on WAKE: 0.923
[2024-01-06 20:00:05,845] {result_logger:109} INFO - recall on WAKE: 0.883
[2024-01-06 20:00:05,945] {result_logger:112} INFO - F1-score on WAKE: 0.902
[2024-01-06 20:00:05,945] {result_logger:113} INFO - 
[2024-01-06 20:00:06,106] {result_logger:108} INFO - precision on NREM: 0.915
[2024-01-06 20:00:06,207] {result_logger:109} INFO - recall on NREM: 0.842
[2024-01-06 20:00:06,307] {result_logger:112} INFO - F1-score on NREM: 0.877
[2024-01-06 20:00:06,307] {result_logger:113} INFO - 
[2024-01-06 20:00:06,473] {result_logger:108} INFO - precision on REM: 0.495
[2024-01-06 20:00:06,575] {result_logger:109} INFO - recall on REM: 0.947
[2024-01-06 20:00:06,677] {result_logger:112} INFO - F1-score on REM: 0.650
[2024-01-06 20:00:06,677] {result_logger:113} INFO - 
[2024-01-06 20:00:06,695] {result_logger:116} INFO - average precision on sleep stages: 0.778
[2024-01-06 20:00:06,713] {result_logger:118} INFO - average recall on sleep stages: 0.891
[2024-01-06 20:00:06,731] {result_logger:120} INFO - average F1-score on sleep stages: 0.810
[2024-01-06 20:00:06,799] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.891
[2024-01-06 20:00:06,802] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.871
[2024-01-06 20:00:06,803] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 20:00:07,355] {result_logger:143} INFO - 
[[320972   9342   1735      6]
 [  3092 230751   5345      2]
 [   243    853  37574      1]
 [  1922    237     29      0]]
[2024-01-06 20:00:07,918] {result_logger:150} INFO - 
[[ 96.66%   2.81%   0.52%   0.00%]
 [  1.29%  96.47%   2.23%   0.00%]
 [  0.63%   2.21%  97.16%   0.00%]
 [ 87.84%  10.83%   1.33%   0.00%]]
[2024-01-06 20:00:08,467] {result_logger:154} INFO - 
[[ 98.39%   3.87%   3.88%  66.67%]
 [  0.95%  95.67%  11.96%  22.22%]
 [  0.07%   0.35%  84.09%  11.11%]
 [  0.59%   0.10%   0.06%   0.00%]]
[2024-01-06 20:00:08,467] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 20:00:08,543] {result_logger:143} INFO - 
[[42646  2606  3067     0]
 [ 3448 29567  2090     0]
 [  128   153  5060     0]
 [  423   232   179     0]]
[2024-01-06 20:00:08,736] {result_logger:150} INFO - 
[[ 88.26%   5.39%   6.35%   0.00%]
 [  9.82%  84.22%   5.95%   0.00%]
 [  2.40%   2.86%  94.74%   0.00%]
 [ 50.72%  27.82%  21.46%   0.00%]]
[2024-01-06 20:00:09,019] {result_logger:154} INFO - 
[[ 91.43%   8.00%  29.50%    nan%]
 [  7.39%  90.81%  20.10%    nan%]
 [  0.27%   0.47%  48.67%    nan%]
 [  0.91%   0.71%   1.72%    nan%]]
[2024-01-06 20:00:09,418] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 20:00:09,418] {result_logger:77} INFO - actual:
[2024-01-06 20:00:09,419] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 20:00:09,419] {result_logger:79} INFO - predicted:
[2024-01-06 20:00:09,419] {result_logger:80} INFO - 
[[93.96%  3.85%  2.19%  0.00%]
 [ 4.69% 92.03%  3.28%  0.00%]
 [12.40%  7.69% 79.92%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 20:00:09,455] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it3/model_8conv_2fc-best.pth
[2024-01-06 20:00:09,456] {run_experiment:113} INFO - [epoch  39] execution time: 213.35s	 avg f1-score: 0.8099

[2024-01-06 20:00:09,456] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 20:00:09,512] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 20:00:35,488] {train_model:86} INFO - Train Epoch: 40 [60928/612104 (10%)]	lr:2.78e-05	Loss: 0.086831
[2024-01-06 20:00:46,808] {train_model:86} INFO - Train Epoch: 40 [122112/612104 (20%)]	lr:2.78e-05	Loss: 0.099084
[2024-01-06 20:00:58,087] {train_model:86} INFO - Train Epoch: 40 [183296/612104 (30%)]	lr:2.78e-05	Loss: 0.177321
[2024-01-06 20:01:09,797] {train_model:86} INFO - Train Epoch: 40 [244480/612104 (40%)]	lr:2.78e-05	Loss: 0.049438
[2024-01-06 20:01:21,745] {train_model:86} INFO - Train Epoch: 40 [305664/612104 (50%)]	lr:2.78e-05	Loss: 0.035749
[2024-01-06 20:01:33,384] {train_model:86} INFO - Train Epoch: 40 [366848/612104 (60%)]	lr:2.78e-05	Loss: 0.058359
[2024-01-06 20:01:44,835] {train_model:86} INFO - Train Epoch: 40 [428032/612104 (70%)]	lr:2.78e-05	Loss: 0.063918
[2024-01-06 20:02:11,991] {train_model:86} INFO - Train Epoch: 40 [489216/612104 (80%)]	lr:2.78e-05	Loss: 0.036502
[2024-01-06 20:02:40,051] {train_model:86} INFO - Train Epoch: 40 [550400/612104 (90%)]	lr:2.78e-05	Loss: 0.107975
[2024-01-06 20:03:05,795] {train_model:86} INFO - Train Epoch: 40 [611584/612104 (100%)]	lr:2.78e-05	Loss: 0.096462
[2024-01-06 20:03:18,121] {run_experiment:78} INFO - 
[2024-01-06 20:03:18,128] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 20:03:19,381] {result_logger:108} INFO - precision on WAKE: 0.990
[2024-01-06 20:03:20,202] {result_logger:109} INFO - recall on WAKE: 0.966
[2024-01-06 20:03:21,010] {result_logger:112} INFO - F1-score on WAKE: 0.978
[2024-01-06 20:03:21,010] {result_logger:113} INFO - 
[2024-01-06 20:03:22,211] {result_logger:108} INFO - precision on NREM: 0.958
[2024-01-06 20:03:23,000] {result_logger:109} INFO - recall on NREM: 0.965
[2024-01-06 20:03:23,782] {result_logger:112} INFO - F1-score on NREM: 0.961
[2024-01-06 20:03:23,782] {result_logger:113} INFO - 
[2024-01-06 20:03:24,943] {result_logger:108} INFO - precision on REM: 0.841
[2024-01-06 20:03:25,658] {result_logger:109} INFO - recall on REM: 0.974
[2024-01-06 20:03:26,379] {result_logger:112} INFO - F1-score on REM: 0.902
[2024-01-06 20:03:26,379] {result_logger:113} INFO - 
[2024-01-06 20:03:26,569] {result_logger:116} INFO - average precision on sleep stages: 0.929
[2024-01-06 20:03:26,761] {result_logger:118} INFO - average recall on sleep stages: 0.968
[2024-01-06 20:03:26,955] {result_logger:120} INFO - average F1-score on sleep stages: 0.947
[2024-01-06 20:03:27,474] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.968
[2024-01-06 20:03:27,500] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.966
[2024-01-06 20:03:27,503] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 20:03:27,660] {result_logger:108} INFO - precision on WAKE: 0.905
[2024-01-06 20:03:27,759] {result_logger:109} INFO - recall on WAKE: 0.944
[2024-01-06 20:03:27,858] {result_logger:112} INFO - F1-score on WAKE: 0.924
[2024-01-06 20:03:27,858] {result_logger:113} INFO - 
[2024-01-06 20:03:28,018] {result_logger:108} INFO - precision on NREM: 0.929
[2024-01-06 20:03:28,116] {result_logger:109} INFO - recall on NREM: 0.828
[2024-01-06 20:03:28,218] {result_logger:112} INFO - F1-score on NREM: 0.876
[2024-01-06 20:03:28,218] {result_logger:113} INFO - 
[2024-01-06 20:03:28,375] {result_logger:108} INFO - precision on REM: 0.673
[2024-01-06 20:03:28,474] {result_logger:109} INFO - recall on REM: 0.894
[2024-01-06 20:03:28,574] {result_logger:112} INFO - F1-score on REM: 0.768
[2024-01-06 20:03:28,574] {result_logger:113} INFO - 
[2024-01-06 20:03:28,592] {result_logger:116} INFO - average precision on sleep stages: 0.836
[2024-01-06 20:03:28,610] {result_logger:118} INFO - average recall on sleep stages: 0.889
[2024-01-06 20:03:28,629] {result_logger:120} INFO - average F1-score on sleep stages: 0.856
[2024-01-06 20:03:28,700] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.889
[2024-01-06 20:03:28,703] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.895
[2024-01-06 20:03:28,703] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 20:03:29,270] {result_logger:143} INFO - 
[[320885   9386   1778      6]
 [  3029 230807   5354      0]
 [   207    810  37652      2]
 [  1925    235     28      0]]
[2024-01-06 20:03:29,840] {result_logger:150} INFO - 
[[ 96.64%   2.83%   0.54%   0.00%]
 [  1.27%  96.50%   2.24%   0.00%]
 [  0.54%   2.09%  97.36%   0.01%]
 [ 87.98%  10.74%   1.28%   0.00%]]
[2024-01-06 20:03:30,414] {result_logger:154} INFO - 
[[ 98.42%   3.89%   3.97%  75.00%]
 [  0.93%  95.68%  11.95%   0.00%]
 [  0.06%   0.34%  84.02%  25.00%]
 [  0.59%   0.10%   0.06%   0.00%]]
[2024-01-06 20:03:30,414] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 20:03:30,492] {result_logger:143} INFO - 
[[45600  2028   691     0]
 [ 4405 29074  1626     0]
 [  356   209  4776     0]
 [  630   165    39     0]]
[2024-01-06 20:03:30,691] {result_logger:150} INFO - 
[[ 94.37%   4.20%   1.43%   0.00%]
 [ 12.55%  82.82%   4.63%   0.00%]
 [  6.67%   3.91%  89.42%   0.00%]
 [ 75.54%  19.78%   4.68%   0.00%]]
[2024-01-06 20:03:30,884] {result_logger:154} INFO - 
[[ 89.43%   6.44%   9.69%    nan%]
 [  8.64%  92.37%  22.80%    nan%]
 [  0.70%   0.66%  66.97%    nan%]
 [  1.24%   0.52%   0.55%    nan%]]
[2024-01-06 20:03:31,294] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 20:03:31,294] {result_logger:77} INFO - actual:
[2024-01-06 20:03:31,294] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 20:03:31,295] {result_logger:79} INFO - predicted:
[2024-01-06 20:03:31,295] {result_logger:80} INFO - 
[[95.35%  3.78%  0.86%  0.00%]
 [ 5.34% 92.41%  2.25%  0.00%]
 [ 9.63%  6.48% 83.89%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 20:03:31,337] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it3/model_8conv_2fc-best.pth
[2024-01-06 20:03:31,337] {run_experiment:113} INFO - [epoch  40] execution time: 201.88s	 avg f1-score: 0.8560

[2024-01-06 20:03:31,337] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 20:03:31,391] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 20:03:57,530] {train_model:86} INFO - Train Epoch: 41 [60928/612104 (10%)]	lr:2.62e-05	Loss: 0.032650
[2024-01-06 20:04:08,998] {train_model:86} INFO - Train Epoch: 41 [122112/612104 (20%)]	lr:2.62e-05	Loss: 0.060528
[2024-01-06 20:04:20,638] {train_model:86} INFO - Train Epoch: 41 [183296/612104 (30%)]	lr:2.62e-05	Loss: 0.134849
[2024-01-06 20:04:31,887] {train_model:86} INFO - Train Epoch: 41 [244480/612104 (40%)]	lr:2.62e-05	Loss: 0.056834
[2024-01-06 20:04:43,431] {train_model:86} INFO - Train Epoch: 41 [305664/612104 (50%)]	lr:2.62e-05	Loss: 0.039283
[2024-01-06 20:04:54,452] {train_model:86} INFO - Train Epoch: 41 [366848/612104 (60%)]	lr:2.62e-05	Loss: 0.135452
[2024-01-06 20:05:05,829] {train_model:86} INFO - Train Epoch: 41 [428032/612104 (70%)]	lr:2.62e-05	Loss: 0.080584
[2024-01-06 20:05:17,106] {train_model:86} INFO - Train Epoch: 41 [489216/612104 (80%)]	lr:2.62e-05	Loss: 0.082716
[2024-01-06 20:05:28,700] {train_model:86} INFO - Train Epoch: 41 [550400/612104 (90%)]	lr:2.62e-05	Loss: 0.028258
[2024-01-06 20:06:32,849] {train_model:86} INFO - Train Epoch: 41 [611584/612104 (100%)]	lr:2.62e-05	Loss: 0.067249
[2024-01-06 20:06:45,596] {run_experiment:78} INFO - 
[2024-01-06 20:06:45,602] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 20:06:46,855] {result_logger:108} INFO - precision on WAKE: 0.990
[2024-01-06 20:06:47,675] {result_logger:109} INFO - recall on WAKE: 0.967
[2024-01-06 20:06:48,488] {result_logger:112} INFO - F1-score on WAKE: 0.978
[2024-01-06 20:06:48,489] {result_logger:113} INFO - 
[2024-01-06 20:06:49,707] {result_logger:108} INFO - precision on NREM: 0.958
[2024-01-06 20:06:50,513] {result_logger:109} INFO - recall on NREM: 0.965
[2024-01-06 20:06:51,335] {result_logger:112} INFO - F1-score on NREM: 0.962
[2024-01-06 20:06:51,335] {result_logger:113} INFO - 
[2024-01-06 20:06:52,449] {result_logger:108} INFO - precision on REM: 0.844
[2024-01-06 20:06:53,155] {result_logger:109} INFO - recall on REM: 0.972
[2024-01-06 20:06:53,874] {result_logger:112} INFO - F1-score on REM: 0.903
[2024-01-06 20:06:53,874] {result_logger:113} INFO - 
[2024-01-06 20:06:54,069] {result_logger:116} INFO - average precision on sleep stages: 0.930
[2024-01-06 20:06:54,265] {result_logger:118} INFO - average recall on sleep stages: 0.968
[2024-01-06 20:06:54,460] {result_logger:120} INFO - average F1-score on sleep stages: 0.948
[2024-01-06 20:06:54,995] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.968
[2024-01-06 20:06:55,022] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.966
[2024-01-06 20:06:55,028] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 20:06:55,191] {result_logger:108} INFO - precision on WAKE: 0.907
[2024-01-06 20:06:55,294] {result_logger:109} INFO - recall on WAKE: 0.889
[2024-01-06 20:06:55,398] {result_logger:112} INFO - F1-score on WAKE: 0.898
[2024-01-06 20:06:55,398] {result_logger:113} INFO - 
[2024-01-06 20:06:55,568] {result_logger:108} INFO - precision on NREM: 0.920
[2024-01-06 20:06:55,667] {result_logger:109} INFO - recall on NREM: 0.832
[2024-01-06 20:06:55,767] {result_logger:112} INFO - F1-score on NREM: 0.874
[2024-01-06 20:06:55,767] {result_logger:113} INFO - 
[2024-01-06 20:06:55,932] {result_logger:108} INFO - precision on REM: 0.501
[2024-01-06 20:06:56,032] {result_logger:109} INFO - recall on REM: 0.909
[2024-01-06 20:06:56,132] {result_logger:112} INFO - F1-score on REM: 0.646
[2024-01-06 20:06:56,133] {result_logger:113} INFO - 
[2024-01-06 20:06:56,152] {result_logger:116} INFO - average precision on sleep stages: 0.776
[2024-01-06 20:06:56,171] {result_logger:118} INFO - average recall on sleep stages: 0.877
[2024-01-06 20:06:56,190] {result_logger:120} INFO - average F1-score on sleep stages: 0.806
[2024-01-06 20:06:56,263] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.877
[2024-01-06 20:06:56,266] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.868
[2024-01-06 20:06:56,266] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 20:06:56,861] {result_logger:143} INFO - 
[[320972   9338   1743      2]
 [  3066 230903   5220      1]
 [   249    841  37580      1]
 [  1924    237     26      1]]
[2024-01-06 20:06:57,450] {result_logger:150} INFO - 
[[ 96.66%   2.81%   0.52%   0.00%]
 [  1.28%  96.54%   2.18%   0.00%]
 [  0.64%   2.17%  97.18%   0.00%]
 [ 87.93%  10.83%   1.19%   0.05%]]
[2024-01-06 20:06:58,038] {result_logger:154} INFO - 
[[ 98.39%   3.87%   3.91%  40.00%]
 [  0.94%  95.68%  11.71%  20.00%]
 [  0.08%   0.35%  84.32%  20.00%]
 [  0.59%   0.10%   0.06%  20.00%]]
[2024-01-06 20:06:58,038] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 20:06:58,113] {result_logger:143} INFO - 
[[42933  2287  3099     0]
 [ 4155 29220  1730     0]
 [  246   239  4856     0]
 [  471   176   187     0]]
[2024-01-06 20:06:58,303] {result_logger:150} INFO - 
[[ 88.85%   4.73%   6.41%   0.00%]
 [ 11.84%  83.24%   4.93%   0.00%]
 [  4.61%   4.47%  90.92%   0.00%]
 [ 56.47%  21.10%  22.42%   0.00%]]
[2024-01-06 20:06:58,496] {result_logger:154} INFO - 
[[ 89.81%   7.16%  31.39%    nan%]
 [  8.69%  91.54%  17.52%    nan%]
 [  0.51%   0.75%  49.19%    nan%]
 [  0.99%   0.55%   1.89%    nan%]]
[2024-01-06 20:06:58,893] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 20:06:58,893] {result_logger:77} INFO - actual:
[2024-01-06 20:06:58,894] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 20:06:58,894] {result_logger:79} INFO - predicted:
[2024-01-06 20:06:58,894] {result_logger:80} INFO - 
[[93.88%  3.69%  2.44%  0.00%]
 [ 4.82% 92.32%  2.86%  0.00%]
 [14.05%  7.01% 78.94%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 20:06:58,928] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it3/model_8conv_2fc-best.pth
[2024-01-06 20:06:58,928] {run_experiment:113} INFO - [epoch  41] execution time: 207.59s	 avg f1-score: 0.8061

[2024-01-06 20:06:58,928] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 20:06:58,982] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 20:07:24,929] {train_model:86} INFO - Train Epoch: 42 [60928/612104 (10%)]	lr:2.47e-05	Loss: 0.078587
[2024-01-06 20:07:36,156] {train_model:86} INFO - Train Epoch: 42 [122112/612104 (20%)]	lr:2.47e-05	Loss: 0.078001
[2024-01-06 20:07:47,615] {train_model:86} INFO - Train Epoch: 42 [183296/612104 (30%)]	lr:2.47e-05	Loss: 0.043006
[2024-01-06 20:07:58,961] {train_model:86} INFO - Train Epoch: 42 [244480/612104 (40%)]	lr:2.47e-05	Loss: 0.055484
[2024-01-06 20:08:10,641] {train_model:86} INFO - Train Epoch: 42 [305664/612104 (50%)]	lr:2.47e-05	Loss: 0.042457
[2024-01-06 20:08:22,307] {train_model:86} INFO - Train Epoch: 42 [366848/612104 (60%)]	lr:2.47e-05	Loss: 0.103993
[2024-01-06 20:08:33,763] {train_model:86} INFO - Train Epoch: 42 [428032/612104 (70%)]	lr:2.47e-05	Loss: 0.081566
[2024-01-06 20:08:45,101] {train_model:86} INFO - Train Epoch: 42 [489216/612104 (80%)]	lr:2.47e-05	Loss: 0.038491
[2024-01-06 20:08:56,379] {train_model:86} INFO - Train Epoch: 42 [550400/612104 (90%)]	lr:2.47e-05	Loss: 0.118071
[2024-01-06 20:09:57,422] {train_model:86} INFO - Train Epoch: 42 [611584/612104 (100%)]	lr:2.47e-05	Loss: 0.064269
[2024-01-06 20:10:09,926] {run_experiment:78} INFO - 
[2024-01-06 20:10:09,933] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 20:10:11,174] {result_logger:108} INFO - precision on WAKE: 0.990
[2024-01-06 20:10:11,970] {result_logger:109} INFO - recall on WAKE: 0.966
[2024-01-06 20:10:12,771] {result_logger:112} INFO - F1-score on WAKE: 0.978
[2024-01-06 20:10:12,771] {result_logger:113} INFO - 
[2024-01-06 20:10:14,000] {result_logger:108} INFO - precision on NREM: 0.958
[2024-01-06 20:10:14,794] {result_logger:109} INFO - recall on NREM: 0.965
[2024-01-06 20:10:15,588] {result_logger:112} INFO - F1-score on NREM: 0.961
[2024-01-06 20:10:15,588] {result_logger:113} INFO - 
[2024-01-06 20:10:16,716] {result_logger:108} INFO - precision on REM: 0.845
[2024-01-06 20:10:17,411] {result_logger:109} INFO - recall on REM: 0.972
[2024-01-06 20:10:18,097] {result_logger:112} INFO - F1-score on REM: 0.904
[2024-01-06 20:10:18,097] {result_logger:113} INFO - 
[2024-01-06 20:10:18,271] {result_logger:116} INFO - average precision on sleep stages: 0.931
[2024-01-06 20:10:18,452] {result_logger:118} INFO - average recall on sleep stages: 0.968
[2024-01-06 20:10:18,632] {result_logger:120} INFO - average F1-score on sleep stages: 0.948
[2024-01-06 20:10:19,142] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.968
[2024-01-06 20:10:19,168] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.966
[2024-01-06 20:10:19,173] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 20:10:19,332] {result_logger:108} INFO - precision on WAKE: 0.900
[2024-01-06 20:10:19,429] {result_logger:109} INFO - recall on WAKE: 0.915
[2024-01-06 20:10:19,526] {result_logger:112} INFO - F1-score on WAKE: 0.907
[2024-01-06 20:10:19,526] {result_logger:113} INFO - 
[2024-01-06 20:10:19,688] {result_logger:108} INFO - precision on NREM: 0.930
[2024-01-06 20:10:19,786] {result_logger:109} INFO - recall on NREM: 0.824
[2024-01-06 20:10:19,880] {result_logger:112} INFO - F1-score on NREM: 0.874
[2024-01-06 20:10:19,880] {result_logger:113} INFO - 
[2024-01-06 20:10:20,041] {result_logger:108} INFO - precision on REM: 0.564
[2024-01-06 20:10:20,138] {result_logger:109} INFO - recall on REM: 0.900
[2024-01-06 20:10:20,234] {result_logger:112} INFO - F1-score on REM: 0.693
[2024-01-06 20:10:20,235] {result_logger:113} INFO - 
[2024-01-06 20:10:20,253] {result_logger:116} INFO - average precision on sleep stages: 0.798
[2024-01-06 20:10:20,270] {result_logger:118} INFO - average recall on sleep stages: 0.880
[2024-01-06 20:10:20,288] {result_logger:120} INFO - average F1-score on sleep stages: 0.825
[2024-01-06 20:10:20,358] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.880
[2024-01-06 20:10:20,360] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.878
[2024-01-06 20:10:20,361] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 20:10:20,914] {result_logger:143} INFO - 
[[320915   9392   1746      2]
 [  3134 230894   5162      0]
 [   232    837  37597      5]
 [  1920    238     30      0]]
[2024-01-06 20:10:21,478] {result_logger:150} INFO - 
[[ 96.65%   2.83%   0.53%   0.00%]
 [  1.31%  96.53%   2.16%   0.00%]
 [  0.60%   2.16%  97.22%   0.01%]
 [ 87.75%  10.88%   1.37%   0.00%]]
[2024-01-06 20:10:22,046] {result_logger:154} INFO - 
[[ 98.38%   3.89%   3.92%  28.57%]
 [  0.96%  95.66%  11.59%   0.00%]
 [  0.07%   0.35%  84.42%  71.43%]
 [  0.59%   0.10%   0.07%   0.00%]]
[2024-01-06 20:10:22,046] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 20:10:22,121] {result_logger:143} INFO - 
[[44233  1969  2117     0]
 [ 4596 28909  1600     0]
 [  336   200  4805     0]
 [  553   129   152     0]]
[2024-01-06 20:10:22,303] {result_logger:150} INFO - 
[[ 91.54%   4.08%   4.38%   0.00%]
 [ 13.09%  82.35%   4.56%   0.00%]
 [  6.29%   3.74%  89.96%   0.00%]
 [ 66.31%  15.47%  18.23%   0.00%]]
[2024-01-06 20:10:22,493] {result_logger:154} INFO - 
[[ 88.97%   6.31%  24.41%    nan%]
 [  9.24%  92.64%  18.45%    nan%]
 [  0.68%   0.64%  55.40%    nan%]
 [  1.11%   0.41%   1.75%    nan%]]
[2024-01-06 20:10:22,895] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 20:10:22,896] {result_logger:77} INFO - actual:
[2024-01-06 20:10:22,896] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 20:10:22,896] {result_logger:79} INFO - predicted:
[2024-01-06 20:10:22,896] {result_logger:80} INFO - 
[[94.59%  3.48%  1.93%  0.00%]
 [ 4.84% 92.63%  2.53%  0.00%]
 [13.60%  6.58% 79.81%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 20:10:22,931] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it3/model_8conv_2fc-best.pth
[2024-01-06 20:10:22,932] {run_experiment:113} INFO - [epoch  42] execution time: 204.00s	 avg f1-score: 0.8248

[2024-01-06 20:10:22,932] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 20:10:22,986] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 20:10:48,987] {train_model:86} INFO - Train Epoch: 43 [60928/612104 (10%)]	lr:2.32e-05	Loss: 0.055050
[2024-01-06 20:11:00,643] {train_model:86} INFO - Train Epoch: 43 [122112/612104 (20%)]	lr:2.32e-05	Loss: 0.140005
[2024-01-06 20:11:12,339] {train_model:86} INFO - Train Epoch: 43 [183296/612104 (30%)]	lr:2.32e-05	Loss: 0.055422
[2024-01-06 20:11:23,730] {train_model:86} INFO - Train Epoch: 43 [244480/612104 (40%)]	lr:2.32e-05	Loss: 0.061439
[2024-01-06 20:11:35,235] {train_model:86} INFO - Train Epoch: 43 [305664/612104 (50%)]	lr:2.32e-05	Loss: 0.052928
[2024-01-06 20:11:46,578] {train_model:86} INFO - Train Epoch: 43 [366848/612104 (60%)]	lr:2.32e-05	Loss: 0.119180
[2024-01-06 20:11:58,097] {train_model:86} INFO - Train Epoch: 43 [428032/612104 (70%)]	lr:2.32e-05	Loss: 0.078685
[2024-01-06 20:12:09,531] {train_model:86} INFO - Train Epoch: 43 [489216/612104 (80%)]	lr:2.32e-05	Loss: 0.053216
[2024-01-06 20:12:34,474] {train_model:86} INFO - Train Epoch: 43 [550400/612104 (90%)]	lr:2.32e-05	Loss: 0.087588
[2024-01-06 20:13:07,451] {train_model:86} INFO - Train Epoch: 43 [611584/612104 (100%)]	lr:2.32e-05	Loss: 0.047903
[2024-01-06 20:13:19,872] {run_experiment:78} INFO - 
[2024-01-06 20:13:19,878] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 20:13:21,100] {result_logger:108} INFO - precision on WAKE: 0.990
[2024-01-06 20:13:21,909] {result_logger:109} INFO - recall on WAKE: 0.967
[2024-01-06 20:13:22,708] {result_logger:112} INFO - F1-score on WAKE: 0.978
[2024-01-06 20:13:22,708] {result_logger:113} INFO - 
[2024-01-06 20:13:23,897] {result_logger:108} INFO - precision on NREM: 0.958
[2024-01-06 20:13:24,682] {result_logger:109} INFO - recall on NREM: 0.966
[2024-01-06 20:13:25,468] {result_logger:112} INFO - F1-score on NREM: 0.962
[2024-01-06 20:13:25,468] {result_logger:113} INFO - 
[2024-01-06 20:13:26,548] {result_logger:108} INFO - precision on REM: 0.848
[2024-01-06 20:13:27,252] {result_logger:109} INFO - recall on REM: 0.972
[2024-01-06 20:13:27,953] {result_logger:112} INFO - F1-score on REM: 0.906
[2024-01-06 20:13:27,953] {result_logger:113} INFO - 
[2024-01-06 20:13:28,145] {result_logger:116} INFO - average precision on sleep stages: 0.932
[2024-01-06 20:13:28,331] {result_logger:118} INFO - average recall on sleep stages: 0.968
[2024-01-06 20:13:28,519] {result_logger:120} INFO - average F1-score on sleep stages: 0.949
[2024-01-06 20:13:29,020] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.968
[2024-01-06 20:13:29,046] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.967
[2024-01-06 20:13:29,050] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 20:13:29,206] {result_logger:108} INFO - precision on WAKE: 0.913
[2024-01-06 20:13:29,305] {result_logger:109} INFO - recall on WAKE: 0.925
[2024-01-06 20:13:29,402] {result_logger:112} INFO - F1-score on WAKE: 0.919
[2024-01-06 20:13:29,403] {result_logger:113} INFO - 
[2024-01-06 20:13:29,555] {result_logger:108} INFO - precision on NREM: 0.904
[2024-01-06 20:13:29,652] {result_logger:109} INFO - recall on NREM: 0.841
[2024-01-06 20:13:29,750] {result_logger:112} INFO - F1-score on NREM: 0.872
[2024-01-06 20:13:29,751] {result_logger:113} INFO - 
[2024-01-06 20:13:29,906] {result_logger:108} INFO - precision on REM: 0.671
[2024-01-06 20:13:30,000] {result_logger:109} INFO - recall on REM: 0.900
[2024-01-06 20:13:30,093] {result_logger:112} INFO - F1-score on REM: 0.769
[2024-01-06 20:13:30,093] {result_logger:113} INFO - 
[2024-01-06 20:13:30,110] {result_logger:116} INFO - average precision on sleep stages: 0.829
[2024-01-06 20:13:30,127] {result_logger:118} INFO - average recall on sleep stages: 0.889
[2024-01-06 20:13:30,145] {result_logger:120} INFO - average F1-score on sleep stages: 0.853
[2024-01-06 20:13:30,211] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.889
[2024-01-06 20:13:30,214] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.890
[2024-01-06 20:13:30,215] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 20:13:30,772] {result_logger:143} INFO - 
[[321029   9324   1701      1]
 [  3059 231075   5056      0]
 [   254    826  37590      1]
 [  1924    233     31      0]]
[2024-01-06 20:13:31,337] {result_logger:150} INFO - 
[[ 96.68%   2.81%   0.51%   0.00%]
 [  1.28%  96.61%   2.11%   0.00%]
 [  0.66%   2.14%  97.20%   0.00%]
 [ 87.93%  10.65%   1.42%   0.00%]]
[2024-01-06 20:13:31,894] {result_logger:154} INFO - 
[[ 98.39%   3.86%   3.83%  50.00%]
 [  0.94%  95.70%  11.39%   0.00%]
 [  0.08%   0.34%  84.70%  50.00%]
 [  0.59%   0.10%   0.07%   0.00%]]
[2024-01-06 20:13:31,894] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 20:13:31,971] {result_logger:143} INFO - 
[[44689  2858   772     0]
 [ 3990 29527  1588     0]
 [  262   270  4809     0]
 [  539   251    44     0]]
[2024-01-06 20:13:32,166] {result_logger:150} INFO - 
[[ 92.49%   5.91%   1.60%   0.00%]
 [ 11.37%  84.11%   4.52%   0.00%]
 [  4.91%   5.06%  90.04%   0.00%]
 [ 64.63%  30.10%   5.28%   0.00%]]
[2024-01-06 20:13:32,350] {result_logger:154} INFO - 
[[ 90.32%   8.69%  10.70%    nan%]
 [  8.06%  89.73%  22.02%    nan%]
 [  0.53%   0.82%  66.67%    nan%]
 [  1.09%   0.76%   0.61%    nan%]]
[2024-01-06 20:13:32,752] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 20:13:32,752] {result_logger:77} INFO - actual:
[2024-01-06 20:13:32,753] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 20:13:32,753] {result_logger:79} INFO - predicted:
[2024-01-06 20:13:32,753] {result_logger:80} INFO - 
[[94.98%  4.09%  0.93%  0.00%]
 [ 5.45% 92.33%  2.22%  0.00%]
 [ 9.57%  6.90% 83.53%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 20:13:32,789] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it3/model_8conv_2fc-best.pth
[2024-01-06 20:13:32,789] {run_experiment:113} INFO - [epoch  43] execution time: 189.86s	 avg f1-score: 0.8531

[2024-01-06 20:13:32,789] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 20:13:32,845] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 20:13:59,092] {train_model:86} INFO - Train Epoch: 44 [60928/612104 (10%)]	lr:2.19e-05	Loss: 0.070203
[2024-01-06 20:14:10,832] {train_model:86} INFO - Train Epoch: 44 [122112/612104 (20%)]	lr:2.19e-05	Loss: 0.083135
[2024-01-06 20:14:22,102] {train_model:86} INFO - Train Epoch: 44 [183296/612104 (30%)]	lr:2.19e-05	Loss: 0.053387
[2024-01-06 20:14:33,985] {train_model:86} INFO - Train Epoch: 44 [244480/612104 (40%)]	lr:2.19e-05	Loss: 0.054637
[2024-01-06 20:14:45,342] {train_model:86} INFO - Train Epoch: 44 [305664/612104 (50%)]	lr:2.19e-05	Loss: 0.112929
[2024-01-06 20:14:56,925] {train_model:86} INFO - Train Epoch: 44 [366848/612104 (60%)]	lr:2.19e-05	Loss: 0.058756
[2024-01-06 20:15:08,551] {train_model:86} INFO - Train Epoch: 44 [428032/612104 (70%)]	lr:2.19e-05	Loss: 0.068738
[2024-01-06 20:15:19,996] {train_model:86} INFO - Train Epoch: 44 [489216/612104 (80%)]	lr:2.19e-05	Loss: 0.077828
[2024-01-06 20:15:31,884] {train_model:86} INFO - Train Epoch: 44 [550400/612104 (90%)]	lr:2.19e-05	Loss: 0.066673
[2024-01-06 20:15:58,953] {train_model:86} INFO - Train Epoch: 44 [611584/612104 (100%)]	lr:2.19e-05	Loss: 0.149589
[2024-01-06 20:16:11,181] {run_experiment:78} INFO - 
[2024-01-06 20:16:11,187] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 20:16:12,448] {result_logger:108} INFO - precision on WAKE: 0.990
[2024-01-06 20:16:13,248] {result_logger:109} INFO - recall on WAKE: 0.967
[2024-01-06 20:16:14,084] {result_logger:112} INFO - F1-score on WAKE: 0.978
[2024-01-06 20:16:14,085] {result_logger:113} INFO - 
[2024-01-06 20:16:15,318] {result_logger:108} INFO - precision on NREM: 0.958
[2024-01-06 20:16:16,098] {result_logger:109} INFO - recall on NREM: 0.966
[2024-01-06 20:16:16,919] {result_logger:112} INFO - F1-score on NREM: 0.962
[2024-01-06 20:16:16,919] {result_logger:113} INFO - 
[2024-01-06 20:16:18,091] {result_logger:108} INFO - precision on REM: 0.847
[2024-01-06 20:16:18,807] {result_logger:109} INFO - recall on REM: 0.972
[2024-01-06 20:16:19,572] {result_logger:112} INFO - F1-score on REM: 0.906
[2024-01-06 20:16:19,572] {result_logger:113} INFO - 
[2024-01-06 20:16:19,762] {result_logger:116} INFO - average precision on sleep stages: 0.932
[2024-01-06 20:16:19,951] {result_logger:118} INFO - average recall on sleep stages: 0.968
[2024-01-06 20:16:20,141] {result_logger:120} INFO - average F1-score on sleep stages: 0.949
[2024-01-06 20:16:20,668] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.968
[2024-01-06 20:16:20,695] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.967
[2024-01-06 20:16:20,698] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 20:16:20,859] {result_logger:108} INFO - precision on WAKE: 0.886
[2024-01-06 20:16:20,960] {result_logger:109} INFO - recall on WAKE: 0.856
[2024-01-06 20:16:21,065] {result_logger:112} INFO - F1-score on WAKE: 0.871
[2024-01-06 20:16:21,065] {result_logger:113} INFO - 
[2024-01-06 20:16:21,225] {result_logger:108} INFO - precision on NREM: 0.932
[2024-01-06 20:16:21,325] {result_logger:109} INFO - recall on NREM: 0.804
[2024-01-06 20:16:21,432] {result_logger:112} INFO - F1-score on NREM: 0.863
[2024-01-06 20:16:21,432] {result_logger:113} INFO - 
[2024-01-06 20:16:21,591] {result_logger:108} INFO - precision on REM: 0.410
[2024-01-06 20:16:21,686] {result_logger:109} INFO - recall on REM: 0.905
[2024-01-06 20:16:21,789] {result_logger:112} INFO - F1-score on REM: 0.564
[2024-01-06 20:16:21,789] {result_logger:113} INFO - 
[2024-01-06 20:16:21,807] {result_logger:116} INFO - average precision on sleep stages: 0.743
[2024-01-06 20:16:21,825] {result_logger:118} INFO - average recall on sleep stages: 0.855
[2024-01-06 20:16:21,843] {result_logger:120} INFO - average F1-score on sleep stages: 0.766
[2024-01-06 20:16:21,914] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.855
[2024-01-06 20:16:21,917] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.839
[2024-01-06 20:16:21,917] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 20:16:22,492] {result_logger:143} INFO - 
[[321051   9287   1715      2]
 [  3115 231019   5055      1]
 [   226    841  37601      3]
 [  1917    239     32      0]]
[2024-01-06 20:16:23,065] {result_logger:150} INFO - 
[[ 96.69%   2.80%   0.52%   0.00%]
 [  1.30%  96.58%   2.11%   0.00%]
 [  0.58%   2.17%  97.23%   0.01%]
 [ 87.61%  10.92%   1.46%   0.00%]]
[2024-01-06 20:16:23,639] {result_logger:154} INFO - 
[[ 98.39%   3.85%   3.86%  33.33%]
 [  0.95%  95.71%  11.38%  16.67%]
 [  0.07%   0.35%  84.68%  50.00%]
 [  0.59%   0.10%   0.07%   0.00%]]
[2024-01-06 20:16:23,640] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 20:16:23,714] {result_logger:143} INFO - 
[[41377  1774  5168     0]
 [ 5076 28232  1797     0]
 [  225   280  4836     0]
 [  417    93   324     0]]
[2024-01-06 20:16:23,939] {result_logger:150} INFO - 
[[ 85.63%   3.67%  10.70%   0.00%]
 [ 14.46%  80.42%   5.12%   0.00%]
 [  4.21%   5.24%  90.54%   0.00%]
 [ 50.00%  11.15%  38.85%   0.00%]]
[2024-01-06 20:16:24,149] {result_logger:154} INFO - 
[[ 87.86%   5.84%  42.62%    nan%]
 [ 10.78%  92.93%  14.82%    nan%]
 [  0.48%   0.92%  39.88%    nan%]
 [  0.89%   0.31%   2.67%    nan%]]
[2024-01-06 20:16:24,589] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 20:16:24,590] {result_logger:77} INFO - actual:
[2024-01-06 20:16:24,590] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 20:16:24,590] {result_logger:79} INFO - predicted:
[2024-01-06 20:16:24,590] {result_logger:80} INFO - 
[[93.35%  3.44%  3.21%  0.00%]
 [ 4.70% 92.33%  2.97%  0.00%]
 [14.07%  5.85% 80.08%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 20:16:24,641] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it3/model_8conv_2fc-best.pth
[2024-01-06 20:16:24,641] {run_experiment:113} INFO - [epoch  44] execution time: 171.85s	 avg f1-score: 0.7663

[2024-01-06 20:16:24,641] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 20:16:24,695] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 20:17:03,932] {train_model:86} INFO - Train Epoch: 45 [60928/612104 (10%)]	lr:2.06e-05	Loss: 0.073790
[2024-01-06 20:17:15,598] {train_model:86} INFO - Train Epoch: 45 [122112/612104 (20%)]	lr:2.06e-05	Loss: 0.068456
[2024-01-06 20:17:27,076] {train_model:86} INFO - Train Epoch: 45 [183296/612104 (30%)]	lr:2.06e-05	Loss: 0.065986
[2024-01-06 20:17:38,439] {train_model:86} INFO - Train Epoch: 45 [244480/612104 (40%)]	lr:2.06e-05	Loss: 0.092938
[2024-01-06 20:17:49,998] {train_model:86} INFO - Train Epoch: 45 [305664/612104 (50%)]	lr:2.06e-05	Loss: 0.113091
[2024-01-06 20:18:01,818] {train_model:86} INFO - Train Epoch: 45 [366848/612104 (60%)]	lr:2.06e-05	Loss: 0.097789
[2024-01-06 20:18:13,284] {train_model:86} INFO - Train Epoch: 45 [428032/612104 (70%)]	lr:2.06e-05	Loss: 0.047318
[2024-01-06 20:18:25,140] {train_model:86} INFO - Train Epoch: 45 [489216/612104 (80%)]	lr:2.06e-05	Loss: 0.076672
[2024-01-06 20:18:36,586] {train_model:86} INFO - Train Epoch: 45 [550400/612104 (90%)]	lr:2.06e-05	Loss: 0.187957
[2024-01-06 20:18:48,579] {train_model:86} INFO - Train Epoch: 45 [611584/612104 (100%)]	lr:2.06e-05	Loss: 0.074410
[2024-01-06 20:19:00,930] {run_experiment:78} INFO - 
[2024-01-06 20:19:00,937] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 20:19:02,250] {result_logger:108} INFO - precision on WAKE: 0.990
[2024-01-06 20:19:03,079] {result_logger:109} INFO - recall on WAKE: 0.967
[2024-01-06 20:19:03,921] {result_logger:112} INFO - F1-score on WAKE: 0.978
[2024-01-06 20:19:03,922] {result_logger:113} INFO - 
[2024-01-06 20:19:05,201] {result_logger:108} INFO - precision on NREM: 0.958
[2024-01-06 20:19:06,030] {result_logger:109} INFO - recall on NREM: 0.966
[2024-01-06 20:19:06,868] {result_logger:112} INFO - F1-score on NREM: 0.962
[2024-01-06 20:19:06,868] {result_logger:113} INFO - 
[2024-01-06 20:19:08,045] {result_logger:108} INFO - precision on REM: 0.851
[2024-01-06 20:19:08,775] {result_logger:109} INFO - recall on REM: 0.972
[2024-01-06 20:19:09,495] {result_logger:112} INFO - F1-score on REM: 0.908
[2024-01-06 20:19:09,495] {result_logger:113} INFO - 
[2024-01-06 20:19:09,691] {result_logger:116} INFO - average precision on sleep stages: 0.933
[2024-01-06 20:19:09,877] {result_logger:118} INFO - average recall on sleep stages: 0.969
[2024-01-06 20:19:10,072] {result_logger:120} INFO - average F1-score on sleep stages: 0.949
[2024-01-06 20:19:10,597] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.969
[2024-01-06 20:19:10,624] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.967
[2024-01-06 20:19:10,628] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 20:19:10,794] {result_logger:108} INFO - precision on WAKE: 0.917
[2024-01-06 20:19:10,894] {result_logger:109} INFO - recall on WAKE: 0.935
[2024-01-06 20:19:10,992] {result_logger:112} INFO - F1-score on WAKE: 0.926
[2024-01-06 20:19:10,992] {result_logger:113} INFO - 
[2024-01-06 20:19:11,161] {result_logger:108} INFO - precision on NREM: 0.922
[2024-01-06 20:19:11,263] {result_logger:109} INFO - recall on NREM: 0.851
[2024-01-06 20:19:11,364] {result_logger:112} INFO - F1-score on NREM: 0.885
[2024-01-06 20:19:11,364] {result_logger:113} INFO - 
[2024-01-06 20:19:11,525] {result_logger:108} INFO - precision on REM: 0.681
[2024-01-06 20:19:11,626] {result_logger:109} INFO - recall on REM: 0.904
[2024-01-06 20:19:11,725] {result_logger:112} INFO - F1-score on REM: 0.777
[2024-01-06 20:19:11,725] {result_logger:113} INFO - 
[2024-01-06 20:19:11,744] {result_logger:116} INFO - average precision on sleep stages: 0.840
[2024-01-06 20:19:11,762] {result_logger:118} INFO - average recall on sleep stages: 0.897
[2024-01-06 20:19:11,781] {result_logger:120} INFO - average F1-score on sleep stages: 0.863
[2024-01-06 20:19:11,855] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.897
[2024-01-06 20:19:11,858] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.900
[2024-01-06 20:19:11,859] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 20:19:12,433] {result_logger:143} INFO - 
[[321119   9259   1673      4]
 [  3124 231171   4894      1]
 [   228    853  37588      2]
 [  1922    237     29      0]]
[2024-01-06 20:19:13,017] {result_logger:150} INFO - 
[[ 96.71%   2.79%   0.50%   0.00%]
 [  1.31%  96.65%   2.05%   0.00%]
 [  0.59%   2.21%  97.20%   0.01%]
 [ 87.84%  10.83%   1.33%   0.00%]]
[2024-01-06 20:19:13,608] {result_logger:154} INFO - 
[[ 98.38%   3.83%   3.79%  57.14%]
 [  0.96%  95.72%  11.08%  14.29%]
 [  0.07%   0.35%  85.07%  28.57%]
 [  0.59%   0.10%   0.07%   0.00%]]
[2024-01-06 20:19:13,608] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 20:19:13,687] {result_logger:143} INFO - 
[[45183  2286   850     0]
 [ 3812 29880  1413     0]
 [  271   241  4829     0]
 [  594   201    39     0]]
[2024-01-06 20:19:13,928] {result_logger:150} INFO - 
[[ 93.51%   4.73%   1.76%   0.00%]
 [ 10.86%  85.12%   4.03%   0.00%]
 [  5.07%   4.51%  90.41%   0.00%]
 [ 71.22%  24.10%   4.68%   0.00%]]
[2024-01-06 20:19:14,139] {result_logger:154} INFO - 
[[ 90.62%   7.01%  11.92%    nan%]
 [  7.65%  91.63%  19.81%    nan%]
 [  0.54%   0.74%  67.72%    nan%]
 [  1.19%   0.62%   0.55%    nan%]]
[2024-01-06 20:19:14,583] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 20:19:14,583] {result_logger:77} INFO - actual:
[2024-01-06 20:19:14,583] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 20:19:14,583] {result_logger:79} INFO - predicted:
[2024-01-06 20:19:14,583] {result_logger:80} INFO - 
[[95.22%  3.85%  0.93%  0.00%]
 [ 5.11% 92.73%  2.16%  0.00%]
 [10.01%  6.35% 83.63%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 20:19:14,640] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it3/model_8conv_2fc-best.pth
[2024-01-06 20:19:14,640] {run_experiment:113} INFO - [epoch  45] execution time: 170.00s	 avg f1-score: 0.8627

[2024-01-06 20:19:14,640] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 20:19:14,695] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 20:20:07,044] {train_model:86} INFO - Train Epoch: 46 [60928/612104 (10%)]	lr:1.94e-05	Loss: 0.194164
[2024-01-06 20:20:22,388] {train_model:86} INFO - Train Epoch: 46 [122112/612104 (20%)]	lr:1.94e-05	Loss: 0.038960
[2024-01-06 20:20:47,866] {train_model:86} INFO - Train Epoch: 46 [183296/612104 (30%)]	lr:1.94e-05	Loss: 0.089225
[2024-01-06 20:20:59,815] {train_model:86} INFO - Train Epoch: 46 [244480/612104 (40%)]	lr:1.94e-05	Loss: 0.088856
[2024-01-06 20:21:11,351] {train_model:86} INFO - Train Epoch: 46 [305664/612104 (50%)]	lr:1.94e-05	Loss: 0.071757
[2024-01-06 20:21:22,722] {train_model:86} INFO - Train Epoch: 46 [366848/612104 (60%)]	lr:1.94e-05	Loss: 0.089850
[2024-01-06 20:21:34,019] {train_model:86} INFO - Train Epoch: 46 [428032/612104 (70%)]	lr:1.94e-05	Loss: 0.071630
[2024-01-06 20:21:45,111] {train_model:86} INFO - Train Epoch: 46 [489216/612104 (80%)]	lr:1.94e-05	Loss: 0.030719
[2024-01-06 20:21:56,571] {train_model:86} INFO - Train Epoch: 46 [550400/612104 (90%)]	lr:1.94e-05	Loss: 0.205843
[2024-01-06 20:22:08,421] {train_model:86} INFO - Train Epoch: 46 [611584/612104 (100%)]	lr:1.94e-05	Loss: 0.062855
[2024-01-06 20:22:21,180] {run_experiment:78} INFO - 
[2024-01-06 20:22:21,187] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 20:22:22,459] {result_logger:108} INFO - precision on WAKE: 0.990
[2024-01-06 20:22:23,307] {result_logger:109} INFO - recall on WAKE: 0.967
[2024-01-06 20:22:24,147] {result_logger:112} INFO - F1-score on WAKE: 0.978
[2024-01-06 20:22:24,147] {result_logger:113} INFO - 
[2024-01-06 20:22:25,397] {result_logger:108} INFO - precision on NREM: 0.958
[2024-01-06 20:22:26,227] {result_logger:109} INFO - recall on NREM: 0.966
[2024-01-06 20:22:27,041] {result_logger:112} INFO - F1-score on NREM: 0.962
[2024-01-06 20:22:27,041] {result_logger:113} INFO - 
[2024-01-06 20:22:28,158] {result_logger:108} INFO - precision on REM: 0.849
[2024-01-06 20:22:28,885] {result_logger:109} INFO - recall on REM: 0.973
[2024-01-06 20:22:29,612] {result_logger:112} INFO - F1-score on REM: 0.907
[2024-01-06 20:22:29,613] {result_logger:113} INFO - 
[2024-01-06 20:22:29,806] {result_logger:116} INFO - average precision on sleep stages: 0.932
[2024-01-06 20:22:29,992] {result_logger:118} INFO - average recall on sleep stages: 0.969
[2024-01-06 20:22:30,180] {result_logger:120} INFO - average F1-score on sleep stages: 0.949
[2024-01-06 20:22:30,710] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.969
[2024-01-06 20:22:30,736] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.967
[2024-01-06 20:22:30,740] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 20:22:30,907] {result_logger:108} INFO - precision on WAKE: 0.924
[2024-01-06 20:22:31,009] {result_logger:109} INFO - recall on WAKE: 0.932
[2024-01-06 20:22:31,107] {result_logger:112} INFO - F1-score on WAKE: 0.928
[2024-01-06 20:22:31,108] {result_logger:113} INFO - 
[2024-01-06 20:22:31,270] {result_logger:108} INFO - precision on NREM: 0.894
[2024-01-06 20:22:31,373] {result_logger:109} INFO - recall on NREM: 0.854
[2024-01-06 20:22:31,474] {result_logger:112} INFO - F1-score on NREM: 0.873
[2024-01-06 20:22:31,475] {result_logger:113} INFO - 
[2024-01-06 20:22:31,638] {result_logger:108} INFO - precision on REM: 0.706
[2024-01-06 20:22:31,733] {result_logger:109} INFO - recall on REM: 0.859
[2024-01-06 20:22:31,828] {result_logger:112} INFO - F1-score on REM: 0.775
[2024-01-06 20:22:31,828] {result_logger:113} INFO - 
[2024-01-06 20:22:31,847] {result_logger:116} INFO - average precision on sleep stages: 0.841
[2024-01-06 20:22:31,865] {result_logger:118} INFO - average recall on sleep stages: 0.882
[2024-01-06 20:22:31,884] {result_logger:120} INFO - average F1-score on sleep stages: 0.859
[2024-01-06 20:22:31,958] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.882
[2024-01-06 20:22:31,961] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.897
[2024-01-06 20:22:31,962] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 20:22:32,541] {result_logger:143} INFO - 
[[321092   9300   1660      3]
 [  3060 231117   5012      1]
 [   236    821  37609      5]
 [  1917    238     33      0]]
[2024-01-06 20:22:33,127] {result_logger:150} INFO - 
[[ 96.70%   2.80%   0.50%   0.00%]
 [  1.28%  96.62%   2.10%   0.00%]
 [  0.61%   2.12%  97.25%   0.01%]
 [ 87.61%  10.88%   1.51%   0.00%]]
[2024-01-06 20:22:33,710] {result_logger:154} INFO - 
[[ 98.40%   3.85%   3.75%  33.33%]
 [  0.94%  95.71%  11.31%  11.11%]
 [  0.07%   0.34%  84.87%  55.56%]
 [  0.59%   0.10%   0.07%   0.00%]]
[2024-01-06 20:22:33,710] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 20:22:33,789] {result_logger:143} INFO - 
[[45019  3070   230     0]
 [ 3450 29970  1685     0]
 [  268   484  4589     0]
 [  524   298    12     0]]
[2024-01-06 20:22:33,993] {result_logger:150} INFO - 
[[ 93.17%   6.35%   0.48%   0.00%]
 [  9.83%  85.37%   4.80%   0.00%]
 [  5.02%   9.06%  85.92%   0.00%]
 [ 62.83%  35.73%   1.44%   0.00%]]
[2024-01-06 20:22:34,190] {result_logger:154} INFO - 
[[ 91.39%   9.08%   3.53%    nan%]
 [  7.00%  88.61%  25.86%    nan%]
 [  0.54%   1.43%  70.43%    nan%]
 [  1.06%   0.88%   0.18%    nan%]]
[2024-01-06 20:22:34,746] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 20:22:34,747] {result_logger:77} INFO - actual:
[2024-01-06 20:22:34,747] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 20:22:34,747] {result_logger:79} INFO - predicted:
[2024-01-06 20:22:34,747] {result_logger:80} INFO - 
[[95.15%  4.38%  0.46%  0.00%]
 [ 5.69% 92.22%  2.09%  0.00%]
 [ 7.07%  7.27% 85.65%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 20:22:34,808] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it3/model_8conv_2fc-best.pth
[2024-01-06 20:22:34,808] {run_experiment:113} INFO - [epoch  46] execution time: 200.17s	 avg f1-score: 0.8586

[2024-01-06 20:22:34,809] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 20:22:34,865] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 20:23:11,032] {train_model:86} INFO - Train Epoch: 47 [60928/612104 (10%)]	lr:1.83e-05	Loss: 0.058580
[2024-01-06 20:23:28,095] {train_model:86} INFO - Train Epoch: 47 [122112/612104 (20%)]	lr:1.83e-05	Loss: 0.107807
[2024-01-06 20:23:55,118] {train_model:86} INFO - Train Epoch: 47 [183296/612104 (30%)]	lr:1.83e-05	Loss: 0.046698
[2024-01-06 20:24:20,791] {train_model:86} INFO - Train Epoch: 47 [244480/612104 (40%)]	lr:1.83e-05	Loss: 0.149189
[2024-01-06 20:24:32,161] {train_model:86} INFO - Train Epoch: 47 [305664/612104 (50%)]	lr:1.83e-05	Loss: 0.039767
[2024-01-06 20:24:43,797] {train_model:86} INFO - Train Epoch: 47 [366848/612104 (60%)]	lr:1.83e-05	Loss: 0.044104
[2024-01-06 20:24:55,054] {train_model:86} INFO - Train Epoch: 47 [428032/612104 (70%)]	lr:1.83e-05	Loss: 0.079016
[2024-01-06 20:25:06,575] {train_model:86} INFO - Train Epoch: 47 [489216/612104 (80%)]	lr:1.83e-05	Loss: 0.067387
[2024-01-06 20:25:18,596] {train_model:86} INFO - Train Epoch: 47 [550400/612104 (90%)]	lr:1.83e-05	Loss: 0.053356
[2024-01-06 20:25:29,983] {train_model:86} INFO - Train Epoch: 47 [611584/612104 (100%)]	lr:1.83e-05	Loss: 0.045578
[2024-01-06 20:25:42,650] {run_experiment:78} INFO - 
[2024-01-06 20:25:42,657] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 20:25:43,921] {result_logger:108} INFO - precision on WAKE: 0.990
[2024-01-06 20:25:44,752] {result_logger:109} INFO - recall on WAKE: 0.967
[2024-01-06 20:25:45,592] {result_logger:112} INFO - F1-score on WAKE: 0.978
[2024-01-06 20:25:45,592] {result_logger:113} INFO - 
[2024-01-06 20:25:46,824] {result_logger:108} INFO - precision on NREM: 0.958
[2024-01-06 20:25:47,627] {result_logger:109} INFO - recall on NREM: 0.967
[2024-01-06 20:25:48,445] {result_logger:112} INFO - F1-score on NREM: 0.962
[2024-01-06 20:25:48,445] {result_logger:113} INFO - 
[2024-01-06 20:25:49,589] {result_logger:108} INFO - precision on REM: 0.852
[2024-01-06 20:25:50,304] {result_logger:109} INFO - recall on REM: 0.974
[2024-01-06 20:25:51,026] {result_logger:112} INFO - F1-score on REM: 0.909
[2024-01-06 20:25:51,026] {result_logger:113} INFO - 
[2024-01-06 20:25:51,218] {result_logger:116} INFO - average precision on sleep stages: 0.933
[2024-01-06 20:25:51,410] {result_logger:118} INFO - average recall on sleep stages: 0.969
[2024-01-06 20:25:51,602] {result_logger:120} INFO - average F1-score on sleep stages: 0.950
[2024-01-06 20:25:52,140] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.969
[2024-01-06 20:25:52,167] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.967
[2024-01-06 20:25:52,171] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 20:25:52,334] {result_logger:108} INFO - precision on WAKE: 0.912
[2024-01-06 20:25:52,432] {result_logger:109} INFO - recall on WAKE: 0.921
[2024-01-06 20:25:52,530] {result_logger:112} INFO - F1-score on WAKE: 0.916
[2024-01-06 20:25:52,530] {result_logger:113} INFO - 
[2024-01-06 20:25:52,690] {result_logger:108} INFO - precision on NREM: 0.920
[2024-01-06 20:25:52,790] {result_logger:109} INFO - recall on NREM: 0.832
[2024-01-06 20:25:52,889] {result_logger:112} INFO - F1-score on NREM: 0.874
[2024-01-06 20:25:52,890] {result_logger:113} INFO - 
[2024-01-06 20:25:53,046] {result_logger:108} INFO - precision on REM: 0.603
[2024-01-06 20:25:53,144] {result_logger:109} INFO - recall on REM: 0.924
[2024-01-06 20:25:53,244] {result_logger:112} INFO - F1-score on REM: 0.730
[2024-01-06 20:25:53,244] {result_logger:113} INFO - 
[2024-01-06 20:25:53,262] {result_logger:116} INFO - average precision on sleep stages: 0.812
[2024-01-06 20:25:53,281] {result_logger:118} INFO - average recall on sleep stages: 0.892
[2024-01-06 20:25:53,300] {result_logger:120} INFO - average F1-score on sleep stages: 0.840
[2024-01-06 20:25:53,372] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.892
[2024-01-06 20:25:53,375] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.886
[2024-01-06 20:25:53,376] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 20:25:53,941] {result_logger:143} INFO - 
[[321090   9303   1657      5]
 [  3135 231179   4876      0]
 [   201    798  37670      2]
 [  1913    246     29      0]]
[2024-01-06 20:25:54,503] {result_logger:150} INFO - 
[[ 96.70%   2.80%   0.50%   0.00%]
 [  1.31%  96.65%   2.04%   0.00%]
 [  0.52%   2.06%  97.41%   0.01%]
 [ 87.43%  11.24%   1.33%   0.00%]]
[2024-01-06 20:25:55,058] {result_logger:154} INFO - 
[[ 98.39%   3.85%   3.75%  71.43%]
 [  0.96%  95.72%  11.02%   0.00%]
 [  0.06%   0.33%  85.16%  28.57%]
 [  0.59%   0.10%   0.07%   0.00%]]
[2024-01-06 20:25:55,058] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 20:25:55,133] {result_logger:143} INFO - 
[[44510  2354  1455     0]
 [ 4099 29212  1794     0]
 [  214   191  4936     0]
 [  540   205    89     0]]
[2024-01-06 20:25:55,334] {result_logger:150} INFO - 
[[ 92.12%   4.87%   3.01%   0.00%]
 [ 11.68%  83.21%   5.11%   0.00%]
 [  4.01%   3.58%  92.42%   0.00%]
 [ 64.75%  24.58%  10.67%   0.00%]]
[2024-01-06 20:25:55,531] {result_logger:154} INFO - 
[[ 90.17%   7.36%  17.59%    nan%]
 [  8.30%  91.40%  21.68%    nan%]
 [  0.43%   0.60%  59.66%    nan%]
 [  1.09%   0.64%   1.08%    nan%]]
[2024-01-06 20:25:55,955] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 20:25:55,955] {result_logger:77} INFO - actual:
[2024-01-06 20:25:55,955] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 20:25:55,955] {result_logger:79} INFO - predicted:
[2024-01-06 20:25:55,955] {result_logger:80} INFO - 
[[94.68%  3.91%  1.42%  0.00%]
 [ 5.24% 92.07%  2.69%  0.00%]
 [11.49%  7.36% 81.15%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 20:25:55,992] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it3/model_8conv_2fc-best.pth
[2024-01-06 20:25:55,992] {run_experiment:113} INFO - [epoch  47] execution time: 201.18s	 avg f1-score: 0.8400

[2024-01-06 20:25:55,992] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 20:25:56,047] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 20:26:37,930] {train_model:86} INFO - Train Epoch: 48 [60928/612104 (10%)]	lr:1.72e-05	Loss: 0.056605
[2024-01-06 20:27:03,716] {train_model:86} INFO - Train Epoch: 48 [122112/612104 (20%)]	lr:1.72e-05	Loss: 0.063259
[2024-01-06 20:27:14,782] {train_model:86} INFO - Train Epoch: 48 [183296/612104 (30%)]	lr:1.72e-05	Loss: 0.050645
[2024-01-06 20:27:41,959] {train_model:86} INFO - Train Epoch: 48 [244480/612104 (40%)]	lr:1.72e-05	Loss: 0.102955
[2024-01-06 20:28:07,517] {train_model:86} INFO - Train Epoch: 48 [305664/612104 (50%)]	lr:1.72e-05	Loss: 0.054404
[2024-01-06 20:28:18,906] {train_model:86} INFO - Train Epoch: 48 [366848/612104 (60%)]	lr:1.72e-05	Loss: 0.125682
[2024-01-06 20:28:30,462] {train_model:86} INFO - Train Epoch: 48 [428032/612104 (70%)]	lr:1.72e-05	Loss: 0.086356
[2024-01-06 20:28:41,854] {train_model:86} INFO - Train Epoch: 48 [489216/612104 (80%)]	lr:1.72e-05	Loss: 0.038866
[2024-01-06 20:28:53,790] {train_model:86} INFO - Train Epoch: 48 [550400/612104 (90%)]	lr:1.72e-05	Loss: 0.071985
[2024-01-06 20:29:05,330] {train_model:86} INFO - Train Epoch: 48 [611584/612104 (100%)]	lr:1.72e-05	Loss: 0.063619
[2024-01-06 20:29:17,962] {run_experiment:78} INFO - 
[2024-01-06 20:29:17,968] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 20:29:19,251] {result_logger:108} INFO - precision on WAKE: 0.990
[2024-01-06 20:29:20,069] {result_logger:109} INFO - recall on WAKE: 0.967
[2024-01-06 20:29:20,879] {result_logger:112} INFO - F1-score on WAKE: 0.978
[2024-01-06 20:29:20,879] {result_logger:113} INFO - 
[2024-01-06 20:29:22,083] {result_logger:108} INFO - precision on NREM: 0.958
[2024-01-06 20:29:22,861] {result_logger:109} INFO - recall on NREM: 0.967
[2024-01-06 20:29:23,638] {result_logger:112} INFO - F1-score on NREM: 0.963
[2024-01-06 20:29:23,639] {result_logger:113} INFO - 
[2024-01-06 20:29:24,784] {result_logger:108} INFO - precision on REM: 0.853
[2024-01-06 20:29:25,470] {result_logger:109} INFO - recall on REM: 0.974
[2024-01-06 20:29:26,158] {result_logger:112} INFO - F1-score on REM: 0.909
[2024-01-06 20:29:26,158] {result_logger:113} INFO - 
[2024-01-06 20:29:26,329] {result_logger:116} INFO - average precision on sleep stages: 0.934
[2024-01-06 20:29:26,512] {result_logger:118} INFO - average recall on sleep stages: 0.969
[2024-01-06 20:29:26,694] {result_logger:120} INFO - average F1-score on sleep stages: 0.950
[2024-01-06 20:29:27,209] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.969
[2024-01-06 20:29:27,234] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.967
[2024-01-06 20:29:27,237] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 20:29:27,392] {result_logger:108} INFO - precision on WAKE: 0.881
[2024-01-06 20:29:27,487] {result_logger:109} INFO - recall on WAKE: 0.942
[2024-01-06 20:29:27,583] {result_logger:112} INFO - F1-score on WAKE: 0.911
[2024-01-06 20:29:27,583] {result_logger:113} INFO - 
[2024-01-06 20:29:27,740] {result_logger:108} INFO - precision on NREM: 0.933
[2024-01-06 20:29:27,837] {result_logger:109} INFO - recall on NREM: 0.790
[2024-01-06 20:29:27,936] {result_logger:112} INFO - F1-score on NREM: 0.856
[2024-01-06 20:29:27,936] {result_logger:113} INFO - 
[2024-01-06 20:29:28,093] {result_logger:108} INFO - precision on REM: 0.632
[2024-01-06 20:29:28,189] {result_logger:109} INFO - recall on REM: 0.880
[2024-01-06 20:29:28,284] {result_logger:112} INFO - F1-score on REM: 0.736
[2024-01-06 20:29:28,285] {result_logger:113} INFO - 
[2024-01-06 20:29:28,302] {result_logger:116} INFO - average precision on sleep stages: 0.816
[2024-01-06 20:29:28,319] {result_logger:118} INFO - average recall on sleep stages: 0.870
[2024-01-06 20:29:28,337] {result_logger:120} INFO - average F1-score on sleep stages: 0.834
[2024-01-06 20:29:28,408] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.870
[2024-01-06 20:29:28,411] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.878
[2024-01-06 20:29:28,411] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 20:29:28,970] {result_logger:143} INFO - 
[[320987   9369   1696      3]
 [  3015 231357   4818      0]
 [   232    765  37673      1]
 [  1924    235     29      0]]
[2024-01-06 20:29:29,542] {result_logger:150} INFO - 
[[ 96.67%   2.82%   0.51%   0.00%]
 [  1.26%  96.73%   2.01%   0.00%]
 [  0.60%   1.98%  97.42%   0.00%]
 [ 87.93%  10.74%   1.33%   0.00%]]
[2024-01-06 20:29:30,124] {result_logger:154} INFO - 
[[ 98.41%   3.88%   3.84%  75.00%]
 [  0.92%  95.71%  10.90%   0.00%]
 [  0.07%   0.32%  85.20%  25.00%]
 [  0.59%   0.10%   0.07%   0.00%]]
[2024-01-06 20:29:30,124] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 20:29:30,201] {result_logger:143} INFO - 
[[45499  1800  1020     0]
 [ 5655 27736  1714     0]
 [  465   178  4698     0]
 [  650   125    59     0]]
[2024-01-06 20:29:30,393] {result_logger:150} INFO - 
[[ 94.16%   3.73%   2.11%   0.00%]
 [ 16.11%  79.01%   4.88%   0.00%]
 [  8.71%   3.33%  87.96%   0.00%]
 [ 77.94%  14.99%   7.07%   0.00%]]
[2024-01-06 20:29:30,586] {result_logger:154} INFO - 
[[ 87.05%   6.03%  13.62%    nan%]
 [ 10.82%  92.95%  22.88%    nan%]
 [  0.89%   0.60%  62.72%    nan%]
 [  1.24%   0.42%   0.79%    nan%]]
[2024-01-06 20:29:30,994] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 20:29:30,995] {result_logger:77} INFO - actual:
[2024-01-06 20:29:30,995] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 20:29:30,995] {result_logger:79} INFO - predicted:
[2024-01-06 20:29:30,995] {result_logger:80} INFO - 
[[95.27%  3.57%  1.16%  0.00%]
 [ 5.47% 91.95%  2.58%  0.00%]
 [11.16%  7.18% 81.66%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 20:29:31,030] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it3/model_8conv_2fc-best.pth
[2024-01-06 20:29:31,031] {run_experiment:113} INFO - [epoch  48] execution time: 215.04s	 avg f1-score: 0.8340

[2024-01-06 20:29:31,031] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 20:29:31,085] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 20:30:11,108] {train_model:86} INFO - Train Epoch: 49 [60928/612104 (10%)]	lr:1.62e-05	Loss: 0.058194
[2024-01-06 20:30:35,950] {train_model:86} INFO - Train Epoch: 49 [122112/612104 (20%)]	lr:1.62e-05	Loss: 0.074908
[2024-01-06 20:30:50,460] {train_model:86} INFO - Train Epoch: 49 [183296/612104 (30%)]	lr:1.62e-05	Loss: 0.040079
[2024-01-06 20:31:01,672] {train_model:86} INFO - Train Epoch: 49 [244480/612104 (40%)]	lr:1.62e-05	Loss: 0.095348
[2024-01-06 20:31:28,791] {train_model:86} INFO - Train Epoch: 49 [305664/612104 (50%)]	lr:1.62e-05	Loss: 0.046925
[2024-01-06 20:31:54,579] {train_model:86} INFO - Train Epoch: 49 [366848/612104 (60%)]	lr:1.62e-05	Loss: 0.069421
[2024-01-06 20:32:06,444] {train_model:86} INFO - Train Epoch: 49 [428032/612104 (70%)]	lr:1.62e-05	Loss: 0.040668
[2024-01-06 20:32:18,057] {train_model:86} INFO - Train Epoch: 49 [489216/612104 (80%)]	lr:1.62e-05	Loss: 0.048892
[2024-01-06 20:32:29,416] {train_model:86} INFO - Train Epoch: 49 [550400/612104 (90%)]	lr:1.62e-05	Loss: 0.140913
[2024-01-06 20:32:40,749] {train_model:86} INFO - Train Epoch: 49 [611584/612104 (100%)]	lr:1.62e-05	Loss: 0.057788
[2024-01-06 20:32:53,419] {run_experiment:78} INFO - 
[2024-01-06 20:32:53,426] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 20:32:54,713] {result_logger:108} INFO - precision on WAKE: 0.990
[2024-01-06 20:32:55,578] {result_logger:109} INFO - recall on WAKE: 0.967
[2024-01-06 20:32:56,430] {result_logger:112} INFO - F1-score on WAKE: 0.978
[2024-01-06 20:32:56,430] {result_logger:113} INFO - 
[2024-01-06 20:32:57,681] {result_logger:108} INFO - precision on NREM: 0.958
[2024-01-06 20:32:58,498] {result_logger:109} INFO - recall on NREM: 0.967
[2024-01-06 20:32:59,313] {result_logger:112} INFO - F1-score on NREM: 0.962
[2024-01-06 20:32:59,313] {result_logger:113} INFO - 
[2024-01-06 20:33:00,499] {result_logger:108} INFO - precision on REM: 0.854
[2024-01-06 20:33:01,218] {result_logger:109} INFO - recall on REM: 0.973
[2024-01-06 20:33:01,955] {result_logger:112} INFO - F1-score on REM: 0.910
[2024-01-06 20:33:01,956] {result_logger:113} INFO - 
[2024-01-06 20:33:02,156] {result_logger:116} INFO - average precision on sleep stages: 0.934
[2024-01-06 20:33:02,356] {result_logger:118} INFO - average recall on sleep stages: 0.969
[2024-01-06 20:33:02,555] {result_logger:120} INFO - average F1-score on sleep stages: 0.950
[2024-01-06 20:33:03,066] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.969
[2024-01-06 20:33:03,093] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.967
[2024-01-06 20:33:03,096] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 20:33:03,258] {result_logger:108} INFO - precision on WAKE: 0.922
[2024-01-06 20:33:03,355] {result_logger:109} INFO - recall on WAKE: 0.934
[2024-01-06 20:33:03,454] {result_logger:112} INFO - F1-score on WAKE: 0.928
[2024-01-06 20:33:03,454] {result_logger:113} INFO - 
[2024-01-06 20:33:03,621] {result_logger:108} INFO - precision on NREM: 0.938
[2024-01-06 20:33:03,722] {result_logger:109} INFO - recall on NREM: 0.846
[2024-01-06 20:33:03,822] {result_logger:112} INFO - F1-score on NREM: 0.889
[2024-01-06 20:33:03,822] {result_logger:113} INFO - 
[2024-01-06 20:33:03,983] {result_logger:108} INFO - precision on REM: 0.610
[2024-01-06 20:33:04,077] {result_logger:109} INFO - recall on REM: 0.934
[2024-01-06 20:33:04,173] {result_logger:112} INFO - F1-score on REM: 0.738
[2024-01-06 20:33:04,173] {result_logger:113} INFO - 
[2024-01-06 20:33:04,191] {result_logger:116} INFO - average precision on sleep stages: 0.823
[2024-01-06 20:33:04,209] {result_logger:118} INFO - average recall on sleep stages: 0.905
[2024-01-06 20:33:04,227] {result_logger:120} INFO - average F1-score on sleep stages: 0.852
[2024-01-06 20:33:04,296] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.905
[2024-01-06 20:33:04,299] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.899
[2024-01-06 20:33:04,299] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 20:33:04,865] {result_logger:143} INFO - 
[[321062   9374   1617      2]
 [  3073 231323   4792      2]
 [   218    820  37630      3]
 [  1916    241     31      0]]
[2024-01-06 20:33:05,435] {result_logger:150} INFO - 
[[ 96.69%   2.82%   0.49%   0.00%]
 [  1.28%  96.71%   2.00%   0.00%]
 [  0.56%   2.12%  97.31%   0.01%]
 [ 87.57%  11.01%   1.42%   0.00%]]
[2024-01-06 20:33:06,006] {result_logger:154} INFO - 
[[ 98.40%   3.88%   3.67%  28.57%]
 [  0.94%  95.68%  10.87%  28.57%]
 [  0.07%   0.34%  85.39%  42.86%]
 [  0.59%   0.10%   0.07%   0.00%]]
[2024-01-06 20:33:06,006] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 20:33:06,082] {result_logger:143} INFO - 
[[45120  1797  1402     0]
 [ 3633 29683  1789     0]
 [  172   179  4990     0]
 [  624   110   100     0]]
[2024-01-06 20:33:06,275] {result_logger:150} INFO - 
[[ 93.38%   3.72%   2.90%   0.00%]
 [ 10.35%  84.55%   5.10%   0.00%]
 [  3.22%   3.35%  93.43%   0.00%]
 [ 74.82%  13.19%  11.99%   0.00%]]
[2024-01-06 20:33:06,464] {result_logger:154} INFO - 
[[ 91.06%   5.66%  16.93%    nan%]
 [  7.33%  93.43%  21.60%    nan%]
 [  0.35%   0.56%  60.26%    nan%]
 [  1.26%   0.35%   1.21%    nan%]]
[2024-01-06 20:33:06,884] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 20:33:06,884] {result_logger:77} INFO - actual:
[2024-01-06 20:33:06,884] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 20:33:06,884] {result_logger:79} INFO - predicted:
[2024-01-06 20:33:06,885] {result_logger:80} INFO - 
[[94.87%  3.64%  1.49%  0.00%]
 [ 4.90% 92.68%  2.42%  0.00%]
 [11.89%  6.28% 81.83%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 20:33:06,921] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it3/model_8conv_2fc-best.pth
[2024-01-06 20:33:06,922] {run_experiment:113} INFO - [epoch  49] execution time: 215.89s	 avg f1-score: 0.8517

[2024-01-06 20:33:06,922] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 20:33:06,975] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 20:33:32,937] {train_model:86} INFO - Train Epoch: 50 [60928/612104 (10%)]	lr:1.53e-05	Loss: 0.052349
[2024-01-06 20:34:00,055] {train_model:86} INFO - Train Epoch: 50 [122112/612104 (20%)]	lr:1.53e-05	Loss: 0.058520
[2024-01-06 20:34:25,755] {train_model:86} INFO - Train Epoch: 50 [183296/612104 (30%)]	lr:1.53e-05	Loss: 0.069352
[2024-01-06 20:34:37,424] {train_model:86} INFO - Train Epoch: 50 [244480/612104 (40%)]	lr:1.53e-05	Loss: 0.052168
[2024-01-06 20:34:49,214] {train_model:86} INFO - Train Epoch: 50 [305664/612104 (50%)]	lr:1.53e-05	Loss: 0.096169
[2024-01-06 20:35:16,413] {train_model:86} INFO - Train Epoch: 50 [366848/612104 (60%)]	lr:1.53e-05	Loss: 0.220326
[2024-01-06 20:35:41,687] {train_model:86} INFO - Train Epoch: 50 [428032/612104 (70%)]	lr:1.53e-05	Loss: 0.069550
[2024-01-06 20:35:53,987] {train_model:86} INFO - Train Epoch: 50 [489216/612104 (80%)]	lr:1.53e-05	Loss: 0.048078
[2024-01-06 20:36:05,556] {train_model:86} INFO - Train Epoch: 50 [550400/612104 (90%)]	lr:1.53e-05	Loss: 0.064027
[2024-01-06 20:36:17,019] {train_model:86} INFO - Train Epoch: 50 [611584/612104 (100%)]	lr:1.53e-05	Loss: 0.200796
[2024-01-06 20:36:29,374] {run_experiment:78} INFO - 
[2024-01-06 20:36:29,380] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 20:36:30,636] {result_logger:108} INFO - precision on WAKE: 0.990
[2024-01-06 20:36:31,467] {result_logger:109} INFO - recall on WAKE: 0.967
[2024-01-06 20:36:32,307] {result_logger:112} INFO - F1-score on WAKE: 0.978
[2024-01-06 20:36:32,307] {result_logger:113} INFO - 
[2024-01-06 20:36:33,567] {result_logger:108} INFO - precision on NREM: 0.959
[2024-01-06 20:36:34,388] {result_logger:109} INFO - recall on NREM: 0.967
[2024-01-06 20:36:35,232] {result_logger:112} INFO - F1-score on NREM: 0.963
[2024-01-06 20:36:35,232] {result_logger:113} INFO - 
[2024-01-06 20:36:36,415] {result_logger:108} INFO - precision on REM: 0.855
[2024-01-06 20:36:37,137] {result_logger:109} INFO - recall on REM: 0.974
[2024-01-06 20:36:37,833] {result_logger:112} INFO - F1-score on REM: 0.911
[2024-01-06 20:36:37,833] {result_logger:113} INFO - 
[2024-01-06 20:36:38,021] {result_logger:116} INFO - average precision on sleep stages: 0.934
[2024-01-06 20:36:38,205] {result_logger:118} INFO - average recall on sleep stages: 0.970
[2024-01-06 20:36:38,387] {result_logger:120} INFO - average F1-score on sleep stages: 0.951
[2024-01-06 20:36:38,896] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.970
[2024-01-06 20:36:38,920] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.968
[2024-01-06 20:36:38,924] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 20:36:39,091] {result_logger:108} INFO - precision on WAKE: 0.902
[2024-01-06 20:36:39,188] {result_logger:109} INFO - recall on WAKE: 0.869
[2024-01-06 20:36:39,285] {result_logger:112} INFO - F1-score on WAKE: 0.885
[2024-01-06 20:36:39,285] {result_logger:113} INFO - 
[2024-01-06 20:36:39,440] {result_logger:108} INFO - precision on NREM: 0.931
[2024-01-06 20:36:39,535] {result_logger:109} INFO - recall on NREM: 0.810
[2024-01-06 20:36:39,632] {result_logger:112} INFO - F1-score on NREM: 0.866
[2024-01-06 20:36:39,632] {result_logger:113} INFO - 
[2024-01-06 20:36:39,788] {result_logger:108} INFO - precision on REM: 0.424
[2024-01-06 20:36:39,884] {result_logger:109} INFO - recall on REM: 0.927
[2024-01-06 20:36:39,979] {result_logger:112} INFO - F1-score on REM: 0.582
[2024-01-06 20:36:39,979] {result_logger:113} INFO - 
[2024-01-06 20:36:39,997] {result_logger:116} INFO - average precision on sleep stages: 0.752
[2024-01-06 20:36:40,014] {result_logger:118} INFO - average recall on sleep stages: 0.869
[2024-01-06 20:36:40,031] {result_logger:120} INFO - average F1-score on sleep stages: 0.778
[2024-01-06 20:36:40,101] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.869
[2024-01-06 20:36:40,104] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.849
[2024-01-06 20:36:40,104] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 20:36:40,658] {result_logger:143} INFO - 
[[321234   9231   1587      3]
 [  3103 231292   4793      2]
 [   227    765  37675      4]
 [  1916    242     30      0]]
[2024-01-06 20:36:41,207] {result_logger:150} INFO - 
[[ 96.74%   2.78%   0.48%   0.00%]
 [  1.30%  96.70%   2.00%   0.00%]
 [  0.59%   1.98%  97.42%   0.01%]
 [ 87.57%  11.06%   1.37%   0.00%]]
[2024-01-06 20:36:41,756] {result_logger:154} INFO - 
[[ 98.39%   3.82%   3.60%  33.33%]
 [  0.95%  95.76%  10.87%  22.22%]
 [  0.07%   0.32%  85.46%  44.44%]
 [  0.59%   0.10%   0.07%   0.00%]]
[2024-01-06 20:36:41,757] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 20:36:41,828] {result_logger:143} INFO - 
[[41984  1946  4389     0]
 [ 4329 28450  2326     0]
 [  213   175  4953     0]
 [  427   137   270     0]]
[2024-01-06 20:36:42,016] {result_logger:150} INFO - 
[[ 86.89%   4.03%   9.08%   0.00%]
 [ 12.33%  81.04%   6.63%   0.00%]
 [  3.99%   3.28%  92.74%   0.00%]
 [ 51.20%  16.43%  32.37%   0.00%]]
[2024-01-06 20:36:42,203] {result_logger:154} INFO - 
[[ 89.42%   6.34%  36.76%    nan%]
 [  9.22%  92.65%  19.48%    nan%]
 [  0.45%   0.57%  41.49%    nan%]
 [  0.91%   0.45%   2.26%    nan%]]
[2024-01-06 20:36:42,691] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 20:36:42,691] {result_logger:77} INFO - actual:
[2024-01-06 20:36:42,691] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 20:36:42,691] {result_logger:79} INFO - predicted:
[2024-01-06 20:36:42,692] {result_logger:80} INFO - 
[[93.39%  3.66%  2.94%  0.00%]
 [ 4.88% 91.44%  3.68%  0.00%]
 [13.41%  7.63% 78.96%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 20:36:42,728] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it3/model_8conv_2fc-best.pth
[2024-01-06 20:36:42,728] {run_experiment:113} INFO - [epoch  50] execution time: 215.81s	 avg f1-score: 0.7780

[2024-01-06 20:36:42,981] {result_logger:56} INFO - final F1-scores on train:
	WAKE                : [0.4829265444353615, 0.7689479813397097, 0.9013536127507157, 0.9328406759823316, 0.9550406168122186, 0.965127835882666, 0.9684801872391139, 0.9702813929811218, 0.9713922460671232, 0.9722995633013986, 0.9728867428454314, 0.9733101935030085, 0.9737851984869905, 0.9743386817330404, 0.974693695496434, 0.9747618021915574, 0.9751033352827195, 0.9753027610340594, 0.9756833061180887, 0.9759867934229538, 0.975998193494444, 0.976195853195554, 0.9760950948416052, 0.9763076693110113, 0.9768689351476302, 0.9767342543644246, 0.9771069404829236, 0.9769256224561532, 0.976955841684986, 0.9773645301425196, 0.9775432789098851, 0.9774439757869914, 0.9775879493499545, 0.9776388122410277, 0.9775559196738177, 0.9777585426549854, 0.9777455286027655, 0.977985571604039, 0.9780334632413211, 0.97804552437151, 0.9780632657974043, 0.977898515394554, 0.9781549885206666, 0.9781475122896441, 0.978236962435608, 0.9782783882225875, 0.9782156680848342, 0.9781879629248701, 0.9782391439470572, 0.9784486894226331]
	NREM                : [0.5696564699459945, 0.7901095134298973, 0.866649401155657, 0.8950595941362509, 0.9137572069186418, 0.9306240306656411, 0.9385603309564717, 0.9424169985606868, 0.9451486512804512, 0.9462926750544409, 0.9476749179376641, 0.9482913989446198, 0.9493275364504145, 0.9503176870206945, 0.951272751625602, 0.9517137832463076, 0.9524951051759627, 0.9532796279100894, 0.9538900259871674, 0.9545482105932214, 0.9550688114611935, 0.955881155031069, 0.9556772700306654, 0.9561704216672411, 0.9573463079039265, 0.9572724105486929, 0.9581030241190869, 0.9579395094924497, 0.9585026407789672, 0.9590132479060299, 0.959442688942423, 0.9597792652734595, 0.9598501048349112, 0.9600313283730075, 0.9604090784066946, 0.960185742898648, 0.9608573237371718, 0.9609759449885565, 0.9611901627872104, 0.9613093068828574, 0.9615509544591399, 0.9614313999412882, 0.9619807874441889, 0.9619038300193405, 0.9622642687518341, 0.9621296011056808, 0.9623035777467895, 0.9626217803491297, 0.9624282567135489, 0.9627579202377632]
	REM                 : [0.13073643534634177, 0.2511857166328934, 0.5185926703615986, 0.6440841317535009, 0.7052200407594988, 0.7534332549703746, 0.7813753301379243, 0.799477494631036, 0.8100006705858686, 0.8146714691603839, 0.8236926721949569, 0.8256220532834037, 0.8330000000000001, 0.8375102524378019, 0.8424294464479934, 0.8468690026086856, 0.8508830504962123, 0.8542094455852155, 0.8589981447124303, 0.8610149808384625, 0.8654692850653435, 0.8688813432748743, 0.869390473297426, 0.871312136768128, 0.878056249116691, 0.8785507178048608, 0.8826331028777402, 0.8819646968534152, 0.8852579358031708, 0.8871516862596234, 0.8895669104378383, 0.891766023083245, 0.8922226984807353, 0.8950735153713958, 0.8961009529943582, 0.8950690194113367, 0.8985638952994774, 0.8997806465532742, 0.9018661866186618, 0.9023305973279013, 0.9032134015910784, 0.9040348177358853, 0.9055867402250114, 0.9055899424387659, 0.9076376983072949, 0.906765358279487, 0.9090909090909091, 0.9093388689082527, 0.909926248337565, 0.9108381887193869]
	ARTIFACT            : [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
	avg                 : [0.39443981657589927, 0.6034144038008334, 0.7621985614226571, 0.8239948006240277, 0.8580059548301198, 0.8830617071728938, 0.8961386161111701, 0.9040586287242816, 0.9088471893111477, 0.9110879025054078, 0.9147514443260175, 0.9157412152436772, 0.918704244979135, 0.9207222070638456, 0.9227986311900098, 0.924448196015517, 0.9261604969849647, 0.9275972781764548, 0.9295238256058954, 0.9305166616182126, 0.932178763340327, 0.9336527838338324, 0.9337209460565656, 0.9345967425821268, 0.9374238307227492, 0.9375191275726594, 0.9392810224932502, 0.9389432762673394, 0.9402388060890413, 0.9411764881027244, 0.9421842927633821, 0.942996421381232, 0.9432202508885337, 0.944247885328477, 0.9446886503582902, 0.9443377683216566, 0.9457222492131382, 0.9462473877152898, 0.9470299375490644, 0.9472284761940896, 0.9476092072825409, 0.9477882443572425, 0.9485741720632891, 0.9485470949159168, 0.9493796431649123, 0.9490577825359184, 0.9498700516408443, 0.9500495373940842, 0.9501978829993903, 0.9506815994599277]
[2024-01-06 20:36:42,981] {result_logger:56} INFO - final F1-scores on valid:
	WAKE                : [0.6665775013653435, 0.7429007139721343, 0.823628525592192, 0.8165107400314701, 0.8405980627388252, 0.8802667238589171, 0.9053663980427294, 0.7770832571797589, 0.8606829649552314, 0.9109714955253428, 0.9242593484520869, 0.9209873949579832, 0.9091503959814855, 0.8644423552047575, 0.8940402331265275, 0.8694578859408623, 0.9308094264411261, 0.9182071869679538, 0.9243518214637348, 0.9298985454100966, 0.7435916037918359, 0.8924156185106681, 0.847131464976491, 0.8204668072759477, 0.9288531980839673, 0.8052220511943446, 0.9174323291970351, 0.8928338727422267, 0.9187905191639437, 0.7856868474047517, 0.9129774854540855, 0.9239643523646996, 0.8482229358297502, 0.9227455602064453, 0.9261876006441224, 0.9229139720335271, 0.9145937069047193, 0.9255076282521899, 0.9021694291365651, 0.9241994325091204, 0.8976822472896824, 0.9074925115916459, 0.9189594900267324, 0.8711222459656621, 0.9260234667213199, 0.9276912298054731, 0.9163904387391654, 0.9105445376133203, 0.9279749907449304, 0.8853181506668776]
	NREM                : [0.682584420946807, 0.013746676472252077, 0.3533894343151005, 0.8672007017272293, 0.8549253731343283, 0.7077055996544089, 0.8971965382054885, 0.8702921658191847, 0.8914455012390802, 0.8672224419630631, 0.8814126779550538, 0.8834869127706484, 0.8448437624234714, 0.8554248855987132, 0.8255147250456085, 0.8862311709938688, 0.8902849316699913, 0.8697631646390183, 0.878435314814541, 0.8753676579815205, 0.8491208335800131, 0.877935246679317, 0.8543758522375109, 0.8884676423911126, 0.8689277004407956, 0.8675310626662058, 0.8838854744416129, 0.8847982773574185, 0.8782524990744169, 0.8536307762349192, 0.8527131782945736, 0.869619788158942, 0.86790625898301, 0.8656725294003954, 0.8685548722800379, 0.8757341483878701, 0.8619190810756887, 0.8708329602769571, 0.876955702866634, 0.8755119248373887, 0.8741828843248417, 0.8736080262303008, 0.871517119244392, 0.8634827422734016, 0.8851759687166727, 0.8733917148727215, 0.873799766683617, 0.8557984541569601, 0.8891917800011983, 0.8663743224313295]
	REM                 : [0.1069592046623243, 0.00048626306831996103, 0.4398222068786951, 0.5292942743009321, 0.42890677397719656, 0.4984789894302655, 0.5929288103201147, 0.4006036918075926, 0.5466768692610406, 0.7095513521963419, 0.7090967534554806, 0.7649904959391739, 0.6462800671266082, 0.46533799427974765, 0.603812256609961, 0.4994479574425374, 0.7385002218606714, 0.7724149488855371, 0.7710570944036178, 0.763455149501661, 0.31721810578827675, 0.5875211579991828, 0.47170253669058, 0.4331177887663243, 0.7534799439914339, 0.41210349866758356, 0.7056041278486455, 0.5822130906956268, 0.7310294117647059, 0.357431592039801, 0.4352530960682938, 0.7721550646102543, 0.48967702371218313, 0.7793260704332405, 0.7264778559209276, 0.768595697388267, 0.7673027166882277, 0.7799332310746189, 0.6504692119809744, 0.7682161814379926, 0.6463463330227605, 0.6932121474428333, 0.7688249400479618, 0.5642282114105706, 0.7768036676586505, 0.7748417053609117, 0.7298536152595002, 0.7356141861739607, 0.738056500517675, 0.5823975542359927]
	ARTIFACT            : [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
	avg                 : [0.4853737089914916, 0.25237788450423543, 0.5389467222619958, 0.7376685720198771, 0.7081434032834499, 0.6954837709811971, 0.798497248856111, 0.6826597049355122, 0.766268445151784, 0.8292484298949159, 0.8382562599542073, 0.8564882678892686, 0.8000914085105216, 0.7284017450277395, 0.7744557382606989, 0.7517123381257561, 0.8531981933239297, 0.8534617668308364, 0.8579480768939645, 0.856240450964426, 0.6366435143867086, 0.7859573410630559, 0.7244032846348607, 0.7140174128111282, 0.8504202808387323, 0.6949522041760448, 0.8356406438290979, 0.7866150802650907, 0.8426908100010221, 0.6655830718931574, 0.7336479199389844, 0.8552464017112986, 0.7352687395083145, 0.8559147200133603, 0.840406776281696, 0.8557479392698881, 0.8479385015562119, 0.8587579398679219, 0.8098647813280578, 0.8559758462615005, 0.8060704882124282, 0.82477089508826, 0.8531005164396954, 0.7662777332165448, 0.8626677010322142, 0.8586415500130354, 0.8400146068940941, 0.8339857259814137, 0.8517410904212679, 0.7780300091113999]
[2024-01-06 20:36:43,096] {logger:50} INFO - 
[2024-01-06 20:36:43,096] {logger:51} INFO - ================================================================================
[2024-01-06 20:36:43,096] {logger:52} INFO - finished training
[2024-01-06 20:36:43,097] {logger:53} INFO - ================================================================================
[2024-01-06 20:36:43,097] {logger:54} INFO - 
[2024-01-06 20:36:43,097] {logger:50} INFO - 
[2024-01-06 20:36:43,097] {logger:51} INFO - ================================================================================
[2024-01-06 20:36:43,097] {logger:52} INFO - best model on epoch: 50 	f1-score: 0.7780
[2024-01-06 20:36:43,097] {logger:53} INFO - ================================================================================
[2024-01-06 20:36:43,097] {logger:54} INFO - 
