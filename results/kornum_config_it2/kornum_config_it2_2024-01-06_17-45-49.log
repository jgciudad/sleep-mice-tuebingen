[2024-01-06 17:45:49,682] {logger:50} INFO - 
[2024-01-06 17:45:49,682] {logger:51} INFO - ================================================================================
[2024-01-06 17:45:49,682] {logger:52} INFO - start training with model: model_8conv_2fc
[2024-01-06 17:45:49,682] {logger:53} INFO - ================================================================================
[2024-01-06 17:45:49,682] {logger:54} INFO - 
[2024-01-06 17:46:10,018] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 17:46:10,083] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 17:46:23,261] {dataloader:107} INFO - data distribution in database for dataset valid:
	WAKE                : 48319
	NREM                : 35104
	REM                 : 5341
	ARTIFACT            : 835
[2024-01-06 17:46:23,270] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 48319
	NREM                : 35104
	REM                 : 5341
	ARTIFACT            : 835
[2024-01-06 17:46:24,678] {run_experiment:47} INFO - classifier:
Model(
  (feature_extractor): Sequential(
    (0): BatchNorm1d(3, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (1): Conv1d(3, 96, kernel_size=(5,), stride=(1,))
    (2): ReLU(inplace=True)
    (3): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (4): Dropout(p=0.0, inplace=False)
    (5): Conv1d(96, 96, kernel_size=(5,), stride=(2,))
    (6): ReLU(inplace=True)
    (7): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (8): Dropout(p=0.2, inplace=False)
    (9): Conv1d(96, 96, kernel_size=(5,), stride=(1,))
    (10): ReLU(inplace=True)
    (11): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (12): Dropout(p=0.0, inplace=False)
    (13): Conv1d(96, 96, kernel_size=(5,), stride=(2,))
    (14): ReLU(inplace=True)
    (15): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (16): Dropout(p=0.2, inplace=False)
    (17): Conv1d(96, 96, kernel_size=(5,), stride=(1,))
    (18): ReLU(inplace=True)
    (19): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (20): Dropout(p=0.0, inplace=False)
    (21): Conv1d(96, 96, kernel_size=(5,), stride=(2,))
    (22): ReLU(inplace=True)
    (23): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (24): Dropout(p=0.2, inplace=False)
    (25): Conv1d(96, 96, kernel_size=(5,), stride=(1,))
    (26): ReLU(inplace=True)
    (27): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (28): Dropout(p=0.0, inplace=False)
    (29): Conv1d(96, 96, kernel_size=(5,), stride=(2,))
    (30): ReLU(inplace=True)
    (31): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (32): Dropout(p=0.2, inplace=False)
  )
  (classifier): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=3936, out_features=80, bias=True)
    (2): ReLU(inplace=True)
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=80, out_features=4, bias=True)
  )
)
[2024-01-06 17:47:19,511] {train_model:86} INFO - Train Epoch: 1 [60928/612104 (10%)]	lr:2.56e-05	Loss: 25.056190
[2024-01-06 17:47:32,102] {train_model:86} INFO - Train Epoch: 1 [122112/612104 (20%)]	lr:2.56e-05	Loss: 33.371586
[2024-01-06 17:47:44,834] {train_model:86} INFO - Train Epoch: 1 [183296/612104 (30%)]	lr:2.56e-05	Loss: 35.340733
[2024-01-06 17:47:57,778] {train_model:86} INFO - Train Epoch: 1 [244480/612104 (40%)]	lr:2.56e-05	Loss: 20.386732
[2024-01-06 17:48:10,866] {train_model:86} INFO - Train Epoch: 1 [305664/612104 (50%)]	lr:2.56e-05	Loss: 19.317522
[2024-01-06 17:48:25,270] {train_model:86} INFO - Train Epoch: 1 [366848/612104 (60%)]	lr:2.56e-05	Loss: 12.623596
[2024-01-06 17:48:38,609] {train_model:86} INFO - Train Epoch: 1 [428032/612104 (70%)]	lr:2.56e-05	Loss: 12.996229
[2024-01-06 17:49:06,135] {train_model:86} INFO - Train Epoch: 1 [489216/612104 (80%)]	lr:2.56e-05	Loss: 13.741188
[2024-01-06 17:49:33,266] {train_model:86} INFO - Train Epoch: 1 [550400/612104 (90%)]	lr:2.56e-05	Loss: 10.629570
[2024-01-06 17:49:53,875] {train_model:86} INFO - Train Epoch: 1 [611584/612104 (100%)]	lr:2.56e-05	Loss: 6.575636
[2024-01-06 17:50:07,192] {run_experiment:78} INFO - 
[2024-01-06 17:50:07,199] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 17:50:08,572] {result_logger:108} INFO - precision on WAKE: 0.673
[2024-01-06 17:50:09,461] {result_logger:109} INFO - recall on WAKE: 0.401
[2024-01-06 17:50:10,346] {result_logger:112} INFO - F1-score on WAKE: 0.503
[2024-01-06 17:50:10,347] {result_logger:113} INFO - 
[2024-01-06 17:50:11,642] {result_logger:108} INFO - precision on NREM: 0.651
[2024-01-06 17:50:12,514] {result_logger:109} INFO - recall on NREM: 0.523
[2024-01-06 17:50:13,362] {result_logger:112} INFO - F1-score on NREM: 0.580
[2024-01-06 17:50:13,362] {result_logger:113} INFO - 
[2024-01-06 17:50:14,615] {result_logger:108} INFO - precision on REM: 0.083
[2024-01-06 17:50:15,452] {result_logger:109} INFO - recall on REM: 0.385
[2024-01-06 17:50:16,281] {result_logger:112} INFO - F1-score on REM: 0.136
[2024-01-06 17:50:16,281] {result_logger:113} INFO - 
[2024-01-06 17:50:16,503] {result_logger:116} INFO - average precision on sleep stages: 0.469
[2024-01-06 17:50:16,724] {result_logger:118} INFO - average recall on sleep stages: 0.436
[2024-01-06 17:50:16,947] {result_logger:120} INFO - average F1-score on sleep stages: 0.406
[2024-01-06 17:50:17,570] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.436
[2024-01-06 17:50:17,602] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.448
[2024-01-06 17:50:17,608] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 17:50:17,792] {result_logger:108} INFO - precision on WAKE: 0.785
[2024-01-06 17:50:17,910] {result_logger:109} INFO - recall on WAKE: 0.372
[2024-01-06 17:50:18,028] {result_logger:112} INFO - F1-score on WAKE: 0.505
[2024-01-06 17:50:18,028] {result_logger:113} INFO - 
[2024-01-06 17:50:18,209] {result_logger:108} INFO - precision on NREM: 0.950
[2024-01-06 17:50:18,318] {result_logger:109} INFO - recall on NREM: 0.502
[2024-01-06 17:50:18,427] {result_logger:112} INFO - F1-score on NREM: 0.657
[2024-01-06 17:50:18,427] {result_logger:113} INFO - 
[2024-01-06 17:50:18,607] {result_logger:108} INFO - precision on REM: 0.091
[2024-01-06 17:50:18,725] {result_logger:109} INFO - recall on REM: 0.808
[2024-01-06 17:50:18,843] {result_logger:112} INFO - F1-score on REM: 0.164
[2024-01-06 17:50:18,843] {result_logger:113} INFO - 
[2024-01-06 17:50:18,867] {result_logger:116} INFO - average precision on sleep stages: 0.609
[2024-01-06 17:50:18,890] {result_logger:118} INFO - average recall on sleep stages: 0.561
[2024-01-06 17:50:18,913] {result_logger:120} INFO - average F1-score on sleep stages: 0.442
[2024-01-06 17:50:18,989] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.561
[2024-01-06 17:50:18,993] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.450
[2024-01-06 17:50:18,993] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 17:50:19,626] {result_logger:143} INFO - 
[[133185  59897 117875  21098]
 [ 50431 124985  47504  16270]
 [ 14209   7213  14903   2346]
 [   670    750    558    210]]
[2024-01-06 17:50:20,265] {result_logger:150} INFO - 
[[ 40.11%  18.04%  35.50%   6.35%]
 [ 21.08%  52.25%  19.86%   6.80%]
 [ 36.74%  18.65%  38.54%   6.07%]
 [ 30.62%  34.28%  25.50%   9.60%]]
[2024-01-06 17:50:20,881] {result_logger:154} INFO - 
[[ 67.10%  31.06%  65.18%  52.85%]
 [ 25.41%  64.81%  26.27%  40.75%]
 [  7.16%   3.74%   8.24%   5.88%]
 [  0.34%   0.39%   0.31%   0.53%]]
[2024-01-06 17:50:20,881] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 17:50:20,966] {result_logger:143} INFO - 
[[17982   890 29420    27]
 [ 3925 17638 13538     4]
 [  989    34  4318     0]
 [  187   130   490    27]]
[2024-01-06 17:50:21,311] {result_logger:150} INFO - 
[[ 37.22%   1.84%  60.89%   0.06%]
 [ 11.18%  50.24%  38.56%   0.01%]
 [ 18.52%   0.64%  80.85%   0.00%]
 [ 22.42%  15.59%  58.75%   3.24%]]
[2024-01-06 17:50:21,554] {result_logger:154} INFO - 
[[ 77.90%   4.76%  61.59%  46.55%]
 [ 17.00%  94.36%  28.34%   6.90%]
 [  4.28%   0.18%   9.04%   0.00%]
 [  0.81%   0.70%   1.03%  46.55%]]
[2024-01-06 17:50:22,151] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 17:50:22,151] {result_logger:77} INFO - actual:
[2024-01-06 17:50:22,151] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 17:50:22,151] {result_logger:79} INFO - predicted:
[2024-01-06 17:50:22,151] {result_logger:80} INFO - 
[[40.06%  4.31% 55.57%  0.06%]
 [ 5.84% 71.72% 22.35%  0.09%]
 [26.64%  8.98% 64.32%  0.06%]
 [31.03%  5.17% 63.79%  0.00%]]
[2024-01-06 17:50:22,209] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it2/model_8conv_2fc-best.pth
[2024-01-06 17:50:22,209] {run_experiment:113} INFO - [epoch   1] execution time: 237.53s	 avg f1-score: 0.4421

[2024-01-06 17:50:22,209] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 17:50:22,270] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 17:50:50,147] {train_model:86} INFO - Train Epoch: 2 [60928/612104 (10%)]	lr:1.41e-04	Loss: 5.405898
[2024-01-06 17:51:03,758] {train_model:86} INFO - Train Epoch: 2 [122112/612104 (20%)]	lr:1.41e-04	Loss: 10.201508
[2024-01-06 17:51:15,840] {train_model:86} INFO - Train Epoch: 2 [183296/612104 (30%)]	lr:1.41e-04	Loss: 4.568024
[2024-01-06 17:51:29,093] {train_model:86} INFO - Train Epoch: 2 [244480/612104 (40%)]	lr:1.41e-04	Loss: 4.819833
[2024-01-06 17:51:42,490] {train_model:86} INFO - Train Epoch: 2 [305664/612104 (50%)]	lr:1.41e-04	Loss: 1.557965
[2024-01-06 17:51:57,190] {train_model:86} INFO - Train Epoch: 2 [366848/612104 (60%)]	lr:1.41e-04	Loss: 1.668445
[2024-01-06 17:52:24,744] {train_model:86} INFO - Train Epoch: 2 [428032/612104 (70%)]	lr:1.41e-04	Loss: 0.780136
[2024-01-06 17:52:52,957] {train_model:86} INFO - Train Epoch: 2 [489216/612104 (80%)]	lr:1.41e-04	Loss: 0.450979
[2024-01-06 17:53:06,010] {train_model:86} INFO - Train Epoch: 2 [550400/612104 (90%)]	lr:1.41e-04	Loss: 0.651499
[2024-01-06 17:53:33,883] {train_model:86} INFO - Train Epoch: 2 [611584/612104 (100%)]	lr:1.41e-04	Loss: 1.071850
[2024-01-06 17:53:48,100] {run_experiment:78} INFO - 
[2024-01-06 17:53:48,107] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 17:53:49,534] {result_logger:108} INFO - precision on WAKE: 0.920
[2024-01-06 17:53:50,467] {result_logger:109} INFO - recall on WAKE: 0.781
[2024-01-06 17:53:51,410] {result_logger:112} INFO - F1-score on WAKE: 0.845
[2024-01-06 17:53:51,410] {result_logger:113} INFO - 
[2024-01-06 17:53:52,808] {result_logger:108} INFO - precision on NREM: 0.837
[2024-01-06 17:53:53,738] {result_logger:109} INFO - recall on NREM: 0.768
[2024-01-06 17:53:54,661] {result_logger:112} INFO - F1-score on NREM: 0.801
[2024-01-06 17:53:54,662] {result_logger:113} INFO - 
[2024-01-06 17:53:55,971] {result_logger:108} INFO - precision on REM: 0.257
[2024-01-06 17:53:56,813] {result_logger:109} INFO - recall on REM: 0.707
[2024-01-06 17:53:57,651] {result_logger:112} INFO - F1-score on REM: 0.377
[2024-01-06 17:53:57,652] {result_logger:113} INFO - 
[2024-01-06 17:53:57,874] {result_logger:116} INFO - average precision on sleep stages: 0.671
[2024-01-06 17:53:58,097] {result_logger:118} INFO - average recall on sleep stages: 0.752
[2024-01-06 17:53:58,318] {result_logger:120} INFO - average F1-score on sleep stages: 0.674
[2024-01-06 17:53:58,919] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.752
[2024-01-06 17:53:58,948] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.771
[2024-01-06 17:53:58,952] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 17:53:59,133] {result_logger:108} INFO - precision on WAKE: 0.718
[2024-01-06 17:53:59,246] {result_logger:109} INFO - recall on WAKE: 0.993
[2024-01-06 17:53:59,360] {result_logger:112} INFO - F1-score on WAKE: 0.834
[2024-01-06 17:53:59,360] {result_logger:113} INFO - 
[2024-01-06 17:53:59,542] {result_logger:108} INFO - precision on NREM: 0.978
[2024-01-06 17:53:59,656] {result_logger:109} INFO - recall on NREM: 0.526
[2024-01-06 17:53:59,768] {result_logger:112} INFO - F1-score on NREM: 0.684
[2024-01-06 17:53:59,768] {result_logger:113} INFO - 
[2024-01-06 17:53:59,943] {result_logger:108} INFO - precision on REM: 0.638
[2024-01-06 17:54:00,056] {result_logger:109} INFO - recall on REM: 0.371
[2024-01-06 17:54:00,168] {result_logger:112} INFO - F1-score on REM: 0.469
[2024-01-06 17:54:00,168] {result_logger:113} INFO - 
[2024-01-06 17:54:00,189] {result_logger:116} INFO - average precision on sleep stages: 0.778
[2024-01-06 17:54:00,210] {result_logger:118} INFO - average recall on sleep stages: 0.630
[2024-01-06 17:54:00,231] {result_logger:120} INFO - average F1-score on sleep stages: 0.662
[2024-01-06 17:54:00,312] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.630
[2024-01-06 17:54:00,315] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.771
[2024-01-06 17:54:00,315] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 17:54:00,970] {result_logger:143} INFO - 
[[259444  29236  42167   1208]
 [ 17968 183728  36850    644]
 [  4731   6472  27351    117]
 [  1138    654    368     28]]
[2024-01-06 17:54:01,605] {result_logger:150} INFO - 
[[ 78.13%   8.80%  12.70%   0.36%]
 [  7.51%  76.81%  15.41%   0.27%]
 [ 12.23%  16.74%  70.73%   0.30%]
 [ 52.01%  29.89%  16.82%   1.28%]]
[2024-01-06 17:54:02,247] {result_logger:154} INFO - 
[[ 91.59%  13.28%  39.51%  60.49%]
 [  6.34%  83.48%  34.52%  32.25%]
 [  1.67%   2.94%  25.62%   5.86%]
 [  0.40%   0.30%   0.34%   1.40%]]
[2024-01-06 17:54:02,247] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 17:54:02,328] {result_logger:143} INFO - 
[[47967   333    19     0]
 [15530 18470  1105     0]
 [ 3276    84  1981     0]
 [  784    37    13     0]]
[2024-01-06 17:54:02,547] {result_logger:150} INFO - 
[[ 99.27%   0.69%   0.04%   0.00%]
 [ 44.24%  52.61%   3.15%   0.00%]
 [ 61.34%   1.57%  37.09%   0.00%]
 [ 94.00%   4.44%   1.56%   0.00%]]
[2024-01-06 17:54:02,764] {result_logger:154} INFO - 
[[ 71.00%   1.76%   0.61%    nan%]
 [ 22.99%  97.60%  35.44%    nan%]
 [  4.85%   0.44%  63.53%    nan%]
 [  1.16%   0.20%   0.42%    nan%]]
[2024-01-06 17:54:03,232] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 17:54:03,232] {result_logger:77} INFO - actual:
[2024-01-06 17:54:03,233] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 17:54:03,233] {result_logger:79} INFO - predicted:
[2024-01-06 17:54:03,233] {result_logger:80} INFO - 
[[95.26%  3.89%  0.85%  0.00%]
 [13.28% 85.46%  1.26%  0.00%]
 [22.07%  4.04% 73.89%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 17:54:03,270] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it2/model_8conv_2fc-best.pth
[2024-01-06 17:54:03,271] {run_experiment:113} INFO - [epoch   2] execution time: 221.06s	 avg f1-score: 0.6623

[2024-01-06 17:54:03,271] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 17:54:03,330] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 17:54:31,392] {train_model:86} INFO - Train Epoch: 3 [60928/612104 (10%)]	lr:2.56e-04	Loss: 0.461969
[2024-01-06 17:54:43,685] {train_model:86} INFO - Train Epoch: 3 [122112/612104 (20%)]	lr:2.56e-04	Loss: 0.468598
[2024-01-06 17:54:56,432] {train_model:86} INFO - Train Epoch: 3 [183296/612104 (30%)]	lr:2.56e-04	Loss: 0.421209
[2024-01-06 17:55:09,062] {train_model:86} INFO - Train Epoch: 3 [244480/612104 (40%)]	lr:2.56e-04	Loss: 0.328334
[2024-01-06 17:55:22,762] {train_model:86} INFO - Train Epoch: 3 [305664/612104 (50%)]	lr:2.56e-04	Loss: 0.253611
[2024-01-06 17:55:50,496] {train_model:86} INFO - Train Epoch: 3 [366848/612104 (60%)]	lr:2.56e-04	Loss: 0.196546
[2024-01-06 17:56:17,659] {train_model:86} INFO - Train Epoch: 3 [428032/612104 (70%)]	lr:2.56e-04	Loss: 0.210157
[2024-01-06 17:56:30,348] {train_model:86} INFO - Train Epoch: 3 [489216/612104 (80%)]	lr:2.56e-04	Loss: 0.345163
[2024-01-06 17:56:58,020] {train_model:86} INFO - Train Epoch: 3 [550400/612104 (90%)]	lr:2.56e-04	Loss: 0.178537
[2024-01-06 17:57:24,238] {train_model:86} INFO - Train Epoch: 3 [611584/612104 (100%)]	lr:2.56e-04	Loss: 0.543738
[2024-01-06 17:57:37,916] {run_experiment:78} INFO - 
[2024-01-06 17:57:37,922] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 17:57:39,289] {result_logger:108} INFO - precision on WAKE: 0.974
[2024-01-06 17:57:40,179] {result_logger:109} INFO - recall on WAKE: 0.862
[2024-01-06 17:57:41,064] {result_logger:112} INFO - F1-score on WAKE: 0.915
[2024-01-06 17:57:41,064] {result_logger:113} INFO - 
[2024-01-06 17:57:42,404] {result_logger:108} INFO - precision on NREM: 0.903
[2024-01-06 17:57:43,300] {result_logger:109} INFO - recall on NREM: 0.865
[2024-01-06 17:57:44,197] {result_logger:112} INFO - F1-score on NREM: 0.883
[2024-01-06 17:57:44,197] {result_logger:113} INFO - 
[2024-01-06 17:57:45,469] {result_logger:108} INFO - precision on REM: 0.388
[2024-01-06 17:57:46,252] {result_logger:109} INFO - recall on REM: 0.868
[2024-01-06 17:57:47,042] {result_logger:112} INFO - F1-score on REM: 0.536
[2024-01-06 17:57:47,042] {result_logger:113} INFO - 
[2024-01-06 17:57:47,251] {result_logger:116} INFO - average precision on sleep stages: 0.755
[2024-01-06 17:57:47,459] {result_logger:118} INFO - average recall on sleep stages: 0.865
[2024-01-06 17:57:47,666] {result_logger:120} INFO - average F1-score on sleep stages: 0.778
[2024-01-06 17:57:48,237] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.865
[2024-01-06 17:57:48,266] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.864
[2024-01-06 17:57:48,270] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 17:57:48,433] {result_logger:108} INFO - precision on WAKE: 0.544
[2024-01-06 17:57:48,539] {result_logger:109} INFO - recall on WAKE: 1.000
[2024-01-06 17:57:48,645] {result_logger:112} INFO - F1-score on WAKE: 0.705
[2024-01-06 17:57:48,645] {result_logger:113} INFO - 
[2024-01-06 17:57:48,814] {result_logger:108} INFO - precision on NREM: 0.920
[2024-01-06 17:57:48,918] {result_logger:109} INFO - recall on NREM: 0.001
[2024-01-06 17:57:49,023] {result_logger:112} INFO - F1-score on NREM: 0.001
[2024-01-06 17:57:49,023] {result_logger:113} INFO - 
[2024-01-06 17:57:49,195] {result_logger:108} INFO - precision on REM: 0.000
[2024-01-06 17:57:49,300] {result_logger:109} INFO - recall on REM: 0.000
[2024-01-06 17:57:49,402] {result_logger:112} INFO - F1-score on REM: 0.000
[2024-01-06 17:57:49,403] {result_logger:113} INFO - 
[2024-01-06 17:57:49,421] {result_logger:116} INFO - average precision on sleep stages: 0.488
[2024-01-06 17:57:49,439] {result_logger:118} INFO - average recall on sleep stages: 0.334
[2024-01-06 17:57:49,457] {result_logger:120} INFO - average F1-score on sleep stages: 0.235
[2024-01-06 17:57:49,533] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.334
[2024-01-06 17:57:49,536] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.545
[2024-01-06 17:57:49,536] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 17:57:50,147] {result_logger:143} INFO - 
[[286295  18853  26756    151]
 [  6086 206838  26178     88]
 [  1630   3443  33577     21]
 [  1533    433    207     15]]
[2024-01-06 17:57:50,749] {result_logger:150} INFO - 
[[ 86.22%   5.68%   8.06%   0.05%]
 [  2.54%  86.47%  10.94%   0.04%]
 [  4.22%   8.90%  86.83%   0.05%]
 [ 70.06%  19.79%   9.46%   0.69%]]
[2024-01-06 17:57:51,353] {result_logger:154} INFO - 
[[ 96.87%   8.21%  30.85%  54.91%]
 [  2.06%  90.10%  30.19%  32.00%]
 [  0.55%   1.50%  38.72%   7.64%]
 [  0.52%   0.19%   0.24%   5.45%]]
[2024-01-06 17:57:51,353] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 17:57:51,434] {result_logger:143} INFO - 
[[48317     2     0     0]
 [35079    23     3     0]
 [ 5341     0     0     0]
 [  830     3     1     0]]
[2024-01-06 17:57:51,637] {result_logger:150} INFO - 
[[100.00%   0.00%   0.00%   0.00%]
 [ 99.93%   0.07%   0.01%   0.00%]
 [100.00%   0.00%   0.00%   0.00%]
 [ 99.52%   0.36%   0.12%   0.00%]]
[2024-01-06 17:57:51,830] {result_logger:154} INFO - 
[[ 53.95%   7.14%   0.00%    nan%]
 [ 39.17%  82.14%  75.00%    nan%]
 [  5.96%   0.00%   0.00%    nan%]
 [  0.93%  10.71%  25.00%    nan%]]
[2024-01-06 17:57:52,253] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 17:57:52,254] {result_logger:77} INFO - actual:
[2024-01-06 17:57:52,254] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 17:57:52,254] {result_logger:79} INFO - predicted:
[2024-01-06 17:57:52,254] {result_logger:80} INFO - 
[[99.98%  0.02%  0.00%  0.00%]
 [71.43% 21.43%  7.14%  0.00%]
 [50.00% 50.00%  0.00%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 17:57:52,290] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it2/model_8conv_2fc-best.pth
[2024-01-06 17:57:52,290] {run_experiment:113} INFO - [epoch   3] execution time: 229.02s	 avg f1-score: 0.2355

[2024-01-06 17:57:52,291] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 17:57:52,349] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 17:58:19,966] {train_model:86} INFO - Train Epoch: 4 [60928/612104 (10%)]	lr:2.41e-04	Loss: 0.272571
[2024-01-06 17:58:32,484] {train_model:86} INFO - Train Epoch: 4 [122112/612104 (20%)]	lr:2.41e-04	Loss: 0.159553
[2024-01-06 17:58:45,543] {train_model:86} INFO - Train Epoch: 4 [183296/612104 (30%)]	lr:2.41e-04	Loss: 0.292218
[2024-01-06 17:58:58,708] {train_model:86} INFO - Train Epoch: 4 [244480/612104 (40%)]	lr:2.41e-04	Loss: 0.239351
[2024-01-06 17:59:26,467] {train_model:86} INFO - Train Epoch: 4 [305664/612104 (50%)]	lr:2.41e-04	Loss: 0.114606
[2024-01-06 17:59:52,461] {train_model:86} INFO - Train Epoch: 4 [366848/612104 (60%)]	lr:2.41e-04	Loss: 0.173074
[2024-01-06 18:00:04,737] {train_model:86} INFO - Train Epoch: 4 [428032/612104 (70%)]	lr:2.41e-04	Loss: 0.357154
[2024-01-06 18:00:17,596] {train_model:86} INFO - Train Epoch: 4 [489216/612104 (80%)]	lr:2.41e-04	Loss: 0.140188
[2024-01-06 18:00:45,027] {train_model:86} INFO - Train Epoch: 4 [550400/612104 (90%)]	lr:2.41e-04	Loss: 0.195562
[2024-01-06 18:01:11,277] {train_model:86} INFO - Train Epoch: 4 [611584/612104 (100%)]	lr:2.41e-04	Loss: 0.582073
[2024-01-06 18:01:25,097] {run_experiment:78} INFO - 
[2024-01-06 18:01:25,103] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 18:01:26,455] {result_logger:108} INFO - precision on WAKE: 0.977
[2024-01-06 18:01:27,356] {result_logger:109} INFO - recall on WAKE: 0.916
[2024-01-06 18:01:28,243] {result_logger:112} INFO - F1-score on WAKE: 0.945
[2024-01-06 18:01:28,243] {result_logger:113} INFO - 
[2024-01-06 18:01:29,658] {result_logger:108} INFO - precision on NREM: 0.921
[2024-01-06 18:01:30,563] {result_logger:109} INFO - recall on NREM: 0.892
[2024-01-06 18:01:31,466] {result_logger:112} INFO - F1-score on NREM: 0.906
[2024-01-06 18:01:31,466] {result_logger:113} INFO - 
[2024-01-06 18:01:32,735] {result_logger:108} INFO - precision on REM: 0.515
[2024-01-06 18:01:33,506] {result_logger:109} INFO - recall on REM: 0.892
[2024-01-06 18:01:34,289] {result_logger:112} INFO - F1-score on REM: 0.653
[2024-01-06 18:01:34,289] {result_logger:113} INFO - 
[2024-01-06 18:01:34,497] {result_logger:116} INFO - average precision on sleep stages: 0.804
[2024-01-06 18:01:34,699] {result_logger:118} INFO - average recall on sleep stages: 0.900
[2024-01-06 18:01:34,902] {result_logger:120} INFO - average F1-score on sleep stages: 0.835
[2024-01-06 18:01:35,475] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.900
[2024-01-06 18:01:35,505] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.905
[2024-01-06 18:01:35,508] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 18:01:35,691] {result_logger:108} INFO - precision on WAKE: 0.954
[2024-01-06 18:01:35,803] {result_logger:109} INFO - recall on WAKE: 0.644
[2024-01-06 18:01:35,913] {result_logger:112} INFO - F1-score on WAKE: 0.769
[2024-01-06 18:01:35,913] {result_logger:113} INFO - 
[2024-01-06 18:01:36,096] {result_logger:108} INFO - precision on NREM: 0.959
[2024-01-06 18:01:36,209] {result_logger:109} INFO - recall on NREM: 0.655
[2024-01-06 18:01:36,324] {result_logger:112} INFO - F1-score on NREM: 0.779
[2024-01-06 18:01:36,324] {result_logger:113} INFO - 
[2024-01-06 18:01:36,509] {result_logger:108} INFO - precision on REM: 0.166
[2024-01-06 18:01:36,621] {result_logger:109} INFO - recall on REM: 0.996
[2024-01-06 18:01:36,732] {result_logger:112} INFO - F1-score on REM: 0.284
[2024-01-06 18:01:36,732] {result_logger:113} INFO - 
[2024-01-06 18:01:36,753] {result_logger:116} INFO - average precision on sleep stages: 0.693
[2024-01-06 18:01:36,774] {result_logger:118} INFO - average recall on sleep stages: 0.765
[2024-01-06 18:01:36,794] {result_logger:120} INFO - average F1-score on sleep stages: 0.611
[2024-01-06 18:01:36,870] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.765
[2024-01-06 18:01:36,873] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.670
[2024-01-06 18:01:36,874] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 18:01:37,499] {result_logger:143} INFO - 
[[304056  15384  12588     27]
 [  5971 213367  19835     17]
 [  1212   2965  34491      3]
 [  1784    295    109      0]]
[2024-01-06 18:01:38,128] {result_logger:150} INFO - 
[[ 91.57%   4.63%   3.79%   0.01%]
 [  2.50%  89.20%   8.29%   0.01%]
 [  3.13%   7.67%  89.19%   0.01%]
 [ 81.54%  13.48%   4.98%   0.00%]]
[2024-01-06 18:01:38,777] {result_logger:154} INFO - 
[[ 97.14%   6.63%  18.78%  57.45%]
 [  1.91%  91.96%  29.59%  36.17%]
 [  0.39%   1.28%  51.46%   6.38%]
 [  0.57%   0.13%   0.16%   0.00%]]
[2024-01-06 18:01:38,777] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 18:01:38,863] {result_logger:143} INFO - 
[[31139   979 16201     0]
 [ 1514 23011 10580     0]
 [    4    17  5320     0]
 [  141   129   564     0]]
[2024-01-06 18:01:39,088] {result_logger:150} INFO - 
[[ 64.44%   2.03%  33.53%   0.00%]
 [  4.31%  65.55%  30.14%   0.00%]
 [  0.07%   0.32%  99.61%   0.00%]
 [ 16.91%  15.47%  67.63%   0.00%]]
[2024-01-06 18:01:39,306] {result_logger:154} INFO - 
[[ 94.94%   4.06%  49.60%    nan%]
 [  4.62%  95.34%  32.39%    nan%]
 [  0.01%   0.07%  16.29%    nan%]
 [  0.43%   0.53%   1.73%    nan%]]
[2024-01-06 18:01:39,778] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 18:01:39,778] {result_logger:77} INFO - actual:
[2024-01-06 18:01:39,779] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 18:01:39,779] {result_logger:79} INFO - predicted:
[2024-01-06 18:01:39,779] {result_logger:80} INFO - 
[[92.68%  1.57%  5.75%  0.00%]
 [ 2.23% 88.32%  9.45%  0.00%]
 [ 5.70%  7.05% 87.24%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 18:01:39,818] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it2/model_8conv_2fc-best.pth
[2024-01-06 18:01:39,818] {run_experiment:113} INFO - [epoch   4] execution time: 227.53s	 avg f1-score: 0.6106

[2024-01-06 18:01:39,819] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 18:01:39,877] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 18:02:07,867] {train_model:86} INFO - Train Epoch: 5 [60928/612104 (10%)]	lr:2.27e-04	Loss: 0.223169
[2024-01-06 18:02:21,139] {train_model:86} INFO - Train Epoch: 5 [122112/612104 (20%)]	lr:2.27e-04	Loss: 0.182128
[2024-01-06 18:02:34,501] {train_model:86} INFO - Train Epoch: 5 [183296/612104 (30%)]	lr:2.27e-04	Loss: 0.137975
[2024-01-06 18:03:03,412] {train_model:86} INFO - Train Epoch: 5 [244480/612104 (40%)]	lr:2.27e-04	Loss: 0.227917
[2024-01-06 18:03:29,906] {train_model:86} INFO - Train Epoch: 5 [305664/612104 (50%)]	lr:2.27e-04	Loss: 0.257516
[2024-01-06 18:03:43,277] {train_model:86} INFO - Train Epoch: 5 [366848/612104 (60%)]	lr:2.27e-04	Loss: 0.224184
[2024-01-06 18:03:56,595] {train_model:86} INFO - Train Epoch: 5 [428032/612104 (70%)]	lr:2.27e-04	Loss: 0.148449
[2024-01-06 18:04:24,976] {train_model:86} INFO - Train Epoch: 5 [489216/612104 (80%)]	lr:2.27e-04	Loss: 0.206126
[2024-01-06 18:04:51,224] {train_model:86} INFO - Train Epoch: 5 [550400/612104 (90%)]	lr:2.27e-04	Loss: 0.479585
[2024-01-06 18:05:03,748] {train_model:86} INFO - Train Epoch: 5 [611584/612104 (100%)]	lr:2.27e-04	Loss: 0.159744
[2024-01-06 18:05:17,571] {run_experiment:78} INFO - 
[2024-01-06 18:05:17,577] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 18:05:18,943] {result_logger:108} INFO - precision on WAKE: 0.983
[2024-01-06 18:05:19,835] {result_logger:109} INFO - recall on WAKE: 0.940
[2024-01-06 18:05:20,730] {result_logger:112} INFO - F1-score on WAKE: 0.961
[2024-01-06 18:05:20,730] {result_logger:113} INFO - 
[2024-01-06 18:05:22,127] {result_logger:108} INFO - precision on NREM: 0.932
[2024-01-06 18:05:23,030] {result_logger:109} INFO - recall on NREM: 0.912
[2024-01-06 18:05:23,934] {result_logger:112} INFO - F1-score on NREM: 0.922
[2024-01-06 18:05:23,935] {result_logger:113} INFO - 
[2024-01-06 18:05:25,193] {result_logger:108} INFO - precision on REM: 0.596
[2024-01-06 18:05:25,971] {result_logger:109} INFO - recall on REM: 0.901
[2024-01-06 18:05:26,751] {result_logger:112} INFO - F1-score on REM: 0.718
[2024-01-06 18:05:26,752] {result_logger:113} INFO - 
[2024-01-06 18:05:26,957] {result_logger:116} INFO - average precision on sleep stages: 0.837
[2024-01-06 18:05:27,167] {result_logger:118} INFO - average recall on sleep stages: 0.918
[2024-01-06 18:05:27,371] {result_logger:120} INFO - average F1-score on sleep stages: 0.867
[2024-01-06 18:05:27,930] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.918
[2024-01-06 18:05:27,959] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.927
[2024-01-06 18:05:27,965] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 18:05:28,139] {result_logger:108} INFO - precision on WAKE: 0.926
[2024-01-06 18:05:28,246] {result_logger:109} INFO - recall on WAKE: 0.524
[2024-01-06 18:05:28,353] {result_logger:112} INFO - F1-score on WAKE: 0.669
[2024-01-06 18:05:28,353] {result_logger:113} INFO - 
[2024-01-06 18:05:28,521] {result_logger:108} INFO - precision on NREM: 0.958
[2024-01-06 18:05:28,627] {result_logger:109} INFO - recall on NREM: 0.748
[2024-01-06 18:05:28,736] {result_logger:112} INFO - F1-score on NREM: 0.840
[2024-01-06 18:05:28,736] {result_logger:113} INFO - 
[2024-01-06 18:05:28,914] {result_logger:108} INFO - precision on REM: 0.156
[2024-01-06 18:05:29,024] {result_logger:109} INFO - recall on REM: 0.993
[2024-01-06 18:05:29,130] {result_logger:112} INFO - F1-score on REM: 0.270
[2024-01-06 18:05:29,130] {result_logger:113} INFO - 
[2024-01-06 18:05:29,151] {result_logger:116} INFO - average precision on sleep stages: 0.680
[2024-01-06 18:05:29,171] {result_logger:118} INFO - average recall on sleep stages: 0.755
[2024-01-06 18:05:29,191] {result_logger:120} INFO - average F1-score on sleep stages: 0.593
[2024-01-06 18:05:29,268] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.755
[2024-01-06 18:05:29,271] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.641
[2024-01-06 18:05:29,271] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 18:05:29,911] {result_logger:143} INFO - 
[[312202  12946   6905      2]
 [  4381 218078  16718     13]
 [   947   2865  34856      3]
 [  1835    285     68      0]]
[2024-01-06 18:05:30,540] {result_logger:150} INFO - 
[[ 94.02%   3.90%   2.08%   0.00%]
 [  1.83%  91.17%   6.99%   0.01%]
 [  2.45%   7.41%  90.13%   0.01%]
 [ 83.87%  13.03%   3.11%   0.00%]]
[2024-01-06 18:05:31,176] {result_logger:154} INFO - 
[[ 97.76%   5.53%  11.79%  11.11%]
 [  1.37%  93.13%  28.55%  72.22%]
 [  0.30%   1.22%  59.54%  16.67%]
 [  0.57%   0.12%   0.12%   0.00%]]
[2024-01-06 18:05:31,176] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 18:05:31,256] {result_logger:143} INFO - 
[[25308  1126 21885     0]
 [ 2035 26271  6799     0]
 [    1    38  5302     0]
 [   61    21   752     0]]
[2024-01-06 18:05:31,470] {result_logger:150} INFO - 
[[ 52.38%   2.33%  45.29%   0.00%]
 [  5.80%  74.84%  19.37%   0.00%]
 [  0.02%   0.71%  99.27%   0.00%]
 [  7.31%   2.52%  90.17%   0.00%]]
[2024-01-06 18:05:31,674] {result_logger:154} INFO - 
[[ 92.35%   4.10%  63.00%    nan%]
 [  7.43%  95.68%  19.57%    nan%]
 [  0.00%   0.14%  15.26%    nan%]
 [  0.22%   0.08%   2.16%    nan%]]
[2024-01-06 18:05:32,243] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 18:05:32,243] {result_logger:77} INFO - actual:
[2024-01-06 18:05:32,244] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 18:05:32,244] {result_logger:79} INFO - predicted:
[2024-01-06 18:05:32,244] {result_logger:80} INFO - 
[[89.82%  1.90%  8.27%  0.00%]
 [ 1.95% 91.90%  6.16%  0.00%]
 [ 6.49%  4.91% 88.61%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 18:05:32,281] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it2/model_8conv_2fc-best.pth
[2024-01-06 18:05:32,281] {run_experiment:113} INFO - [epoch   5] execution time: 232.46s	 avg f1-score: 0.5929

[2024-01-06 18:05:32,281] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 18:05:32,337] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 18:05:59,141] {train_model:86} INFO - Train Epoch: 6 [60928/612104 (10%)]	lr:2.14e-04	Loss: 0.142617
[2024-01-06 18:06:13,016] {train_model:86} INFO - Train Epoch: 6 [122112/612104 (20%)]	lr:2.14e-04	Loss: 0.305863
[2024-01-06 18:06:41,566] {train_model:86} INFO - Train Epoch: 6 [183296/612104 (30%)]	lr:2.14e-04	Loss: 0.255601
[2024-01-06 18:07:07,874] {train_model:86} INFO - Train Epoch: 6 [244480/612104 (40%)]	lr:2.14e-04	Loss: 0.271989
[2024-01-06 18:07:21,340] {train_model:86} INFO - Train Epoch: 6 [305664/612104 (50%)]	lr:2.14e-04	Loss: 0.100254
[2024-01-06 18:07:33,497] {train_model:86} INFO - Train Epoch: 6 [366848/612104 (60%)]	lr:2.14e-04	Loss: 0.161927
[2024-01-06 18:07:46,263] {train_model:86} INFO - Train Epoch: 6 [428032/612104 (70%)]	lr:2.14e-04	Loss: 0.197779
[2024-01-06 18:08:13,930] {train_model:86} INFO - Train Epoch: 6 [489216/612104 (80%)]	lr:2.14e-04	Loss: 0.133045
[2024-01-06 18:08:39,836] {train_model:86} INFO - Train Epoch: 6 [550400/612104 (90%)]	lr:2.14e-04	Loss: 0.266848
[2024-01-06 18:08:52,534] {train_model:86} INFO - Train Epoch: 6 [611584/612104 (100%)]	lr:2.14e-04	Loss: 0.138879
[2024-01-06 18:09:06,444] {run_experiment:78} INFO - 
[2024-01-06 18:09:06,450] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 18:09:07,910] {result_logger:108} INFO - precision on WAKE: 0.985
[2024-01-06 18:09:08,833] {result_logger:109} INFO - recall on WAKE: 0.946
[2024-01-06 18:09:09,778] {result_logger:112} INFO - F1-score on WAKE: 0.965
[2024-01-06 18:09:09,778] {result_logger:113} INFO - 
[2024-01-06 18:09:11,228] {result_logger:108} INFO - precision on NREM: 0.938
[2024-01-06 18:09:12,157] {result_logger:109} INFO - recall on NREM: 0.924
[2024-01-06 18:09:13,065] {result_logger:112} INFO - F1-score on NREM: 0.931
[2024-01-06 18:09:13,065] {result_logger:113} INFO - 
[2024-01-06 18:09:14,365] {result_logger:108} INFO - precision on REM: 0.637
[2024-01-06 18:09:15,154] {result_logger:109} INFO - recall on REM: 0.913
[2024-01-06 18:09:15,951] {result_logger:112} INFO - F1-score on REM: 0.750
[2024-01-06 18:09:15,951] {result_logger:113} INFO - 
[2024-01-06 18:09:16,162] {result_logger:116} INFO - average precision on sleep stages: 0.853
[2024-01-06 18:09:16,374] {result_logger:118} INFO - average recall on sleep stages: 0.928
[2024-01-06 18:09:16,581] {result_logger:120} INFO - average F1-score on sleep stages: 0.882
[2024-01-06 18:09:17,174] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.928
[2024-01-06 18:09:17,202] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.935
[2024-01-06 18:09:17,206] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 18:09:17,386] {result_logger:108} INFO - precision on WAKE: 0.867
[2024-01-06 18:09:17,498] {result_logger:109} INFO - recall on WAKE: 0.918
[2024-01-06 18:09:17,611] {result_logger:112} INFO - F1-score on WAKE: 0.892
[2024-01-06 18:09:17,611] {result_logger:113} INFO - 
[2024-01-06 18:09:17,791] {result_logger:108} INFO - precision on NREM: 0.961
[2024-01-06 18:09:17,903] {result_logger:109} INFO - recall on NREM: 0.720
[2024-01-06 18:09:18,016] {result_logger:112} INFO - F1-score on NREM: 0.823
[2024-01-06 18:09:18,016] {result_logger:113} INFO - 
[2024-01-06 18:09:18,195] {result_logger:108} INFO - precision on REM: 0.441
[2024-01-06 18:09:18,308] {result_logger:109} INFO - recall on REM: 0.934
[2024-01-06 18:09:18,420] {result_logger:112} INFO - F1-score on REM: 0.599
[2024-01-06 18:09:18,421] {result_logger:113} INFO - 
[2024-01-06 18:09:18,442] {result_logger:116} INFO - average precision on sleep stages: 0.756
[2024-01-06 18:09:18,464] {result_logger:118} INFO - average recall on sleep stages: 0.857
[2024-01-06 18:09:18,485] {result_logger:120} INFO - average F1-score on sleep stages: 0.771
[2024-01-06 18:09:18,567] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.857
[2024-01-06 18:09:18,570] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.840
[2024-01-06 18:09:18,571] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 18:09:19,218] {result_logger:143} INFO - 
[[314127  12053   5873      2]
 [  3865 221035  14287      3]
 [   842   2509  35316      4]
 [  1870    260     58      0]]
[2024-01-06 18:09:19,884] {result_logger:150} INFO - 
[[ 94.60%   3.63%   1.77%   0.00%]
 [  1.62%  92.41%   5.97%   0.00%]
 [  2.18%   6.49%  91.32%   0.01%]
 [ 85.47%  11.88%   2.65%   0.00%]]
[2024-01-06 18:09:20,565] {result_logger:154} INFO - 
[[ 97.95%   5.11%  10.58%  22.22%]
 [  1.21%  93.72%  25.73%  33.33%]
 [  0.26%   1.06%  63.59%  44.44%]
 [  0.58%   0.11%   0.10%   0.00%]]
[2024-01-06 18:09:20,565] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 18:09:20,654] {result_logger:143} INFO - 
[[44350   960  3009     0]
 [ 6526 25264  3315     0]
 [  281    70  4990     0]
 [  601    42   191     0]]
[2024-01-06 18:09:20,880] {result_logger:150} INFO - 
[[ 91.79%   1.99%   6.23%   0.00%]
 [ 18.59%  71.97%   9.44%   0.00%]
 [  5.26%   1.31%  93.43%   0.00%]
 [ 72.06%   5.04%  22.90%   0.00%]]
[2024-01-06 18:09:21,101] {result_logger:154} INFO - 
[[ 85.69%   3.65%  26.15%    nan%]
 [ 12.61%  95.93%  28.81%    nan%]
 [  0.54%   0.27%  43.37%    nan%]
 [  1.16%   0.16%   1.66%    nan%]]
[2024-01-06 18:09:21,581] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 18:09:21,581] {result_logger:77} INFO - actual:
[2024-01-06 18:09:21,581] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 18:09:21,581] {result_logger:79} INFO - predicted:
[2024-01-06 18:09:21,581] {result_logger:80} INFO - 
[[95.09%  2.12%  2.79%  0.00%]
 [ 3.77% 93.13%  3.09%  0.00%]
 [13.43%  6.21% 80.37%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 18:09:21,622] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it2/model_8conv_2fc-best.pth
[2024-01-06 18:09:21,622] {run_experiment:113} INFO - [epoch   6] execution time: 229.34s	 avg f1-score: 0.7713

[2024-01-06 18:09:21,622] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 18:09:21,680] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 18:09:48,438] {train_model:86} INFO - Train Epoch: 7 [60928/612104 (10%)]	lr:2.01e-04	Loss: 0.163648
[2024-01-06 18:10:16,548] {train_model:86} INFO - Train Epoch: 7 [122112/612104 (20%)]	lr:2.01e-04	Loss: 0.142400
[2024-01-06 18:10:42,448] {train_model:86} INFO - Train Epoch: 7 [183296/612104 (30%)]	lr:2.01e-04	Loss: 0.135214
[2024-01-06 18:10:55,710] {train_model:86} INFO - Train Epoch: 7 [244480/612104 (40%)]	lr:2.01e-04	Loss: 0.089819
[2024-01-06 18:11:09,424] {train_model:86} INFO - Train Epoch: 7 [305664/612104 (50%)]	lr:2.01e-04	Loss: 0.173476
[2024-01-06 18:11:23,200] {train_model:86} INFO - Train Epoch: 7 [366848/612104 (60%)]	lr:2.01e-04	Loss: 0.148230
[2024-01-06 18:11:51,019] {train_model:86} INFO - Train Epoch: 7 [428032/612104 (70%)]	lr:2.01e-04	Loss: 0.208548
[2024-01-06 18:12:16,783] {train_model:86} INFO - Train Epoch: 7 [489216/612104 (80%)]	lr:2.01e-04	Loss: 0.212574
[2024-01-06 18:12:28,722] {train_model:86} INFO - Train Epoch: 7 [550400/612104 (90%)]	lr:2.01e-04	Loss: 0.120798
[2024-01-06 18:12:41,192] {train_model:86} INFO - Train Epoch: 7 [611584/612104 (100%)]	lr:2.01e-04	Loss: 0.217642
[2024-01-06 18:12:54,795] {run_experiment:78} INFO - 
[2024-01-06 18:12:54,802] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 18:12:56,165] {result_logger:108} INFO - precision on WAKE: 0.986
[2024-01-06 18:12:57,078] {result_logger:109} INFO - recall on WAKE: 0.949
[2024-01-06 18:12:57,972] {result_logger:112} INFO - F1-score on WAKE: 0.967
[2024-01-06 18:12:57,972] {result_logger:113} INFO - 
[2024-01-06 18:12:59,342] {result_logger:108} INFO - precision on NREM: 0.941
[2024-01-06 18:13:00,248] {result_logger:109} INFO - recall on NREM: 0.931
[2024-01-06 18:13:01,155] {result_logger:112} INFO - F1-score on NREM: 0.936
[2024-01-06 18:13:01,155] {result_logger:113} INFO - 
[2024-01-06 18:13:02,422] {result_logger:108} INFO - precision on REM: 0.662
[2024-01-06 18:13:03,215] {result_logger:109} INFO - recall on REM: 0.923
[2024-01-06 18:13:03,974] {result_logger:112} INFO - F1-score on REM: 0.771
[2024-01-06 18:13:03,974] {result_logger:113} INFO - 
[2024-01-06 18:13:04,186] {result_logger:116} INFO - average precision on sleep stages: 0.863
[2024-01-06 18:13:04,396] {result_logger:118} INFO - average recall on sleep stages: 0.934
[2024-01-06 18:13:04,610] {result_logger:120} INFO - average F1-score on sleep stages: 0.891
[2024-01-06 18:13:05,177] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.934
[2024-01-06 18:13:05,206] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.940
[2024-01-06 18:13:05,210] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 18:13:05,391] {result_logger:108} INFO - precision on WAKE: 0.837
[2024-01-06 18:13:05,498] {result_logger:109} INFO - recall on WAKE: 0.977
[2024-01-06 18:13:05,608] {result_logger:112} INFO - F1-score on WAKE: 0.902
[2024-01-06 18:13:05,608] {result_logger:113} INFO - 
[2024-01-06 18:13:05,793] {result_logger:108} INFO - precision on NREM: 0.927
[2024-01-06 18:13:05,903] {result_logger:109} INFO - recall on NREM: 0.796
[2024-01-06 18:13:06,006] {result_logger:112} INFO - F1-score on NREM: 0.857
[2024-01-06 18:13:06,006] {result_logger:113} INFO - 
[2024-01-06 18:13:06,183] {result_logger:108} INFO - precision on REM: 0.860
[2024-01-06 18:13:06,291] {result_logger:109} INFO - recall on REM: 0.357
[2024-01-06 18:13:06,398] {result_logger:112} INFO - F1-score on REM: 0.505
[2024-01-06 18:13:06,398] {result_logger:113} INFO - 
[2024-01-06 18:13:06,418] {result_logger:116} INFO - average precision on sleep stages: 0.875
[2024-01-06 18:13:06,438] {result_logger:118} INFO - average recall on sleep stages: 0.710
[2024-01-06 18:13:06,459] {result_logger:120} INFO - average F1-score on sleep stages: 0.754
[2024-01-06 18:13:06,539] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.710
[2024-01-06 18:13:06,542] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.868
[2024-01-06 18:13:06,543] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 18:13:07,172] {result_logger:143} INFO - 
[[315084  11584   5385      2]
 [  3758 222584  12847      1]
 [   689   2277  35699      6]
 [  1888    250     50      0]]
[2024-01-06 18:13:07,808] {result_logger:150} INFO - 
[[ 94.89%   3.49%   1.62%   0.00%]
 [  1.57%  93.06%   5.37%   0.00%]
 [  1.78%   5.89%  92.31%   0.02%]
 [ 86.29%  11.43%   2.29%   0.00%]]
[2024-01-06 18:13:08,427] {result_logger:154} INFO - 
[[ 98.03%   4.89%   9.98%  22.22%]
 [  1.17%  94.04%  23.80%  11.11%]
 [  0.21%   0.96%  66.13%  66.67%]
 [  0.59%   0.11%   0.09%   0.00%]]
[2024-01-06 18:13:08,427] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 18:13:08,511] {result_logger:143} INFO - 
[[47202  1099    18     0]
 [ 6859 27954   292     0]
 [ 2334  1099  1908     0]
 [  791    39     4     0]]
[2024-01-06 18:13:08,723] {result_logger:150} INFO - 
[[ 97.69%   2.27%   0.04%   0.00%]
 [ 19.54%  79.63%   0.83%   0.00%]
 [ 43.70%  20.58%  35.72%   0.00%]
 [ 94.84%   4.68%   0.48%   0.00%]]
[2024-01-06 18:13:08,938] {result_logger:154} INFO - 
[[ 82.54%   3.64%   0.81%    nan%]
 [ 11.99%  92.59%  13.14%    nan%]
 [  4.08%   3.64%  85.87%    nan%]
 [  1.38%   0.13%   0.18%    nan%]]
[2024-01-06 18:13:09,392] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 18:13:09,392] {result_logger:77} INFO - actual:
[2024-01-06 18:13:09,392] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 18:13:09,392] {result_logger:79} INFO - predicted:
[2024-01-06 18:13:09,392] {result_logger:80} INFO - 
[[96.64%  3.03%  0.33%  0.00%]
 [ 5.43% 93.70%  0.87%  0.00%]
 [12.60%  7.70% 79.70%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 18:13:09,430] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it2/model_8conv_2fc-best.pth
[2024-01-06 18:13:09,431] {run_experiment:113} INFO - [epoch   7] execution time: 227.81s	 avg f1-score: 0.7544

[2024-01-06 18:13:09,431] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 18:13:09,489] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 18:13:55,876] {train_model:86} INFO - Train Epoch: 8 [60928/612104 (10%)]	lr:1.90e-04	Loss: 0.508782
[2024-01-06 18:14:17,986] {train_model:86} INFO - Train Epoch: 8 [122112/612104 (20%)]	lr:1.90e-04	Loss: 0.127667
[2024-01-06 18:14:30,930] {train_model:86} INFO - Train Epoch: 8 [183296/612104 (30%)]	lr:1.90e-04	Loss: 0.139074
[2024-01-06 18:14:44,550] {train_model:86} INFO - Train Epoch: 8 [244480/612104 (40%)]	lr:1.90e-04	Loss: 0.326790
[2024-01-06 18:14:58,397] {train_model:86} INFO - Train Epoch: 8 [305664/612104 (50%)]	lr:1.90e-04	Loss: 0.123965
[2024-01-06 18:15:11,892] {train_model:86} INFO - Train Epoch: 8 [366848/612104 (60%)]	lr:1.90e-04	Loss: 0.167665
[2024-01-06 18:15:39,500] {train_model:86} INFO - Train Epoch: 8 [428032/612104 (70%)]	lr:1.90e-04	Loss: 0.332109
[2024-01-06 18:16:07,307] {train_model:86} INFO - Train Epoch: 8 [489216/612104 (80%)]	lr:1.90e-04	Loss: 0.127481
[2024-01-06 18:16:20,668] {train_model:86} INFO - Train Epoch: 8 [550400/612104 (90%)]	lr:1.90e-04	Loss: 0.096631
[2024-01-06 18:16:48,655] {train_model:86} INFO - Train Epoch: 8 [611584/612104 (100%)]	lr:1.90e-04	Loss: 0.492042
[2024-01-06 18:17:02,473] {run_experiment:78} INFO - 
[2024-01-06 18:17:02,479] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 18:17:03,838] {result_logger:108} INFO - precision on WAKE: 0.987
[2024-01-06 18:17:04,714] {result_logger:109} INFO - recall on WAKE: 0.951
[2024-01-06 18:17:05,592] {result_logger:112} INFO - F1-score on WAKE: 0.969
[2024-01-06 18:17:05,593] {result_logger:113} INFO - 
[2024-01-06 18:17:06,950] {result_logger:108} INFO - precision on NREM: 0.943
[2024-01-06 18:17:07,803] {result_logger:109} INFO - recall on NREM: 0.933
[2024-01-06 18:17:08,667] {result_logger:112} INFO - F1-score on NREM: 0.938
[2024-01-06 18:17:08,667] {result_logger:113} INFO - 
[2024-01-06 18:17:09,922] {result_logger:108} INFO - precision on REM: 0.677
[2024-01-06 18:17:10,687] {result_logger:109} INFO - recall on REM: 0.930
[2024-01-06 18:17:11,468] {result_logger:112} INFO - F1-score on REM: 0.784
[2024-01-06 18:17:11,468] {result_logger:113} INFO - 
[2024-01-06 18:17:11,675] {result_logger:116} INFO - average precision on sleep stages: 0.869
[2024-01-06 18:17:11,889] {result_logger:118} INFO - average recall on sleep stages: 0.938
[2024-01-06 18:17:12,102] {result_logger:120} INFO - average F1-score on sleep stages: 0.897
[2024-01-06 18:17:12,694] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.938
[2024-01-06 18:17:12,723] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.943
[2024-01-06 18:17:12,727] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 18:17:12,914] {result_logger:108} INFO - precision on WAKE: 0.741
[2024-01-06 18:17:13,026] {result_logger:109} INFO - recall on WAKE: 0.992
[2024-01-06 18:17:13,136] {result_logger:112} INFO - F1-score on WAKE: 0.849
[2024-01-06 18:17:13,136] {result_logger:113} INFO - 
[2024-01-06 18:17:13,328] {result_logger:108} INFO - precision on NREM: 0.974
[2024-01-06 18:17:13,442] {result_logger:109} INFO - recall on NREM: 0.629
[2024-01-06 18:17:13,557] {result_logger:112} INFO - F1-score on NREM: 0.764
[2024-01-06 18:17:13,557] {result_logger:113} INFO - 
[2024-01-06 18:17:13,743] {result_logger:108} INFO - precision on REM: 0.878
[2024-01-06 18:17:13,856] {result_logger:109} INFO - recall on REM: 0.230
[2024-01-06 18:17:13,968] {result_logger:112} INFO - F1-score on REM: 0.365
[2024-01-06 18:17:13,969] {result_logger:113} INFO - 
[2024-01-06 18:17:13,990] {result_logger:116} INFO - average precision on sleep stages: 0.864
[2024-01-06 18:17:14,017] {result_logger:118} INFO - average recall on sleep stages: 0.617
[2024-01-06 18:17:14,043] {result_logger:120} INFO - average F1-score on sleep stages: 0.659
[2024-01-06 18:17:14,124] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.617
[2024-01-06 18:17:14,127] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.803
[2024-01-06 18:17:14,128] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 18:17:14,812] {result_logger:143} INFO - 
[[315810  11402   4841      2]
 [  3611 223283  12295      1]
 [   668   2043  35947     13]
 [  1875    253     59      1]]
[2024-01-06 18:17:15,473] {result_logger:150} INFO - 
[[ 95.11%   3.43%   1.46%   0.00%]
 [  1.51%  93.35%   5.14%   0.00%]
 [  1.73%   5.28%  92.96%   0.03%]
 [ 85.69%  11.56%   2.70%   0.05%]]
[2024-01-06 18:17:16,137] {result_logger:154} INFO - 
[[ 98.09%   4.81%   9.11%  11.76%]
 [  1.12%  94.22%  23.14%   5.88%]
 [  0.21%   0.86%  67.64%  76.47%]
 [  0.58%   0.11%   0.11%   5.88%]]
[2024-01-06 18:17:16,137] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 18:17:16,224] {result_logger:143} INFO - 
[[47953   364     2     0]
 [12866 22070   169     0]
 [ 3888   222  1231     0]
 [  816    18     0     0]]
[2024-01-06 18:17:16,445] {result_logger:150} INFO - 
[[ 99.24%   0.75%   0.00%   0.00%]
 [ 36.65%  62.87%   0.48%   0.00%]
 [ 72.80%   4.16%  23.05%   0.00%]
 [ 97.84%   2.16%   0.00%   0.00%]]
[2024-01-06 18:17:16,662] {result_logger:154} INFO - 
[[ 73.18%   1.61%   0.14%    nan%]
 [ 19.64%  97.34%  12.05%    nan%]
 [  5.93%   0.98%  87.80%    nan%]
 [  1.25%   0.08%   0.00%    nan%]]
[2024-01-06 18:17:17,133] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 18:17:17,133] {result_logger:77} INFO - actual:
[2024-01-06 18:17:17,133] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 18:17:17,133] {result_logger:79} INFO - predicted:
[2024-01-06 18:17:17,134] {result_logger:80} INFO - 
[[96.64%  3.04%  0.32%  0.00%]
 [ 8.46% 91.08%  0.46%  0.00%]
 [20.33%  2.14% 77.53%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 18:17:17,178] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it2/model_8conv_2fc-best.pth
[2024-01-06 18:17:17,178] {run_experiment:113} INFO - [epoch   8] execution time: 247.75s	 avg f1-score: 0.6593

[2024-01-06 18:17:17,178] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 18:17:17,239] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 18:17:44,796] {train_model:86} INFO - Train Epoch: 9 [60928/612104 (10%)]	lr:1.79e-04	Loss: 0.133927
[2024-01-06 18:17:58,036] {train_model:86} INFO - Train Epoch: 9 [122112/612104 (20%)]	lr:1.79e-04	Loss: 0.224226
[2024-01-06 18:18:11,933] {train_model:86} INFO - Train Epoch: 9 [183296/612104 (30%)]	lr:1.79e-04	Loss: 0.130051
[2024-01-06 18:18:25,577] {train_model:86} INFO - Train Epoch: 9 [244480/612104 (40%)]	lr:1.79e-04	Loss: 0.208294
[2024-01-06 18:18:37,595] {train_model:86} INFO - Train Epoch: 9 [305664/612104 (50%)]	lr:1.79e-04	Loss: 0.128950
[2024-01-06 18:19:05,810] {train_model:86} INFO - Train Epoch: 9 [366848/612104 (60%)]	lr:1.79e-04	Loss: 0.108451
[2024-01-06 18:19:31,732] {train_model:86} INFO - Train Epoch: 9 [428032/612104 (70%)]	lr:1.79e-04	Loss: 0.150308
[2024-01-06 18:19:43,791] {train_model:86} INFO - Train Epoch: 9 [489216/612104 (80%)]	lr:1.79e-04	Loss: 0.291171
[2024-01-06 18:20:11,559] {train_model:86} INFO - Train Epoch: 9 [550400/612104 (90%)]	lr:1.79e-04	Loss: 0.209784
[2024-01-06 18:20:37,857] {train_model:86} INFO - Train Epoch: 9 [611584/612104 (100%)]	lr:1.79e-04	Loss: 0.117815
[2024-01-06 18:20:51,971] {run_experiment:78} INFO - 
[2024-01-06 18:20:51,979] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 18:20:53,396] {result_logger:108} INFO - precision on WAKE: 0.987
[2024-01-06 18:20:54,330] {result_logger:109} INFO - recall on WAKE: 0.953
[2024-01-06 18:20:55,263] {result_logger:112} INFO - F1-score on WAKE: 0.969
[2024-01-06 18:20:55,263] {result_logger:113} INFO - 
[2024-01-06 18:20:56,666] {result_logger:108} INFO - precision on NREM: 0.945
[2024-01-06 18:20:57,599] {result_logger:109} INFO - recall on NREM: 0.936
[2024-01-06 18:20:58,525] {result_logger:112} INFO - F1-score on NREM: 0.940
[2024-01-06 18:20:58,525] {result_logger:113} INFO - 
[2024-01-06 18:20:59,817] {result_logger:108} INFO - precision on REM: 0.690
[2024-01-06 18:21:00,634] {result_logger:109} INFO - recall on REM: 0.933
[2024-01-06 18:21:01,446] {result_logger:112} INFO - F1-score on REM: 0.793
[2024-01-06 18:21:01,447] {result_logger:113} INFO - 
[2024-01-06 18:21:01,665] {result_logger:116} INFO - average precision on sleep stages: 0.874
[2024-01-06 18:21:01,881] {result_logger:118} INFO - average recall on sleep stages: 0.941
[2024-01-06 18:21:02,100] {result_logger:120} INFO - average F1-score on sleep stages: 0.901
[2024-01-06 18:21:02,699] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.941
[2024-01-06 18:21:02,730] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.945
[2024-01-06 18:21:02,736] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 18:21:02,917] {result_logger:108} INFO - precision on WAKE: 0.870
[2024-01-06 18:21:03,029] {result_logger:109} INFO - recall on WAKE: 0.976
[2024-01-06 18:21:03,142] {result_logger:112} INFO - F1-score on WAKE: 0.920
[2024-01-06 18:21:03,142] {result_logger:113} INFO - 
[2024-01-06 18:21:03,322] {result_logger:108} INFO - precision on NREM: 0.949
[2024-01-06 18:21:03,435] {result_logger:109} INFO - recall on NREM: 0.797
[2024-01-06 18:21:03,548] {result_logger:112} INFO - F1-score on NREM: 0.866
[2024-01-06 18:21:03,548] {result_logger:113} INFO - 
[2024-01-06 18:21:03,728] {result_logger:108} INFO - precision on REM: 0.731
[2024-01-06 18:21:03,839] {result_logger:109} INFO - recall on REM: 0.702
[2024-01-06 18:21:03,948] {result_logger:112} INFO - F1-score on REM: 0.716
[2024-01-06 18:21:03,948] {result_logger:113} INFO - 
[2024-01-06 18:21:03,967] {result_logger:116} INFO - average precision on sleep stages: 0.850
[2024-01-06 18:21:03,986] {result_logger:118} INFO - average recall on sleep stages: 0.825
[2024-01-06 18:21:04,006] {result_logger:120} INFO - average F1-score on sleep stages: 0.834
[2024-01-06 18:21:04,083] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.825
[2024-01-06 18:21:04,086] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.888
[2024-01-06 18:21:04,087] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 18:21:04,701] {result_logger:143} INFO - 
[[316363  11135   4556      1]
 [  3611 223925  11652      2]
 [   608   1982  36078      3]
 [  1895    243     50      0]]
[2024-01-06 18:21:05,322] {result_logger:150} INFO - 
[[ 95.27%   3.35%   1.37%   0.00%]
 [  1.51%  93.62%   4.87%   0.00%]
 [  1.57%   5.13%  93.29%   0.01%]
 [ 86.61%  11.11%   2.29%   0.00%]]
[2024-01-06 18:21:05,941] {result_logger:154} INFO - 
[[ 98.10%   4.69%   8.71%  16.67%]
 [  1.12%  94.37%  22.26%  33.33%]
 [  0.19%   0.84%  68.94%  50.00%]
 [  0.59%   0.10%   0.10%   0.00%]]
[2024-01-06 18:21:05,941] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 18:21:06,026] {result_logger:143} INFO - 
[[47145  1089    85     0]
 [ 5844 27965  1296     0]
 [ 1177   415  3749     0]
 [  759    41    34     0]]
[2024-01-06 18:21:06,240] {result_logger:150} INFO - 
[[ 97.57%   2.25%   0.18%   0.00%]
 [ 16.65%  79.66%   3.69%   0.00%]
 [ 22.04%   7.77%  70.19%   0.00%]
 [ 91.01%   4.92%   4.08%   0.00%]]
[2024-01-06 18:21:06,547] {result_logger:154} INFO - 
[[ 85.84%   3.69%   1.65%    nan%]
 [ 10.64%  94.76%  25.10%    nan%]
 [  2.14%   1.41%  72.60%    nan%]
 [  1.38%   0.14%   0.66%    nan%]]
[2024-01-06 18:21:06,979] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 18:21:06,979] {result_logger:77} INFO - actual:
[2024-01-06 18:21:06,979] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 18:21:06,979] {result_logger:79} INFO - predicted:
[2024-01-06 18:21:06,979] {result_logger:80} INFO - 
[[96.53%  2.87%  0.60%  0.00%]
 [ 4.61% 93.48%  1.91%  0.00%]
 [10.53%  6.74% 82.73%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 18:21:07,016] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it2/model_8conv_2fc-best.pth
[2024-01-06 18:21:07,016] {run_experiment:113} INFO - [epoch   9] execution time: 229.84s	 avg f1-score: 0.8341

[2024-01-06 18:21:07,016] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 18:21:07,076] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 18:21:33,999] {train_model:86} INFO - Train Epoch: 10 [60928/612104 (10%)]	lr:1.68e-04	Loss: 0.180922
[2024-01-06 18:21:47,257] {train_model:86} INFO - Train Epoch: 10 [122112/612104 (20%)]	lr:1.68e-04	Loss: 0.162010
[2024-01-06 18:21:59,492] {train_model:86} INFO - Train Epoch: 10 [183296/612104 (30%)]	lr:1.68e-04	Loss: 0.188352
[2024-01-06 18:22:11,994] {train_model:86} INFO - Train Epoch: 10 [244480/612104 (40%)]	lr:1.68e-04	Loss: 0.150989
[2024-01-06 18:22:26,599] {train_model:86} INFO - Train Epoch: 10 [305664/612104 (50%)]	lr:1.68e-04	Loss: 0.092810
[2024-01-06 18:22:54,737] {train_model:86} INFO - Train Epoch: 10 [366848/612104 (60%)]	lr:1.68e-04	Loss: 0.083108
[2024-01-06 18:23:20,796] {train_model:86} INFO - Train Epoch: 10 [428032/612104 (70%)]	lr:1.68e-04	Loss: 0.172926
[2024-01-06 18:23:49,102] {train_model:86} INFO - Train Epoch: 10 [489216/612104 (80%)]	lr:1.68e-04	Loss: 0.094674
[2024-01-06 18:24:16,019] {train_model:86} INFO - Train Epoch: 10 [550400/612104 (90%)]	lr:1.68e-04	Loss: 0.111522
[2024-01-06 18:24:28,895] {train_model:86} INFO - Train Epoch: 10 [611584/612104 (100%)]	lr:1.68e-04	Loss: 0.120833
[2024-01-06 18:24:43,237] {run_experiment:78} INFO - 
[2024-01-06 18:24:43,243] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 18:24:44,774] {result_logger:108} INFO - precision on WAKE: 0.987
[2024-01-06 18:24:45,761] {result_logger:109} INFO - recall on WAKE: 0.955
[2024-01-06 18:24:46,751] {result_logger:112} INFO - F1-score on WAKE: 0.971
[2024-01-06 18:24:46,751] {result_logger:113} INFO - 
[2024-01-06 18:24:48,220] {result_logger:108} INFO - precision on NREM: 0.947
[2024-01-06 18:24:49,164] {result_logger:109} INFO - recall on NREM: 0.938
[2024-01-06 18:24:50,088] {result_logger:112} INFO - F1-score on NREM: 0.943
[2024-01-06 18:24:50,088] {result_logger:113} INFO - 
[2024-01-06 18:24:51,365] {result_logger:108} INFO - precision on REM: 0.700
[2024-01-06 18:24:52,171] {result_logger:109} INFO - recall on REM: 0.937
[2024-01-06 18:24:52,962] {result_logger:112} INFO - F1-score on REM: 0.801
[2024-01-06 18:24:52,962] {result_logger:113} INFO - 
[2024-01-06 18:24:53,167] {result_logger:116} INFO - average precision on sleep stages: 0.878
[2024-01-06 18:24:53,378] {result_logger:118} INFO - average recall on sleep stages: 0.943
[2024-01-06 18:24:53,588] {result_logger:120} INFO - average F1-score on sleep stages: 0.905
[2024-01-06 18:24:54,160] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.943
[2024-01-06 18:24:54,189] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.947
[2024-01-06 18:24:54,192] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 18:24:54,363] {result_logger:108} INFO - precision on WAKE: 0.884
[2024-01-06 18:24:54,472] {result_logger:109} INFO - recall on WAKE: 0.825
[2024-01-06 18:24:54,580] {result_logger:112} INFO - F1-score on WAKE: 0.854
[2024-01-06 18:24:54,580] {result_logger:113} INFO - 
[2024-01-06 18:24:54,753] {result_logger:108} INFO - precision on NREM: 0.951
[2024-01-06 18:24:54,862] {result_logger:109} INFO - recall on NREM: 0.770
[2024-01-06 18:24:54,971] {result_logger:112} INFO - F1-score on NREM: 0.851
[2024-01-06 18:24:54,971] {result_logger:113} INFO - 
[2024-01-06 18:24:55,144] {result_logger:108} INFO - precision on REM: 0.335
[2024-01-06 18:24:55,251] {result_logger:109} INFO - recall on REM: 0.955
[2024-01-06 18:24:55,361] {result_logger:112} INFO - F1-score on REM: 0.496
[2024-01-06 18:24:55,361] {result_logger:113} INFO - 
[2024-01-06 18:24:55,381] {result_logger:116} INFO - average precision on sleep stages: 0.723
[2024-01-06 18:24:55,401] {result_logger:118} INFO - average recall on sleep stages: 0.850
[2024-01-06 18:24:55,422] {result_logger:120} INFO - average F1-score on sleep stages: 0.734
[2024-01-06 18:24:55,501] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.850
[2024-01-06 18:24:55,505] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.811
[2024-01-06 18:24:55,505] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 18:24:56,143] {result_logger:143} INFO - 
[[317125  10650   4279      1]
 [  3538 224386  11266      0]
 [   560   1886  36223      2]
 [  1883    253     52      0]]
[2024-01-06 18:24:56,783] {result_logger:150} INFO - 
[[ 95.50%   3.21%   1.29%   0.00%]
 [  1.48%  93.81%   4.71%   0.00%]
 [  1.45%   4.88%  93.67%   0.01%]
 [ 86.06%  11.56%   2.38%   0.00%]]
[2024-01-06 18:24:57,413] {result_logger:154} INFO - 
[[ 98.15%   4.49%   8.26%  33.33%]
 [  1.09%  94.61%  21.74%   0.00%]
 [  0.17%   0.80%  69.90%  66.67%]
 [  0.58%   0.11%   0.10%   0.00%]]
[2024-01-06 18:24:57,413] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 18:24:57,498] {result_logger:143} INFO - 
[[39878  1309  7132     0]
 [ 5080 27029  2996     0]
 [  158    80  5103     0]
 [  272    73   489     0]]
[2024-01-06 18:24:57,713] {result_logger:150} INFO - 
[[ 82.53%   2.71%  14.76%   0.00%]
 [ 14.47%  76.99%   8.53%   0.00%]
 [  2.96%   1.50%  95.54%   0.00%]
 [ 32.61%   8.75%  58.63%   0.00%]]
[2024-01-06 18:24:57,925] {result_logger:154} INFO - 
[[ 87.86%   4.59%  45.37%    nan%]
 [ 11.19%  94.87%  19.06%    nan%]
 [  0.35%   0.28%  32.46%    nan%]
 [  0.60%   0.26%   3.11%    nan%]]
[2024-01-06 18:24:58,373] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 18:24:58,373] {result_logger:77} INFO - actual:
[2024-01-06 18:24:58,374] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 18:24:58,374] {result_logger:79} INFO - predicted:
[2024-01-06 18:24:58,374] {result_logger:80} INFO - 
[[93.91%  2.50%  3.59%  0.00%]
 [ 3.61% 93.29%  3.10%  0.00%]
 [11.03%  4.94% 84.03%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 18:24:58,419] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it2/model_8conv_2fc-best.pth
[2024-01-06 18:24:58,419] {run_experiment:113} INFO - [epoch  10] execution time: 231.40s	 avg f1-score: 0.7336

[2024-01-06 18:24:58,419] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 18:24:58,479] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 18:25:26,716] {train_model:86} INFO - Train Epoch: 11 [60928/612104 (10%)]	lr:1.58e-04	Loss: 0.113402
[2024-01-06 18:25:39,563] {train_model:86} INFO - Train Epoch: 11 [122112/612104 (20%)]	lr:1.58e-04	Loss: 0.131105
[2024-01-06 18:25:54,162] {train_model:86} INFO - Train Epoch: 11 [183296/612104 (30%)]	lr:1.58e-04	Loss: 0.087066
[2024-01-06 18:26:07,639] {train_model:86} INFO - Train Epoch: 11 [244480/612104 (40%)]	lr:1.58e-04	Loss: 0.178246
[2024-01-06 18:26:36,250] {train_model:86} INFO - Train Epoch: 11 [305664/612104 (50%)]	lr:1.58e-04	Loss: 0.103515
[2024-01-06 18:27:17,803] {train_model:86} INFO - Train Epoch: 11 [366848/612104 (60%)]	lr:1.58e-04	Loss: 0.124780
[2024-01-06 18:27:44,509] {train_model:86} INFO - Train Epoch: 11 [428032/612104 (70%)]	lr:1.58e-04	Loss: 0.160230
[2024-01-06 18:27:56,547] {train_model:86} INFO - Train Epoch: 11 [489216/612104 (80%)]	lr:1.58e-04	Loss: 0.109173
[2024-01-06 18:28:10,261] {train_model:86} INFO - Train Epoch: 11 [550400/612104 (90%)]	lr:1.58e-04	Loss: 0.141252
[2024-01-06 18:28:23,397] {train_model:86} INFO - Train Epoch: 11 [611584/612104 (100%)]	lr:1.58e-04	Loss: 0.124514
[2024-01-06 18:28:37,630] {run_experiment:78} INFO - 
[2024-01-06 18:28:37,636] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 18:28:39,211] {result_logger:108} INFO - precision on WAKE: 0.987
[2024-01-06 18:28:40,189] {result_logger:109} INFO - recall on WAKE: 0.956
[2024-01-06 18:28:41,187] {result_logger:112} INFO - F1-score on WAKE: 0.971
[2024-01-06 18:28:41,187] {result_logger:113} INFO - 
[2024-01-06 18:28:42,688] {result_logger:108} INFO - precision on NREM: 0.947
[2024-01-06 18:28:43,621] {result_logger:109} INFO - recall on NREM: 0.939
[2024-01-06 18:28:44,545] {result_logger:112} INFO - F1-score on NREM: 0.943
[2024-01-06 18:28:44,545] {result_logger:113} INFO - 
[2024-01-06 18:28:45,872] {result_logger:108} INFO - precision on REM: 0.704
[2024-01-06 18:28:46,686] {result_logger:109} INFO - recall on REM: 0.938
[2024-01-06 18:28:47,501] {result_logger:112} INFO - F1-score on REM: 0.804
[2024-01-06 18:28:47,501] {result_logger:113} INFO - 
[2024-01-06 18:28:47,713] {result_logger:116} INFO - average precision on sleep stages: 0.880
[2024-01-06 18:28:47,925] {result_logger:118} INFO - average recall on sleep stages: 0.944
[2024-01-06 18:28:48,140] {result_logger:120} INFO - average F1-score on sleep stages: 0.906
[2024-01-06 18:28:48,721] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.944
[2024-01-06 18:28:48,751] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.948
[2024-01-06 18:28:48,755] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 18:28:48,941] {result_logger:108} INFO - precision on WAKE: 0.752
[2024-01-06 18:28:49,054] {result_logger:109} INFO - recall on WAKE: 0.991
[2024-01-06 18:28:49,167] {result_logger:112} INFO - F1-score on WAKE: 0.855
[2024-01-06 18:28:49,167] {result_logger:113} INFO - 
[2024-01-06 18:28:49,350] {result_logger:108} INFO - precision on NREM: 0.973
[2024-01-06 18:28:49,464] {result_logger:109} INFO - recall on NREM: 0.602
[2024-01-06 18:28:49,577] {result_logger:112} INFO - F1-score on NREM: 0.744
[2024-01-06 18:28:49,577] {result_logger:113} INFO - 
[2024-01-06 18:28:49,763] {result_logger:108} INFO - precision on REM: 0.748
[2024-01-06 18:28:49,875] {result_logger:109} INFO - recall on REM: 0.482
[2024-01-06 18:28:49,987] {result_logger:112} INFO - F1-score on REM: 0.586
[2024-01-06 18:28:49,987] {result_logger:113} INFO - 
[2024-01-06 18:28:50,008] {result_logger:116} INFO - average precision on sleep stages: 0.824
[2024-01-06 18:28:50,029] {result_logger:118} INFO - average recall on sleep stages: 0.691
[2024-01-06 18:28:50,049] {result_logger:120} INFO - average F1-score on sleep stages: 0.728
[2024-01-06 18:28:50,125] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.691
[2024-01-06 18:28:50,128] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.806
[2024-01-06 18:28:50,129] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 18:28:50,800] {result_logger:143} INFO - 
[[317399  10594   4061      1]
 [  3484 224509  11196      1]
 [   563   1848  36258      2]
 [  1881    248     59      0]]
[2024-01-06 18:28:51,467] {result_logger:150} INFO - 
[[ 95.59%   3.19%   1.22%   0.00%]
 [  1.46%  93.86%   4.68%   0.00%]
 [  1.46%   4.78%  93.76%   0.01%]
 [ 85.97%  11.33%   2.70%   0.00%]]
[2024-01-06 18:28:52,134] {result_logger:154} INFO - 
[[ 98.17%   4.47%   7.87%  25.00%]
 [  1.08%  94.65%  21.71%  25.00%]
 [  0.17%   0.78%  70.30%  50.00%]
 [  0.58%   0.10%   0.11%   0.00%]]
[2024-01-06 18:28:52,134] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 18:28:52,222] {result_logger:143} INFO - 
[[47866   424    29     0]
 [13143 21124   838     0]
 [ 2603   165  2573     0]
 [  814    15     5     0]]
[2024-01-06 18:28:52,445] {result_logger:150} INFO - 
[[ 99.06%   0.88%   0.06%   0.00%]
 [ 37.44%  60.17%   2.39%   0.00%]
 [ 48.74%   3.09%  48.17%   0.00%]
 [ 97.60%   1.80%   0.60%   0.00%]]
[2024-01-06 18:28:52,657] {result_logger:154} INFO - 
[[ 74.30%   1.95%   0.84%    nan%]
 [ 20.40%  97.22%  24.33%    nan%]
 [  4.04%   0.76%  74.69%    nan%]
 [  1.26%   0.07%   0.15%    nan%]]
[2024-01-06 18:28:53,121] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 18:28:53,121] {result_logger:77} INFO - actual:
[2024-01-06 18:28:53,121] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 18:28:53,121] {result_logger:79} INFO - predicted:
[2024-01-06 18:28:53,121] {result_logger:80} INFO - 
[[97.03%  2.65%  0.32%  0.00%]
 [ 6.90% 91.47%  1.62%  0.00%]
 [11.99%  4.30% 83.72%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 18:28:53,165] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it2/model_8conv_2fc-best.pth
[2024-01-06 18:28:53,165] {run_experiment:113} INFO - [epoch  11] execution time: 234.75s	 avg f1-score: 0.7283

[2024-01-06 18:28:53,165] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 18:28:53,225] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 18:29:21,047] {train_model:86} INFO - Train Epoch: 12 [60928/612104 (10%)]	lr:1.49e-04	Loss: 0.229045
[2024-01-06 18:29:34,143] {train_model:86} INFO - Train Epoch: 12 [122112/612104 (20%)]	lr:1.49e-04	Loss: 0.179944
[2024-01-06 18:29:47,897] {train_model:86} INFO - Train Epoch: 12 [183296/612104 (30%)]	lr:1.49e-04	Loss: 0.100744
[2024-01-06 18:30:15,667] {train_model:86} INFO - Train Epoch: 12 [244480/612104 (40%)]	lr:1.49e-04	Loss: 0.056400
[2024-01-06 18:30:46,575] {train_model:86} INFO - Train Epoch: 12 [305664/612104 (50%)]	lr:1.49e-04	Loss: 0.207966
[2024-01-06 18:31:12,962] {train_model:86} INFO - Train Epoch: 12 [366848/612104 (60%)]	lr:1.49e-04	Loss: 0.141429
[2024-01-06 18:31:25,982] {train_model:86} INFO - Train Epoch: 12 [428032/612104 (70%)]	lr:1.49e-04	Loss: 0.081309
[2024-01-06 18:31:38,207] {train_model:86} INFO - Train Epoch: 12 [489216/612104 (80%)]	lr:1.49e-04	Loss: 0.213577
[2024-01-06 18:31:50,322] {train_model:86} INFO - Train Epoch: 12 [550400/612104 (90%)]	lr:1.49e-04	Loss: 0.163870
[2024-01-06 18:32:02,992] {train_model:86} INFO - Train Epoch: 12 [611584/612104 (100%)]	lr:1.49e-04	Loss: 0.092238
[2024-01-06 18:32:17,268] {run_experiment:78} INFO - 
[2024-01-06 18:32:17,274] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 18:32:18,733] {result_logger:108} INFO - precision on WAKE: 0.988
[2024-01-06 18:32:19,681] {result_logger:109} INFO - recall on WAKE: 0.957
[2024-01-06 18:32:20,620] {result_logger:112} INFO - F1-score on WAKE: 0.972
[2024-01-06 18:32:20,620] {result_logger:113} INFO - 
[2024-01-06 18:32:22,049] {result_logger:108} INFO - precision on NREM: 0.948
[2024-01-06 18:32:22,968] {result_logger:109} INFO - recall on NREM: 0.941
[2024-01-06 18:32:23,876] {result_logger:112} INFO - F1-score on NREM: 0.944
[2024-01-06 18:32:23,876] {result_logger:113} INFO - 
[2024-01-06 18:32:25,191] {result_logger:108} INFO - precision on REM: 0.714
[2024-01-06 18:32:25,983] {result_logger:109} INFO - recall on REM: 0.940
[2024-01-06 18:32:26,778] {result_logger:112} INFO - F1-score on REM: 0.811
[2024-01-06 18:32:26,778] {result_logger:113} INFO - 
[2024-01-06 18:32:26,996] {result_logger:116} INFO - average precision on sleep stages: 0.883
[2024-01-06 18:32:27,211] {result_logger:118} INFO - average recall on sleep stages: 0.946
[2024-01-06 18:32:27,427] {result_logger:120} INFO - average F1-score on sleep stages: 0.909
[2024-01-06 18:32:28,002] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.946
[2024-01-06 18:32:28,033] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.949
[2024-01-06 18:32:28,037] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 18:32:28,221] {result_logger:108} INFO - precision on WAKE: 0.875
[2024-01-06 18:32:28,331] {result_logger:109} INFO - recall on WAKE: 0.846
[2024-01-06 18:32:28,442] {result_logger:112} INFO - F1-score on WAKE: 0.861
[2024-01-06 18:32:28,442] {result_logger:113} INFO - 
[2024-01-06 18:32:28,630] {result_logger:108} INFO - precision on NREM: 0.945
[2024-01-06 18:32:28,742] {result_logger:109} INFO - recall on NREM: 0.781
[2024-01-06 18:32:28,851] {result_logger:112} INFO - F1-score on NREM: 0.855
[2024-01-06 18:32:28,852] {result_logger:113} INFO - 
[2024-01-06 18:32:29,034] {result_logger:108} INFO - precision on REM: 0.368
[2024-01-06 18:32:29,143] {result_logger:109} INFO - recall on REM: 0.898
[2024-01-06 18:32:29,252] {result_logger:112} INFO - F1-score on REM: 0.522
[2024-01-06 18:32:29,252] {result_logger:113} INFO - 
[2024-01-06 18:32:29,273] {result_logger:116} INFO - average precision on sleep stages: 0.730
[2024-01-06 18:32:29,292] {result_logger:118} INFO - average recall on sleep stages: 0.842
[2024-01-06 18:32:29,312] {result_logger:120} INFO - average F1-score on sleep stages: 0.746
[2024-01-06 18:32:29,390] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.842
[2024-01-06 18:32:29,394] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.824
[2024-01-06 18:32:29,394] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 18:32:30,034] {result_logger:143} INFO - 
[[317660  10554   3840      1]
 [  3408 225044  10738      0]
 [   537   1780  36353      1]
 [  1892    243     53      0]]
[2024-01-06 18:32:30,685] {result_logger:150} INFO - 
[[ 95.66%   3.18%   1.16%   0.00%]
 [  1.42%  94.09%   4.49%   0.00%]
 [  1.39%   4.60%  94.01%   0.00%]
 [ 86.47%  11.11%   2.42%   0.00%]]
[2024-01-06 18:32:31,332] {result_logger:154} INFO - 
[[ 98.20%   4.44%   7.53%  50.00%]
 [  1.05%  94.71%  21.06%   0.00%]
 [  0.17%   0.75%  71.30%  50.00%]
 [  0.58%   0.10%   0.10%   0.00%]]
[2024-01-06 18:32:31,333] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 18:32:31,420] {result_logger:143} INFO - 
[[40902  1478  5939     0]
 [ 5402 27413  2290     0]
 [  438   108  4795     0]
 [  339   111   384     0]]
[2024-01-06 18:32:31,641] {result_logger:150} INFO - 
[[ 84.65%   3.06%  12.29%   0.00%]
 [ 15.39%  78.09%   6.52%   0.00%]
 [  8.20%   2.02%  89.78%   0.00%]
 [ 40.65%  13.31%  46.04%   0.00%]]
[2024-01-06 18:32:31,855] {result_logger:154} INFO - 
[[ 86.88%   5.08%  44.29%    nan%]
 [ 11.47%  94.17%  17.08%    nan%]
 [  0.93%   0.37%  35.76%    nan%]
 [  0.72%   0.38%   2.86%    nan%]]
[2024-01-06 18:32:32,320] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 18:32:32,320] {result_logger:77} INFO - actual:
[2024-01-06 18:32:32,321] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 18:32:32,321] {result_logger:79} INFO - predicted:
[2024-01-06 18:32:32,321] {result_logger:80} INFO - 
[[94.36%  2.46%  3.18%  0.00%]
 [ 3.62% 93.80%  2.58%  0.00%]
 [11.93%  4.83% 83.25%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 18:32:32,359] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it2/model_8conv_2fc-best.pth
[2024-01-06 18:32:32,359] {run_experiment:113} INFO - [epoch  12] execution time: 219.19s	 avg f1-score: 0.7460

[2024-01-06 18:32:32,360] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 18:32:32,419] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 18:32:59,673] {train_model:86} INFO - Train Epoch: 13 [60928/612104 (10%)]	lr:1.40e-04	Loss: 0.243099
[2024-01-06 18:33:11,824] {train_model:86} INFO - Train Epoch: 13 [122112/612104 (20%)]	lr:1.40e-04	Loss: 0.103575
[2024-01-06 18:33:24,471] {train_model:86} INFO - Train Epoch: 13 [183296/612104 (30%)]	lr:1.40e-04	Loss: 0.099372
[2024-01-06 18:34:28,433] {train_model:86} INFO - Train Epoch: 13 [244480/612104 (40%)]	lr:1.40e-04	Loss: 0.120227
[2024-01-06 18:34:41,127] {train_model:86} INFO - Train Epoch: 13 [305664/612104 (50%)]	lr:1.40e-04	Loss: 0.084305
[2024-01-06 18:34:54,918] {train_model:86} INFO - Train Epoch: 13 [366848/612104 (60%)]	lr:1.40e-04	Loss: 0.131023
[2024-01-06 18:35:08,253] {train_model:86} INFO - Train Epoch: 13 [428032/612104 (70%)]	lr:1.40e-04	Loss: 0.080559
[2024-01-06 18:35:22,967] {train_model:86} INFO - Train Epoch: 13 [489216/612104 (80%)]	lr:1.40e-04	Loss: 0.066478
[2024-01-06 18:35:36,524] {train_model:86} INFO - Train Epoch: 13 [550400/612104 (90%)]	lr:1.40e-04	Loss: 0.093162
[2024-01-06 18:35:50,371] {train_model:86} INFO - Train Epoch: 13 [611584/612104 (100%)]	lr:1.40e-04	Loss: 0.144030
[2024-01-06 18:36:05,570] {run_experiment:78} INFO - 
[2024-01-06 18:36:05,576] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 18:36:07,025] {result_logger:108} INFO - precision on WAKE: 0.988
[2024-01-06 18:36:07,959] {result_logger:109} INFO - recall on WAKE: 0.957
[2024-01-06 18:36:08,907] {result_logger:112} INFO - F1-score on WAKE: 0.972
[2024-01-06 18:36:08,907] {result_logger:113} INFO - 
[2024-01-06 18:36:10,314] {result_logger:108} INFO - precision on NREM: 0.949
[2024-01-06 18:36:11,229] {result_logger:109} INFO - recall on NREM: 0.941
[2024-01-06 18:36:12,141] {result_logger:112} INFO - F1-score on NREM: 0.945
[2024-01-06 18:36:12,141] {result_logger:113} INFO - 
[2024-01-06 18:36:13,454] {result_logger:108} INFO - precision on REM: 0.716
[2024-01-06 18:36:14,262] {result_logger:109} INFO - recall on REM: 0.945
[2024-01-06 18:36:15,074] {result_logger:112} INFO - F1-score on REM: 0.814
[2024-01-06 18:36:15,074] {result_logger:113} INFO - 
[2024-01-06 18:36:15,294] {result_logger:116} INFO - average precision on sleep stages: 0.884
[2024-01-06 18:36:15,509] {result_logger:118} INFO - average recall on sleep stages: 0.948
[2024-01-06 18:36:15,726] {result_logger:120} INFO - average F1-score on sleep stages: 0.911
[2024-01-06 18:36:16,312] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.948
[2024-01-06 18:36:16,343] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.950
[2024-01-06 18:36:16,347] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 18:36:16,531] {result_logger:108} INFO - precision on WAKE: 0.888
[2024-01-06 18:36:16,644] {result_logger:109} INFO - recall on WAKE: 0.913
[2024-01-06 18:36:16,758] {result_logger:112} INFO - F1-score on WAKE: 0.900
[2024-01-06 18:36:16,759] {result_logger:113} INFO - 
[2024-01-06 18:36:16,942] {result_logger:108} INFO - precision on NREM: 0.960
[2024-01-06 18:36:17,055] {result_logger:109} INFO - recall on NREM: 0.620
[2024-01-06 18:36:17,169] {result_logger:112} INFO - F1-score on NREM: 0.753
[2024-01-06 18:36:17,169] {result_logger:113} INFO - 
[2024-01-06 18:36:17,351] {result_logger:108} INFO - precision on REM: 0.306
[2024-01-06 18:36:17,465] {result_logger:109} INFO - recall on REM: 0.940
[2024-01-06 18:36:17,577] {result_logger:112} INFO - F1-score on REM: 0.462
[2024-01-06 18:36:17,577] {result_logger:113} INFO - 
[2024-01-06 18:36:17,598] {result_logger:116} INFO - average precision on sleep stages: 0.718
[2024-01-06 18:36:17,620] {result_logger:118} INFO - average recall on sleep stages: 0.824
[2024-01-06 18:36:17,642] {result_logger:120} INFO - average F1-score on sleep stages: 0.705
[2024-01-06 18:36:17,723] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.824
[2024-01-06 18:36:17,726] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.799
[2024-01-06 18:36:17,727] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 18:36:18,382] {result_logger:143} INFO - 
[[317860  10353   3841      1]
 [  3404 225121  10665      0]
 [   472   1666  36533      0]
 [  1888    247     53      0]]
[2024-01-06 18:36:19,037] {result_logger:150} INFO - 
[[ 95.73%   3.12%   1.16%   0.00%]
 [  1.42%  94.12%   4.46%   0.00%]
 [  1.22%   4.31%  94.47%   0.00%]
 [ 86.29%  11.29%   2.42%   0.00%]]
[2024-01-06 18:36:19,690] {result_logger:154} INFO - 
[[ 98.22%   4.36%   7.52% 100.00%]
 [  1.05%  94.83%  20.87%   0.00%]
 [  0.15%   0.70%  71.50%   0.00%]
 [  0.58%   0.10%   0.10%   0.00%]]
[2024-01-06 18:36:19,691] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 18:36:19,777] {result_logger:143} INFO - 
[[44107   889  3323     0]
 [ 5279 21754  8072     0]
 [  290    29  5022     0]
 [  562    13   259     0]]
[2024-01-06 18:36:20,125] {result_logger:150} INFO - 
[[ 91.28%   1.84%   6.88%   0.00%]
 [ 15.04%  61.97%  22.99%   0.00%]
 [  5.43%   0.54%  94.03%   0.00%]
 [ 67.39%   1.56%  31.06%   0.00%]]
[2024-01-06 18:36:20,355] {result_logger:154} INFO - 
[[ 87.80%   3.92%  19.93%    nan%]
 [ 10.51%  95.90%  48.40%    nan%]
 [  0.58%   0.13%  30.12%    nan%]
 [  1.12%   0.06%   1.55%    nan%]]
[2024-01-06 18:36:20,844] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 18:36:20,844] {result_logger:77} INFO - actual:
[2024-01-06 18:36:20,844] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 18:36:20,844] {result_logger:79} INFO - predicted:
[2024-01-06 18:36:20,844] {result_logger:80} INFO - 
[[94.74%  1.90%  3.36%  0.00%]
 [ 3.50% 87.74%  8.76%  0.00%]
 [11.09% 10.95% 77.96%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 18:36:20,909] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it2/model_8conv_2fc-best.pth
[2024-01-06 18:36:20,909] {run_experiment:113} INFO - [epoch  13] execution time: 228.55s	 avg f1-score: 0.7049

[2024-01-06 18:36:20,909] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 18:36:20,971] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 18:36:48,298] {train_model:86} INFO - Train Epoch: 14 [60928/612104 (10%)]	lr:1.32e-04	Loss: 0.107282
[2024-01-06 18:37:35,373] {train_model:86} INFO - Train Epoch: 14 [122112/612104 (20%)]	lr:1.32e-04	Loss: 0.257540
[2024-01-06 18:38:01,662] {train_model:86} INFO - Train Epoch: 14 [183296/612104 (30%)]	lr:1.32e-04	Loss: 0.117672
[2024-01-06 18:38:14,390] {train_model:86} INFO - Train Epoch: 14 [244480/612104 (40%)]	lr:1.32e-04	Loss: 0.129318
[2024-01-06 18:38:27,448] {train_model:86} INFO - Train Epoch: 14 [305664/612104 (50%)]	lr:1.32e-04	Loss: 0.116862
[2024-01-06 18:38:40,705] {train_model:86} INFO - Train Epoch: 14 [366848/612104 (60%)]	lr:1.32e-04	Loss: 0.123234
[2024-01-06 18:38:53,138] {train_model:86} INFO - Train Epoch: 14 [428032/612104 (70%)]	lr:1.32e-04	Loss: 0.111238
[2024-01-06 18:39:05,386] {train_model:86} INFO - Train Epoch: 14 [489216/612104 (80%)]	lr:1.32e-04	Loss: 0.111636
[2024-01-06 18:39:20,747] {train_model:86} INFO - Train Epoch: 14 [550400/612104 (90%)]	lr:1.32e-04	Loss: 0.126247
[2024-01-06 18:39:34,736] {train_model:86} INFO - Train Epoch: 14 [611584/612104 (100%)]	lr:1.32e-04	Loss: 0.087828
[2024-01-06 18:39:48,626] {run_experiment:78} INFO - 
[2024-01-06 18:39:48,632] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 18:39:49,982] {result_logger:108} INFO - precision on WAKE: 0.988
[2024-01-06 18:39:50,879] {result_logger:109} INFO - recall on WAKE: 0.958
[2024-01-06 18:39:51,783] {result_logger:112} INFO - F1-score on WAKE: 0.973
[2024-01-06 18:39:51,784] {result_logger:113} INFO - 
[2024-01-06 18:39:53,182] {result_logger:108} INFO - precision on NREM: 0.950
[2024-01-06 18:39:54,101] {result_logger:109} INFO - recall on NREM: 0.942
[2024-01-06 18:39:55,008] {result_logger:112} INFO - F1-score on NREM: 0.946
[2024-01-06 18:39:55,009] {result_logger:113} INFO - 
[2024-01-06 18:39:56,289] {result_logger:108} INFO - precision on REM: 0.719
[2024-01-06 18:39:57,091] {result_logger:109} INFO - recall on REM: 0.945
[2024-01-06 18:39:57,882] {result_logger:112} INFO - F1-score on REM: 0.816
[2024-01-06 18:39:57,883] {result_logger:113} INFO - 
[2024-01-06 18:39:58,079] {result_logger:116} INFO - average precision on sleep stages: 0.886
[2024-01-06 18:39:58,288] {result_logger:118} INFO - average recall on sleep stages: 0.948
[2024-01-06 18:39:58,487] {result_logger:120} INFO - average F1-score on sleep stages: 0.912
[2024-01-06 18:39:59,040] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.948
[2024-01-06 18:39:59,068] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.951
[2024-01-06 18:39:59,072] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 18:39:59,238] {result_logger:108} INFO - precision on WAKE: 0.956
[2024-01-06 18:39:59,346] {result_logger:109} INFO - recall on WAKE: 0.735
[2024-01-06 18:39:59,454] {result_logger:112} INFO - F1-score on WAKE: 0.831
[2024-01-06 18:39:59,454] {result_logger:113} INFO - 
[2024-01-06 18:39:59,628] {result_logger:108} INFO - precision on NREM: 0.917
[2024-01-06 18:39:59,737] {result_logger:109} INFO - recall on NREM: 0.884
[2024-01-06 18:39:59,847] {result_logger:112} INFO - F1-score on NREM: 0.900
[2024-01-06 18:39:59,847] {result_logger:113} INFO - 
[2024-01-06 18:40:00,030] {result_logger:108} INFO - precision on REM: 0.290
[2024-01-06 18:40:00,144] {result_logger:109} INFO - recall on REM: 0.966
[2024-01-06 18:40:00,257] {result_logger:112} INFO - F1-score on REM: 0.446
[2024-01-06 18:40:00,257] {result_logger:113} INFO - 
[2024-01-06 18:40:00,277] {result_logger:116} INFO - average precision on sleep stages: 0.721
[2024-01-06 18:40:00,298] {result_logger:118} INFO - average recall on sleep stages: 0.862
[2024-01-06 18:40:00,317] {result_logger:120} INFO - average F1-score on sleep stages: 0.726
[2024-01-06 18:40:00,398] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.862
[2024-01-06 18:40:00,400] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.808
[2024-01-06 18:40:00,401] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 18:40:01,048] {result_logger:143} INFO - 
[[318057  10317   3681      0]
 [  3254 225333  10603      0]
 [   494   1647  36529      1]
 [  1896    238     54      0]]
[2024-01-06 18:40:01,696] {result_logger:150} INFO - 
[[ 95.78%   3.11%   1.11%   0.00%]
 [  1.36%  94.21%   4.43%   0.00%]
 [  1.28%   4.26%  94.46%   0.00%]
 [ 86.65%  10.88%   2.47%   0.00%]]
[2024-01-06 18:40:02,336] {result_logger:154} INFO - 
[[ 98.26%   4.34%   7.24%   0.00%]
 [  1.01%  94.86%  20.84%   0.00%]
 [  0.15%   0.69%  71.81% 100.00%]
 [  0.59%   0.10%   0.11%   0.00%]]
[2024-01-06 18:40:02,336] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 18:40:02,421] {result_logger:143} INFO - 
[[35494  2669 10156     0]
 [ 1610 31033  2462     0]
 [   30   152  5159     0]
 [   89   236   509     0]]
[2024-01-06 18:40:02,681] {result_logger:150} INFO - 
[[ 73.46%   5.52%  21.02%   0.00%]
 [  4.59%  88.40%   7.01%   0.00%]
 [  0.56%   2.85%  96.59%   0.00%]
 [ 10.67%  28.30%  61.03%   0.00%]]
[2024-01-06 18:40:02,907] {result_logger:154} INFO - 
[[ 95.36%   7.83%  55.54%    nan%]
 [  4.33%  91.03%  13.46%    nan%]
 [  0.08%   0.45%  28.21%    nan%]
 [  0.24%   0.69%   2.78%    nan%]]
[2024-01-06 18:40:03,398] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 18:40:03,398] {result_logger:77} INFO - actual:
[2024-01-06 18:40:03,398] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 18:40:03,398] {result_logger:79} INFO - predicted:
[2024-01-06 18:40:03,398] {result_logger:80} INFO - 
[[95.24%  2.68%  2.08%  0.00%]
 [ 2.24% 93.80%  3.96%  0.00%]
 [ 5.50%  6.12% 88.38%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 18:40:03,453] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it2/model_8conv_2fc-best.pth
[2024-01-06 18:40:03,453] {run_experiment:113} INFO - [epoch  14] execution time: 222.54s	 avg f1-score: 0.7257

[2024-01-06 18:40:03,453] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 18:40:03,513] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 18:41:00,414] {train_model:86} INFO - Train Epoch: 15 [60928/612104 (10%)]	lr:1.25e-04	Loss: 0.152135
[2024-01-06 18:41:27,336] {train_model:86} INFO - Train Epoch: 15 [122112/612104 (20%)]	lr:1.25e-04	Loss: 0.073089
[2024-01-06 18:41:39,795] {train_model:86} INFO - Train Epoch: 15 [183296/612104 (30%)]	lr:1.25e-04	Loss: 0.236543
[2024-01-06 18:41:53,121] {train_model:86} INFO - Train Epoch: 15 [244480/612104 (40%)]	lr:1.25e-04	Loss: 0.185521
[2024-01-06 18:42:06,404] {train_model:86} INFO - Train Epoch: 15 [305664/612104 (50%)]	lr:1.25e-04	Loss: 0.139743
[2024-01-06 18:42:19,783] {train_model:86} INFO - Train Epoch: 15 [366848/612104 (60%)]	lr:1.25e-04	Loss: 0.141891
[2024-01-06 18:42:33,995] {train_model:86} INFO - Train Epoch: 15 [428032/612104 (70%)]	lr:1.25e-04	Loss: 0.106560
[2024-01-06 18:42:47,831] {train_model:86} INFO - Train Epoch: 15 [489216/612104 (80%)]	lr:1.25e-04	Loss: 0.130311
[2024-01-06 18:43:00,834] {train_model:86} INFO - Train Epoch: 15 [550400/612104 (90%)]	lr:1.25e-04	Loss: 0.042586
[2024-01-06 18:43:29,370] {train_model:86} INFO - Train Epoch: 15 [611584/612104 (100%)]	lr:1.25e-04	Loss: 0.136525
[2024-01-06 18:43:43,593] {run_experiment:78} INFO - 
[2024-01-06 18:43:43,600] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 18:43:45,005] {result_logger:108} INFO - precision on WAKE: 0.988
[2024-01-06 18:43:45,898] {result_logger:109} INFO - recall on WAKE: 0.959
[2024-01-06 18:43:46,801] {result_logger:112} INFO - F1-score on WAKE: 0.973
[2024-01-06 18:43:46,801] {result_logger:113} INFO - 
[2024-01-06 18:43:48,158] {result_logger:108} INFO - precision on NREM: 0.950
[2024-01-06 18:43:49,070] {result_logger:109} INFO - recall on NREM: 0.945
[2024-01-06 18:43:49,957] {result_logger:112} INFO - F1-score on NREM: 0.947
[2024-01-06 18:43:49,957] {result_logger:113} INFO - 
[2024-01-06 18:43:51,182] {result_logger:108} INFO - precision on REM: 0.733
[2024-01-06 18:43:51,968] {result_logger:109} INFO - recall on REM: 0.944
[2024-01-06 18:43:52,749] {result_logger:112} INFO - F1-score on REM: 0.825
[2024-01-06 18:43:52,749] {result_logger:113} INFO - 
[2024-01-06 18:43:52,962] {result_logger:116} INFO - average precision on sleep stages: 0.890
[2024-01-06 18:43:53,168] {result_logger:118} INFO - average recall on sleep stages: 0.949
[2024-01-06 18:43:53,372] {result_logger:120} INFO - average F1-score on sleep stages: 0.915
[2024-01-06 18:43:53,954] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.949
[2024-01-06 18:43:53,983] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.952
[2024-01-06 18:43:53,987] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 18:43:54,157] {result_logger:108} INFO - precision on WAKE: 0.897
[2024-01-06 18:43:54,264] {result_logger:109} INFO - recall on WAKE: 0.727
[2024-01-06 18:43:54,370] {result_logger:112} INFO - F1-score on WAKE: 0.803
[2024-01-06 18:43:54,371] {result_logger:113} INFO - 
[2024-01-06 18:43:54,551] {result_logger:108} INFO - precision on NREM: 0.953
[2024-01-06 18:43:54,659] {result_logger:109} INFO - recall on NREM: 0.767
[2024-01-06 18:43:54,767] {result_logger:112} INFO - F1-score on NREM: 0.850
[2024-01-06 18:43:54,767] {result_logger:113} INFO - 
[2024-01-06 18:43:54,945] {result_logger:108} INFO - precision on REM: 0.231
[2024-01-06 18:43:55,050] {result_logger:109} INFO - recall on REM: 0.922
[2024-01-06 18:43:55,155] {result_logger:112} INFO - F1-score on REM: 0.369
[2024-01-06 18:43:55,155] {result_logger:113} INFO - 
[2024-01-06 18:43:55,175] {result_logger:116} INFO - average precision on sleep stages: 0.694
[2024-01-06 18:43:55,194] {result_logger:118} INFO - average recall on sleep stages: 0.805
[2024-01-06 18:43:55,214] {result_logger:120} INFO - average F1-score on sleep stages: 0.674
[2024-01-06 18:43:55,292] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.805
[2024-01-06 18:43:55,295] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.755
[2024-01-06 18:43:55,296] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 18:43:55,916] {result_logger:143} INFO - 
[[318336  10213   3502      4]
 [  3380 225995   9815      0]
 [   469   1711  36490      1]
 [  1904    248     36      0]]
[2024-01-06 18:43:56,542] {result_logger:150} INFO - 
[[ 95.87%   3.08%   1.05%   0.00%]
 [  1.41%  94.48%   4.10%   0.00%]
 [  1.21%   4.42%  94.36%   0.00%]
 [ 87.02%  11.33%   1.65%   0.00%]]
[2024-01-06 18:43:57,174] {result_logger:154} INFO - 
[[ 98.22%   4.29%   7.03%  80.00%]
 [  1.04%  94.89%  19.69%   0.00%]
 [  0.14%   0.72%  73.21%  20.00%]
 [  0.59%   0.10%   0.07%   0.00%]]
[2024-01-06 18:43:57,174] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 18:43:57,259] {result_logger:143} INFO - 
[[35151  1214 11954     0]
 [ 3737 26916  4452     0]
 [  299   120  4922     0]
 [  119    64   651     0]]
[2024-01-06 18:43:57,465] {result_logger:150} INFO - 
[[ 72.75%   2.51%  24.74%   0.00%]
 [ 10.65%  76.67%  12.68%   0.00%]
 [  5.60%   2.25%  92.16%   0.00%]
 [ 14.27%   7.67%  78.06%   0.00%]]
[2024-01-06 18:43:57,669] {result_logger:154} INFO - 
[[ 89.43%   4.29%  54.39%    nan%]
 [  9.51%  95.06%  20.26%    nan%]
 [  0.76%   0.42%  22.39%    nan%]
 [  0.30%   0.23%   2.96%    nan%]]
[2024-01-06 18:43:58,085] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 18:43:58,085] {result_logger:77} INFO - actual:
[2024-01-06 18:43:58,086] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 18:43:58,086] {result_logger:79} INFO - predicted:
[2024-01-06 18:43:58,086] {result_logger:80} INFO - 
[[94.62%  2.21%  3.17%  0.00%]
 [ 2.69% 92.95%  4.36%  0.00%]
 [ 6.15%  5.14% 88.72%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 18:43:58,122] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it2/model_8conv_2fc-best.pth
[2024-01-06 18:43:58,123] {run_experiment:113} INFO - [epoch  15] execution time: 234.67s	 avg f1-score: 0.6741

[2024-01-06 18:43:58,123] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 18:43:58,181] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 18:44:25,913] {train_model:86} INFO - Train Epoch: 16 [60928/612104 (10%)]	lr:1.17e-04	Loss: 0.089919
[2024-01-06 18:44:52,566] {train_model:86} INFO - Train Epoch: 16 [122112/612104 (20%)]	lr:1.17e-04	Loss: 0.069341
[2024-01-06 18:45:05,313] {train_model:86} INFO - Train Epoch: 16 [183296/612104 (30%)]	lr:1.17e-04	Loss: 0.230091
[2024-01-06 18:45:18,192] {train_model:86} INFO - Train Epoch: 16 [244480/612104 (40%)]	lr:1.17e-04	Loss: 0.107136
[2024-01-06 18:45:31,808] {train_model:86} INFO - Train Epoch: 16 [305664/612104 (50%)]	lr:1.17e-04	Loss: 0.099780
[2024-01-06 18:45:44,777] {train_model:86} INFO - Train Epoch: 16 [366848/612104 (60%)]	lr:1.17e-04	Loss: 0.168029
[2024-01-06 18:45:57,487] {train_model:86} INFO - Train Epoch: 16 [428032/612104 (70%)]	lr:1.17e-04	Loss: 0.118889
[2024-01-06 18:46:11,050] {train_model:86} INFO - Train Epoch: 16 [489216/612104 (80%)]	lr:1.17e-04	Loss: 0.159464
[2024-01-06 18:46:53,461] {train_model:86} INFO - Train Epoch: 16 [550400/612104 (90%)]	lr:1.17e-04	Loss: 0.234018
[2024-01-06 18:47:06,199] {train_model:86} INFO - Train Epoch: 16 [611584/612104 (100%)]	lr:1.17e-04	Loss: 0.219442
[2024-01-06 18:47:20,583] {run_experiment:78} INFO - 
[2024-01-06 18:47:20,589] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 18:47:22,052] {result_logger:108} INFO - precision on WAKE: 0.988
[2024-01-06 18:47:22,991] {result_logger:109} INFO - recall on WAKE: 0.959
[2024-01-06 18:47:23,910] {result_logger:112} INFO - F1-score on WAKE: 0.974
[2024-01-06 18:47:23,910] {result_logger:113} INFO - 
[2024-01-06 18:47:25,317] {result_logger:108} INFO - precision on NREM: 0.951
[2024-01-06 18:47:26,212] {result_logger:109} INFO - recall on NREM: 0.944
[2024-01-06 18:47:27,103] {result_logger:112} INFO - F1-score on NREM: 0.948
[2024-01-06 18:47:27,103] {result_logger:113} INFO - 
[2024-01-06 18:47:28,372] {result_logger:108} INFO - precision on REM: 0.733
[2024-01-06 18:47:29,129] {result_logger:109} INFO - recall on REM: 0.948
[2024-01-06 18:47:29,868] {result_logger:112} INFO - F1-score on REM: 0.827
[2024-01-06 18:47:29,868] {result_logger:113} INFO - 
[2024-01-06 18:47:30,073] {result_logger:116} INFO - average precision on sleep stages: 0.891
[2024-01-06 18:47:30,274] {result_logger:118} INFO - average recall on sleep stages: 0.951
[2024-01-06 18:47:30,477] {result_logger:120} INFO - average F1-score on sleep stages: 0.916
[2024-01-06 18:47:31,074] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.951
[2024-01-06 18:47:31,103] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.953
[2024-01-06 18:47:31,106] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 18:47:31,296] {result_logger:108} INFO - precision on WAKE: 0.823
[2024-01-06 18:47:31,407] {result_logger:109} INFO - recall on WAKE: 0.916
[2024-01-06 18:47:31,521] {result_logger:112} INFO - F1-score on WAKE: 0.867
[2024-01-06 18:47:31,522] {result_logger:113} INFO - 
[2024-01-06 18:47:31,712] {result_logger:108} INFO - precision on NREM: 0.807
[2024-01-06 18:47:31,822] {result_logger:109} INFO - recall on NREM: 0.746
[2024-01-06 18:47:31,933] {result_logger:112} INFO - F1-score on NREM: 0.776
[2024-01-06 18:47:31,933] {result_logger:113} INFO - 
[2024-01-06 18:47:32,118] {result_logger:108} INFO - precision on REM: 0.815
[2024-01-06 18:47:32,227] {result_logger:109} INFO - recall on REM: 0.383
[2024-01-06 18:47:32,336] {result_logger:112} INFO - F1-score on REM: 0.521
[2024-01-06 18:47:32,336] {result_logger:113} INFO - 
[2024-01-06 18:47:32,358] {result_logger:116} INFO - average precision on sleep stages: 0.815
[2024-01-06 18:47:32,379] {result_logger:118} INFO - average recall on sleep stages: 0.682
[2024-01-06 18:47:32,400] {result_logger:120} INFO - average F1-score on sleep stages: 0.721
[2024-01-06 18:47:32,480] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.682
[2024-01-06 18:47:32,483] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.817
[2024-01-06 18:47:32,484] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 18:47:33,124] {result_logger:143} INFO - 
[[318575  10027   3451      2]
 [  3390 225911   9888      1]
 [   434   1566  36668      3]
 [  1904    238     46      0]]
[2024-01-06 18:47:33,766] {result_logger:150} INFO - 
[[ 95.94%   3.02%   1.04%   0.00%]
 [  1.42%  94.45%   4.13%   0.00%]
 [  1.12%   4.05%  94.82%   0.01%]
 [ 87.02%  10.88%   2.10%   0.00%]]
[2024-01-06 18:47:34,410] {result_logger:154} INFO - 
[[ 98.23%   4.22%   6.89%  33.33%]
 [  1.05%  95.02%  19.76%  16.67%]
 [  0.13%   0.66%  73.26%  50.00%]
 [  0.59%   0.10%   0.09%   0.00%]]
[2024-01-06 18:47:34,410] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 18:47:34,495] {result_logger:143} INFO - 
[[44269  4025    25     0]
 [ 8473 26194   438     0]
 [ 1070  2226  2045     0]
 [  501   323    10     0]]
[2024-01-06 18:47:34,739] {result_logger:150} INFO - 
[[ 91.62%   8.33%   0.05%   0.00%]
 [ 24.14%  74.62%   1.25%   0.00%]
 [ 20.03%  41.68%  38.29%   0.00%]
 [ 60.07%  38.73%   1.20%   0.00%]]
[2024-01-06 18:47:34,966] {result_logger:154} INFO - 
[[ 81.51%  12.28%   0.99%    nan%]
 [ 15.60%  79.94%  17.39%    nan%]
 [  1.97%   6.79%  81.22%    nan%]
 [  0.92%   0.99%   0.40%    nan%]]
[2024-01-06 18:47:35,554] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 18:47:35,554] {result_logger:77} INFO - actual:
[2024-01-06 18:47:35,555] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 18:47:35,555] {result_logger:79} INFO - predicted:
[2024-01-06 18:47:35,555] {result_logger:80} INFO - 
[[94.84%  4.90%  0.26%  0.00%]
 [ 7.74% 91.17%  1.09%  0.00%]
 [10.56%  9.25% 80.18%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 18:47:35,606] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it2/model_8conv_2fc-best.pth
[2024-01-06 18:47:35,607] {run_experiment:113} INFO - [epoch  16] execution time: 217.48s	 avg f1-score: 0.7212

[2024-01-06 18:47:35,607] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 18:47:35,666] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 18:48:16,421] {train_model:86} INFO - Train Epoch: 17 [60928/612104 (10%)]	lr:1.11e-04	Loss: 0.170175
[2024-01-06 18:48:29,232] {train_model:86} INFO - Train Epoch: 17 [122112/612104 (20%)]	lr:1.11e-04	Loss: 0.190511
[2024-01-06 18:48:42,802] {train_model:86} INFO - Train Epoch: 17 [183296/612104 (30%)]	lr:1.11e-04	Loss: 0.102312
[2024-01-06 18:48:55,603] {train_model:86} INFO - Train Epoch: 17 [244480/612104 (40%)]	lr:1.11e-04	Loss: 0.113453
[2024-01-06 18:49:08,784] {train_model:86} INFO - Train Epoch: 17 [305664/612104 (50%)]	lr:1.11e-04	Loss: 0.120380
[2024-01-06 18:49:21,302] {train_model:86} INFO - Train Epoch: 17 [366848/612104 (60%)]	lr:1.11e-04	Loss: 0.092750
[2024-01-06 18:49:33,611] {train_model:86} INFO - Train Epoch: 17 [428032/612104 (70%)]	lr:1.11e-04	Loss: 0.068562
[2024-01-06 18:50:01,484] {train_model:86} INFO - Train Epoch: 17 [489216/612104 (80%)]	lr:1.11e-04	Loss: 0.069355
[2024-01-06 18:50:28,166] {train_model:86} INFO - Train Epoch: 17 [550400/612104 (90%)]	lr:1.11e-04	Loss: 0.103068
[2024-01-06 18:50:41,626] {train_model:86} INFO - Train Epoch: 17 [611584/612104 (100%)]	lr:1.11e-04	Loss: 0.123661
[2024-01-06 18:50:55,960] {run_experiment:78} INFO - 
[2024-01-06 18:50:55,967] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 18:50:57,385] {result_logger:108} INFO - precision on WAKE: 0.988
[2024-01-06 18:50:58,325] {result_logger:109} INFO - recall on WAKE: 0.960
[2024-01-06 18:50:59,259] {result_logger:112} INFO - F1-score on WAKE: 0.974
[2024-01-06 18:50:59,259] {result_logger:113} INFO - 
[2024-01-06 18:51:00,633] {result_logger:108} INFO - precision on NREM: 0.951
[2024-01-06 18:51:01,540] {result_logger:109} INFO - recall on NREM: 0.946
[2024-01-06 18:51:02,446] {result_logger:112} INFO - F1-score on NREM: 0.948
[2024-01-06 18:51:02,446] {result_logger:113} INFO - 
[2024-01-06 18:51:03,705] {result_logger:108} INFO - precision on REM: 0.741
[2024-01-06 18:51:04,516] {result_logger:109} INFO - recall on REM: 0.948
[2024-01-06 18:51:05,302] {result_logger:112} INFO - F1-score on REM: 0.832
[2024-01-06 18:51:05,303] {result_logger:113} INFO - 
[2024-01-06 18:51:05,514] {result_logger:116} INFO - average precision on sleep stages: 0.893
[2024-01-06 18:51:05,722] {result_logger:118} INFO - average recall on sleep stages: 0.951
[2024-01-06 18:51:05,926] {result_logger:120} INFO - average F1-score on sleep stages: 0.918
[2024-01-06 18:51:06,503] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.951
[2024-01-06 18:51:06,532] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.954
[2024-01-06 18:51:06,536] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 18:51:06,710] {result_logger:108} INFO - precision on WAKE: 0.867
[2024-01-06 18:51:06,819] {result_logger:109} INFO - recall on WAKE: 0.972
[2024-01-06 18:51:06,930] {result_logger:112} INFO - F1-score on WAKE: 0.917
[2024-01-06 18:51:06,930] {result_logger:113} INFO - 
[2024-01-06 18:51:07,106] {result_logger:108} INFO - precision on NREM: 0.942
[2024-01-06 18:51:07,216] {result_logger:109} INFO - recall on NREM: 0.800
[2024-01-06 18:51:07,327] {result_logger:112} INFO - F1-score on NREM: 0.865
[2024-01-06 18:51:07,327] {result_logger:113} INFO - 
[2024-01-06 18:51:07,500] {result_logger:108} INFO - precision on REM: 0.788
[2024-01-06 18:51:07,608] {result_logger:109} INFO - recall on REM: 0.709
[2024-01-06 18:51:07,717] {result_logger:112} INFO - F1-score on REM: 0.746
[2024-01-06 18:51:07,717] {result_logger:113} INFO - 
[2024-01-06 18:51:07,737] {result_logger:116} INFO - average precision on sleep stages: 0.866
[2024-01-06 18:51:07,757] {result_logger:118} INFO - average recall on sleep stages: 0.827
[2024-01-06 18:51:07,776] {result_logger:120} INFO - average F1-score on sleep stages: 0.843
[2024-01-06 18:51:07,856] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.827
[2024-01-06 18:51:07,859] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.888
[2024-01-06 18:51:07,860] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 18:51:08,488] {result_logger:143} INFO - 
[[318616  10160   3277      2]
 [  3323 226330   9536      1]
 [   429   1575  36666      1]
 [  1903    244     41      0]]
[2024-01-06 18:51:09,107] {result_logger:150} INFO - 
[[ 95.95%   3.06%   0.99%   0.00%]
 [  1.39%  94.62%   3.99%   0.00%]
 [  1.11%   4.07%  94.82%   0.00%]
 [ 86.97%  11.15%   1.87%   0.00%]]
[2024-01-06 18:51:09,718] {result_logger:154} INFO - 
[[ 98.26%   4.26%   6.62%  50.00%]
 [  1.02%  94.97%  19.26%  25.00%]
 [  0.13%   0.66%  74.04%  25.00%]
 [  0.59%   0.10%   0.08%   0.00%]]
[2024-01-06 18:51:09,718] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 18:51:09,802] {result_logger:143} INFO - 
[[46964  1254   101     0]
 [ 6107 28080   918     0]
 [ 1068   487  3786     0]
 [  760    41    33     0]]
[2024-01-06 18:51:10,056] {result_logger:150} INFO - 
[[ 97.20%   2.60%   0.21%   0.00%]
 [ 17.40%  79.99%   2.62%   0.00%]
 [ 20.00%   9.12%  70.89%   0.00%]
 [ 91.13%   4.92%   3.96%   0.00%]]
[2024-01-06 18:51:10,285] {result_logger:154} INFO - 
[[ 85.55%   4.20%   2.09%    nan%]
 [ 11.12%  94.03%  18.97%    nan%]
 [  1.95%   1.63%  78.26%    nan%]
 [  1.38%   0.14%   0.68%    nan%]]
[2024-01-06 18:51:10,775] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 18:51:10,775] {result_logger:77} INFO - actual:
[2024-01-06 18:51:10,775] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 18:51:10,775] {result_logger:79} INFO - predicted:
[2024-01-06 18:51:10,775] {result_logger:80} INFO - 
[[96.24%  3.26%  0.50%  0.00%]
 [ 5.27% 93.05%  1.68%  0.00%]
 [10.13%  5.91% 83.96%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 18:51:10,836] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it2/model_8conv_2fc-best.pth
[2024-01-06 18:51:10,836] {run_experiment:113} INFO - [epoch  17] execution time: 215.23s	 avg f1-score: 0.8427

[2024-01-06 18:51:10,836] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 18:51:10,894] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 18:51:50,908] {train_model:86} INFO - Train Epoch: 18 [60928/612104 (10%)]	lr:1.04e-04	Loss: 0.111599
[2024-01-06 18:52:04,297] {train_model:86} INFO - Train Epoch: 18 [122112/612104 (20%)]	lr:1.04e-04	Loss: 0.089811
[2024-01-06 18:52:16,486] {train_model:86} INFO - Train Epoch: 18 [183296/612104 (30%)]	lr:1.04e-04	Loss: 0.113758
[2024-01-06 18:52:28,676] {train_model:86} INFO - Train Epoch: 18 [244480/612104 (40%)]	lr:1.04e-04	Loss: 0.103797
[2024-01-06 18:52:40,730] {train_model:86} INFO - Train Epoch: 18 [305664/612104 (50%)]	lr:1.04e-04	Loss: 0.083038
[2024-01-06 18:52:52,601] {train_model:86} INFO - Train Epoch: 18 [366848/612104 (60%)]	lr:1.04e-04	Loss: 0.065122
[2024-01-06 18:53:04,683] {train_model:86} INFO - Train Epoch: 18 [428032/612104 (70%)]	lr:1.04e-04	Loss: 0.245517
[2024-01-06 18:53:45,848] {train_model:86} INFO - Train Epoch: 18 [489216/612104 (80%)]	lr:1.04e-04	Loss: 0.102764
[2024-01-06 18:53:59,184] {train_model:86} INFO - Train Epoch: 18 [550400/612104 (90%)]	lr:1.04e-04	Loss: 0.126193
[2024-01-06 18:54:24,195] {train_model:86} INFO - Train Epoch: 18 [611584/612104 (100%)]	lr:1.04e-04	Loss: 0.121944
[2024-01-06 18:54:38,155] {run_experiment:78} INFO - 
[2024-01-06 18:54:38,162] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 18:54:39,485] {result_logger:108} INFO - precision on WAKE: 0.988
[2024-01-06 18:54:40,359] {result_logger:109} INFO - recall on WAKE: 0.960
[2024-01-06 18:54:41,244] {result_logger:112} INFO - F1-score on WAKE: 0.974
[2024-01-06 18:54:41,244] {result_logger:113} INFO - 
[2024-01-06 18:54:42,567] {result_logger:108} INFO - precision on NREM: 0.953
[2024-01-06 18:54:43,415] {result_logger:109} INFO - recall on NREM: 0.946
[2024-01-06 18:54:44,253] {result_logger:112} INFO - F1-score on NREM: 0.949
[2024-01-06 18:54:44,253] {result_logger:113} INFO - 
[2024-01-06 18:54:45,462] {result_logger:108} INFO - precision on REM: 0.739
[2024-01-06 18:54:46,225] {result_logger:109} INFO - recall on REM: 0.951
[2024-01-06 18:54:46,973] {result_logger:112} INFO - F1-score on REM: 0.832
[2024-01-06 18:54:46,974] {result_logger:113} INFO - 
[2024-01-06 18:54:47,168] {result_logger:116} INFO - average precision on sleep stages: 0.893
[2024-01-06 18:54:47,370] {result_logger:118} INFO - average recall on sleep stages: 0.953
[2024-01-06 18:54:47,571] {result_logger:120} INFO - average F1-score on sleep stages: 0.918
[2024-01-06 18:54:48,133] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.953
[2024-01-06 18:54:48,160] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.954
[2024-01-06 18:54:48,164] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 18:54:48,334] {result_logger:108} INFO - precision on WAKE: 0.870
[2024-01-06 18:54:48,438] {result_logger:109} INFO - recall on WAKE: 0.902
[2024-01-06 18:54:48,541] {result_logger:112} INFO - F1-score on WAKE: 0.886
[2024-01-06 18:54:48,541] {result_logger:113} INFO - 
[2024-01-06 18:54:48,707] {result_logger:108} INFO - precision on NREM: 0.934
[2024-01-06 18:54:48,810] {result_logger:109} INFO - recall on NREM: 0.773
[2024-01-06 18:54:48,912] {result_logger:112} INFO - F1-score on NREM: 0.846
[2024-01-06 18:54:48,913] {result_logger:113} INFO - 
[2024-01-06 18:54:49,077] {result_logger:108} INFO - precision on REM: 0.497
[2024-01-06 18:54:49,179] {result_logger:109} INFO - recall on REM: 0.896
[2024-01-06 18:54:49,280] {result_logger:112} INFO - F1-score on REM: 0.639
[2024-01-06 18:54:49,281] {result_logger:113} INFO - 
[2024-01-06 18:54:49,300] {result_logger:116} INFO - average precision on sleep stages: 0.767
[2024-01-06 18:54:49,319] {result_logger:118} INFO - average recall on sleep stages: 0.857
[2024-01-06 18:54:49,337] {result_logger:120} INFO - average F1-score on sleep stages: 0.790
[2024-01-06 18:54:49,407] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.857
[2024-01-06 18:54:49,410] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.851
[2024-01-06 18:54:49,411] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 18:54:50,016] {result_logger:143} INFO - 
[[318905   9797   3349      4]
 [  3347 226203   9640      0]
 [   426   1452  36793      0]
 [  1907    241     40      0]]
[2024-01-06 18:54:50,626] {result_logger:150} INFO - 
[[ 96.04%   2.95%   1.01%   0.00%]
 [  1.40%  94.57%   4.03%   0.00%]
 [  1.10%   3.75%  95.14%   0.00%]
 [ 87.16%  11.01%   1.83%   0.00%]]
[2024-01-06 18:54:51,236] {result_logger:154} INFO - 
[[ 98.25%   4.12%   6.72% 100.00%]
 [  1.03%  95.17%  19.35%   0.00%]
 [  0.13%   0.61%  73.85%   0.00%]
 [  0.59%   0.10%   0.08%   0.00%]]
[2024-01-06 18:54:51,236] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 18:54:51,316] {result_logger:143} INFO - 
[[43599  1761  2959     0]
 [ 6090 27124  1891     0]
 [  411   144  4786     0]
 [  414   165   255     0]]
[2024-01-06 18:54:51,576] {result_logger:150} INFO - 
[[ 90.23%   3.64%   6.12%   0.00%]
 [ 17.35%  77.27%   5.39%   0.00%]
 [  7.70%   2.70%  89.61%   0.00%]
 [ 49.64%  19.78%  30.58%   0.00%]]
[2024-01-06 18:54:51,808] {result_logger:154} INFO - 
[[ 86.31%   6.03%  29.92%    nan%]
 [ 12.06%  92.91%  19.12%    nan%]
 [  0.81%   0.49%  48.39%    nan%]
 [  0.82%   0.57%   2.58%    nan%]]
[2024-01-06 18:54:52,315] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 18:54:52,315] {result_logger:77} INFO - actual:
[2024-01-06 18:54:52,316] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 18:54:52,316] {result_logger:79} INFO - predicted:
[2024-01-06 18:54:52,316] {result_logger:80} INFO - 
[[94.80%  3.16%  2.04%  0.00%]
 [ 4.54% 92.55%  2.92%  0.00%]
 [13.15%  5.84% 81.00%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 18:54:52,380] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it2/model_8conv_2fc-best.pth
[2024-01-06 18:54:52,381] {run_experiment:113} INFO - [epoch  18] execution time: 221.54s	 avg f1-score: 0.7903

[2024-01-06 18:54:52,381] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 18:54:52,439] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 18:55:18,835] {train_model:86} INFO - Train Epoch: 19 [60928/612104 (10%)]	lr:9.80e-05	Loss: 0.084666
[2024-01-06 18:55:31,351] {train_model:86} INFO - Train Epoch: 19 [122112/612104 (20%)]	lr:9.80e-05	Loss: 0.072731
[2024-01-06 18:55:43,835] {train_model:86} INFO - Train Epoch: 19 [183296/612104 (30%)]	lr:9.80e-05	Loss: 0.244065
[2024-01-06 18:55:56,707] {train_model:86} INFO - Train Epoch: 19 [244480/612104 (40%)]	lr:9.80e-05	Loss: 0.224852
[2024-01-06 18:56:09,706] {train_model:86} INFO - Train Epoch: 19 [305664/612104 (50%)]	lr:9.80e-05	Loss: 0.062221
[2024-01-06 18:56:21,443] {train_model:86} INFO - Train Epoch: 19 [366848/612104 (60%)]	lr:9.80e-05	Loss: 0.186433
[2024-01-06 18:56:49,339] {train_model:86} INFO - Train Epoch: 19 [428032/612104 (70%)]	lr:9.80e-05	Loss: 0.088774
[2024-01-06 18:57:15,872] {train_model:86} INFO - Train Epoch: 19 [489216/612104 (80%)]	lr:9.80e-05	Loss: 0.164488
[2024-01-06 18:57:28,016] {train_model:86} INFO - Train Epoch: 19 [550400/612104 (90%)]	lr:9.80e-05	Loss: 0.241543
[2024-01-06 18:57:55,937] {train_model:86} INFO - Train Epoch: 19 [611584/612104 (100%)]	lr:9.80e-05	Loss: 0.204532
[2024-01-06 18:58:09,422] {run_experiment:78} INFO - 
[2024-01-06 18:58:09,428] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 18:58:10,811] {result_logger:108} INFO - precision on WAKE: 0.988
[2024-01-06 18:58:11,687] {result_logger:109} INFO - recall on WAKE: 0.961
[2024-01-06 18:58:12,564] {result_logger:112} INFO - F1-score on WAKE: 0.974
[2024-01-06 18:58:12,564] {result_logger:113} INFO - 
[2024-01-06 18:58:13,877] {result_logger:108} INFO - precision on NREM: 0.953
[2024-01-06 18:58:14,768] {result_logger:109} INFO - recall on NREM: 0.947
[2024-01-06 18:58:15,642] {result_logger:112} INFO - F1-score on NREM: 0.950
[2024-01-06 18:58:15,642] {result_logger:113} INFO - 
[2024-01-06 18:58:16,895] {result_logger:108} INFO - precision on REM: 0.749
[2024-01-06 18:58:17,704] {result_logger:109} INFO - recall on REM: 0.950
[2024-01-06 18:58:18,501] {result_logger:112} INFO - F1-score on REM: 0.837
[2024-01-06 18:58:18,501] {result_logger:113} INFO - 
[2024-01-06 18:58:18,712] {result_logger:116} INFO - average precision on sleep stages: 0.896
[2024-01-06 18:58:18,925] {result_logger:118} INFO - average recall on sleep stages: 0.953
[2024-01-06 18:58:19,138] {result_logger:120} INFO - average F1-score on sleep stages: 0.920
[2024-01-06 18:58:19,731] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.953
[2024-01-06 18:58:19,760] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.955
[2024-01-06 18:58:19,766] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 18:58:19,946] {result_logger:108} INFO - precision on WAKE: 0.877
[2024-01-06 18:58:20,057] {result_logger:109} INFO - recall on WAKE: 0.967
[2024-01-06 18:58:20,167] {result_logger:112} INFO - F1-score on WAKE: 0.920
[2024-01-06 18:58:20,167] {result_logger:113} INFO - 
[2024-01-06 18:58:20,340] {result_logger:108} INFO - precision on NREM: 0.949
[2024-01-06 18:58:20,450] {result_logger:109} INFO - recall on NREM: 0.789
[2024-01-06 18:58:20,558] {result_logger:112} INFO - F1-score on NREM: 0.862
[2024-01-06 18:58:20,558] {result_logger:113} INFO - 
[2024-01-06 18:58:20,731] {result_logger:108} INFO - precision on REM: 0.705
[2024-01-06 18:58:20,837] {result_logger:109} INFO - recall on REM: 0.838
[2024-01-06 18:58:20,945] {result_logger:112} INFO - F1-score on REM: 0.766
[2024-01-06 18:58:20,945] {result_logger:113} INFO - 
[2024-01-06 18:58:20,964] {result_logger:116} INFO - average precision on sleep stages: 0.844
[2024-01-06 18:58:20,985] {result_logger:118} INFO - average recall on sleep stages: 0.865
[2024-01-06 18:58:21,004] {result_logger:120} INFO - average F1-score on sleep stages: 0.849
[2024-01-06 18:58:21,082] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.865
[2024-01-06 18:58:21,085] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.889
[2024-01-06 18:58:21,086] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 18:58:21,715] {result_logger:143} INFO - 
[[319230   9691   3132      2]
 [  3562 226438   9190      0]
 [   424   1525  36722      0]
 [  1918    235     35      0]]
[2024-01-06 18:58:22,350] {result_logger:150} INFO - 
[[ 96.14%   2.92%   0.94%   0.00%]
 [  1.49%  94.67%   3.84%   0.00%]
 [  1.10%   3.94%  94.96%   0.00%]
 [ 87.66%  10.74%   1.60%   0.00%]]
[2024-01-06 18:58:22,981] {result_logger:154} INFO - 
[[ 98.18%   4.07%   6.38% 100.00%]
 [  1.10%  95.19%  18.72%   0.00%]
 [  0.13%   0.64%  74.82%   0.00%]
 [  0.59%   0.10%   0.07%   0.00%]]
[2024-01-06 18:58:22,982] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 18:58:23,066] {result_logger:143} INFO - 
[[46714  1270   335     0]
 [ 5874 27692  1539     0]
 [  660   203  4478     0]
 [  724    77    33     0]]
[2024-01-06 18:58:23,287] {result_logger:150} INFO - 
[[ 96.68%   2.63%   0.69%   0.00%]
 [ 16.73%  78.88%   4.38%   0.00%]
 [ 12.36%   3.80%  83.84%   0.00%]
 [ 86.81%   9.23%   3.96%   0.00%]]
[2024-01-06 18:58:23,498] {result_logger:154} INFO - 
[[ 86.55%   4.34%   5.25%    nan%]
 [ 10.88%  94.70%  24.10%    nan%]
 [  1.22%   0.69%  70.13%    nan%]
 [  1.34%   0.26%   0.52%    nan%]]
[2024-01-06 18:58:23,958] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 18:58:23,959] {result_logger:77} INFO - actual:
[2024-01-06 18:58:23,959] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 18:58:23,959] {result_logger:79} INFO - predicted:
[2024-01-06 18:58:23,959] {result_logger:80} INFO - 
[[96.07%  3.29%  0.64%  0.00%]
 [ 5.14% 92.69%  2.16%  0.00%]
 [ 9.66%  5.69% 84.65%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 18:58:24,001] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it2/model_8conv_2fc-best.pth
[2024-01-06 18:58:24,002] {run_experiment:113} INFO - [epoch  19] execution time: 211.62s	 avg f1-score: 0.8492

[2024-01-06 18:58:24,002] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 18:58:24,061] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 18:58:50,985] {train_model:86} INFO - Train Epoch: 20 [60928/612104 (10%)]	lr:9.23e-05	Loss: 0.061999
[2024-01-06 18:59:02,760] {train_model:86} INFO - Train Epoch: 20 [122112/612104 (20%)]	lr:9.23e-05	Loss: 0.106079
[2024-01-06 18:59:14,608] {train_model:86} INFO - Train Epoch: 20 [183296/612104 (30%)]	lr:9.23e-05	Loss: 0.081050
[2024-01-06 18:59:27,745] {train_model:86} INFO - Train Epoch: 20 [244480/612104 (40%)]	lr:9.23e-05	Loss: 0.087980
[2024-01-06 18:59:41,051] {train_model:86} INFO - Train Epoch: 20 [305664/612104 (50%)]	lr:9.23e-05	Loss: 0.110622
[2024-01-06 18:59:53,066] {train_model:86} INFO - Train Epoch: 20 [366848/612104 (60%)]	lr:9.23e-05	Loss: 0.170051
[2024-01-06 19:00:20,489] {train_model:86} INFO - Train Epoch: 20 [428032/612104 (70%)]	lr:9.23e-05	Loss: 0.126734
[2024-01-06 19:00:46,445] {train_model:86} INFO - Train Epoch: 20 [489216/612104 (80%)]	lr:9.23e-05	Loss: 0.087544
[2024-01-06 19:01:13,685] {train_model:86} INFO - Train Epoch: 20 [550400/612104 (90%)]	lr:9.23e-05	Loss: 0.110573
[2024-01-06 19:01:40,052] {train_model:86} INFO - Train Epoch: 20 [611584/612104 (100%)]	lr:9.23e-05	Loss: 0.109739
[2024-01-06 19:01:54,270] {run_experiment:78} INFO - 
[2024-01-06 19:01:54,276] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 19:01:55,731] {result_logger:108} INFO - precision on WAKE: 0.988
[2024-01-06 19:01:56,643] {result_logger:109} INFO - recall on WAKE: 0.962
[2024-01-06 19:01:57,572] {result_logger:112} INFO - F1-score on WAKE: 0.975
[2024-01-06 19:01:57,572] {result_logger:113} INFO - 
[2024-01-06 19:01:58,997] {result_logger:108} INFO - precision on NREM: 0.954
[2024-01-06 19:01:59,906] {result_logger:109} INFO - recall on NREM: 0.947
[2024-01-06 19:02:00,811] {result_logger:112} INFO - F1-score on NREM: 0.950
[2024-01-06 19:02:00,811] {result_logger:113} INFO - 
[2024-01-06 19:02:02,066] {result_logger:108} INFO - precision on REM: 0.752
[2024-01-06 19:02:02,862] {result_logger:109} INFO - recall on REM: 0.951
[2024-01-06 19:02:03,644] {result_logger:112} INFO - F1-score on REM: 0.840
[2024-01-06 19:02:03,644] {result_logger:113} INFO - 
[2024-01-06 19:02:03,851] {result_logger:116} INFO - average precision on sleep stages: 0.898
[2024-01-06 19:02:04,057] {result_logger:118} INFO - average recall on sleep stages: 0.953
[2024-01-06 19:02:04,268] {result_logger:120} INFO - average F1-score on sleep stages: 0.922
[2024-01-06 19:02:04,831] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.953
[2024-01-06 19:02:04,860] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.956
[2024-01-06 19:02:04,863] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 19:02:05,039] {result_logger:108} INFO - precision on WAKE: 0.923
[2024-01-06 19:02:05,147] {result_logger:109} INFO - recall on WAKE: 0.933
[2024-01-06 19:02:05,259] {result_logger:112} INFO - F1-score on WAKE: 0.928
[2024-01-06 19:02:05,259] {result_logger:113} INFO - 
[2024-01-06 19:02:05,436] {result_logger:108} INFO - precision on NREM: 0.924
[2024-01-06 19:02:05,546] {result_logger:109} INFO - recall on NREM: 0.865
[2024-01-06 19:02:05,655] {result_logger:112} INFO - F1-score on NREM: 0.894
[2024-01-06 19:02:05,655] {result_logger:113} INFO - 
[2024-01-06 19:02:05,831] {result_logger:108} INFO - precision on REM: 0.645
[2024-01-06 19:02:05,939] {result_logger:109} INFO - recall on REM: 0.854
[2024-01-06 19:02:06,050] {result_logger:112} INFO - F1-score on REM: 0.735
[2024-01-06 19:02:06,050] {result_logger:113} INFO - 
[2024-01-06 19:02:06,071] {result_logger:116} INFO - average precision on sleep stages: 0.831
[2024-01-06 19:02:06,091] {result_logger:118} INFO - average recall on sleep stages: 0.884
[2024-01-06 19:02:06,110] {result_logger:120} INFO - average F1-score on sleep stages: 0.852
[2024-01-06 19:02:06,188] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.884
[2024-01-06 19:02:06,191] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.901
[2024-01-06 19:02:06,192] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 19:02:06,816] {result_logger:143} INFO - 
[[319488   9608   2958      1]
 [  3451 226600   9137      2]
 [   465   1436  36769      1]
 [  1905    240     43      0]]
[2024-01-06 19:02:07,429] {result_logger:150} INFO - 
[[ 96.22%   2.89%   0.89%   0.00%]
 [  1.44%  94.74%   3.82%   0.00%]
 [  1.20%   3.71%  95.08%   0.00%]
 [ 87.07%  10.97%   1.97%   0.00%]]
[2024-01-06 19:02:08,042] {result_logger:154} INFO - 
[[ 98.21%   4.04%   6.05%  25.00%]
 [  1.06%  95.26%  18.68%  50.00%]
 [  0.14%   0.60%  75.18%  25.00%]
 [  0.59%   0.10%   0.09%   0.00%]]
[2024-01-06 19:02:08,042] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 19:02:08,121] {result_logger:143} INFO - 
[[45071  2130  1118     0]
 [ 3325 30383  1397     0]
 [  424   354  4563     0]
 [  514   187   133     0]]
[2024-01-06 19:02:08,337] {result_logger:150} INFO - 
[[ 93.28%   4.41%   2.31%   0.00%]
 [  9.47%  86.55%   3.98%   0.00%]
 [  7.94%   6.63%  85.43%   0.00%]
 [ 61.63%  22.42%  15.95%   0.00%]]
[2024-01-06 19:02:08,549] {result_logger:154} INFO - 
[[ 91.36%   6.44%  15.50%    nan%]
 [  6.74%  91.92%  19.37%    nan%]
 [  0.86%   1.07%  63.28%    nan%]
 [  1.04%   0.57%   1.84%    nan%]]
[2024-01-06 19:02:09,113] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 19:02:09,113] {result_logger:77} INFO - actual:
[2024-01-06 19:02:09,114] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 19:02:09,114] {result_logger:79} INFO - predicted:
[2024-01-06 19:02:09,114] {result_logger:80} INFO - 
[[95.29%  3.49%  1.21%  0.00%]
 [ 4.41% 93.36%  2.24%  0.00%]
 [12.00%  6.55% 81.46%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 19:02:09,152] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it2/model_8conv_2fc-best.pth
[2024-01-06 19:02:09,152] {run_experiment:113} INFO - [epoch  20] execution time: 225.15s	 avg f1-score: 0.8523

[2024-01-06 19:02:09,153] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 19:02:09,214] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 19:02:35,710] {train_model:86} INFO - Train Epoch: 21 [60928/612104 (10%)]	lr:8.69e-05	Loss: 0.081557
[2024-01-06 19:02:47,633] {train_model:86} INFO - Train Epoch: 21 [122112/612104 (20%)]	lr:8.69e-05	Loss: 0.066283
[2024-01-06 19:03:00,205] {train_model:86} INFO - Train Epoch: 21 [183296/612104 (30%)]	lr:8.69e-05	Loss: 0.086423
[2024-01-06 19:03:12,170] {train_model:86} INFO - Train Epoch: 21 [244480/612104 (40%)]	lr:8.69e-05	Loss: 0.154386
[2024-01-06 19:03:24,541] {train_model:86} INFO - Train Epoch: 21 [305664/612104 (50%)]	lr:8.69e-05	Loss: 0.096535
[2024-01-06 19:03:52,310] {train_model:86} INFO - Train Epoch: 21 [366848/612104 (60%)]	lr:8.69e-05	Loss: 0.150217
[2024-01-06 19:04:18,542] {train_model:86} INFO - Train Epoch: 21 [428032/612104 (70%)]	lr:8.69e-05	Loss: 0.199030
[2024-01-06 19:04:30,934] {train_model:86} INFO - Train Epoch: 21 [489216/612104 (80%)]	lr:8.69e-05	Loss: 0.191362
[2024-01-06 19:04:58,590] {train_model:86} INFO - Train Epoch: 21 [550400/612104 (90%)]	lr:8.69e-05	Loss: 0.082261
[2024-01-06 19:05:24,383] {train_model:86} INFO - Train Epoch: 21 [611584/612104 (100%)]	lr:8.69e-05	Loss: 0.034856
[2024-01-06 19:05:38,139] {run_experiment:78} INFO - 
[2024-01-06 19:05:38,146] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 19:05:39,519] {result_logger:108} INFO - precision on WAKE: 0.989
[2024-01-06 19:05:40,434] {result_logger:109} INFO - recall on WAKE: 0.961
[2024-01-06 19:05:41,362] {result_logger:112} INFO - F1-score on WAKE: 0.975
[2024-01-06 19:05:41,362] {result_logger:113} INFO - 
[2024-01-06 19:05:42,780] {result_logger:108} INFO - precision on NREM: 0.953
[2024-01-06 19:05:43,694] {result_logger:109} INFO - recall on NREM: 0.948
[2024-01-06 19:05:44,595] {result_logger:112} INFO - F1-score on NREM: 0.950
[2024-01-06 19:05:44,595] {result_logger:113} INFO - 
[2024-01-06 19:05:45,808] {result_logger:108} INFO - precision on REM: 0.753
[2024-01-06 19:05:46,593] {result_logger:109} INFO - recall on REM: 0.952
[2024-01-06 19:05:47,381] {result_logger:112} INFO - F1-score on REM: 0.841
[2024-01-06 19:05:47,381] {result_logger:113} INFO - 
[2024-01-06 19:05:47,589] {result_logger:116} INFO - average precision on sleep stages: 0.898
[2024-01-06 19:05:47,800] {result_logger:118} INFO - average recall on sleep stages: 0.954
[2024-01-06 19:05:48,012] {result_logger:120} INFO - average F1-score on sleep stages: 0.922
[2024-01-06 19:05:48,574] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.954
[2024-01-06 19:05:48,603] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.956
[2024-01-06 19:05:48,606] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 19:05:48,781] {result_logger:108} INFO - precision on WAKE: 0.919
[2024-01-06 19:05:48,889] {result_logger:109} INFO - recall on WAKE: 0.798
[2024-01-06 19:05:48,999] {result_logger:112} INFO - F1-score on WAKE: 0.854
[2024-01-06 19:05:48,999] {result_logger:113} INFO - 
[2024-01-06 19:05:49,174] {result_logger:108} INFO - precision on NREM: 0.937
[2024-01-06 19:05:49,277] {result_logger:109} INFO - recall on NREM: 0.809
[2024-01-06 19:05:49,384] {result_logger:112} INFO - F1-score on NREM: 0.868
[2024-01-06 19:05:49,384] {result_logger:113} INFO - 
[2024-01-06 19:05:49,552] {result_logger:108} INFO - precision on REM: 0.310
[2024-01-06 19:05:49,654] {result_logger:109} INFO - recall on REM: 0.954
[2024-01-06 19:05:49,759] {result_logger:112} INFO - F1-score on REM: 0.468
[2024-01-06 19:05:49,759] {result_logger:113} INFO - 
[2024-01-06 19:05:49,779] {result_logger:116} INFO - average precision on sleep stages: 0.722
[2024-01-06 19:05:49,800] {result_logger:118} INFO - average recall on sleep stages: 0.854
[2024-01-06 19:05:49,820] {result_logger:120} INFO - average F1-score on sleep stages: 0.730
[2024-01-06 19:05:49,896] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.854
[2024-01-06 19:05:49,899] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.812
[2024-01-06 19:05:49,899] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 19:05:50,520] {result_logger:143} INFO - 
[[319258   9838   2957      2]
 [  3272 226810   9107      1]
 [   414   1426  36831      0]
 [  1922    229     37      0]]
[2024-01-06 19:05:51,140] {result_logger:150} INFO - 
[[ 96.15%   2.96%   0.89%   0.00%]
 [  1.37%  94.82%   3.81%   0.00%]
 [  1.07%   3.69%  95.24%   0.00%]
 [ 87.84%  10.47%   1.69%   0.00%]]
[2024-01-06 19:05:51,744] {result_logger:154} INFO - 
[[ 98.27%   4.13%   6.04%  66.67%]
 [  1.01%  95.18%  18.61%  33.33%]
 [  0.13%   0.60%  75.27%   0.00%]
 [  0.59%   0.10%   0.08%   0.00%]]
[2024-01-06 19:05:51,744] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 19:05:51,824] {result_logger:143} INFO - 
[[38578  1797  7944     0]
 [ 3295 28413  3397     0]
 [  120   124  5097     0]
 [  204   123   507     0]]
[2024-01-06 19:05:52,035] {result_logger:150} INFO - 
[[ 79.84%   3.72%  16.44%   0.00%]
 [  9.39%  80.94%   9.68%   0.00%]
 [  2.25%   2.32%  95.43%   0.00%]
 [ 24.46%  14.75%  60.79%   0.00%]]
[2024-01-06 19:05:52,241] {result_logger:154} INFO - 
[[ 91.42%   5.90%  46.88%    nan%]
 [  7.81%  93.29%  20.05%    nan%]
 [  0.28%   0.41%  30.08%    nan%]
 [  0.48%   0.40%   2.99%    nan%]]
[2024-01-06 19:05:52,684] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 19:05:52,684] {result_logger:77} INFO - actual:
[2024-01-06 19:05:52,684] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 19:05:52,684] {result_logger:79} INFO - predicted:
[2024-01-06 19:05:52,685] {result_logger:80} INFO - 
[[93.56%  2.86%  3.58%  0.00%]
 [ 3.18% 92.76%  4.06%  0.00%]
 [10.33%  5.90% 83.78%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 19:05:52,722] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it2/model_8conv_2fc-best.pth
[2024-01-06 19:05:52,723] {run_experiment:113} INFO - [epoch  21] execution time: 223.57s	 avg f1-score: 0.7303

[2024-01-06 19:05:52,723] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 19:05:52,780] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 19:06:19,680] {train_model:86} INFO - Train Epoch: 22 [60928/612104 (10%)]	lr:8.19e-05	Loss: 0.190447
[2024-01-06 19:06:33,894] {train_model:86} INFO - Train Epoch: 22 [122112/612104 (20%)]	lr:8.19e-05	Loss: 0.066335
[2024-01-06 19:06:45,776] {train_model:86} INFO - Train Epoch: 22 [183296/612104 (30%)]	lr:8.19e-05	Loss: 0.058433
[2024-01-06 19:06:58,473] {train_model:86} INFO - Train Epoch: 22 [244480/612104 (40%)]	lr:8.19e-05	Loss: 0.040927
[2024-01-06 19:07:26,675] {train_model:86} INFO - Train Epoch: 22 [305664/612104 (50%)]	lr:8.19e-05	Loss: 0.097563
[2024-01-06 19:07:52,647] {train_model:86} INFO - Train Epoch: 22 [366848/612104 (60%)]	lr:8.19e-05	Loss: 0.060307
[2024-01-06 19:08:04,570] {train_model:86} INFO - Train Epoch: 22 [428032/612104 (70%)]	lr:8.19e-05	Loss: 0.155683
[2024-01-06 19:08:33,193] {train_model:86} INFO - Train Epoch: 22 [489216/612104 (80%)]	lr:8.19e-05	Loss: 0.101560
[2024-01-06 19:08:59,687] {train_model:86} INFO - Train Epoch: 22 [550400/612104 (90%)]	lr:8.19e-05	Loss: 0.077310
[2024-01-06 19:09:12,038] {train_model:86} INFO - Train Epoch: 22 [611584/612104 (100%)]	lr:8.19e-05	Loss: 0.076477
[2024-01-06 19:09:26,076] {run_experiment:78} INFO - 
[2024-01-06 19:09:26,082] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 19:09:27,403] {result_logger:108} INFO - precision on WAKE: 0.989
[2024-01-06 19:09:28,261] {result_logger:109} INFO - recall on WAKE: 0.962
[2024-01-06 19:09:29,153] {result_logger:112} INFO - F1-score on WAKE: 0.975
[2024-01-06 19:09:29,153] {result_logger:113} INFO - 
[2024-01-06 19:09:30,544] {result_logger:108} INFO - precision on NREM: 0.953
[2024-01-06 19:09:31,455] {result_logger:109} INFO - recall on NREM: 0.950
[2024-01-06 19:09:32,341] {result_logger:112} INFO - F1-score on NREM: 0.951
[2024-01-06 19:09:32,341] {result_logger:113} INFO - 
[2024-01-06 19:09:33,574] {result_logger:108} INFO - precision on REM: 0.761
[2024-01-06 19:09:34,336] {result_logger:109} INFO - recall on REM: 0.953
[2024-01-06 19:09:35,089] {result_logger:112} INFO - F1-score on REM: 0.846
[2024-01-06 19:09:35,089] {result_logger:113} INFO - 
[2024-01-06 19:09:35,276] {result_logger:116} INFO - average precision on sleep stages: 0.901
[2024-01-06 19:09:35,483] {result_logger:118} INFO - average recall on sleep stages: 0.955
[2024-01-06 19:09:35,692] {result_logger:120} INFO - average F1-score on sleep stages: 0.924
[2024-01-06 19:09:36,229] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.955
[2024-01-06 19:09:36,257] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.957
[2024-01-06 19:09:36,260] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 19:09:36,427] {result_logger:108} INFO - precision on WAKE: 0.886
[2024-01-06 19:09:36,532] {result_logger:109} INFO - recall on WAKE: 0.803
[2024-01-06 19:09:36,637] {result_logger:112} INFO - F1-score on WAKE: 0.842
[2024-01-06 19:09:36,637] {result_logger:113} INFO - 
[2024-01-06 19:09:36,807] {result_logger:108} INFO - precision on NREM: 0.896
[2024-01-06 19:09:36,914] {result_logger:109} INFO - recall on NREM: 0.822
[2024-01-06 19:09:37,013] {result_logger:112} INFO - F1-score on NREM: 0.857
[2024-01-06 19:09:37,014] {result_logger:113} INFO - 
[2024-01-06 19:09:37,184] {result_logger:108} INFO - precision on REM: 0.346
[2024-01-06 19:09:37,290] {result_logger:109} INFO - recall on REM: 0.826
[2024-01-06 19:09:37,397] {result_logger:112} INFO - F1-score on REM: 0.487
[2024-01-06 19:09:37,397] {result_logger:113} INFO - 
[2024-01-06 19:09:37,417] {result_logger:116} INFO - average precision on sleep stages: 0.709
[2024-01-06 19:09:37,436] {result_logger:118} INFO - average recall on sleep stages: 0.817
[2024-01-06 19:09:37,455] {result_logger:120} INFO - average F1-score on sleep stages: 0.729
[2024-01-06 19:09:37,530] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.817
[2024-01-06 19:09:37,533] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.812
[2024-01-06 19:09:37,533] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 19:09:38,135] {result_logger:143} INFO - 
[[319475   9709   2868      3]
 [  3318 227147   8725      0]
 [   391   1412  36867      1]
 [  1913    240     35      0]]
[2024-01-06 19:09:38,737] {result_logger:150} INFO - 
[[ 96.21%   2.92%   0.86%   0.00%]
 [  1.39%  94.97%   3.65%   0.00%]
 [  1.01%   3.65%  95.34%   0.00%]
 [ 87.43%  10.97%   1.60%   0.00%]]
[2024-01-06 19:09:39,357] {result_logger:154} INFO - 
[[ 98.27%   4.07%   5.91%  75.00%]
 [  1.02%  95.24%  17.99%   0.00%]
 [  0.12%   0.59%  76.02%  25.00%]
 [  0.59%   0.10%   0.07%   0.00%]]
[2024-01-06 19:09:39,357] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 19:09:39,442] {result_logger:143} INFO - 
[[38795  2732  6792     0]
 [ 4697 28844  1564     0]
 [  312   615  4414     0]
 [  219   203   412     0]]
[2024-01-06 19:09:39,640] {result_logger:150} INFO - 
[[ 80.29%   5.65%  14.06%   0.00%]
 [ 13.38%  82.16%   4.46%   0.00%]
 [  5.84%  11.51%  82.64%   0.00%]
 [ 26.26%  24.34%  49.40%   0.00%]]
[2024-01-06 19:09:39,848] {result_logger:154} INFO - 
[[ 88.12%   8.43%  51.52%    nan%]
 [ 10.67%  89.04%  11.86%    nan%]
 [  0.71%   1.90%  33.49%    nan%]
 [  0.50%   0.63%   3.13%    nan%]]
[2024-01-06 19:09:40,286] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 19:09:40,286] {result_logger:77} INFO - actual:
[2024-01-06 19:09:40,287] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 19:09:40,287] {result_logger:79} INFO - predicted:
[2024-01-06 19:09:40,287] {result_logger:80} INFO - 
[[93.81%  3.40%  2.80%  0.00%]
 [ 4.02% 92.49%  3.49%  0.00%]
 [10.80%  7.12% 82.07%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 19:09:40,321] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it2/model_8conv_2fc-best.pth
[2024-01-06 19:09:40,322] {run_experiment:113} INFO - [epoch  22] execution time: 227.60s	 avg f1-score: 0.7290

[2024-01-06 19:09:40,322] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 19:09:40,378] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 19:10:06,676] {train_model:86} INFO - Train Epoch: 23 [60928/612104 (10%)]	lr:7.71e-05	Loss: 0.075386
[2024-01-06 19:10:19,096] {train_model:86} INFO - Train Epoch: 23 [122112/612104 (20%)]	lr:7.71e-05	Loss: 0.106075
[2024-01-06 19:10:31,022] {train_model:86} INFO - Train Epoch: 23 [183296/612104 (30%)]	lr:7.71e-05	Loss: 0.086007
[2024-01-06 19:10:58,847] {train_model:86} INFO - Train Epoch: 23 [244480/612104 (40%)]	lr:7.71e-05	Loss: 0.112385
[2024-01-06 19:11:25,154] {train_model:86} INFO - Train Epoch: 23 [305664/612104 (50%)]	lr:7.71e-05	Loss: 0.143421
[2024-01-06 19:11:37,514] {train_model:86} INFO - Train Epoch: 23 [366848/612104 (60%)]	lr:7.71e-05	Loss: 0.225373
[2024-01-06 19:11:49,792] {train_model:86} INFO - Train Epoch: 23 [428032/612104 (70%)]	lr:7.71e-05	Loss: 0.143455
[2024-01-06 19:12:17,019] {train_model:86} INFO - Train Epoch: 23 [489216/612104 (80%)]	lr:7.71e-05	Loss: 0.079839
[2024-01-06 19:12:43,071] {train_model:86} INFO - Train Epoch: 23 [550400/612104 (90%)]	lr:7.71e-05	Loss: 0.089142
[2024-01-06 19:12:55,223] {train_model:86} INFO - Train Epoch: 23 [611584/612104 (100%)]	lr:7.71e-05	Loss: 0.153929
[2024-01-06 19:13:08,581] {run_experiment:78} INFO - 
[2024-01-06 19:13:08,587] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 19:13:09,944] {result_logger:108} INFO - precision on WAKE: 0.989
[2024-01-06 19:13:10,836] {result_logger:109} INFO - recall on WAKE: 0.962
[2024-01-06 19:13:11,718] {result_logger:112} INFO - F1-score on WAKE: 0.975
[2024-01-06 19:13:11,718] {result_logger:113} INFO - 
[2024-01-06 19:13:13,083] {result_logger:108} INFO - precision on NREM: 0.953
[2024-01-06 19:13:13,997] {result_logger:109} INFO - recall on NREM: 0.950
[2024-01-06 19:13:14,910] {result_logger:112} INFO - F1-score on NREM: 0.951
[2024-01-06 19:13:14,910] {result_logger:113} INFO - 
[2024-01-06 19:13:16,152] {result_logger:108} INFO - precision on REM: 0.760
[2024-01-06 19:13:16,946] {result_logger:109} INFO - recall on REM: 0.952
[2024-01-06 19:13:17,730] {result_logger:112} INFO - F1-score on REM: 0.845
[2024-01-06 19:13:17,730] {result_logger:113} INFO - 
[2024-01-06 19:13:17,928] {result_logger:116} INFO - average precision on sleep stages: 0.901
[2024-01-06 19:13:18,130] {result_logger:118} INFO - average recall on sleep stages: 0.955
[2024-01-06 19:13:18,332] {result_logger:120} INFO - average F1-score on sleep stages: 0.924
[2024-01-06 19:13:18,882] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.955
[2024-01-06 19:13:18,911] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.957
[2024-01-06 19:13:18,917] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 19:13:19,087] {result_logger:108} INFO - precision on WAKE: 0.858
[2024-01-06 19:13:19,194] {result_logger:109} INFO - recall on WAKE: 0.883
[2024-01-06 19:13:19,300] {result_logger:112} INFO - F1-score on WAKE: 0.871
[2024-01-06 19:13:19,300] {result_logger:113} INFO - 
[2024-01-06 19:13:19,473] {result_logger:108} INFO - precision on NREM: 0.937
[2024-01-06 19:13:19,580] {result_logger:109} INFO - recall on NREM: 0.762
[2024-01-06 19:13:19,688] {result_logger:112} INFO - F1-score on NREM: 0.840
[2024-01-06 19:13:19,688] {result_logger:113} INFO - 
[2024-01-06 19:13:19,857] {result_logger:108} INFO - precision on REM: 0.414
[2024-01-06 19:13:19,963] {result_logger:109} INFO - recall on REM: 0.812
[2024-01-06 19:13:20,069] {result_logger:112} INFO - F1-score on REM: 0.548
[2024-01-06 19:13:20,069] {result_logger:113} INFO - 
[2024-01-06 19:13:20,088] {result_logger:116} INFO - average precision on sleep stages: 0.736
[2024-01-06 19:13:20,107] {result_logger:118} INFO - average recall on sleep stages: 0.819
[2024-01-06 19:13:20,126] {result_logger:120} INFO - average F1-score on sleep stages: 0.753
[2024-01-06 19:13:20,201] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.819
[2024-01-06 19:13:20,204] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.831
[2024-01-06 19:13:20,205] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 19:13:20,832] {result_logger:143} INFO - 
[[319448   9792   2813      2]
 [  3201 227194   8794      1]
 [   410   1457  36804      0]
 [  1912    237     39      0]]
[2024-01-06 19:13:21,451] {result_logger:150} INFO - 
[[ 96.20%   2.95%   0.85%   0.00%]
 [  1.34%  94.98%   3.68%   0.00%]
 [  1.06%   3.77%  95.17%   0.00%]
 [ 87.39%  10.83%   1.78%   0.00%]]
[2024-01-06 19:13:22,045] {result_logger:154} INFO - 
[[ 98.30%   4.10%   5.81%  66.67%]
 [  0.99%  95.19%  18.15%  33.33%]
 [  0.13%   0.61%  75.96%   0.00%]
 [  0.59%   0.10%   0.08%   0.00%]]
[2024-01-06 19:13:22,045] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 19:13:22,121] {result_logger:143} INFO - 
[[42676  1456  4187     0]
 [ 6388 26753  1964     0]
 [  657   347  4337     0]
 [  460    74   300     0]]
[2024-01-06 19:13:22,332] {result_logger:150} INFO - 
[[ 88.32%   3.01%   8.67%   0.00%]
 [ 18.20%  76.21%   5.59%   0.00%]
 [ 12.30%   6.50%  81.20%   0.00%]
 [ 55.16%   8.87%  35.97%   0.00%]]
[2024-01-06 19:13:22,536] {result_logger:154} INFO - 
[[ 85.04%   5.09%  38.81%    nan%]
 [ 12.73%  93.44%  18.21%    nan%]
 [  1.31%   1.21%  40.20%    nan%]
 [  0.92%   0.26%   2.78%    nan%]]
[2024-01-06 19:13:22,971] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 19:13:22,972] {result_logger:77} INFO - actual:
[2024-01-06 19:13:22,972] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 19:13:22,972] {result_logger:79} INFO - predicted:
[2024-01-06 19:13:22,972] {result_logger:80} INFO - 
[[95.15%  2.43%  2.42%  0.00%]
 [ 3.92% 93.60%  2.48%  0.00%]
 [12.15%  5.69% 82.16%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 19:13:23,009] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it2/model_8conv_2fc-best.pth
[2024-01-06 19:13:23,009] {run_experiment:113} INFO - [epoch  23] execution time: 222.69s	 avg f1-score: 0.7530

[2024-01-06 19:13:23,009] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 19:13:23,067] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 19:13:49,772] {train_model:86} INFO - Train Epoch: 24 [60928/612104 (10%)]	lr:7.26e-05	Loss: 0.121737
[2024-01-06 19:14:01,788] {train_model:86} INFO - Train Epoch: 24 [122112/612104 (20%)]	lr:7.26e-05	Loss: 0.068679
[2024-01-06 19:14:13,694] {train_model:86} INFO - Train Epoch: 24 [183296/612104 (30%)]	lr:7.26e-05	Loss: 0.077897
[2024-01-06 19:14:54,558] {train_model:86} INFO - Train Epoch: 24 [244480/612104 (40%)]	lr:7.26e-05	Loss: 0.129646
[2024-01-06 19:15:07,925] {train_model:86} INFO - Train Epoch: 24 [305664/612104 (50%)]	lr:7.26e-05	Loss: 0.337025
[2024-01-06 19:15:22,417] {train_model:86} INFO - Train Epoch: 24 [366848/612104 (60%)]	lr:7.26e-05	Loss: 0.077554
[2024-01-06 19:15:50,218] {train_model:86} INFO - Train Epoch: 24 [428032/612104 (70%)]	lr:7.26e-05	Loss: 0.138353
[2024-01-06 19:16:16,405] {train_model:86} INFO - Train Epoch: 24 [489216/612104 (80%)]	lr:7.26e-05	Loss: 0.130892
[2024-01-06 19:16:28,741] {train_model:86} INFO - Train Epoch: 24 [550400/612104 (90%)]	lr:7.26e-05	Loss: 0.215812
[2024-01-06 19:16:40,959] {train_model:86} INFO - Train Epoch: 24 [611584/612104 (100%)]	lr:7.26e-05	Loss: 0.145375
[2024-01-06 19:16:54,474] {run_experiment:78} INFO - 
[2024-01-06 19:16:54,480] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 19:16:55,843] {result_logger:108} INFO - precision on WAKE: 0.989
[2024-01-06 19:16:56,742] {result_logger:109} INFO - recall on WAKE: 0.962
[2024-01-06 19:16:57,648] {result_logger:112} INFO - F1-score on WAKE: 0.975
[2024-01-06 19:16:57,648] {result_logger:113} INFO - 
[2024-01-06 19:16:59,000] {result_logger:108} INFO - precision on NREM: 0.953
[2024-01-06 19:16:59,899] {result_logger:109} INFO - recall on NREM: 0.951
[2024-01-06 19:17:00,811] {result_logger:112} INFO - F1-score on NREM: 0.952
[2024-01-06 19:17:00,811] {result_logger:113} INFO - 
[2024-01-06 19:17:02,065] {result_logger:108} INFO - precision on REM: 0.763
[2024-01-06 19:17:02,857] {result_logger:109} INFO - recall on REM: 0.955
[2024-01-06 19:17:03,642] {result_logger:112} INFO - F1-score on REM: 0.848
[2024-01-06 19:17:03,642] {result_logger:113} INFO - 
[2024-01-06 19:17:03,846] {result_logger:116} INFO - average precision on sleep stages: 0.902
[2024-01-06 19:17:04,052] {result_logger:118} INFO - average recall on sleep stages: 0.956
[2024-01-06 19:17:04,259] {result_logger:120} INFO - average F1-score on sleep stages: 0.925
[2024-01-06 19:17:04,809] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.956
[2024-01-06 19:17:04,839] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.957
[2024-01-06 19:17:04,843] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 19:17:05,012] {result_logger:108} INFO - precision on WAKE: 0.808
[2024-01-06 19:17:05,116] {result_logger:109} INFO - recall on WAKE: 0.980
[2024-01-06 19:17:05,226] {result_logger:112} INFO - F1-score on WAKE: 0.886
[2024-01-06 19:17:05,226] {result_logger:113} INFO - 
[2024-01-06 19:17:05,394] {result_logger:108} INFO - precision on NREM: 0.950
[2024-01-06 19:17:05,495] {result_logger:109} INFO - recall on NREM: 0.694
[2024-01-06 19:17:05,601] {result_logger:112} INFO - F1-score on NREM: 0.802
[2024-01-06 19:17:05,601] {result_logger:113} INFO - 
[2024-01-06 19:17:05,770] {result_logger:108} INFO - precision on REM: 0.761
[2024-01-06 19:17:05,874] {result_logger:109} INFO - recall on REM: 0.638
[2024-01-06 19:17:05,977] {result_logger:112} INFO - F1-score on REM: 0.694
[2024-01-06 19:17:05,977] {result_logger:113} INFO - 
[2024-01-06 19:17:05,995] {result_logger:116} INFO - average precision on sleep stages: 0.840
[2024-01-06 19:17:06,013] {result_logger:118} INFO - average recall on sleep stages: 0.771
[2024-01-06 19:17:06,032] {result_logger:120} INFO - average F1-score on sleep stages: 0.794
[2024-01-06 19:17:06,109] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.771
[2024-01-06 19:17:06,113] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.847
[2024-01-06 19:17:06,113] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 19:17:06,720] {result_logger:143} INFO - 
[[319336   9766   2951      2]
 [  3232 227412   8545      1]
 [   366   1379  36926      0]
 [  1917    236     35      0]]
[2024-01-06 19:17:07,333] {result_logger:150} INFO - 
[[ 96.17%   2.94%   0.89%   0.00%]
 [  1.35%  95.08%   3.57%   0.00%]
 [  0.95%   3.57%  95.49%   0.00%]
 [ 87.61%  10.79%   1.60%   0.00%]]
[2024-01-06 19:17:07,926] {result_logger:154} INFO - 
[[ 98.30%   4.09%   6.09%  66.67%]
 [  0.99%  95.23%  17.63%  33.33%]
 [  0.11%   0.58%  76.20%   0.00%]
 [  0.59%   0.10%   0.07%   0.00%]]
[2024-01-06 19:17:07,926] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 19:17:08,007] {result_logger:143} INFO - 
[[47369   896    54     0]
 [ 9709 24377  1019     0]
 [ 1556   376  3409     0]
 [  787    36    11     0]]
[2024-01-06 19:17:08,212] {result_logger:150} INFO - 
[[ 98.03%   1.85%   0.11%   0.00%]
 [ 27.66%  69.44%   2.90%   0.00%]
 [ 29.13%   7.04%  63.83%   0.00%]
 [ 94.36%   4.32%   1.32%   0.00%]]
[2024-01-06 19:17:08,526] {result_logger:154} INFO - 
[[ 79.72%   3.49%   1.20%    nan%]
 [ 16.34%  94.91%  22.68%    nan%]
 [  2.62%   1.46%  75.87%    nan%]
 [  1.32%   0.14%   0.24%    nan%]]
[2024-01-06 19:17:08,963] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 19:17:08,963] {result_logger:77} INFO - actual:
[2024-01-06 19:17:08,964] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 19:17:08,964] {result_logger:79} INFO - predicted:
[2024-01-06 19:17:08,964] {result_logger:80} INFO - 
[[97.43%  2.18%  0.39%  0.00%]
 [ 4.24% 93.90%  1.86%  0.00%]
 [ 9.75%  6.08% 84.18%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 19:17:09,001] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it2/model_8conv_2fc-best.pth
[2024-01-06 19:17:09,001] {run_experiment:113} INFO - [epoch  24] execution time: 225.99s	 avg f1-score: 0.7941

[2024-01-06 19:17:09,001] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 19:17:09,061] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 19:17:35,399] {train_model:86} INFO - Train Epoch: 25 [60928/612104 (10%)]	lr:6.84e-05	Loss: 0.094580
[2024-01-06 19:17:47,453] {train_model:86} INFO - Train Epoch: 25 [122112/612104 (20%)]	lr:6.84e-05	Loss: 0.102170
[2024-01-06 19:18:15,597] {train_model:86} INFO - Train Epoch: 25 [183296/612104 (30%)]	lr:6.84e-05	Loss: 0.160621
[2024-01-06 19:18:41,479] {train_model:86} INFO - Train Epoch: 25 [244480/612104 (40%)]	lr:6.84e-05	Loss: 0.112741
[2024-01-06 19:18:53,769] {train_model:86} INFO - Train Epoch: 25 [305664/612104 (50%)]	lr:6.84e-05	Loss: 0.121656
[2024-01-06 19:19:06,797] {train_model:86} INFO - Train Epoch: 25 [366848/612104 (60%)]	lr:6.84e-05	Loss: 0.095895
[2024-01-06 19:19:34,662] {train_model:86} INFO - Train Epoch: 25 [428032/612104 (70%)]	lr:6.84e-05	Loss: 0.054845
[2024-01-06 19:20:00,910] {train_model:86} INFO - Train Epoch: 25 [489216/612104 (80%)]	lr:6.84e-05	Loss: 0.113545
[2024-01-06 19:20:13,543] {train_model:86} INFO - Train Epoch: 25 [550400/612104 (90%)]	lr:6.84e-05	Loss: 0.045086
[2024-01-06 19:20:26,077] {train_model:86} INFO - Train Epoch: 25 [611584/612104 (100%)]	lr:6.84e-05	Loss: 0.087857
[2024-01-06 19:20:39,917] {run_experiment:78} INFO - 
[2024-01-06 19:20:39,924] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 19:20:41,264] {result_logger:108} INFO - precision on WAKE: 0.989
[2024-01-06 19:20:42,153] {result_logger:109} INFO - recall on WAKE: 0.962
[2024-01-06 19:20:43,046] {result_logger:112} INFO - F1-score on WAKE: 0.975
[2024-01-06 19:20:43,047] {result_logger:113} INFO - 
[2024-01-06 19:20:44,437] {result_logger:108} INFO - precision on NREM: 0.953
[2024-01-06 19:20:45,336] {result_logger:109} INFO - recall on NREM: 0.951
[2024-01-06 19:20:46,240] {result_logger:112} INFO - F1-score on NREM: 0.952
[2024-01-06 19:20:46,240] {result_logger:113} INFO - 
[2024-01-06 19:20:47,462] {result_logger:108} INFO - precision on REM: 0.767
[2024-01-06 19:20:48,242] {result_logger:109} INFO - recall on REM: 0.955
[2024-01-06 19:20:49,015] {result_logger:112} INFO - F1-score on REM: 0.851
[2024-01-06 19:20:49,016] {result_logger:113} INFO - 
[2024-01-06 19:20:49,209] {result_logger:116} INFO - average precision on sleep stages: 0.903
[2024-01-06 19:20:49,407] {result_logger:118} INFO - average recall on sleep stages: 0.956
[2024-01-06 19:20:49,605] {result_logger:120} INFO - average F1-score on sleep stages: 0.926
[2024-01-06 19:20:50,158] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.956
[2024-01-06 19:20:50,186] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.957
[2024-01-06 19:20:50,190] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 19:20:50,369] {result_logger:108} INFO - precision on WAKE: 0.910
[2024-01-06 19:20:50,477] {result_logger:109} INFO - recall on WAKE: 0.950
[2024-01-06 19:20:50,585] {result_logger:112} INFO - F1-score on WAKE: 0.930
[2024-01-06 19:20:50,585] {result_logger:113} INFO - 
[2024-01-06 19:20:50,752] {result_logger:108} INFO - precision on NREM: 0.917
[2024-01-06 19:20:50,857] {result_logger:109} INFO - recall on NREM: 0.846
[2024-01-06 19:20:50,961] {result_logger:112} INFO - F1-score on NREM: 0.881
[2024-01-06 19:20:50,961] {result_logger:113} INFO - 
[2024-01-06 19:20:51,136] {result_logger:108} INFO - precision on REM: 0.730
[2024-01-06 19:20:51,240] {result_logger:109} INFO - recall on REM: 0.814
[2024-01-06 19:20:51,342] {result_logger:112} INFO - F1-score on REM: 0.770
[2024-01-06 19:20:51,342] {result_logger:113} INFO - 
[2024-01-06 19:20:51,362] {result_logger:116} INFO - average precision on sleep stages: 0.853
[2024-01-06 19:20:51,382] {result_logger:118} INFO - average recall on sleep stages: 0.870
[2024-01-06 19:20:51,402] {result_logger:120} INFO - average F1-score on sleep stages: 0.860
[2024-01-06 19:20:51,479] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.870
[2024-01-06 19:20:51,482] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.901
[2024-01-06 19:20:51,482] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 19:20:52,094] {result_logger:143} INFO - 
[[319523   9816   2714      2]
 [  3213 227449   8528      0]
 [   394   1342  36935      0]
 [  1916    240     32      0]]
[2024-01-06 19:20:52,711] {result_logger:150} INFO - 
[[ 96.23%   2.96%   0.82%   0.00%]
 [  1.34%  95.09%   3.57%   0.00%]
 [  1.02%   3.47%  95.51%   0.00%]
 [ 87.57%  10.97%   1.46%   0.00%]]
[2024-01-06 19:20:53,312] {result_logger:154} INFO - 
[[ 98.30%   4.11%   5.63% 100.00%]
 [  0.99%  95.23%  17.69%   0.00%]
 [  0.12%   0.56%  76.61%   0.00%]
 [  0.59%   0.10%   0.07%   0.00%]]
[2024-01-06 19:20:53,312] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 19:20:53,394] {result_logger:143} INFO - 
[[45899  2226   194     0]
 [ 3979 29714  1412     0]
 [  546   447  4348     0]
 [  595   224    15     0]]
[2024-01-06 19:20:53,605] {result_logger:150} INFO - 
[[ 94.99%   4.61%   0.40%   0.00%]
 [ 11.33%  84.64%   4.02%   0.00%]
 [ 10.22%   8.37%  81.41%   0.00%]
 [ 71.34%  26.86%   1.80%   0.00%]]
[2024-01-06 19:20:53,815] {result_logger:154} INFO - 
[[ 89.96%   6.83%   3.25%    nan%]
 [  7.80%  91.12%  23.66%    nan%]
 [  1.07%   1.37%  72.84%    nan%]
 [  1.17%   0.69%   0.25%    nan%]]
[2024-01-06 19:20:54,266] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 19:20:54,266] {result_logger:77} INFO - actual:
[2024-01-06 19:20:54,266] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 19:20:54,266] {result_logger:79} INFO - predicted:
[2024-01-06 19:20:54,267] {result_logger:80} INFO - 
[[95.78%  3.65%  0.57%  0.00%]
 [ 5.02% 93.16%  1.82%  0.00%]
 [ 8.59%  6.18% 85.22%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 19:20:54,303] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it2/model_8conv_2fc-best.pth
[2024-01-06 19:20:54,303] {run_experiment:113} INFO - [epoch  25] execution time: 225.30s	 avg f1-score: 0.8600

[2024-01-06 19:20:54,303] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 19:20:54,362] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 19:21:20,785] {train_model:86} INFO - Train Epoch: 26 [60928/612104 (10%)]	lr:6.44e-05	Loss: 0.129144
[2024-01-06 19:21:48,799] {train_model:86} INFO - Train Epoch: 26 [122112/612104 (20%)]	lr:6.44e-05	Loss: 0.153926
[2024-01-06 19:22:14,856] {train_model:86} INFO - Train Epoch: 26 [183296/612104 (30%)]	lr:6.44e-05	Loss: 0.064638
[2024-01-06 19:22:27,362] {train_model:86} INFO - Train Epoch: 26 [244480/612104 (40%)]	lr:6.44e-05	Loss: 0.166567
[2024-01-06 19:22:40,998] {train_model:86} INFO - Train Epoch: 26 [305664/612104 (50%)]	lr:6.44e-05	Loss: 0.416702
[2024-01-06 19:23:08,947] {train_model:86} INFO - Train Epoch: 26 [366848/612104 (60%)]	lr:6.44e-05	Loss: 0.101545
[2024-01-06 19:23:35,137] {train_model:86} INFO - Train Epoch: 26 [428032/612104 (70%)]	lr:6.44e-05	Loss: 0.103936
[2024-01-06 19:23:47,657] {train_model:86} INFO - Train Epoch: 26 [489216/612104 (80%)]	lr:6.44e-05	Loss: 0.197169
[2024-01-06 19:24:00,900] {train_model:86} INFO - Train Epoch: 26 [550400/612104 (90%)]	lr:6.44e-05	Loss: 0.115246
[2024-01-06 19:24:13,336] {train_model:86} INFO - Train Epoch: 26 [611584/612104 (100%)]	lr:6.44e-05	Loss: 0.092168
[2024-01-06 19:24:26,706] {run_experiment:78} INFO - 
[2024-01-06 19:24:26,712] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 19:24:28,099] {result_logger:108} INFO - precision on WAKE: 0.988
[2024-01-06 19:24:28,983] {result_logger:109} INFO - recall on WAKE: 0.964
[2024-01-06 19:24:29,884] {result_logger:112} INFO - F1-score on WAKE: 0.976
[2024-01-06 19:24:29,885] {result_logger:113} INFO - 
[2024-01-06 19:24:31,227] {result_logger:108} INFO - precision on NREM: 0.955
[2024-01-06 19:24:32,119] {result_logger:109} INFO - recall on NREM: 0.951
[2024-01-06 19:24:33,025] {result_logger:112} INFO - F1-score on NREM: 0.953
[2024-01-06 19:24:33,025] {result_logger:113} INFO - 
[2024-01-06 19:24:34,275] {result_logger:108} INFO - precision on REM: 0.773
[2024-01-06 19:24:35,070] {result_logger:109} INFO - recall on REM: 0.955
[2024-01-06 19:24:35,851] {result_logger:112} INFO - F1-score on REM: 0.854
[2024-01-06 19:24:35,851] {result_logger:113} INFO - 
[2024-01-06 19:24:36,053] {result_logger:116} INFO - average precision on sleep stages: 0.905
[2024-01-06 19:24:36,258] {result_logger:118} INFO - average recall on sleep stages: 0.957
[2024-01-06 19:24:36,462] {result_logger:120} INFO - average F1-score on sleep stages: 0.928
[2024-01-06 19:24:37,042] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.957
[2024-01-06 19:24:37,070] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.958
[2024-01-06 19:24:37,074] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 19:24:37,256] {result_logger:108} INFO - precision on WAKE: 0.877
[2024-01-06 19:24:37,364] {result_logger:109} INFO - recall on WAKE: 0.910
[2024-01-06 19:24:37,474] {result_logger:112} INFO - F1-score on WAKE: 0.893
[2024-01-06 19:24:37,474] {result_logger:113} INFO - 
[2024-01-06 19:24:37,659] {result_logger:108} INFO - precision on NREM: 0.939
[2024-01-06 19:24:37,768] {result_logger:109} INFO - recall on NREM: 0.778
[2024-01-06 19:24:37,877] {result_logger:112} INFO - F1-score on NREM: 0.851
[2024-01-06 19:24:37,878] {result_logger:113} INFO - 
[2024-01-06 19:24:38,056] {result_logger:108} INFO - precision on REM: 0.500
[2024-01-06 19:24:38,164] {result_logger:109} INFO - recall on REM: 0.893
[2024-01-06 19:24:38,272] {result_logger:112} INFO - F1-score on REM: 0.641
[2024-01-06 19:24:38,272] {result_logger:113} INFO - 
[2024-01-06 19:24:38,292] {result_logger:116} INFO - average precision on sleep stages: 0.772
[2024-01-06 19:24:38,313] {result_logger:118} INFO - average recall on sleep stages: 0.860
[2024-01-06 19:24:38,333] {result_logger:120} INFO - average F1-score on sleep stages: 0.795
[2024-01-06 19:24:38,409] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.860
[2024-01-06 19:24:38,412] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.857
[2024-01-06 19:24:38,413] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 19:24:39,026] {result_logger:143} INFO - 
[[319950   9525   2578      2]
 [  3316 227578   8296      0]
 [   418   1321  36932      0]
 [  1919    237     32      0]]
[2024-01-06 19:24:39,658] {result_logger:150} INFO - 
[[ 96.35%   2.87%   0.78%   0.00%]
 [  1.39%  95.15%   3.47%   0.00%]
 [  1.08%   3.42%  95.50%   0.00%]
 [ 87.71%  10.83%   1.46%   0.00%]]
[2024-01-06 19:24:40,292] {result_logger:154} INFO - 
[[ 98.26%   3.99%   5.39% 100.00%]
 [  1.02%  95.36%  17.34%   0.00%]
 [  0.13%   0.55%  77.20%   0.00%]
 [  0.59%   0.10%   0.07%   0.00%]]
[2024-01-06 19:24:40,292] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 19:24:40,374] {result_logger:143} INFO - 
[[43975  1628  2716     0]
 [ 5735 27327  2043     0]
 [  434   140  4767     0]
 [  494   137   203     0]]
[2024-01-06 19:24:40,581] {result_logger:150} INFO - 
[[ 91.01%   3.37%   5.62%   0.00%]
 [ 16.34%  77.84%   5.82%   0.00%]
 [  8.13%   2.62%  89.25%   0.00%]
 [ 59.23%  16.43%  24.34%   0.00%]]
[2024-01-06 19:24:40,788] {result_logger:154} INFO - 
[[ 86.84%   5.57%  27.92%    nan%]
 [ 11.33%  93.48%  21.00%    nan%]
 [  0.86%   0.48%  49.00%    nan%]
 [  0.98%   0.47%   2.09%    nan%]]
[2024-01-06 19:24:41,231] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 19:24:41,231] {result_logger:77} INFO - actual:
[2024-01-06 19:24:41,231] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 19:24:41,231] {result_logger:79} INFO - predicted:
[2024-01-06 19:24:41,232] {result_logger:80} INFO - 
[[94.73%  3.04%  2.23%  0.00%]
 [ 4.54% 92.76%  2.69%  0.00%]
 [13.78%  5.92% 80.30%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 19:24:41,267] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it2/model_8conv_2fc-best.pth
[2024-01-06 19:24:41,267] {run_experiment:113} INFO - [epoch  26] execution time: 226.96s	 avg f1-score: 0.7953

[2024-01-06 19:24:41,267] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 19:24:41,328] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 19:25:23,443] {train_model:86} INFO - Train Epoch: 27 [60928/612104 (10%)]	lr:6.07e-05	Loss: 0.054355
[2024-01-06 19:25:49,783] {train_model:86} INFO - Train Epoch: 27 [122112/612104 (20%)]	lr:6.07e-05	Loss: 0.076782
[2024-01-06 19:26:02,174] {train_model:86} INFO - Train Epoch: 27 [183296/612104 (30%)]	lr:6.07e-05	Loss: 0.104342
[2024-01-06 19:26:14,082] {train_model:86} INFO - Train Epoch: 27 [244480/612104 (40%)]	lr:6.07e-05	Loss: 0.094136
[2024-01-06 19:26:26,331] {train_model:86} INFO - Train Epoch: 27 [305664/612104 (50%)]	lr:6.07e-05	Loss: 0.110932
[2024-01-06 19:26:54,381] {train_model:86} INFO - Train Epoch: 27 [366848/612104 (60%)]	lr:6.07e-05	Loss: 0.083849
[2024-01-06 19:27:20,713] {train_model:86} INFO - Train Epoch: 27 [428032/612104 (70%)]	lr:6.07e-05	Loss: 0.046885
[2024-01-06 19:27:33,633] {train_model:86} INFO - Train Epoch: 27 [489216/612104 (80%)]	lr:6.07e-05	Loss: 0.136408
[2024-01-06 19:27:46,469] {train_model:86} INFO - Train Epoch: 27 [550400/612104 (90%)]	lr:6.07e-05	Loss: 0.070336
[2024-01-06 19:27:58,869] {train_model:86} INFO - Train Epoch: 27 [611584/612104 (100%)]	lr:6.07e-05	Loss: 0.097123
[2024-01-06 19:28:13,157] {run_experiment:78} INFO - 
[2024-01-06 19:28:13,163] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 19:28:14,500] {result_logger:108} INFO - precision on WAKE: 0.989
[2024-01-06 19:28:15,404] {result_logger:109} INFO - recall on WAKE: 0.963
[2024-01-06 19:28:16,293] {result_logger:112} INFO - F1-score on WAKE: 0.976
[2024-01-06 19:28:16,293] {result_logger:113} INFO - 
[2024-01-06 19:28:17,671] {result_logger:108} INFO - precision on NREM: 0.955
[2024-01-06 19:28:18,557] {result_logger:109} INFO - recall on NREM: 0.951
[2024-01-06 19:28:19,449] {result_logger:112} INFO - F1-score on NREM: 0.953
[2024-01-06 19:28:19,449] {result_logger:113} INFO - 
[2024-01-06 19:28:20,638] {result_logger:108} INFO - precision on REM: 0.770
[2024-01-06 19:28:21,396] {result_logger:109} INFO - recall on REM: 0.958
[2024-01-06 19:28:22,137] {result_logger:112} INFO - F1-score on REM: 0.854
[2024-01-06 19:28:22,137] {result_logger:113} INFO - 
[2024-01-06 19:28:22,337] {result_logger:116} INFO - average precision on sleep stages: 0.905
[2024-01-06 19:28:22,536] {result_logger:118} INFO - average recall on sleep stages: 0.957
[2024-01-06 19:28:22,731] {result_logger:120} INFO - average F1-score on sleep stages: 0.927
[2024-01-06 19:28:23,286] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.957
[2024-01-06 19:28:23,314] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.958
[2024-01-06 19:28:23,318] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 19:28:23,490] {result_logger:108} INFO - precision on WAKE: 0.864
[2024-01-06 19:28:23,596] {result_logger:109} INFO - recall on WAKE: 0.950
[2024-01-06 19:28:23,700] {result_logger:112} INFO - F1-score on WAKE: 0.905
[2024-01-06 19:28:23,700] {result_logger:113} INFO - 
[2024-01-06 19:28:23,869] {result_logger:108} INFO - precision on NREM: 0.933
[2024-01-06 19:28:23,973] {result_logger:109} INFO - recall on NREM: 0.770
[2024-01-06 19:28:24,076] {result_logger:112} INFO - F1-score on NREM: 0.844
[2024-01-06 19:28:24,077] {result_logger:113} INFO - 
[2024-01-06 19:28:24,245] {result_logger:108} INFO - precision on REM: 0.672
[2024-01-06 19:28:24,346] {result_logger:109} INFO - recall on REM: 0.836
[2024-01-06 19:28:24,448] {result_logger:112} INFO - F1-score on REM: 0.745
[2024-01-06 19:28:24,448] {result_logger:113} INFO - 
[2024-01-06 19:28:24,466] {result_logger:116} INFO - average precision on sleep stages: 0.823
[2024-01-06 19:28:24,484] {result_logger:118} INFO - average recall on sleep stages: 0.852
[2024-01-06 19:28:24,502] {result_logger:120} INFO - average F1-score on sleep stages: 0.831
[2024-01-06 19:28:24,576] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.852
[2024-01-06 19:28:24,579] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.872
[2024-01-06 19:28:24,579] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 19:28:25,198] {result_logger:143} INFO - 
[[319869   9564   2620      2]
 [  3315 227465   8410      0]
 [   364   1278  37029      0]
 [  1911    246     31      0]]
[2024-01-06 19:28:25,822] {result_logger:150} INFO - 
[[ 96.33%   2.88%   0.79%   0.00%]
 [  1.39%  95.10%   3.52%   0.00%]
 [  0.94%   3.30%  95.75%   0.00%]
 [ 87.34%  11.24%   1.42%   0.00%]]
[2024-01-06 19:28:26,439] {result_logger:154} INFO - 
[[ 98.28%   4.01%   5.45% 100.00%]
 [  1.02%  95.35%  17.49%   0.00%]
 [  0.11%   0.54%  77.00%   0.00%]
 [  0.59%   0.10%   0.06%   0.00%]]
[2024-01-06 19:28:26,439] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 19:28:26,520] {result_logger:143} INFO - 
[[45926  1707   686     0]
 [ 6569 27040  1496     0]
 [  647   228  4466     0]
 [  647   135    52     0]]
[2024-01-06 19:28:26,771] {result_logger:150} INFO - 
[[ 95.05%   3.53%   1.42%   0.00%]
 [ 18.71%  77.03%   4.26%   0.00%]
 [ 12.11%   4.27%  83.62%   0.00%]
 [ 77.58%  16.19%   6.24%   0.00%]]
[2024-01-06 19:28:26,988] {result_logger:154} INFO - 
[[ 85.38%   5.86%  10.24%    nan%]
 [ 12.21%  92.89%  22.33%    nan%]
 [  1.20%   0.78%  66.66%    nan%]
 [  1.20%   0.46%   0.78%    nan%]]
[2024-01-06 19:28:27,461] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 19:28:27,461] {result_logger:77} INFO - actual:
[2024-01-06 19:28:27,461] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 19:28:27,461] {result_logger:79} INFO - predicted:
[2024-01-06 19:28:27,461] {result_logger:80} INFO - 
[[95.95%  3.13%  0.92%  0.00%]
 [ 5.04% 92.63%  2.33%  0.00%]
 [10.61%  6.90% 82.49%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 19:28:27,523] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it2/model_8conv_2fc-best.pth
[2024-01-06 19:28:27,523] {run_experiment:113} INFO - [epoch  27] execution time: 226.26s	 avg f1-score: 0.8314

[2024-01-06 19:28:27,523] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 19:28:27,580] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 19:29:07,784] {train_model:86} INFO - Train Epoch: 28 [60928/612104 (10%)]	lr:5.71e-05	Loss: 0.051507
[2024-01-06 19:29:20,716] {train_model:86} INFO - Train Epoch: 28 [122112/612104 (20%)]	lr:5.71e-05	Loss: 0.324346
[2024-01-06 19:29:33,064] {train_model:86} INFO - Train Epoch: 28 [183296/612104 (30%)]	lr:5.71e-05	Loss: 0.064260
[2024-01-06 19:29:45,605] {train_model:86} INFO - Train Epoch: 28 [244480/612104 (40%)]	lr:5.71e-05	Loss: 0.127398
[2024-01-06 19:30:04,703] {train_model:86} INFO - Train Epoch: 28 [305664/612104 (50%)]	lr:5.71e-05	Loss: 0.062584
[2024-01-06 19:30:33,628] {train_model:86} INFO - Train Epoch: 28 [366848/612104 (60%)]	lr:5.71e-05	Loss: 0.152111
[2024-01-06 19:30:53,022] {train_model:86} INFO - Train Epoch: 28 [428032/612104 (70%)]	lr:5.71e-05	Loss: 0.092211
[2024-01-06 19:31:06,426] {train_model:86} INFO - Train Epoch: 28 [489216/612104 (80%)]	lr:5.71e-05	Loss: 0.051827
[2024-01-06 19:31:18,801] {train_model:86} INFO - Train Epoch: 28 [550400/612104 (90%)]	lr:5.71e-05	Loss: 0.094480
[2024-01-06 19:31:46,660] {train_model:86} INFO - Train Epoch: 28 [611584/612104 (100%)]	lr:5.71e-05	Loss: 0.070693
[2024-01-06 19:32:00,527] {run_experiment:78} INFO - 
[2024-01-06 19:32:00,533] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 19:32:01,866] {result_logger:108} INFO - precision on WAKE: 0.988
[2024-01-06 19:32:02,750] {result_logger:109} INFO - recall on WAKE: 0.963
[2024-01-06 19:32:03,643] {result_logger:112} INFO - F1-score on WAKE: 0.976
[2024-01-06 19:32:03,644] {result_logger:113} INFO - 
[2024-01-06 19:32:05,005] {result_logger:108} INFO - precision on NREM: 0.955
[2024-01-06 19:32:05,904] {result_logger:109} INFO - recall on NREM: 0.951
[2024-01-06 19:32:06,817] {result_logger:112} INFO - F1-score on NREM: 0.953
[2024-01-06 19:32:06,818] {result_logger:113} INFO - 
[2024-01-06 19:32:08,088] {result_logger:108} INFO - precision on REM: 0.772
[2024-01-06 19:32:08,888] {result_logger:109} INFO - recall on REM: 0.956
[2024-01-06 19:32:09,685] {result_logger:112} INFO - F1-score on REM: 0.854
[2024-01-06 19:32:09,685] {result_logger:113} INFO - 
[2024-01-06 19:32:09,898] {result_logger:116} INFO - average precision on sleep stages: 0.905
[2024-01-06 19:32:10,112] {result_logger:118} INFO - average recall on sleep stages: 0.957
[2024-01-06 19:32:10,329] {result_logger:120} INFO - average F1-score on sleep stages: 0.928
[2024-01-06 19:32:10,915] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.957
[2024-01-06 19:32:10,945] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.958
[2024-01-06 19:32:10,949] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 19:32:11,143] {result_logger:108} INFO - precision on WAKE: 0.900
[2024-01-06 19:32:11,258] {result_logger:109} INFO - recall on WAKE: 0.859
[2024-01-06 19:32:11,364] {result_logger:112} INFO - F1-score on WAKE: 0.879
[2024-01-06 19:32:11,364] {result_logger:113} INFO - 
[2024-01-06 19:32:11,543] {result_logger:108} INFO - precision on NREM: 0.899
[2024-01-06 19:32:11,652] {result_logger:109} INFO - recall on NREM: 0.837
[2024-01-06 19:32:11,765] {result_logger:112} INFO - F1-score on NREM: 0.867
[2024-01-06 19:32:11,765] {result_logger:113} INFO - 
[2024-01-06 19:32:11,946] {result_logger:108} INFO - precision on REM: 0.477
[2024-01-06 19:32:12,058] {result_logger:109} INFO - recall on REM: 0.894
[2024-01-06 19:32:12,169] {result_logger:112} INFO - F1-score on REM: 0.623
[2024-01-06 19:32:12,169] {result_logger:113} INFO - 
[2024-01-06 19:32:12,190] {result_logger:116} INFO - average precision on sleep stages: 0.759
[2024-01-06 19:32:12,209] {result_logger:118} INFO - average recall on sleep stages: 0.863
[2024-01-06 19:32:12,230] {result_logger:120} INFO - average F1-score on sleep stages: 0.789
[2024-01-06 19:32:12,308] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.863
[2024-01-06 19:32:12,311] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.852
[2024-01-06 19:32:12,312] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 19:32:12,957] {result_logger:143} INFO - 
[[319907   9559   2588      1]
 [  3325 227517   8348      0]
 [   409   1283  36979      0]
 [  1916    234     38      0]]
[2024-01-06 19:32:13,590] {result_logger:150} INFO - 
[[ 96.34%   2.88%   0.78%   0.00%]
 [  1.39%  95.12%   3.49%   0.00%]
 [  1.06%   3.32%  95.62%   0.00%]
 [ 87.57%  10.69%   1.74%   0.00%]]
[2024-01-06 19:32:14,225] {result_logger:154} INFO - 
[[ 98.26%   4.01%   5.40% 100.00%]
 [  1.02%  95.36%  17.41%   0.00%]
 [  0.13%   0.54%  77.12%   0.00%]
 [  0.59%   0.10%   0.08%   0.00%]]
[2024-01-06 19:32:14,225] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 19:32:14,308] {result_logger:143} INFO - 
[[41486  2990  3843     0]
 [ 4344 29377  1384     0]
 [  242   323  4776     0]
 [  318   294   222     0]]
[2024-01-06 19:32:14,521] {result_logger:150} INFO - 
[[ 85.86%   6.19%   7.95%   0.00%]
 [ 12.37%  83.68%   3.94%   0.00%]
 [  4.53%   6.05%  89.42%   0.00%]
 [ 38.13%  35.25%  26.62%   0.00%]]
[2024-01-06 19:32:14,727] {result_logger:154} INFO - 
[[ 89.43%   9.07%  37.58%    nan%]
 [  9.36%  89.06%  13.54%    nan%]
 [  0.52%   0.98%  46.71%    nan%]
 [  0.69%   0.89%   2.17%    nan%]]
[2024-01-06 19:32:15,178] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 19:32:15,178] {result_logger:77} INFO - actual:
[2024-01-06 19:32:15,179] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 19:32:15,179] {result_logger:79} INFO - predicted:
[2024-01-06 19:32:15,179] {result_logger:80} INFO - 
[[93.96%  3.73%  2.31%  0.00%]
 [ 4.51% 92.63%  2.85%  0.00%]
 [12.82%  6.86% 80.32%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 19:32:15,215] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it2/model_8conv_2fc-best.pth
[2024-01-06 19:32:15,215] {run_experiment:113} INFO - [epoch  28] execution time: 227.69s	 avg f1-score: 0.7894

[2024-01-06 19:32:15,215] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 19:32:15,271] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 19:32:42,980] {train_model:86} INFO - Train Epoch: 29 [60928/612104 (10%)]	lr:5.38e-05	Loss: 0.180718
[2024-01-06 19:32:56,630] {train_model:86} INFO - Train Epoch: 29 [122112/612104 (20%)]	lr:5.38e-05	Loss: 0.114944
[2024-01-06 19:33:09,572] {train_model:86} INFO - Train Epoch: 29 [183296/612104 (30%)]	lr:5.38e-05	Loss: 0.156691
[2024-01-06 19:33:23,150] {train_model:86} INFO - Train Epoch: 29 [244480/612104 (40%)]	lr:5.38e-05	Loss: 0.107980
[2024-01-06 19:33:50,534] {train_model:86} INFO - Train Epoch: 29 [305664/612104 (50%)]	lr:5.38e-05	Loss: 0.102045
[2024-01-06 19:34:16,427] {train_model:86} INFO - Train Epoch: 29 [366848/612104 (60%)]	lr:5.38e-05	Loss: 0.050916
[2024-01-06 19:34:28,479] {train_model:86} INFO - Train Epoch: 29 [428032/612104 (70%)]	lr:5.38e-05	Loss: 0.138137
[2024-01-06 19:34:40,262] {train_model:86} INFO - Train Epoch: 29 [489216/612104 (80%)]	lr:5.38e-05	Loss: 0.064848
[2024-01-06 19:35:08,246] {train_model:86} INFO - Train Epoch: 29 [550400/612104 (90%)]	lr:5.38e-05	Loss: 0.145534
[2024-01-06 19:35:34,894] {train_model:86} INFO - Train Epoch: 29 [611584/612104 (100%)]	lr:5.38e-05	Loss: 0.145670
[2024-01-06 19:35:48,497] {run_experiment:78} INFO - 
[2024-01-06 19:35:48,503] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 19:35:49,883] {result_logger:108} INFO - precision on WAKE: 0.989
[2024-01-06 19:35:50,769] {result_logger:109} INFO - recall on WAKE: 0.963
[2024-01-06 19:35:51,671] {result_logger:112} INFO - F1-score on WAKE: 0.976
[2024-01-06 19:35:51,671] {result_logger:113} INFO - 
[2024-01-06 19:35:53,074] {result_logger:108} INFO - precision on NREM: 0.954
[2024-01-06 19:35:53,964] {result_logger:109} INFO - recall on NREM: 0.953
[2024-01-06 19:35:54,857] {result_logger:112} INFO - F1-score on NREM: 0.954
[2024-01-06 19:35:54,857] {result_logger:113} INFO - 
[2024-01-06 19:35:56,123] {result_logger:108} INFO - precision on REM: 0.774
[2024-01-06 19:35:56,897] {result_logger:109} INFO - recall on REM: 0.959
[2024-01-06 19:35:57,658] {result_logger:112} INFO - F1-score on REM: 0.857
[2024-01-06 19:35:57,658] {result_logger:113} INFO - 
[2024-01-06 19:35:57,861] {result_logger:116} INFO - average precision on sleep stages: 0.906
[2024-01-06 19:35:58,065] {result_logger:118} INFO - average recall on sleep stages: 0.958
[2024-01-06 19:35:58,271] {result_logger:120} INFO - average F1-score on sleep stages: 0.929
[2024-01-06 19:35:58,823] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.958
[2024-01-06 19:35:58,852] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.959
[2024-01-06 19:35:58,856] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 19:35:59,025] {result_logger:108} INFO - precision on WAKE: 0.863
[2024-01-06 19:35:59,133] {result_logger:109} INFO - recall on WAKE: 0.887
[2024-01-06 19:35:59,241] {result_logger:112} INFO - F1-score on WAKE: 0.874
[2024-01-06 19:35:59,241] {result_logger:113} INFO - 
[2024-01-06 19:35:59,412] {result_logger:108} INFO - precision on NREM: 0.930
[2024-01-06 19:35:59,516] {result_logger:109} INFO - recall on NREM: 0.752
[2024-01-06 19:35:59,618] {result_logger:112} INFO - F1-score on NREM: 0.832
[2024-01-06 19:35:59,618] {result_logger:113} INFO - 
[2024-01-06 19:35:59,787] {result_logger:108} INFO - precision on REM: 0.429
[2024-01-06 19:35:59,892] {result_logger:109} INFO - recall on REM: 0.860
[2024-01-06 19:35:59,998] {result_logger:112} INFO - F1-score on REM: 0.572
[2024-01-06 19:35:59,999] {result_logger:113} INFO - 
[2024-01-06 19:36:00,018] {result_logger:116} INFO - average precision on sleep stages: 0.741
[2024-01-06 19:36:00,038] {result_logger:118} INFO - average recall on sleep stages: 0.833
[2024-01-06 19:36:00,058] {result_logger:120} INFO - average F1-score on sleep stages: 0.760
[2024-01-06 19:36:00,131] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.833
[2024-01-06 19:36:00,134] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.832
[2024-01-06 19:36:00,135] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 19:36:00,756] {result_logger:143} INFO - 
[[319711   9666   2675      3]
 [  3124 227945   8120      1]
 [   345   1251  37075      0]
 [  1917    229     42      0]]
[2024-01-06 19:36:01,355] {result_logger:150} INFO - 
[[ 96.28%   2.91%   0.81%   0.00%]
 [  1.31%  95.30%   3.39%   0.00%]
 [  0.89%   3.23%  95.87%   0.00%]
 [ 87.61%  10.47%   1.92%   0.00%]]
[2024-01-06 19:36:01,963] {result_logger:154} INFO - 
[[ 98.34%   4.04%   5.58%  75.00%]
 [  0.96%  95.34%  16.95%  25.00%]
 [  0.11%   0.52%  77.38%   0.00%]
 [  0.59%   0.10%   0.09%   0.00%]]
[2024-01-06 19:36:01,963] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 19:36:02,043] {result_logger:143} INFO - 
[[42842  1626  3851     0]
 [ 6429 26413  2263     0]
 [  397   350  4594     0]
 [  436    98   300     0]]
[2024-01-06 19:36:02,254] {result_logger:150} INFO - 
[[ 88.66%   3.37%   7.97%   0.00%]
 [ 18.31%  75.24%   6.45%   0.00%]
 [  7.43%   6.55%  86.01%   0.00%]
 [ 52.28%  11.75%  35.97%   0.00%]]
[2024-01-06 19:36:02,460] {result_logger:154} INFO - 
[[ 85.51%   5.71%  34.98%    nan%]
 [ 12.83%  92.72%  20.56%    nan%]
 [  0.79%   1.23%  41.73%    nan%]
 [  0.87%   0.34%   2.73%    nan%]]
[2024-01-06 19:36:02,895] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 19:36:02,895] {result_logger:77} INFO - actual:
[2024-01-06 19:36:02,896] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 19:36:02,896] {result_logger:79} INFO - predicted:
[2024-01-06 19:36:02,896] {result_logger:80} INFO - 
[[94.75%  2.74%  2.51%  0.00%]
 [ 4.19% 92.56%  3.25%  0.00%]
 [13.05%  6.80% 80.16%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 19:36:02,932] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it2/model_8conv_2fc-best.pth
[2024-01-06 19:36:02,932] {run_experiment:113} INFO - [epoch  29] execution time: 227.72s	 avg f1-score: 0.7596

[2024-01-06 19:36:02,932] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 19:36:02,988] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 19:36:29,958] {train_model:86} INFO - Train Epoch: 30 [60928/612104 (10%)]	lr:5.07e-05	Loss: 0.178043
[2024-01-06 19:36:41,766] {train_model:86} INFO - Train Epoch: 30 [122112/612104 (20%)]	lr:5.07e-05	Loss: 0.093087
[2024-01-06 19:36:54,433] {train_model:86} INFO - Train Epoch: 30 [183296/612104 (30%)]	lr:5.07e-05	Loss: 0.098422
[2024-01-06 19:37:21,401] {train_model:86} INFO - Train Epoch: 30 [244480/612104 (40%)]	lr:5.07e-05	Loss: 0.222709
[2024-01-06 19:37:48,821] {train_model:86} INFO - Train Epoch: 30 [305664/612104 (50%)]	lr:5.07e-05	Loss: 0.142427
[2024-01-06 19:38:01,677] {train_model:86} INFO - Train Epoch: 30 [366848/612104 (60%)]	lr:5.07e-05	Loss: 0.090377
[2024-01-06 19:38:13,714] {train_model:86} INFO - Train Epoch: 30 [428032/612104 (70%)]	lr:5.07e-05	Loss: 0.121958
[2024-01-06 19:38:41,572] {train_model:86} INFO - Train Epoch: 30 [489216/612104 (80%)]	lr:5.07e-05	Loss: 0.067488
[2024-01-06 19:39:07,820] {train_model:86} INFO - Train Epoch: 30 [550400/612104 (90%)]	lr:5.07e-05	Loss: 0.166892
[2024-01-06 19:39:20,150] {train_model:86} INFO - Train Epoch: 30 [611584/612104 (100%)]	lr:5.07e-05	Loss: 0.081855
[2024-01-06 19:39:33,590] {run_experiment:78} INFO - 
[2024-01-06 19:39:33,596] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 19:39:34,965] {result_logger:108} INFO - precision on WAKE: 0.989
[2024-01-06 19:39:35,871] {result_logger:109} INFO - recall on WAKE: 0.963
[2024-01-06 19:39:36,766] {result_logger:112} INFO - F1-score on WAKE: 0.976
[2024-01-06 19:39:36,766] {result_logger:113} INFO - 
[2024-01-06 19:39:38,128] {result_logger:108} INFO - precision on NREM: 0.955
[2024-01-06 19:39:39,046] {result_logger:109} INFO - recall on NREM: 0.953
[2024-01-06 19:39:39,950] {result_logger:112} INFO - F1-score on NREM: 0.954
[2024-01-06 19:39:39,951] {result_logger:113} INFO - 
[2024-01-06 19:39:41,203] {result_logger:108} INFO - precision on REM: 0.777
[2024-01-06 19:39:41,991] {result_logger:109} INFO - recall on REM: 0.960
[2024-01-06 19:39:42,773] {result_logger:112} INFO - F1-score on REM: 0.859
[2024-01-06 19:39:42,773] {result_logger:113} INFO - 
[2024-01-06 19:39:42,979] {result_logger:116} INFO - average precision on sleep stages: 0.907
[2024-01-06 19:39:43,180] {result_logger:118} INFO - average recall on sleep stages: 0.959
[2024-01-06 19:39:43,380] {result_logger:120} INFO - average F1-score on sleep stages: 0.930
[2024-01-06 19:39:43,951] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.959
[2024-01-06 19:39:43,980] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.959
[2024-01-06 19:39:43,984] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 19:39:44,159] {result_logger:108} INFO - precision on WAKE: 0.878
[2024-01-06 19:39:44,266] {result_logger:109} INFO - recall on WAKE: 0.849
[2024-01-06 19:39:44,379] {result_logger:112} INFO - F1-score on WAKE: 0.863
[2024-01-06 19:39:44,379] {result_logger:113} INFO - 
[2024-01-06 19:39:44,563] {result_logger:108} INFO - precision on NREM: 0.935
[2024-01-06 19:39:44,669] {result_logger:109} INFO - recall on NREM: 0.781
[2024-01-06 19:39:44,778] {result_logger:112} INFO - F1-score on NREM: 0.851
[2024-01-06 19:39:44,778] {result_logger:113} INFO - 
[2024-01-06 19:39:44,956] {result_logger:108} INFO - precision on REM: 0.376
[2024-01-06 19:39:45,066] {result_logger:109} INFO - recall on REM: 0.895
[2024-01-06 19:39:45,175] {result_logger:112} INFO - F1-score on REM: 0.529
[2024-01-06 19:39:45,175] {result_logger:113} INFO - 
[2024-01-06 19:39:45,195] {result_logger:116} INFO - average precision on sleep stages: 0.729
[2024-01-06 19:39:45,216] {result_logger:118} INFO - average recall on sleep stages: 0.842
[2024-01-06 19:39:45,236] {result_logger:120} INFO - average F1-score on sleep stages: 0.748
[2024-01-06 19:39:45,316] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.842
[2024-01-06 19:39:45,320] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.825
[2024-01-06 19:39:45,320] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 19:39:45,959] {result_logger:143} INFO - 
[[319896   9585   2573      1]
 [  3146 227994   8050      0]
 [   343   1209  37119      0]
 [  1920    235     33      0]]
[2024-01-06 19:39:46,604] {result_logger:150} INFO - 
[[ 96.34%   2.89%   0.77%   0.00%]
 [  1.32%  95.32%   3.37%   0.00%]
 [  0.89%   3.13%  95.99%   0.00%]
 [ 87.75%  10.74%   1.51%   0.00%]]
[2024-01-06 19:39:47,233] {result_logger:154} INFO - 
[[ 98.34%   4.01%   5.39% 100.00%]
 [  0.97%  95.39%  16.85%   0.00%]
 [  0.11%   0.51%  77.70%   0.00%]
 [  0.59%   0.10%   0.07%   0.00%]]
[2024-01-06 19:39:47,233] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 19:39:47,320] {result_logger:143} INFO - 
[[41013  1703  5603     0]
 [ 5340 27420  2345     0]
 [  355   207  4779     0]
 [  325   101   408     0]]
[2024-01-06 19:39:47,532] {result_logger:150} INFO - 
[[ 84.88%   3.52%  11.60%   0.00%]
 [ 15.21%  78.11%   6.68%   0.00%]
 [  6.65%   3.88%  89.48%   0.00%]
 [ 38.97%  12.11%  48.92%   0.00%]]
[2024-01-06 19:39:47,746] {result_logger:154} INFO - 
[[ 87.20%   5.79%  42.66%    nan%]
 [ 11.35%  93.17%  17.85%    nan%]
 [  0.75%   0.70%  36.38%    nan%]
 [  0.69%   0.34%   3.11%    nan%]]
[2024-01-06 19:39:48,197] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 19:39:48,197] {result_logger:77} INFO - actual:
[2024-01-06 19:39:48,197] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 19:39:48,197] {result_logger:79} INFO - predicted:
[2024-01-06 19:39:48,198] {result_logger:80} INFO - 
[[93.98%  2.94%  3.09%  0.00%]
 [ 4.04% 92.63%  3.33%  0.00%]
 [12.49%  6.01% 81.49%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 19:39:48,234] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it2/model_8conv_2fc-best.pth
[2024-01-06 19:39:48,234] {run_experiment:113} INFO - [epoch  30] execution time: 225.30s	 avg f1-score: 0.7478

[2024-01-06 19:39:48,234] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 19:39:48,293] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 19:40:14,718] {train_model:86} INFO - Train Epoch: 31 [60928/612104 (10%)]	lr:4.77e-05	Loss: 0.062213
[2024-01-06 19:40:26,898] {train_model:86} INFO - Train Epoch: 31 [122112/612104 (20%)]	lr:4.77e-05	Loss: 0.062902
[2024-01-06 19:40:39,166] {train_model:86} INFO - Train Epoch: 31 [183296/612104 (30%)]	lr:4.77e-05	Loss: 0.113885
[2024-01-06 19:41:06,637] {train_model:86} INFO - Train Epoch: 31 [244480/612104 (40%)]	lr:4.77e-05	Loss: 0.148243
[2024-01-06 19:41:32,746] {train_model:86} INFO - Train Epoch: 31 [305664/612104 (50%)]	lr:4.77e-05	Loss: 0.110306
[2024-01-06 19:41:45,397] {train_model:86} INFO - Train Epoch: 31 [366848/612104 (60%)]	lr:4.77e-05	Loss: 0.075390
[2024-01-06 19:42:14,004] {train_model:86} INFO - Train Epoch: 31 [428032/612104 (70%)]	lr:4.77e-05	Loss: 0.093091
[2024-01-06 19:42:39,920] {train_model:86} INFO - Train Epoch: 31 [489216/612104 (80%)]	lr:4.77e-05	Loss: 0.098468
[2024-01-06 19:42:53,075] {train_model:86} INFO - Train Epoch: 31 [550400/612104 (90%)]	lr:4.77e-05	Loss: 0.120727
[2024-01-06 19:43:06,099] {train_model:86} INFO - Train Epoch: 31 [611584/612104 (100%)]	lr:4.77e-05	Loss: 0.063669
[2024-01-06 19:43:19,864] {run_experiment:78} INFO - 
[2024-01-06 19:43:19,871] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 19:43:21,277] {result_logger:108} INFO - precision on WAKE: 0.989
[2024-01-06 19:43:22,181] {result_logger:109} INFO - recall on WAKE: 0.963
[2024-01-06 19:43:23,091] {result_logger:112} INFO - F1-score on WAKE: 0.976
[2024-01-06 19:43:23,091] {result_logger:113} INFO - 
[2024-01-06 19:43:24,516] {result_logger:108} INFO - precision on NREM: 0.954
[2024-01-06 19:43:25,421] {result_logger:109} INFO - recall on NREM: 0.953
[2024-01-06 19:43:26,318] {result_logger:112} INFO - F1-score on NREM: 0.954
[2024-01-06 19:43:26,318] {result_logger:113} INFO - 
[2024-01-06 19:43:27,612] {result_logger:108} INFO - precision on REM: 0.778
[2024-01-06 19:43:28,400] {result_logger:109} INFO - recall on REM: 0.959
[2024-01-06 19:43:29,183] {result_logger:112} INFO - F1-score on REM: 0.859
[2024-01-06 19:43:29,183] {result_logger:113} INFO - 
[2024-01-06 19:43:29,387] {result_logger:116} INFO - average precision on sleep stages: 0.907
[2024-01-06 19:43:29,593] {result_logger:118} INFO - average recall on sleep stages: 0.959
[2024-01-06 19:43:29,796] {result_logger:120} INFO - average F1-score on sleep stages: 0.930
[2024-01-06 19:43:30,371] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.959
[2024-01-06 19:43:30,400] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.959
[2024-01-06 19:43:30,403] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 19:43:30,579] {result_logger:108} INFO - precision on WAKE: 0.911
[2024-01-06 19:43:30,690] {result_logger:109} INFO - recall on WAKE: 0.758
[2024-01-06 19:43:30,801] {result_logger:112} INFO - F1-score on WAKE: 0.827
[2024-01-06 19:43:30,801] {result_logger:113} INFO - 
[2024-01-06 19:43:30,990] {result_logger:108} INFO - precision on NREM: 0.915
[2024-01-06 19:43:31,097] {result_logger:109} INFO - recall on NREM: 0.850
[2024-01-06 19:43:31,200] {result_logger:112} INFO - F1-score on NREM: 0.881
[2024-01-06 19:43:31,201] {result_logger:113} INFO - 
[2024-01-06 19:43:31,381] {result_logger:108} INFO - precision on REM: 0.297
[2024-01-06 19:43:31,491] {result_logger:109} INFO - recall on REM: 0.886
[2024-01-06 19:43:31,597] {result_logger:112} INFO - F1-score on REM: 0.445
[2024-01-06 19:43:31,598] {result_logger:113} INFO - 
[2024-01-06 19:43:31,617] {result_logger:116} INFO - average precision on sleep stages: 0.708
[2024-01-06 19:43:31,637] {result_logger:118} INFO - average recall on sleep stages: 0.831
[2024-01-06 19:43:31,657] {result_logger:120} INFO - average F1-score on sleep stages: 0.718
[2024-01-06 19:43:31,734] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.831
[2024-01-06 19:43:31,738] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.802
[2024-01-06 19:43:31,738] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 19:43:32,350] {result_logger:143} INFO - 
[[319868   9674   2510      3]
 [  3129 228006   8054      1]
 [   369   1205  37097      0]
 [  1917    233     38      0]]
[2024-01-06 19:43:32,975] {result_logger:150} INFO - 
[[ 96.33%   2.91%   0.76%   0.00%]
 [  1.31%  95.32%   3.37%   0.00%]
 [  0.95%   3.12%  95.93%   0.00%]
 [ 87.61%  10.65%   1.74%   0.00%]]
[2024-01-06 19:43:33,596] {result_logger:154} INFO - 
[[ 98.34%   4.05%   5.26%  75.00%]
 [  0.96%  95.35%  16.89%  25.00%]
 [  0.11%   0.50%  77.77%   0.00%]
 [  0.59%   0.10%   0.08%   0.00%]]
[2024-01-06 19:43:33,596] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 19:43:33,682] {result_logger:143} INFO - 
[[36620  2415  9284     0]
 [ 3324 29853  1928     0]
 [  246   362  4733     0]
 [  169   147   518     0]]
[2024-01-06 19:43:33,894] {result_logger:150} INFO - 
[[ 75.79%   5.00%  19.21%   0.00%]
 [  9.47%  85.04%   5.49%   0.00%]
 [  4.61%   6.78%  88.62%   0.00%]
 [ 20.26%  17.63%  62.11%   0.00%]]
[2024-01-06 19:43:34,100] {result_logger:154} INFO - 
[[ 90.74%   7.37%  56.39%    nan%]
 [  8.24%  91.08%  11.71%    nan%]
 [  0.61%   1.10%  28.75%    nan%]
 [  0.42%   0.45%   3.15%    nan%]]
[2024-01-06 19:43:34,652] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 19:43:34,652] {result_logger:77} INFO - actual:
[2024-01-06 19:43:34,652] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 19:43:34,652] {result_logger:79} INFO - predicted:
[2024-01-06 19:43:34,652] {result_logger:80} INFO - 
[[93.49%  3.32%  3.19%  0.00%]
 [ 3.60% 93.32%  3.08%  0.00%]
 [ 8.78%  5.18% 86.04%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 19:43:34,688] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it2/model_8conv_2fc-best.pth
[2024-01-06 19:43:34,689] {run_experiment:113} INFO - [epoch  31] execution time: 226.45s	 avg f1-score: 0.7179

[2024-01-06 19:43:34,689] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 19:43:34,749] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 19:44:01,543] {train_model:86} INFO - Train Epoch: 32 [60928/612104 (10%)]	lr:4.49e-05	Loss: 0.082691
[2024-01-06 19:44:15,217] {train_model:86} INFO - Train Epoch: 32 [122112/612104 (20%)]	lr:4.49e-05	Loss: 0.142187
[2024-01-06 19:44:42,621] {train_model:86} INFO - Train Epoch: 32 [183296/612104 (30%)]	lr:4.49e-05	Loss: 0.103336
[2024-01-06 19:45:08,910] {train_model:86} INFO - Train Epoch: 32 [244480/612104 (40%)]	lr:4.49e-05	Loss: 0.090079
[2024-01-06 19:45:21,074] {train_model:86} INFO - Train Epoch: 32 [305664/612104 (50%)]	lr:4.49e-05	Loss: 0.081019
[2024-01-06 19:45:48,945] {train_model:86} INFO - Train Epoch: 32 [366848/612104 (60%)]	lr:4.49e-05	Loss: 0.079972
[2024-01-06 19:46:14,880] {train_model:86} INFO - Train Epoch: 32 [428032/612104 (70%)]	lr:4.49e-05	Loss: 0.173431
[2024-01-06 19:46:27,829] {train_model:86} INFO - Train Epoch: 32 [489216/612104 (80%)]	lr:4.49e-05	Loss: 0.082494
[2024-01-06 19:46:40,154] {train_model:86} INFO - Train Epoch: 32 [550400/612104 (90%)]	lr:4.49e-05	Loss: 0.042849
[2024-01-06 19:46:52,800] {train_model:86} INFO - Train Epoch: 32 [611584/612104 (100%)]	lr:4.49e-05	Loss: 0.097144
[2024-01-06 19:47:06,262] {run_experiment:78} INFO - 
[2024-01-06 19:47:06,268] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 19:47:07,564] {result_logger:108} INFO - precision on WAKE: 0.989
[2024-01-06 19:47:08,422] {result_logger:109} INFO - recall on WAKE: 0.964
[2024-01-06 19:47:09,302] {result_logger:112} INFO - F1-score on WAKE: 0.976
[2024-01-06 19:47:09,302] {result_logger:113} INFO - 
[2024-01-06 19:47:10,640] {result_logger:108} INFO - precision on NREM: 0.955
[2024-01-06 19:47:11,542] {result_logger:109} INFO - recall on NREM: 0.954
[2024-01-06 19:47:12,450] {result_logger:112} INFO - F1-score on NREM: 0.954
[2024-01-06 19:47:12,450] {result_logger:113} INFO - 
[2024-01-06 19:47:13,701] {result_logger:108} INFO - precision on REM: 0.782
[2024-01-06 19:47:14,500] {result_logger:109} INFO - recall on REM: 0.959
[2024-01-06 19:47:15,297] {result_logger:112} INFO - F1-score on REM: 0.861
[2024-01-06 19:47:15,297] {result_logger:113} INFO - 
[2024-01-06 19:47:15,520] {result_logger:116} INFO - average precision on sleep stages: 0.909
[2024-01-06 19:47:15,732] {result_logger:118} INFO - average recall on sleep stages: 0.959
[2024-01-06 19:47:15,936] {result_logger:120} INFO - average F1-score on sleep stages: 0.931
[2024-01-06 19:47:16,514] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.959
[2024-01-06 19:47:16,544] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.960
[2024-01-06 19:47:16,548] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 19:47:16,729] {result_logger:108} INFO - precision on WAKE: 0.929
[2024-01-06 19:47:16,838] {result_logger:109} INFO - recall on WAKE: 0.919
[2024-01-06 19:47:16,944] {result_logger:112} INFO - F1-score on WAKE: 0.924
[2024-01-06 19:47:16,944] {result_logger:113} INFO - 
[2024-01-06 19:47:17,121] {result_logger:108} INFO - precision on NREM: 0.913
[2024-01-06 19:47:17,226] {result_logger:109} INFO - recall on NREM: 0.856
[2024-01-06 19:47:17,334] {result_logger:112} INFO - F1-score on NREM: 0.884
[2024-01-06 19:47:17,334] {result_logger:113} INFO - 
[2024-01-06 19:47:17,514] {result_logger:108} INFO - precision on REM: 0.613
[2024-01-06 19:47:17,619] {result_logger:109} INFO - recall on REM: 0.923
[2024-01-06 19:47:17,727] {result_logger:112} INFO - F1-score on REM: 0.736
[2024-01-06 19:47:17,728] {result_logger:113} INFO - 
[2024-01-06 19:47:17,747] {result_logger:116} INFO - average precision on sleep stages: 0.818
[2024-01-06 19:47:17,767] {result_logger:118} INFO - average recall on sleep stages: 0.899
[2024-01-06 19:47:17,785] {result_logger:120} INFO - average F1-score on sleep stages: 0.848
[2024-01-06 19:47:17,865] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.899
[2024-01-06 19:47:17,868] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.894
[2024-01-06 19:47:17,869] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 19:47:18,510] {result_logger:143} INFO - 
[[320010   9561   2483      1]
 [  3102 228238   7849      1]
 [   331   1270  37070      0]
 [  1922    232     34      0]]
[2024-01-06 19:47:19,149] {result_logger:150} INFO - 
[[ 96.37%   2.88%   0.75%   0.00%]
 [  1.30%  95.42%   3.28%   0.00%]
 [  0.86%   3.28%  95.86%   0.00%]
 [ 87.84%  10.60%   1.55%   0.00%]]
[2024-01-06 19:47:19,790] {result_logger:154} INFO - 
[[ 98.35%   4.00%   5.23%  50.00%]
 [  0.95%  95.38%  16.55%  50.00%]
 [  0.10%   0.53%  78.15%   0.00%]
 [  0.59%   0.10%   0.07%   0.00%]]
[2024-01-06 19:47:19,790] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 19:47:19,876] {result_logger:143} INFO - 
[[44402  2612  1305     0]
 [ 3245 30051  1809     0]
 [  166   247  4928     0]
 [  494   248    92     0]]
[2024-01-06 19:47:20,086] {result_logger:150} INFO - 
[[ 91.89%   5.41%   2.70%   0.00%]
 [  9.24%  85.60%   5.15%   0.00%]
 [  3.11%   4.62%  92.27%   0.00%]
 [ 59.23%  29.74%  11.03%   0.00%]]
[2024-01-06 19:47:20,293] {result_logger:154} INFO - 
[[ 91.92%   7.88%  16.04%    nan%]
 [  6.72%  90.63%  22.24%    nan%]
 [  0.34%   0.74%  60.59%    nan%]
 [  1.02%   0.75%   1.13%    nan%]]
[2024-01-06 19:47:20,740] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 19:47:20,740] {result_logger:77} INFO - actual:
[2024-01-06 19:47:20,740] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 19:47:20,740] {result_logger:79} INFO - predicted:
[2024-01-06 19:47:20,741] {result_logger:80} INFO - 
[[94.95%  3.76%  1.29%  0.00%]
 [ 4.65% 92.78%  2.56%  0.00%]
 [10.99%  7.12% 81.89%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 19:47:20,777] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it2/model_8conv_2fc-best.pth
[2024-01-06 19:47:20,777] {run_experiment:113} INFO - [epoch  32] execution time: 226.09s	 avg f1-score: 0.8480

[2024-01-06 19:47:20,778] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 19:47:20,835] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 19:47:47,467] {train_model:86} INFO - Train Epoch: 33 [60928/612104 (10%)]	lr:4.23e-05	Loss: 0.085162
[2024-01-06 19:47:59,647] {train_model:86} INFO - Train Epoch: 33 [122112/612104 (20%)]	lr:4.23e-05	Loss: 0.091050
[2024-01-06 19:48:27,162] {train_model:86} INFO - Train Epoch: 33 [183296/612104 (30%)]	lr:4.23e-05	Loss: 0.106028
[2024-01-06 19:48:53,172] {train_model:86} INFO - Train Epoch: 33 [244480/612104 (40%)]	lr:4.23e-05	Loss: 0.205013
[2024-01-06 19:49:21,728] {train_model:86} INFO - Train Epoch: 33 [305664/612104 (50%)]	lr:4.23e-05	Loss: 0.159979
[2024-01-06 19:49:47,772] {train_model:86} INFO - Train Epoch: 33 [366848/612104 (60%)]	lr:4.23e-05	Loss: 0.122763
[2024-01-06 19:49:59,933] {train_model:86} INFO - Train Epoch: 33 [428032/612104 (70%)]	lr:4.23e-05	Loss: 0.198659
[2024-01-06 19:50:12,057] {train_model:86} INFO - Train Epoch: 33 [489216/612104 (80%)]	lr:4.23e-05	Loss: 0.051144
[2024-01-06 19:50:25,198] {train_model:86} INFO - Train Epoch: 33 [550400/612104 (90%)]	lr:4.23e-05	Loss: 0.143140
[2024-01-06 19:50:37,451] {train_model:86} INFO - Train Epoch: 33 [611584/612104 (100%)]	lr:4.23e-05	Loss: 0.079338
[2024-01-06 19:50:51,317] {run_experiment:78} INFO - 
[2024-01-06 19:50:51,324] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 19:50:52,655] {result_logger:108} INFO - precision on WAKE: 0.989
[2024-01-06 19:50:53,546] {result_logger:109} INFO - recall on WAKE: 0.964
[2024-01-06 19:50:54,443] {result_logger:112} INFO - F1-score on WAKE: 0.976
[2024-01-06 19:50:54,443] {result_logger:113} INFO - 
[2024-01-06 19:50:55,801] {result_logger:108} INFO - precision on NREM: 0.955
[2024-01-06 19:50:56,707] {result_logger:109} INFO - recall on NREM: 0.953
[2024-01-06 19:50:57,612] {result_logger:112} INFO - F1-score on NREM: 0.954
[2024-01-06 19:50:57,612] {result_logger:113} INFO - 
[2024-01-06 19:50:58,849] {result_logger:108} INFO - precision on REM: 0.778
[2024-01-06 19:50:59,636] {result_logger:109} INFO - recall on REM: 0.960
[2024-01-06 19:51:00,425] {result_logger:112} INFO - F1-score on REM: 0.859
[2024-01-06 19:51:00,425] {result_logger:113} INFO - 
[2024-01-06 19:51:00,632] {result_logger:116} INFO - average precision on sleep stages: 0.907
[2024-01-06 19:51:00,834] {result_logger:118} INFO - average recall on sleep stages: 0.959
[2024-01-06 19:51:01,039] {result_logger:120} INFO - average F1-score on sleep stages: 0.930
[2024-01-06 19:51:01,611] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.959
[2024-01-06 19:51:01,640] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.959
[2024-01-06 19:51:01,644] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 19:51:01,817] {result_logger:108} INFO - precision on WAKE: 0.830
[2024-01-06 19:51:01,923] {result_logger:109} INFO - recall on WAKE: 0.972
[2024-01-06 19:51:02,034] {result_logger:112} INFO - F1-score on WAKE: 0.895
[2024-01-06 19:51:02,034] {result_logger:113} INFO - 
[2024-01-06 19:51:02,208] {result_logger:108} INFO - precision on NREM: 0.937
[2024-01-06 19:51:02,320] {result_logger:109} INFO - recall on NREM: 0.709
[2024-01-06 19:51:02,432] {result_logger:112} INFO - F1-score on NREM: 0.807
[2024-01-06 19:51:02,432] {result_logger:113} INFO - 
[2024-01-06 19:51:02,612] {result_logger:108} INFO - precision on REM: 0.697
[2024-01-06 19:51:02,720] {result_logger:109} INFO - recall on REM: 0.731
[2024-01-06 19:51:02,827] {result_logger:112} INFO - F1-score on REM: 0.714
[2024-01-06 19:51:02,828] {result_logger:113} INFO - 
[2024-01-06 19:51:02,848] {result_logger:116} INFO - average precision on sleep stages: 0.822
[2024-01-06 19:51:02,868] {result_logger:118} INFO - average recall on sleep stages: 0.804
[2024-01-06 19:51:02,888] {result_logger:120} INFO - average F1-score on sleep stages: 0.805
[2024-01-06 19:51:02,965] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.804
[2024-01-06 19:51:02,968] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.854
[2024-01-06 19:51:02,969] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 19:51:03,599] {result_logger:143} INFO - 
[[319948   9553   2553      1]
 [  3143 227983   8064      0]
 [   328   1200  37143      0]
 [  1919    235     34      0]]
[2024-01-06 19:51:04,236] {result_logger:150} INFO - 
[[ 96.35%   2.88%   0.77%   0.00%]
 [  1.31%  95.31%   3.37%   0.00%]
 [  0.85%   3.10%  96.05%   0.00%]
 [ 87.71%  10.74%   1.55%   0.00%]]
[2024-01-06 19:51:04,875] {result_logger:154} INFO - 
[[ 98.34%   4.00%   5.34% 100.00%]
 [  0.97%  95.40%  16.87%   0.00%]
 [  0.10%   0.50%  77.71%   0.00%]
 [  0.59%   0.10%   0.07%   0.00%]]
[2024-01-06 19:51:04,875] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 19:51:04,960] {result_logger:143} INFO - 
[[46985  1244    90     0]
 [ 8619 24883  1603     0]
 [ 1019   419  3903     0]
 [  748    66    20     0]]
[2024-01-06 19:51:05,171] {result_logger:150} INFO - 
[[ 97.24%   2.57%   0.19%   0.00%]
 [ 24.55%  70.88%   4.57%   0.00%]
 [ 19.08%   7.84%  73.08%   0.00%]
 [ 89.69%   7.91%   2.40%   0.00%]]
[2024-01-06 19:51:05,382] {result_logger:154} INFO - 
[[ 81.90%   4.67%   1.60%    nan%]
 [ 15.02%  93.50%  28.54%    nan%]
 [  1.78%   1.57%  69.50%    nan%]
 [  1.30%   0.25%   0.36%    nan%]]
[2024-01-06 19:51:05,833] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 19:51:05,833] {result_logger:77} INFO - actual:
[2024-01-06 19:51:05,833] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 19:51:05,833] {result_logger:79} INFO - predicted:
[2024-01-06 19:51:05,833] {result_logger:80} INFO - 
[[96.83%  2.66%  0.51%  0.00%]
 [ 4.93% 92.70%  2.37%  0.00%]
 [ 9.01%  7.48% 83.51%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 19:51:05,870] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it2/model_8conv_2fc-best.pth
[2024-01-06 19:51:05,870] {run_experiment:113} INFO - [epoch  33] execution time: 225.09s	 avg f1-score: 0.8055

[2024-01-06 19:51:05,870] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 19:51:05,925] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 19:51:34,188] {train_model:86} INFO - Train Epoch: 34 [60928/612104 (10%)]	lr:3.99e-05	Loss: 0.061976
[2024-01-06 19:52:01,635] {train_model:86} INFO - Train Epoch: 34 [122112/612104 (20%)]	lr:3.99e-05	Loss: 0.158256
[2024-01-06 19:52:27,529] {train_model:86} INFO - Train Epoch: 34 [183296/612104 (30%)]	lr:3.99e-05	Loss: 0.109121
[2024-01-06 19:52:54,938] {train_model:86} INFO - Train Epoch: 34 [244480/612104 (40%)]	lr:3.99e-05	Loss: 0.060869
[2024-01-06 19:53:21,262] {train_model:86} INFO - Train Epoch: 34 [305664/612104 (50%)]	lr:3.99e-05	Loss: 0.092316
[2024-01-06 19:53:34,254] {train_model:86} INFO - Train Epoch: 34 [366848/612104 (60%)]	lr:3.99e-05	Loss: 0.068382
[2024-01-06 19:53:46,650] {train_model:86} INFO - Train Epoch: 34 [428032/612104 (70%)]	lr:3.99e-05	Loss: 0.088103
[2024-01-06 19:53:59,135] {train_model:86} INFO - Train Epoch: 34 [489216/612104 (80%)]	lr:3.99e-05	Loss: 0.242328
[2024-01-06 19:54:11,229] {train_model:86} INFO - Train Epoch: 34 [550400/612104 (90%)]	lr:3.99e-05	Loss: 0.083896
[2024-01-06 19:54:24,021] {train_model:86} INFO - Train Epoch: 34 [611584/612104 (100%)]	lr:3.99e-05	Loss: 0.150808
[2024-01-06 19:54:37,105] {run_experiment:78} INFO - 
[2024-01-06 19:54:37,111] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 19:54:38,483] {result_logger:108} INFO - precision on WAKE: 0.989
[2024-01-06 19:54:39,366] {result_logger:109} INFO - recall on WAKE: 0.964
[2024-01-06 19:54:40,238] {result_logger:112} INFO - F1-score on WAKE: 0.976
[2024-01-06 19:54:40,238] {result_logger:113} INFO - 
[2024-01-06 19:54:41,631] {result_logger:108} INFO - precision on NREM: 0.955
[2024-01-06 19:54:42,542] {result_logger:109} INFO - recall on NREM: 0.955
[2024-01-06 19:54:43,446] {result_logger:112} INFO - F1-score on NREM: 0.955
[2024-01-06 19:54:43,446] {result_logger:113} INFO - 
[2024-01-06 19:54:44,725] {result_logger:108} INFO - precision on REM: 0.787
[2024-01-06 19:54:45,507] {result_logger:109} INFO - recall on REM: 0.961
[2024-01-06 19:54:46,276] {result_logger:112} INFO - F1-score on REM: 0.865
[2024-01-06 19:54:46,277] {result_logger:113} INFO - 
[2024-01-06 19:54:46,480] {result_logger:116} INFO - average precision on sleep stages: 0.910
[2024-01-06 19:54:46,681] {result_logger:118} INFO - average recall on sleep stages: 0.960
[2024-01-06 19:54:46,891] {result_logger:120} INFO - average F1-score on sleep stages: 0.932
[2024-01-06 19:54:47,433] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.960
[2024-01-06 19:54:47,462] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.960
[2024-01-06 19:54:47,466] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 19:54:47,643] {result_logger:108} INFO - precision on WAKE: 0.893
[2024-01-06 19:54:47,752] {result_logger:109} INFO - recall on WAKE: 0.852
[2024-01-06 19:54:47,856] {result_logger:112} INFO - F1-score on WAKE: 0.872
[2024-01-06 19:54:47,857] {result_logger:113} INFO - 
[2024-01-06 19:54:48,031] {result_logger:108} INFO - precision on NREM: 0.920
[2024-01-06 19:54:48,139] {result_logger:109} INFO - recall on NREM: 0.810
[2024-01-06 19:54:48,245] {result_logger:112} INFO - F1-score on NREM: 0.861
[2024-01-06 19:54:48,246] {result_logger:113} INFO - 
[2024-01-06 19:54:48,427] {result_logger:108} INFO - precision on REM: 0.408
[2024-01-06 19:54:48,530] {result_logger:109} INFO - recall on REM: 0.901
[2024-01-06 19:54:48,636] {result_logger:112} INFO - F1-score on REM: 0.562
[2024-01-06 19:54:48,636] {result_logger:113} INFO - 
[2024-01-06 19:54:48,656] {result_logger:116} INFO - average precision on sleep stages: 0.741
[2024-01-06 19:54:48,675] {result_logger:118} INFO - average recall on sleep stages: 0.854
[2024-01-06 19:54:48,694] {result_logger:120} INFO - average F1-score on sleep stages: 0.765
[2024-01-06 19:54:48,766] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.854
[2024-01-06 19:54:48,770] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.838
[2024-01-06 19:54:48,770] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 19:54:49,393] {result_logger:143} INFO - 
[[320033   9564   2455      3]
 [  3193 228388   7608      1]
 [   332   1193  37146      0]
 [  1920    232     36      0]]
[2024-01-06 19:54:50,012] {result_logger:150} INFO - 
[[ 96.38%   2.88%   0.74%   0.00%]
 [  1.33%  95.48%   3.18%   0.00%]
 [  0.86%   3.08%  96.06%   0.00%]
 [ 87.75%  10.60%   1.65%   0.00%]]
[2024-01-06 19:54:50,635] {result_logger:154} INFO - 
[[ 98.33%   4.00%   5.20%  75.00%]
 [  0.98%  95.41%  16.10%  25.00%]
 [  0.10%   0.50%  78.62%   0.00%]
 [  0.59%   0.10%   0.08%   0.00%]]
[2024-01-06 19:54:50,635] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 19:54:50,714] {result_logger:143} INFO - 
[[41171  2197  4951     0]
 [ 4651 28424  2030     0]
 [  258   270  4813     0]
 [  321   169   344     0]]
[2024-01-06 19:54:50,926] {result_logger:150} INFO - 
[[ 85.21%   4.55%  10.25%   0.00%]
 [ 13.25%  80.97%   5.78%   0.00%]
 [  4.83%   5.06%  90.11%   0.00%]
 [ 38.49%  20.26%  41.25%   0.00%]]
[2024-01-06 19:54:51,132] {result_logger:154} INFO - 
[[ 88.73%   7.07%  40.79%    nan%]
 [ 10.02%  91.51%  16.72%    nan%]
 [  0.56%   0.87%  39.65%    nan%]
 [  0.69%   0.54%   2.83%    nan%]]
[2024-01-06 19:54:51,557] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 19:54:51,557] {result_logger:77} INFO - actual:
[2024-01-06 19:54:51,558] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 19:54:51,558] {result_logger:79} INFO - predicted:
[2024-01-06 19:54:51,558] {result_logger:80} INFO - 
[[93.85%  3.27%  2.88%  0.00%]
 [ 4.14% 92.58%  3.28%  0.00%]
 [12.91%  6.49% 80.60%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 19:54:51,594] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it2/model_8conv_2fc-best.pth
[2024-01-06 19:54:51,594] {run_experiment:113} INFO - [epoch  34] execution time: 225.72s	 avg f1-score: 0.7651

[2024-01-06 19:54:51,594] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 19:54:51,654] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 19:55:18,373] {train_model:86} INFO - Train Epoch: 35 [60928/612104 (10%)]	lr:3.75e-05	Loss: 0.064912
[2024-01-06 19:55:45,771] {train_model:86} INFO - Train Epoch: 35 [122112/612104 (20%)]	lr:3.75e-05	Loss: 0.129796
[2024-01-06 19:56:24,435] {train_model:86} INFO - Train Epoch: 35 [183296/612104 (30%)]	lr:3.75e-05	Loss: 0.060827
[2024-01-06 19:56:53,660] {train_model:86} INFO - Train Epoch: 35 [244480/612104 (40%)]	lr:3.75e-05	Loss: 0.058069
[2024-01-06 19:57:06,420] {train_model:86} INFO - Train Epoch: 35 [305664/612104 (50%)]	lr:3.75e-05	Loss: 0.055842
[2024-01-06 19:57:19,219] {train_model:86} INFO - Train Epoch: 35 [366848/612104 (60%)]	lr:3.75e-05	Loss: 0.074900
[2024-01-06 19:57:31,423] {train_model:86} INFO - Train Epoch: 35 [428032/612104 (70%)]	lr:3.75e-05	Loss: 0.188097
[2024-01-06 19:57:43,280] {train_model:86} INFO - Train Epoch: 35 [489216/612104 (80%)]	lr:3.75e-05	Loss: 0.110253
[2024-01-06 19:57:55,589] {train_model:86} INFO - Train Epoch: 35 [550400/612104 (90%)]	lr:3.75e-05	Loss: 0.042204
[2024-01-06 19:58:07,849] {train_model:86} INFO - Train Epoch: 35 [611584/612104 (100%)]	lr:3.75e-05	Loss: 0.198657
[2024-01-06 19:58:22,226] {run_experiment:78} INFO - 
[2024-01-06 19:58:22,233] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 19:58:23,584] {result_logger:108} INFO - precision on WAKE: 0.989
[2024-01-06 19:58:24,470] {result_logger:109} INFO - recall on WAKE: 0.964
[2024-01-06 19:58:25,391] {result_logger:112} INFO - F1-score on WAKE: 0.976
[2024-01-06 19:58:25,391] {result_logger:113} INFO - 
[2024-01-06 19:58:26,792] {result_logger:108} INFO - precision on NREM: 0.955
[2024-01-06 19:58:27,683] {result_logger:109} INFO - recall on NREM: 0.955
[2024-01-06 19:58:28,577] {result_logger:112} INFO - F1-score on NREM: 0.955
[2024-01-06 19:58:28,577] {result_logger:113} INFO - 
[2024-01-06 19:58:29,818] {result_logger:108} INFO - precision on REM: 0.788
[2024-01-06 19:58:30,600] {result_logger:109} INFO - recall on REM: 0.961
[2024-01-06 19:58:31,382] {result_logger:112} INFO - F1-score on REM: 0.866
[2024-01-06 19:58:31,382] {result_logger:113} INFO - 
[2024-01-06 19:58:31,585] {result_logger:116} INFO - average precision on sleep stages: 0.911
[2024-01-06 19:58:31,789] {result_logger:118} INFO - average recall on sleep stages: 0.960
[2024-01-06 19:58:31,992] {result_logger:120} INFO - average F1-score on sleep stages: 0.932
[2024-01-06 19:58:32,546] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.960
[2024-01-06 19:58:32,573] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.960
[2024-01-06 19:58:32,579] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 19:58:32,754] {result_logger:108} INFO - precision on WAKE: 0.915
[2024-01-06 19:58:32,861] {result_logger:109} INFO - recall on WAKE: 0.904
[2024-01-06 19:58:32,969] {result_logger:112} INFO - F1-score on WAKE: 0.910
[2024-01-06 19:58:32,969] {result_logger:113} INFO - 
[2024-01-06 19:58:33,144] {result_logger:108} INFO - precision on NREM: 0.923
[2024-01-06 19:58:33,253] {result_logger:109} INFO - recall on NREM: 0.836
[2024-01-06 19:58:33,362] {result_logger:112} INFO - F1-score on NREM: 0.877
[2024-01-06 19:58:33,362] {result_logger:113} INFO - 
[2024-01-06 19:58:33,537] {result_logger:108} INFO - precision on REM: 0.532
[2024-01-06 19:58:33,642] {result_logger:109} INFO - recall on REM: 0.916
[2024-01-06 19:58:33,750] {result_logger:112} INFO - F1-score on REM: 0.673
[2024-01-06 19:58:33,750] {result_logger:113} INFO - 
[2024-01-06 19:58:33,770] {result_logger:116} INFO - average precision on sleep stages: 0.790
[2024-01-06 19:58:33,791] {result_logger:118} INFO - average recall on sleep stages: 0.885
[2024-01-06 19:58:33,810] {result_logger:120} INFO - average F1-score on sleep stages: 0.820
[2024-01-06 19:58:33,888] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.885
[2024-01-06 19:58:33,891] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.878
[2024-01-06 19:58:33,892] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 19:58:34,515] {result_logger:143} INFO - 
[[320089   9567   2398      1]
 [  3231 228367   7592      0]
 [   326   1191  37154      0]
 [  1926    233     29      0]]
[2024-01-06 19:58:35,136] {result_logger:150} INFO - 
[[ 96.40%   2.88%   0.72%   0.00%]
 [  1.35%  95.48%   3.17%   0.00%]
 [  0.84%   3.08%  96.08%   0.00%]
 [ 88.03%  10.65%   1.33%   0.00%]]
[2024-01-06 19:58:35,756] {result_logger:154} INFO - 
[[ 98.32%   4.00%   5.08% 100.00%]
 [  0.99%  95.41%  16.09%   0.00%]
 [  0.10%   0.50%  78.76%   0.00%]
 [  0.59%   0.10%   0.06%   0.00%]]
[2024-01-06 19:58:35,756] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 19:58:35,839] {result_logger:143} INFO - 
[[43701  2197  2421     0]
 [ 3866 29364  1875     0]
 [  186   265  4890     0]
 [  476   175   183     0]]
[2024-01-06 19:58:36,054] {result_logger:150} INFO - 
[[ 90.44%   4.55%   5.01%   0.00%]
 [ 11.01%  83.65%   5.34%   0.00%]
 [  3.48%   4.96%  91.56%   0.00%]
 [ 57.07%  20.98%  21.94%   0.00%]]
[2024-01-06 19:58:36,265] {result_logger:154} INFO - 
[[ 90.61%   6.87%  25.84%    nan%]
 [  8.02%  91.76%  20.01%    nan%]
 [  0.39%   0.83%  52.19%    nan%]
 [  0.99%   0.55%   1.95%    nan%]]
[2024-01-06 19:58:36,815] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 19:58:36,815] {result_logger:77} INFO - actual:
[2024-01-06 19:58:36,815] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 19:58:36,816] {result_logger:79} INFO - predicted:
[2024-01-06 19:58:36,816] {result_logger:80} INFO - 
[[94.56%  3.41%  2.03%  0.00%]
 [ 4.36% 92.86%  2.78%  0.00%]
 [13.11%  6.83% 80.06%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 19:58:36,852] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it2/model_8conv_2fc-best.pth
[2024-01-06 19:58:36,852] {run_experiment:113} INFO - [epoch  35] execution time: 225.26s	 avg f1-score: 0.8201

[2024-01-06 19:58:36,853] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 19:58:36,914] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 19:59:19,389] {train_model:86} INFO - Train Epoch: 36 [60928/612104 (10%)]	lr:3.53e-05	Loss: 0.080159
[2024-01-06 19:59:57,357] {train_model:86} INFO - Train Epoch: 36 [122112/612104 (20%)]	lr:3.53e-05	Loss: 0.125441
[2024-01-06 20:00:26,910] {train_model:86} INFO - Train Epoch: 36 [183296/612104 (30%)]	lr:3.53e-05	Loss: 0.103327
[2024-01-06 20:00:39,099] {train_model:86} INFO - Train Epoch: 36 [244480/612104 (40%)]	lr:3.53e-05	Loss: 0.116818
[2024-01-06 20:00:51,374] {train_model:86} INFO - Train Epoch: 36 [305664/612104 (50%)]	lr:3.53e-05	Loss: 0.071967
[2024-01-06 20:01:03,379] {train_model:86} INFO - Train Epoch: 36 [366848/612104 (60%)]	lr:3.53e-05	Loss: 0.091289
[2024-01-06 20:01:15,749] {train_model:86} INFO - Train Epoch: 36 [428032/612104 (70%)]	lr:3.53e-05	Loss: 0.068646
[2024-01-06 20:01:27,833] {train_model:86} INFO - Train Epoch: 36 [489216/612104 (80%)]	lr:3.53e-05	Loss: 0.060817
[2024-01-06 20:01:40,351] {train_model:86} INFO - Train Epoch: 36 [550400/612104 (90%)]	lr:3.53e-05	Loss: 0.065867
[2024-01-06 20:01:53,519] {train_model:86} INFO - Train Epoch: 36 [611584/612104 (100%)]	lr:3.53e-05	Loss: 0.024609
[2024-01-06 20:02:07,600] {run_experiment:78} INFO - 
[2024-01-06 20:02:07,607] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 20:02:09,069] {result_logger:108} INFO - precision on WAKE: 0.989
[2024-01-06 20:02:10,024] {result_logger:109} INFO - recall on WAKE: 0.964
[2024-01-06 20:02:10,965] {result_logger:112} INFO - F1-score on WAKE: 0.976
[2024-01-06 20:02:10,966] {result_logger:113} INFO - 
[2024-01-06 20:02:12,414] {result_logger:108} INFO - precision on NREM: 0.955
[2024-01-06 20:02:13,351] {result_logger:109} INFO - recall on NREM: 0.955
[2024-01-06 20:02:14,245] {result_logger:112} INFO - F1-score on NREM: 0.955
[2024-01-06 20:02:14,245] {result_logger:113} INFO - 
[2024-01-06 20:02:15,490] {result_logger:108} INFO - precision on REM: 0.789
[2024-01-06 20:02:16,252] {result_logger:109} INFO - recall on REM: 0.961
[2024-01-06 20:02:17,007] {result_logger:112} INFO - F1-score on REM: 0.866
[2024-01-06 20:02:17,007] {result_logger:113} INFO - 
[2024-01-06 20:02:17,201] {result_logger:116} INFO - average precision on sleep stages: 0.911
[2024-01-06 20:02:17,403] {result_logger:118} INFO - average recall on sleep stages: 0.960
[2024-01-06 20:02:17,608] {result_logger:120} INFO - average F1-score on sleep stages: 0.933
[2024-01-06 20:02:18,169] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.960
[2024-01-06 20:02:18,197] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.960
[2024-01-06 20:02:18,201] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 20:02:18,366] {result_logger:108} INFO - precision on WAKE: 0.859
[2024-01-06 20:02:18,471] {result_logger:109} INFO - recall on WAKE: 0.963
[2024-01-06 20:02:18,580] {result_logger:112} INFO - F1-score on WAKE: 0.908
[2024-01-06 20:02:18,580] {result_logger:113} INFO - 
[2024-01-06 20:02:18,754] {result_logger:108} INFO - precision on NREM: 0.924
[2024-01-06 20:02:18,858] {result_logger:109} INFO - recall on NREM: 0.774
[2024-01-06 20:02:18,962] {result_logger:112} INFO - F1-score on NREM: 0.842
[2024-01-06 20:02:18,962] {result_logger:113} INFO - 
[2024-01-06 20:02:19,135] {result_logger:108} INFO - precision on REM: 0.746
[2024-01-06 20:02:19,238] {result_logger:109} INFO - recall on REM: 0.727
[2024-01-06 20:02:19,340] {result_logger:112} INFO - F1-score on REM: 0.737
[2024-01-06 20:02:19,340] {result_logger:113} INFO - 
[2024-01-06 20:02:19,359] {result_logger:116} INFO - average precision on sleep stages: 0.843
[2024-01-06 20:02:19,377] {result_logger:118} INFO - average recall on sleep stages: 0.821
[2024-01-06 20:02:19,396] {result_logger:120} INFO - average F1-score on sleep stages: 0.829
[2024-01-06 20:02:19,470] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.821
[2024-01-06 20:02:19,472] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.874
[2024-01-06 20:02:19,473] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 20:02:20,078] {result_logger:143} INFO - 
[[320106   9494   2452      3]
 [  3215 228479   7496      0]
 [   321   1188  37162      0]
 [  1920    233     35      0]]
[2024-01-06 20:02:20,674] {result_logger:150} INFO - 
[[ 96.40%   2.86%   0.74%   0.00%]
 [  1.34%  95.52%   3.13%   0.00%]
 [  0.83%   3.07%  96.10%   0.00%]
 [ 87.75%  10.65%   1.60%   0.00%]]
[2024-01-06 20:02:21,244] {result_logger:154} INFO - 
[[ 98.32%   3.97%   5.20% 100.00%]
 [  0.99%  95.44%  15.90%   0.00%]
 [  0.10%   0.50%  78.82%   0.00%]
 [  0.59%   0.10%   0.07%   0.00%]]
[2024-01-06 20:02:21,245] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 20:02:21,323] {result_logger:143} INFO - 
[[46510  1686   123     0]
 [ 6733 27173  1199     0]
 [  914   542  3885     0]
 [  639   179    16     0]]
[2024-01-06 20:02:21,605] {result_logger:150} INFO - 
[[ 96.26%   3.49%   0.25%   0.00%]
 [ 19.18%  77.40%   3.42%   0.00%]
 [ 17.11%  10.15%  72.74%   0.00%]
 [ 76.62%  21.46%   1.92%   0.00%]]
[2024-01-06 20:02:21,851] {result_logger:154} INFO - 
[[ 84.88%   5.70%   2.35%    nan%]
 [ 12.29%  91.86%  22.96%    nan%]
 [  1.67%   1.83%  74.38%    nan%]
 [  1.17%   0.61%   0.31%    nan%]]
[2024-01-06 20:02:22,383] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 20:02:22,384] {result_logger:77} INFO - actual:
[2024-01-06 20:02:22,384] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 20:02:22,384] {result_logger:79} INFO - predicted:
[2024-01-06 20:02:22,384] {result_logger:80} INFO - 
[[96.24%  3.18%  0.59%  0.00%]
 [ 5.26% 92.93%  1.81%  0.00%]
 [ 9.71%  6.72% 83.57%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 20:02:22,442] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it2/model_8conv_2fc-best.pth
[2024-01-06 20:02:22,443] {run_experiment:113} INFO - [epoch  36] execution time: 225.59s	 avg f1-score: 0.8290

[2024-01-06 20:02:22,443] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 20:02:22,508] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 20:03:03,660] {train_model:86} INFO - Train Epoch: 37 [60928/612104 (10%)]	lr:3.33e-05	Loss: 0.125073
[2024-01-06 20:03:31,579] {train_model:86} INFO - Train Epoch: 37 [122112/612104 (20%)]	lr:3.33e-05	Loss: 0.069339
[2024-01-06 20:03:58,793] {train_model:86} INFO - Train Epoch: 37 [183296/612104 (30%)]	lr:3.33e-05	Loss: 0.129928
[2024-01-06 20:04:11,590] {train_model:86} INFO - Train Epoch: 37 [244480/612104 (40%)]	lr:3.33e-05	Loss: 0.047263
[2024-01-06 20:04:25,382] {train_model:86} INFO - Train Epoch: 37 [305664/612104 (50%)]	lr:3.33e-05	Loss: 0.084255
[2024-01-06 20:04:37,688] {train_model:86} INFO - Train Epoch: 37 [366848/612104 (60%)]	lr:3.33e-05	Loss: 0.039535
[2024-01-06 20:04:49,974] {train_model:86} INFO - Train Epoch: 37 [428032/612104 (70%)]	lr:3.33e-05	Loss: 0.141475
[2024-01-06 20:05:02,722] {train_model:86} INFO - Train Epoch: 37 [489216/612104 (80%)]	lr:3.33e-05	Loss: 0.077523
[2024-01-06 20:05:16,026] {train_model:86} INFO - Train Epoch: 37 [550400/612104 (90%)]	lr:3.33e-05	Loss: 0.065884
[2024-01-06 20:05:29,285] {train_model:86} INFO - Train Epoch: 37 [611584/612104 (100%)]	lr:3.33e-05	Loss: 0.128787
[2024-01-06 20:05:43,566] {run_experiment:78} INFO - 
[2024-01-06 20:05:43,573] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 20:05:44,971] {result_logger:108} INFO - precision on WAKE: 0.989
[2024-01-06 20:05:45,937] {result_logger:109} INFO - recall on WAKE: 0.964
[2024-01-06 20:05:46,862] {result_logger:112} INFO - F1-score on WAKE: 0.977
[2024-01-06 20:05:46,862] {result_logger:113} INFO - 
[2024-01-06 20:05:48,235] {result_logger:108} INFO - precision on NREM: 0.956
[2024-01-06 20:05:49,175] {result_logger:109} INFO - recall on NREM: 0.956
[2024-01-06 20:05:50,059] {result_logger:112} INFO - F1-score on NREM: 0.956
[2024-01-06 20:05:50,059] {result_logger:113} INFO - 
[2024-01-06 20:05:51,358] {result_logger:108} INFO - precision on REM: 0.794
[2024-01-06 20:05:52,181] {result_logger:109} INFO - recall on REM: 0.962
[2024-01-06 20:05:53,061] {result_logger:112} INFO - F1-score on REM: 0.870
[2024-01-06 20:05:53,062] {result_logger:113} INFO - 
[2024-01-06 20:05:53,289] {result_logger:116} INFO - average precision on sleep stages: 0.913
[2024-01-06 20:05:53,502] {result_logger:118} INFO - average recall on sleep stages: 0.961
[2024-01-06 20:05:53,714] {result_logger:120} INFO - average F1-score on sleep stages: 0.934
[2024-01-06 20:05:54,334] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.961
[2024-01-06 20:05:54,364] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.961
[2024-01-06 20:05:54,368] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 20:05:54,558] {result_logger:108} INFO - precision on WAKE: 0.889
[2024-01-06 20:05:54,675] {result_logger:109} INFO - recall on WAKE: 0.932
[2024-01-06 20:05:54,793] {result_logger:112} INFO - F1-score on WAKE: 0.910
[2024-01-06 20:05:54,793] {result_logger:113} INFO - 
[2024-01-06 20:05:54,982] {result_logger:108} INFO - precision on NREM: 0.918
[2024-01-06 20:05:55,098] {result_logger:109} INFO - recall on NREM: 0.798
[2024-01-06 20:05:55,212] {result_logger:112} INFO - F1-score on NREM: 0.853
[2024-01-06 20:05:55,212] {result_logger:113} INFO - 
[2024-01-06 20:05:55,396] {result_logger:108} INFO - precision on REM: 0.640
[2024-01-06 20:05:55,513] {result_logger:109} INFO - recall on REM: 0.910
[2024-01-06 20:05:55,628] {result_logger:112} INFO - F1-score on REM: 0.752
[2024-01-06 20:05:55,628] {result_logger:113} INFO - 
[2024-01-06 20:05:55,649] {result_logger:116} INFO - average precision on sleep stages: 0.816
[2024-01-06 20:05:55,671] {result_logger:118} INFO - average recall on sleep stages: 0.880
[2024-01-06 20:05:55,692] {result_logger:120} INFO - average F1-score on sleep stages: 0.838
[2024-01-06 20:05:55,775] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.880
[2024-01-06 20:05:55,778] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.878
[2024-01-06 20:05:55,779] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 20:05:56,433] {result_logger:143} INFO - 
[[320175   9495   2384      1]
 [  3162 228753   7275      0]
 [   329   1142  37200      0]
 [  1920    235     33      0]]
[2024-01-06 20:05:57,068] {result_logger:150} INFO - 
[[ 96.42%   2.86%   0.72%   0.00%]
 [  1.32%  95.64%   3.04%   0.00%]
 [  0.85%   2.95%  96.20%   0.00%]
 [ 87.75%  10.74%   1.51%   0.00%]]
[2024-01-06 20:05:57,707] {result_logger:154} INFO - 
[[ 98.34%   3.96%   5.08% 100.00%]
 [  0.97%  95.46%  15.51%   0.00%]
 [  0.10%   0.48%  79.33%   0.00%]
 [  0.59%   0.10%   0.07%   0.00%]]
[2024-01-06 20:05:57,707] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 20:05:57,794] {result_logger:143} INFO - 
[[45053  2321   945     0]
 [ 5322 27998  1785     0]
 [  290   192  4859     0]
 [  560   220    54     0]]
[2024-01-06 20:05:58,055] {result_logger:150} INFO - 
[[ 93.24%   4.80%   1.96%   0.00%]
 [ 15.16%  79.76%   5.08%   0.00%]
 [  5.43%   3.59%  90.98%   0.00%]
 [ 67.15%  26.38%   6.47%   0.00%]]
[2024-01-06 20:05:58,297] {result_logger:154} INFO - 
[[ 87.95%   7.55%  12.36%    nan%]
 [ 10.39%  91.11%  23.35%    nan%]
 [  0.57%   0.62%  63.57%    nan%]
 [  1.09%   0.72%   0.71%    nan%]]
[2024-01-06 20:05:58,817] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 20:05:58,817] {result_logger:77} INFO - actual:
[2024-01-06 20:05:58,817] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 20:05:58,817] {result_logger:79} INFO - predicted:
[2024-01-06 20:05:58,817] {result_logger:80} INFO - 
[[95.32%  3.61%  1.07%  0.00%]
 [ 5.23% 92.31%  2.46%  0.00%]
 [10.34%  6.71% 82.95%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 20:05:58,883] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it2/model_8conv_2fc-best.pth
[2024-01-06 20:05:58,883] {run_experiment:113} INFO - [epoch  37] execution time: 216.44s	 avg f1-score: 0.8384

[2024-01-06 20:05:58,883] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 20:05:58,945] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 20:06:54,860] {train_model:86} INFO - Train Epoch: 38 [60928/612104 (10%)]	lr:3.13e-05	Loss: 0.090895
[2024-01-06 20:07:20,901] {train_model:86} INFO - Train Epoch: 38 [122112/612104 (20%)]	lr:3.13e-05	Loss: 0.145205
[2024-01-06 20:07:32,889] {train_model:86} INFO - Train Epoch: 38 [183296/612104 (30%)]	lr:3.13e-05	Loss: 0.121433
[2024-01-06 20:07:44,902] {train_model:86} INFO - Train Epoch: 38 [244480/612104 (40%)]	lr:3.13e-05	Loss: 0.081346
[2024-01-06 20:07:56,858] {train_model:86} INFO - Train Epoch: 38 [305664/612104 (50%)]	lr:3.13e-05	Loss: 0.087757
[2024-01-06 20:08:08,912] {train_model:86} INFO - Train Epoch: 38 [366848/612104 (60%)]	lr:3.13e-05	Loss: 0.164679
[2024-01-06 20:08:21,089] {train_model:86} INFO - Train Epoch: 38 [428032/612104 (70%)]	lr:3.13e-05	Loss: 0.114542
[2024-01-06 20:08:33,842] {train_model:86} INFO - Train Epoch: 38 [489216/612104 (80%)]	lr:3.13e-05	Loss: 0.083774
[2024-01-06 20:08:46,409] {train_model:86} INFO - Train Epoch: 38 [550400/612104 (90%)]	lr:3.13e-05	Loss: 0.158749
[2024-01-06 20:09:09,972] {train_model:86} INFO - Train Epoch: 38 [611584/612104 (100%)]	lr:3.13e-05	Loss: 0.257338
[2024-01-06 20:09:23,218] {run_experiment:78} INFO - 
[2024-01-06 20:09:23,224] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 20:09:24,591] {result_logger:108} INFO - precision on WAKE: 0.989
[2024-01-06 20:09:25,490] {result_logger:109} INFO - recall on WAKE: 0.965
[2024-01-06 20:09:26,353] {result_logger:112} INFO - F1-score on WAKE: 0.977
[2024-01-06 20:09:26,354] {result_logger:113} INFO - 
[2024-01-06 20:09:27,673] {result_logger:108} INFO - precision on NREM: 0.956
[2024-01-06 20:09:28,549] {result_logger:109} INFO - recall on NREM: 0.956
[2024-01-06 20:09:29,405] {result_logger:112} INFO - F1-score on NREM: 0.956
[2024-01-06 20:09:29,405] {result_logger:113} INFO - 
[2024-01-06 20:09:30,631] {result_logger:108} INFO - precision on REM: 0.793
[2024-01-06 20:09:31,403] {result_logger:109} INFO - recall on REM: 0.962
[2024-01-06 20:09:32,186] {result_logger:112} INFO - F1-score on REM: 0.869
[2024-01-06 20:09:32,186] {result_logger:113} INFO - 
[2024-01-06 20:09:32,379] {result_logger:116} INFO - average precision on sleep stages: 0.913
[2024-01-06 20:09:32,569] {result_logger:118} INFO - average recall on sleep stages: 0.961
[2024-01-06 20:09:32,755] {result_logger:120} INFO - average F1-score on sleep stages: 0.934
[2024-01-06 20:09:33,309] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.961
[2024-01-06 20:09:33,336] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.961
[2024-01-06 20:09:33,340] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 20:09:33,513] {result_logger:108} INFO - precision on WAKE: 0.899
[2024-01-06 20:09:33,616] {result_logger:109} INFO - recall on WAKE: 0.895
[2024-01-06 20:09:33,720] {result_logger:112} INFO - F1-score on WAKE: 0.897
[2024-01-06 20:09:33,720] {result_logger:113} INFO - 
[2024-01-06 20:09:33,891] {result_logger:108} INFO - precision on NREM: 0.921
[2024-01-06 20:09:33,992] {result_logger:109} INFO - recall on NREM: 0.825
[2024-01-06 20:09:34,094] {result_logger:112} INFO - F1-score on NREM: 0.870
[2024-01-06 20:09:34,094] {result_logger:113} INFO - 
[2024-01-06 20:09:34,262] {result_logger:108} INFO - precision on REM: 0.510
[2024-01-06 20:09:34,362] {result_logger:109} INFO - recall on REM: 0.884
[2024-01-06 20:09:34,465] {result_logger:112} INFO - F1-score on REM: 0.647
[2024-01-06 20:09:34,465] {result_logger:113} INFO - 
[2024-01-06 20:09:34,485] {result_logger:116} INFO - average precision on sleep stages: 0.777
[2024-01-06 20:09:34,504] {result_logger:118} INFO - average recall on sleep stages: 0.868
[2024-01-06 20:09:34,524] {result_logger:120} INFO - average F1-score on sleep stages: 0.805
[2024-01-06 20:09:34,600] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.868
[2024-01-06 20:09:34,602] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.866
[2024-01-06 20:09:34,603] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 20:09:35,215] {result_logger:143} INFO - 
[[320349   9419   2287      0]
 [  3194 228562   7434      0]
 [   346   1131  37194      0]
 [  1921    233     34      0]]
[2024-01-06 20:09:35,851] {result_logger:150} INFO - 
[[ 96.47%   2.84%   0.69%   0.00%]
 [  1.34%  95.56%   3.11%   0.00%]
 [  0.89%   2.92%  96.18%   0.00%]
 [ 87.80%  10.65%   1.55%   0.00%]]
[2024-01-06 20:09:36,473] {result_logger:154} INFO - 
[[ 98.32%   3.94%   4.87%    nan%]
 [  0.98%  95.49%  15.83%    nan%]
 [  0.11%   0.47%  79.22%    nan%]
 [  0.59%   0.10%   0.07%    nan%]]
[2024-01-06 20:09:36,474] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 20:09:36,556] {result_logger:143} INFO - 
[[43243  2155  2921     0]
 [ 4550 28945  1610     0]
 [  291   328  4722     0]
 [  429   168   237     0]]
[2024-01-06 20:09:36,805] {result_logger:150} INFO - 
[[ 89.49%   4.46%   6.05%   0.00%]
 [ 12.96%  82.45%   4.59%   0.00%]
 [  5.45%   6.14%  88.41%   0.00%]
 [ 51.44%  20.14%  28.42%   0.00%]]
[2024-01-06 20:09:37,038] {result_logger:154} INFO - 
[[ 89.14%   6.82%  30.78%    nan%]
 [  9.38%  91.61%  16.97%    nan%]
 [  0.60%   1.04%  49.76%    nan%]
 [  0.88%   0.53%   2.50%    nan%]]
[2024-01-06 20:09:37,528] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 20:09:37,528] {result_logger:77} INFO - actual:
[2024-01-06 20:09:37,529] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 20:09:37,529] {result_logger:79} INFO - predicted:
[2024-01-06 20:09:37,529] {result_logger:80} INFO - 
[[94.42%  3.28%  2.30%  0.00%]
 [ 4.37% 92.99%  2.64%  0.00%]
 [13.97%  6.55% 79.47%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 20:09:37,590] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it2/model_8conv_2fc-best.pth
[2024-01-06 20:09:37,591] {run_experiment:113} INFO - [epoch  38] execution time: 218.71s	 avg f1-score: 0.8048

[2024-01-06 20:09:37,591] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 20:09:37,648] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 20:10:19,549] {train_model:86} INFO - Train Epoch: 39 [60928/612104 (10%)]	lr:2.95e-05	Loss: 0.080985
[2024-01-06 20:10:45,704] {train_model:86} INFO - Train Epoch: 39 [122112/612104 (20%)]	lr:2.95e-05	Loss: 0.106352
[2024-01-06 20:10:59,520] {train_model:86} INFO - Train Epoch: 39 [183296/612104 (30%)]	lr:2.95e-05	Loss: 0.071318
[2024-01-06 20:11:11,711] {train_model:86} INFO - Train Epoch: 39 [244480/612104 (40%)]	lr:2.95e-05	Loss: 0.094943
[2024-01-06 20:11:23,991] {train_model:86} INFO - Train Epoch: 39 [305664/612104 (50%)]	lr:2.95e-05	Loss: 0.058024
[2024-01-06 20:11:36,616] {train_model:86} INFO - Train Epoch: 39 [366848/612104 (60%)]	lr:2.95e-05	Loss: 0.156726
[2024-01-06 20:11:48,910] {train_model:86} INFO - Train Epoch: 39 [428032/612104 (70%)]	lr:2.95e-05	Loss: 0.089648
[2024-01-06 20:12:01,204] {train_model:86} INFO - Train Epoch: 39 [489216/612104 (80%)]	lr:2.95e-05	Loss: 0.093503
[2024-01-06 20:12:13,710] {train_model:86} INFO - Train Epoch: 39 [550400/612104 (90%)]	lr:2.95e-05	Loss: 0.049597
[2024-01-06 20:12:41,544] {train_model:86} INFO - Train Epoch: 39 [611584/612104 (100%)]	lr:2.95e-05	Loss: 0.209388
[2024-01-06 20:12:55,187] {run_experiment:78} INFO - 
[2024-01-06 20:12:55,193] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 20:12:56,538] {result_logger:108} INFO - precision on WAKE: 0.989
[2024-01-06 20:12:57,414] {result_logger:109} INFO - recall on WAKE: 0.965
[2024-01-06 20:12:58,271] {result_logger:112} INFO - F1-score on WAKE: 0.977
[2024-01-06 20:12:58,271] {result_logger:113} INFO - 
[2024-01-06 20:12:59,551] {result_logger:108} INFO - precision on NREM: 0.956
[2024-01-06 20:13:00,398] {result_logger:109} INFO - recall on NREM: 0.957
[2024-01-06 20:13:01,258] {result_logger:112} INFO - F1-score on NREM: 0.956
[2024-01-06 20:13:01,258] {result_logger:113} INFO - 
[2024-01-06 20:13:02,499] {result_logger:108} INFO - precision on REM: 0.798
[2024-01-06 20:13:03,291] {result_logger:109} INFO - recall on REM: 0.960
[2024-01-06 20:13:04,091] {result_logger:112} INFO - F1-score on REM: 0.871
[2024-01-06 20:13:04,092] {result_logger:113} INFO - 
[2024-01-06 20:13:04,307] {result_logger:116} INFO - average precision on sleep stages: 0.914
[2024-01-06 20:13:04,519] {result_logger:118} INFO - average recall on sleep stages: 0.960
[2024-01-06 20:13:04,736] {result_logger:120} INFO - average F1-score on sleep stages: 0.935
[2024-01-06 20:13:05,334] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.960
[2024-01-06 20:13:05,363] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.961
[2024-01-06 20:13:05,367] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 20:13:05,548] {result_logger:108} INFO - precision on WAKE: 0.892
[2024-01-06 20:13:05,656] {result_logger:109} INFO - recall on WAKE: 0.922
[2024-01-06 20:13:05,768] {result_logger:112} INFO - F1-score on WAKE: 0.906
[2024-01-06 20:13:05,769] {result_logger:113} INFO - 
[2024-01-06 20:13:05,954] {result_logger:108} INFO - precision on NREM: 0.925
[2024-01-06 20:13:06,079] {result_logger:109} INFO - recall on NREM: 0.807
[2024-01-06 20:13:06,193] {result_logger:112} INFO - F1-score on NREM: 0.862
[2024-01-06 20:13:06,194] {result_logger:113} INFO - 
[2024-01-06 20:13:06,375] {result_logger:108} INFO - precision on REM: 0.578
[2024-01-06 20:13:06,484] {result_logger:109} INFO - recall on REM: 0.886
[2024-01-06 20:13:06,592] {result_logger:112} INFO - F1-score on REM: 0.700
[2024-01-06 20:13:06,592] {result_logger:113} INFO - 
[2024-01-06 20:13:06,612] {result_logger:116} INFO - average precision on sleep stages: 0.798
[2024-01-06 20:13:06,632] {result_logger:118} INFO - average recall on sleep stages: 0.872
[2024-01-06 20:13:06,653] {result_logger:120} INFO - average F1-score on sleep stages: 0.823
[2024-01-06 20:13:06,733] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.872
[2024-01-06 20:13:06,736] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.874
[2024-01-06 20:13:06,736] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 20:13:07,367] {result_logger:143} INFO - 
[[320371   9411   2272      1]
 [  3184 228856   7148      2]
 [   363   1193  37115      0]
 [  1915    237     36      0]]
[2024-01-06 20:13:07,987] {result_logger:150} INFO - 
[[ 96.48%   2.83%   0.68%   0.00%]
 [  1.33%  95.68%   2.99%   0.00%]
 [  0.94%   3.08%  95.98%   0.00%]
 [ 87.52%  10.83%   1.65%   0.00%]]
[2024-01-06 20:13:08,579] {result_logger:154} INFO - 
[[ 98.32%   3.93%   4.88%  33.33%]
 [  0.98%  95.48%  15.35%  66.67%]
 [  0.11%   0.50%  79.70%   0.00%]
 [  0.59%   0.10%   0.08%   0.00%]]
[2024-01-06 20:13:08,580] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 20:13:08,662] {result_logger:143} INFO - 
[[44531  2096  1692     0]
 [ 5013 28332  1760     0]
 [  396   212  4733     0]
 [  533   177   124     0]]
[2024-01-06 20:13:08,919] {result_logger:150} INFO - 
[[ 92.16%   4.34%   3.50%   0.00%]
 [ 14.28%  80.71%   5.01%   0.00%]
 [  7.41%   3.97%  88.62%   0.00%]
 [ 63.91%  21.22%  14.87%   0.00%]]
[2024-01-06 20:13:09,238] {result_logger:154} INFO - 
[[ 88.23%   6.80%  20.36%    nan%]
 [  9.93%  91.94%  21.18%    nan%]
 [  0.78%   0.69%  56.96%    nan%]
 [  1.06%   0.57%   1.49%    nan%]]
[2024-01-06 20:13:09,711] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 20:13:09,711] {result_logger:77} INFO - actual:
[2024-01-06 20:13:09,711] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 20:13:09,711] {result_logger:79} INFO - predicted:
[2024-01-06 20:13:09,711] {result_logger:80} INFO - 
[[95.09%  3.43%  1.48%  0.00%]
 [ 4.84% 92.43%  2.74%  0.00%]
 [11.85%  7.27% 80.88%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 20:13:09,761] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it2/model_8conv_2fc-best.pth
[2024-01-06 20:13:09,761] {run_experiment:113} INFO - [epoch  39] execution time: 212.17s	 avg f1-score: 0.8227

[2024-01-06 20:13:09,761] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 20:13:09,820] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 20:13:51,218] {train_model:86} INFO - Train Epoch: 40 [60928/612104 (10%)]	lr:2.78e-05	Loss: 0.115353
[2024-01-06 20:14:03,442] {train_model:86} INFO - Train Epoch: 40 [122112/612104 (20%)]	lr:2.78e-05	Loss: 0.072576
[2024-01-06 20:14:15,626] {train_model:86} INFO - Train Epoch: 40 [183296/612104 (30%)]	lr:2.78e-05	Loss: 0.069730
[2024-01-06 20:14:27,598] {train_model:86} INFO - Train Epoch: 40 [244480/612104 (40%)]	lr:2.78e-05	Loss: 0.208900
[2024-01-06 20:14:40,332] {train_model:86} INFO - Train Epoch: 40 [305664/612104 (50%)]	lr:2.78e-05	Loss: 0.067384
[2024-01-06 20:14:54,605] {train_model:86} INFO - Train Epoch: 40 [366848/612104 (60%)]	lr:2.78e-05	Loss: 0.066136
[2024-01-06 20:15:07,703] {train_model:86} INFO - Train Epoch: 40 [428032/612104 (70%)]	lr:2.78e-05	Loss: 0.136003
[2024-01-06 20:15:19,961] {train_model:86} INFO - Train Epoch: 40 [489216/612104 (80%)]	lr:2.78e-05	Loss: 0.093938
[2024-01-06 20:15:32,967] {train_model:86} INFO - Train Epoch: 40 [550400/612104 (90%)]	lr:2.78e-05	Loss: 0.134549
[2024-01-06 20:16:13,005] {train_model:86} INFO - Train Epoch: 40 [611584/612104 (100%)]	lr:2.78e-05	Loss: 0.051611
[2024-01-06 20:16:26,719] {run_experiment:78} INFO - 
[2024-01-06 20:16:26,726] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 20:16:28,092] {result_logger:108} INFO - precision on WAKE: 0.989
[2024-01-06 20:16:28,972] {result_logger:109} INFO - recall on WAKE: 0.965
[2024-01-06 20:16:29,851] {result_logger:112} INFO - F1-score on WAKE: 0.977
[2024-01-06 20:16:29,851] {result_logger:113} INFO - 
[2024-01-06 20:16:31,173] {result_logger:108} INFO - precision on NREM: 0.955
[2024-01-06 20:16:32,040] {result_logger:109} INFO - recall on NREM: 0.957
[2024-01-06 20:16:32,898] {result_logger:112} INFO - F1-score on NREM: 0.956
[2024-01-06 20:16:32,898] {result_logger:113} INFO - 
[2024-01-06 20:16:34,140] {result_logger:108} INFO - precision on REM: 0.797
[2024-01-06 20:16:34,903] {result_logger:109} INFO - recall on REM: 0.961
[2024-01-06 20:16:35,683] {result_logger:112} INFO - F1-score on REM: 0.872
[2024-01-06 20:16:35,683] {result_logger:113} INFO - 
[2024-01-06 20:16:35,882] {result_logger:116} INFO - average precision on sleep stages: 0.914
[2024-01-06 20:16:36,089] {result_logger:118} INFO - average recall on sleep stages: 0.961
[2024-01-06 20:16:36,298] {result_logger:120} INFO - average F1-score on sleep stages: 0.935
[2024-01-06 20:16:36,880] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.961
[2024-01-06 20:16:36,909] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.961
[2024-01-06 20:16:36,914] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 20:16:37,084] {result_logger:108} INFO - precision on WAKE: 0.893
[2024-01-06 20:16:37,192] {result_logger:109} INFO - recall on WAKE: 0.946
[2024-01-06 20:16:37,302] {result_logger:112} INFO - F1-score on WAKE: 0.919
[2024-01-06 20:16:37,302] {result_logger:113} INFO - 
[2024-01-06 20:16:37,480] {result_logger:108} INFO - precision on NREM: 0.930
[2024-01-06 20:16:37,590] {result_logger:109} INFO - recall on NREM: 0.791
[2024-01-06 20:16:37,699] {result_logger:112} INFO - F1-score on NREM: 0.855
[2024-01-06 20:16:37,699] {result_logger:113} INFO - 
[2024-01-06 20:16:37,870] {result_logger:108} INFO - precision on REM: 0.629
[2024-01-06 20:16:37,976] {result_logger:109} INFO - recall on REM: 0.905
[2024-01-06 20:16:38,082] {result_logger:112} INFO - F1-score on REM: 0.742
[2024-01-06 20:16:38,082] {result_logger:113} INFO - 
[2024-01-06 20:16:38,103] {result_logger:116} INFO - average precision on sleep stages: 0.817
[2024-01-06 20:16:38,123] {result_logger:118} INFO - average recall on sleep stages: 0.881
[2024-01-06 20:16:38,143] {result_logger:120} INFO - average F1-score on sleep stages: 0.839
[2024-01-06 20:16:38,216] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.881
[2024-01-06 20:16:38,219] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.882
[2024-01-06 20:16:38,219] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 20:16:38,858] {result_logger:143} INFO - 
[[320360   9483   2212      0]
 [  3136 228818   7236      0]
 [   314   1186  37171      0]
 [  1919    237     32      0]]
[2024-01-06 20:16:39,512] {result_logger:150} INFO - 
[[ 96.48%   2.86%   0.67%   0.00%]
 [  1.31%  95.66%   3.03%   0.00%]
 [  0.81%   3.07%  96.12%   0.00%]
 [ 87.71%  10.83%   1.46%   0.00%]]
[2024-01-06 20:16:40,173] {result_logger:154} INFO - 
[[ 98.35%   3.96%   4.74%    nan%]
 [  0.96%  95.45%  15.51%    nan%]
 [  0.10%   0.49%  79.68%    nan%]
 [  0.59%   0.10%   0.07%    nan%]]
[2024-01-06 20:16:40,173] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 20:16:40,261] {result_logger:143} INFO - 
[[45715  1907   697     0]
 [ 5165 27781  2159     0]
 [  310   196  4835     0]
 [  595   148    91     0]]
[2024-01-06 20:16:40,519] {result_logger:150} INFO - 
[[ 94.61%   3.95%   1.44%   0.00%]
 [ 14.71%  79.14%   6.15%   0.00%]
 [  5.80%   3.67%  90.53%   0.00%]
 [ 71.34%  17.75%  10.91%   0.00%]]
[2024-01-06 20:16:40,751] {result_logger:154} INFO - 
[[ 88.28%   6.35%   8.96%    nan%]
 [  9.97%  92.50%  27.74%    nan%]
 [  0.60%   0.65%  62.13%    nan%]
 [  1.15%   0.49%   1.17%    nan%]]
[2024-01-06 20:16:41,218] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 20:16:41,218] {result_logger:77} INFO - actual:
[2024-01-06 20:16:41,218] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 20:16:41,218] {result_logger:79} INFO - predicted:
[2024-01-06 20:16:41,219] {result_logger:80} INFO - 
[[95.41%  3.54%  1.05%  0.00%]
 [ 5.22% 92.22%  2.56%  0.00%]
 [10.42%  6.46% 83.11%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 20:16:41,268] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it2/model_8conv_2fc-best.pth
[2024-01-06 20:16:41,269] {run_experiment:113} INFO - [epoch  40] execution time: 211.51s	 avg f1-score: 0.8386

[2024-01-06 20:16:41,269] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 20:16:41,330] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 20:17:08,369] {train_model:86} INFO - Train Epoch: 41 [60928/612104 (10%)]	lr:2.62e-05	Loss: 0.057871
[2024-01-06 20:17:21,412] {train_model:86} INFO - Train Epoch: 41 [122112/612104 (20%)]	lr:2.62e-05	Loss: 0.089482
[2024-01-06 20:17:34,491] {train_model:86} INFO - Train Epoch: 41 [183296/612104 (30%)]	lr:2.62e-05	Loss: 0.130461
[2024-01-06 20:17:47,942] {train_model:86} INFO - Train Epoch: 41 [244480/612104 (40%)]	lr:2.62e-05	Loss: 0.186913
[2024-01-06 20:18:00,806] {train_model:86} INFO - Train Epoch: 41 [305664/612104 (50%)]	lr:2.62e-05	Loss: 0.112154
[2024-01-06 20:18:12,705] {train_model:86} INFO - Train Epoch: 41 [366848/612104 (60%)]	lr:2.62e-05	Loss: 0.079086
[2024-01-06 20:18:24,716] {train_model:86} INFO - Train Epoch: 41 [428032/612104 (70%)]	lr:2.62e-05	Loss: 0.080567
[2024-01-06 20:18:36,949] {train_model:86} INFO - Train Epoch: 41 [489216/612104 (80%)]	lr:2.62e-05	Loss: 0.100732
[2024-01-06 20:19:04,444] {train_model:86} INFO - Train Epoch: 41 [550400/612104 (90%)]	lr:2.62e-05	Loss: 0.079902
[2024-01-06 20:19:53,436] {train_model:86} INFO - Train Epoch: 41 [611584/612104 (100%)]	lr:2.62e-05	Loss: 0.114711
[2024-01-06 20:20:08,286] {run_experiment:78} INFO - 
[2024-01-06 20:20:08,293] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 20:20:09,734] {result_logger:108} INFO - precision on WAKE: 0.989
[2024-01-06 20:20:10,665] {result_logger:109} INFO - recall on WAKE: 0.965
[2024-01-06 20:20:11,601] {result_logger:112} INFO - F1-score on WAKE: 0.977
[2024-01-06 20:20:11,601] {result_logger:113} INFO - 
[2024-01-06 20:20:13,032] {result_logger:108} INFO - precision on NREM: 0.956
[2024-01-06 20:20:13,959] {result_logger:109} INFO - recall on NREM: 0.956
[2024-01-06 20:20:14,877] {result_logger:112} INFO - F1-score on NREM: 0.956
[2024-01-06 20:20:14,877] {result_logger:113} INFO - 
[2024-01-06 20:20:16,151] {result_logger:108} INFO - precision on REM: 0.794
[2024-01-06 20:20:16,963] {result_logger:109} INFO - recall on REM: 0.963
[2024-01-06 20:20:17,776] {result_logger:112} INFO - F1-score on REM: 0.870
[2024-01-06 20:20:17,777] {result_logger:113} INFO - 
[2024-01-06 20:20:17,988] {result_logger:116} INFO - average precision on sleep stages: 0.913
[2024-01-06 20:20:18,201] {result_logger:118} INFO - average recall on sleep stages: 0.961
[2024-01-06 20:20:18,411] {result_logger:120} INFO - average F1-score on sleep stages: 0.934
[2024-01-06 20:20:19,011] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.961
[2024-01-06 20:20:19,041] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.961
[2024-01-06 20:20:19,045] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 20:20:19,227] {result_logger:108} INFO - precision on WAKE: 0.895
[2024-01-06 20:20:19,342] {result_logger:109} INFO - recall on WAKE: 0.836
[2024-01-06 20:20:19,456] {result_logger:112} INFO - F1-score on WAKE: 0.864
[2024-01-06 20:20:19,457] {result_logger:113} INFO - 
[2024-01-06 20:20:19,641] {result_logger:108} INFO - precision on NREM: 0.925
[2024-01-06 20:20:19,756] {result_logger:109} INFO - recall on NREM: 0.805
[2024-01-06 20:20:19,870] {result_logger:112} INFO - F1-score on NREM: 0.861
[2024-01-06 20:20:19,870] {result_logger:113} INFO - 
[2024-01-06 20:20:20,053] {result_logger:108} INFO - precision on REM: 0.360
[2024-01-06 20:20:20,166] {result_logger:109} INFO - recall on REM: 0.879
[2024-01-06 20:20:20,280] {result_logger:112} INFO - F1-score on REM: 0.510
[2024-01-06 20:20:20,281] {result_logger:113} INFO - 
[2024-01-06 20:20:20,302] {result_logger:116} INFO - average precision on sleep stages: 0.726
[2024-01-06 20:20:20,323] {result_logger:118} INFO - average recall on sleep stages: 0.840
[2024-01-06 20:20:20,344] {result_logger:120} INFO - average F1-score on sleep stages: 0.745
[2024-01-06 20:20:20,426] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.840
[2024-01-06 20:20:20,430] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.826
[2024-01-06 20:20:20,430] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 20:20:21,090] {result_logger:143} INFO - 
[[320344   9398   2313      0]
 [  3222 228596   7370      2]
 [   318   1111  37242      0]
 [  1914    239     35      0]]
[2024-01-06 20:20:21,738] {result_logger:150} INFO - 
[[ 96.47%   2.83%   0.70%   0.00%]
 [  1.35%  95.57%   3.08%   0.00%]
 [  0.82%   2.87%  96.30%   0.00%]
 [ 87.48%  10.92%   1.60%   0.00%]]
[2024-01-06 20:20:22,395] {result_logger:154} INFO - 
[[ 98.33%   3.93%   4.93%   0.00%]
 [  0.99%  95.51%  15.69% 100.00%]
 [  0.10%   0.46%  79.31%   0.00%]
 [  0.59%   0.10%   0.07%   0.00%]]
[2024-01-06 20:20:22,395] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 20:20:22,483] {result_logger:143} INFO - 
[[40398  1954  5967     0]
 [ 4446 28259  2400     0]
 [  298   346  4697     0]
 [  281   124   429     0]]
[2024-01-06 20:20:22,712] {result_logger:150} INFO - 
[[ 83.61%   4.04%  12.35%   0.00%]
 [ 12.66%  80.50%   6.84%   0.00%]
 [  5.58%   6.48%  87.94%   0.00%]
 [ 33.69%  14.87%  51.44%   0.00%]]
[2024-01-06 20:20:22,932] {result_logger:154} INFO - 
[[ 88.94%   6.37%  44.22%    nan%]
 [  9.79%  92.10%  17.79%    nan%]
 [  0.66%   1.13%  34.81%    nan%]
 [  0.62%   0.40%   3.18%    nan%]]
[2024-01-06 20:20:23,404] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 20:20:23,404] {result_logger:77} INFO - actual:
[2024-01-06 20:20:23,404] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 20:20:23,404] {result_logger:79} INFO - predicted:
[2024-01-06 20:20:23,404] {result_logger:80} INFO - 
[[93.60%  3.13%  3.27%  0.00%]
 [ 4.02% 92.45%  3.52%  0.00%]
 [12.40%  6.63% 80.98%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 20:20:23,443] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it2/model_8conv_2fc-best.pth
[2024-01-06 20:20:23,444] {run_experiment:113} INFO - [epoch  41] execution time: 222.17s	 avg f1-score: 0.7452

[2024-01-06 20:20:23,444] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 20:20:23,503] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 20:20:50,697] {train_model:86} INFO - Train Epoch: 42 [60928/612104 (10%)]	lr:2.47e-05	Loss: 0.057874
[2024-01-06 20:21:03,539] {train_model:86} INFO - Train Epoch: 42 [122112/612104 (20%)]	lr:2.47e-05	Loss: 0.048148
[2024-01-06 20:21:16,090] {train_model:86} INFO - Train Epoch: 42 [183296/612104 (30%)]	lr:2.47e-05	Loss: 0.054091
[2024-01-06 20:21:28,336] {train_model:86} INFO - Train Epoch: 42 [244480/612104 (40%)]	lr:2.47e-05	Loss: 0.075605
[2024-01-06 20:21:41,159] {train_model:86} INFO - Train Epoch: 42 [305664/612104 (50%)]	lr:2.47e-05	Loss: 0.125885
[2024-01-06 20:21:55,303] {train_model:86} INFO - Train Epoch: 42 [366848/612104 (60%)]	lr:2.47e-05	Loss: 0.057614
[2024-01-06 20:22:08,292] {train_model:86} INFO - Train Epoch: 42 [428032/612104 (70%)]	lr:2.47e-05	Loss: 0.109361
[2024-01-06 20:22:51,822] {train_model:86} INFO - Train Epoch: 42 [489216/612104 (80%)]	lr:2.47e-05	Loss: 0.041977
[2024-01-06 20:23:18,289] {train_model:86} INFO - Train Epoch: 42 [550400/612104 (90%)]	lr:2.47e-05	Loss: 0.083812
[2024-01-06 20:23:31,481] {train_model:86} INFO - Train Epoch: 42 [611584/612104 (100%)]	lr:2.47e-05	Loss: 0.161699
[2024-01-06 20:23:46,406] {run_experiment:78} INFO - 
[2024-01-06 20:23:46,413] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 20:23:47,863] {result_logger:108} INFO - precision on WAKE: 0.989
[2024-01-06 20:23:48,823] {result_logger:109} INFO - recall on WAKE: 0.965
[2024-01-06 20:23:49,783] {result_logger:112} INFO - F1-score on WAKE: 0.977
[2024-01-06 20:23:49,783] {result_logger:113} INFO - 
[2024-01-06 20:23:51,206] {result_logger:108} INFO - precision on NREM: 0.956
[2024-01-06 20:23:52,122] {result_logger:109} INFO - recall on NREM: 0.957
[2024-01-06 20:23:53,033] {result_logger:112} INFO - F1-score on NREM: 0.957
[2024-01-06 20:23:53,033] {result_logger:113} INFO - 
[2024-01-06 20:23:54,309] {result_logger:108} INFO - precision on REM: 0.797
[2024-01-06 20:23:55,105] {result_logger:109} INFO - recall on REM: 0.964
[2024-01-06 20:23:55,907] {result_logger:112} INFO - F1-score on REM: 0.873
[2024-01-06 20:23:55,907] {result_logger:113} INFO - 
[2024-01-06 20:23:56,118] {result_logger:116} INFO - average precision on sleep stages: 0.914
[2024-01-06 20:23:56,329] {result_logger:118} INFO - average recall on sleep stages: 0.962
[2024-01-06 20:23:56,537] {result_logger:120} INFO - average F1-score on sleep stages: 0.935
[2024-01-06 20:23:57,127] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.962
[2024-01-06 20:23:57,157] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.962
[2024-01-06 20:23:57,161] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 20:23:57,345] {result_logger:108} INFO - precision on WAKE: 0.860
[2024-01-06 20:23:57,458] {result_logger:109} INFO - recall on WAKE: 0.965
[2024-01-06 20:23:57,569] {result_logger:112} INFO - F1-score on WAKE: 0.909
[2024-01-06 20:23:57,569] {result_logger:113} INFO - 
[2024-01-06 20:23:57,755] {result_logger:108} INFO - precision on NREM: 0.942
[2024-01-06 20:23:57,867] {result_logger:109} INFO - recall on NREM: 0.762
[2024-01-06 20:23:57,981] {result_logger:112} INFO - F1-score on NREM: 0.842
[2024-01-06 20:23:57,981] {result_logger:113} INFO - 
[2024-01-06 20:23:58,162] {result_logger:108} INFO - precision on REM: 0.721
[2024-01-06 20:23:58,273] {result_logger:109} INFO - recall on REM: 0.830
[2024-01-06 20:23:58,384] {result_logger:112} INFO - F1-score on REM: 0.772
[2024-01-06 20:23:58,385] {result_logger:113} INFO - 
[2024-01-06 20:23:58,405] {result_logger:116} INFO - average precision on sleep stages: 0.841
[2024-01-06 20:23:58,425] {result_logger:118} INFO - average recall on sleep stages: 0.852
[2024-01-06 20:23:58,445] {result_logger:120} INFO - average F1-score on sleep stages: 0.841
[2024-01-06 20:23:58,527] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.852
[2024-01-06 20:23:58,530] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.876
[2024-01-06 20:23:58,530] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 20:23:59,180] {result_logger:143} INFO - 
[[320310   9409   2334      2]
 [  3136 228917   7135      2]
 [   316   1067  37288      0]
 [  1922    233     33      0]]
[2024-01-06 20:23:59,830] {result_logger:150} INFO - 
[[ 96.46%   2.83%   0.70%   0.00%]
 [  1.31%  95.71%   2.98%   0.00%]
 [  0.82%   2.76%  96.42%   0.00%]
 [ 87.84%  10.65%   1.51%   0.00%]]
[2024-01-06 20:24:00,473] {result_logger:154} INFO - 
[[ 98.35%   3.93%   4.99%  50.00%]
 [  0.96%  95.53%  15.25%  50.00%]
 [  0.10%   0.45%  79.69%   0.00%]
 [  0.59%   0.10%   0.07%   0.00%]]
[2024-01-06 20:24:00,474] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 20:24:00,559] {result_logger:143} INFO - 
[[46615  1421   283     0]
 [ 6921 26755  1429     0]
 [  669   240  4432     0]
 [  739    65    30     0]]
[2024-01-06 20:24:00,772] {result_logger:150} INFO - 
[[ 96.47%   2.94%   0.59%   0.00%]
 [ 19.72%  76.21%   4.07%   0.00%]
 [ 12.53%   4.49%  82.98%   0.00%]
 [ 88.61%   7.79%   3.60%   0.00%]]
[2024-01-06 20:24:00,984] {result_logger:154} INFO - 
[[ 84.84%   4.99%   4.58%    nan%]
 [ 12.60%  93.94%  23.15%    nan%]
 [  1.22%   0.84%  71.78%    nan%]
 [  1.35%   0.23%   0.49%    nan%]]
[2024-01-06 20:24:01,430] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 20:24:01,431] {result_logger:77} INFO - actual:
[2024-01-06 20:24:01,431] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 20:24:01,431] {result_logger:79} INFO - predicted:
[2024-01-06 20:24:01,431] {result_logger:80} INFO - 
[[96.34%  3.00%  0.66%  0.00%]
 [ 4.99% 92.89%  2.11%  0.00%]
 [ 9.52%  6.12% 84.35%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 20:24:01,468] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it2/model_8conv_2fc-best.pth
[2024-01-06 20:24:01,468] {run_experiment:113} INFO - [epoch  42] execution time: 218.02s	 avg f1-score: 0.8412

[2024-01-06 20:24:01,468] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 20:24:01,526] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 20:24:28,355] {train_model:86} INFO - Train Epoch: 43 [60928/612104 (10%)]	lr:2.32e-05	Loss: 0.090593
[2024-01-06 20:24:40,466] {train_model:86} INFO - Train Epoch: 43 [122112/612104 (20%)]	lr:2.32e-05	Loss: 0.036507
[2024-01-06 20:24:52,672] {train_model:86} INFO - Train Epoch: 43 [183296/612104 (30%)]	lr:2.32e-05	Loss: 0.065214
[2024-01-06 20:25:05,961] {train_model:86} INFO - Train Epoch: 43 [244480/612104 (40%)]	lr:2.32e-05	Loss: 0.066830
[2024-01-06 20:25:18,692] {train_model:86} INFO - Train Epoch: 43 [305664/612104 (50%)]	lr:2.32e-05	Loss: 0.068302
[2024-01-06 20:25:44,206] {train_model:86} INFO - Train Epoch: 43 [366848/612104 (60%)]	lr:2.32e-05	Loss: 0.123974
[2024-01-06 20:26:13,311] {train_model:86} INFO - Train Epoch: 43 [428032/612104 (70%)]	lr:2.32e-05	Loss: 0.170028
[2024-01-06 20:26:40,809] {train_model:86} INFO - Train Epoch: 43 [489216/612104 (80%)]	lr:2.32e-05	Loss: 0.049481
[2024-01-06 20:27:07,413] {train_model:86} INFO - Train Epoch: 43 [550400/612104 (90%)]	lr:2.32e-05	Loss: 0.063523
[2024-01-06 20:27:19,744] {train_model:86} INFO - Train Epoch: 43 [611584/612104 (100%)]	lr:2.32e-05	Loss: 0.060143
[2024-01-06 20:27:34,348] {run_experiment:78} INFO - 
[2024-01-06 20:27:34,354] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 20:27:35,780] {result_logger:108} INFO - precision on WAKE: 0.989
[2024-01-06 20:27:36,714] {result_logger:109} INFO - recall on WAKE: 0.965
[2024-01-06 20:27:37,670] {result_logger:112} INFO - F1-score on WAKE: 0.977
[2024-01-06 20:27:37,670] {result_logger:113} INFO - 
[2024-01-06 20:27:39,118] {result_logger:108} INFO - precision on NREM: 0.957
[2024-01-06 20:27:40,069] {result_logger:109} INFO - recall on NREM: 0.956
[2024-01-06 20:27:40,992] {result_logger:112} INFO - F1-score on NREM: 0.956
[2024-01-06 20:27:40,992] {result_logger:113} INFO - 
[2024-01-06 20:27:42,306] {result_logger:108} INFO - precision on REM: 0.794
[2024-01-06 20:27:43,128] {result_logger:109} INFO - recall on REM: 0.964
[2024-01-06 20:27:43,949] {result_logger:112} INFO - F1-score on REM: 0.871
[2024-01-06 20:27:43,949] {result_logger:113} INFO - 
[2024-01-06 20:27:44,166] {result_logger:116} INFO - average precision on sleep stages: 0.913
[2024-01-06 20:27:44,381] {result_logger:118} INFO - average recall on sleep stages: 0.962
[2024-01-06 20:27:44,597] {result_logger:120} INFO - average F1-score on sleep stages: 0.935
[2024-01-06 20:27:45,201] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.962
[2024-01-06 20:27:45,231] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.961
[2024-01-06 20:27:45,235] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 20:27:45,423] {result_logger:108} INFO - precision on WAKE: 0.907
[2024-01-06 20:27:45,537] {result_logger:109} INFO - recall on WAKE: 0.925
[2024-01-06 20:27:45,652] {result_logger:112} INFO - F1-score on WAKE: 0.916
[2024-01-06 20:27:45,652] {result_logger:113} INFO - 
[2024-01-06 20:27:45,834] {result_logger:108} INFO - precision on NREM: 0.907
[2024-01-06 20:27:45,950] {result_logger:109} INFO - recall on NREM: 0.832
[2024-01-06 20:27:46,063] {result_logger:112} INFO - F1-score on NREM: 0.868
[2024-01-06 20:27:46,063] {result_logger:113} INFO - 
[2024-01-06 20:27:46,250] {result_logger:108} INFO - precision on REM: 0.653
[2024-01-06 20:27:46,362] {result_logger:109} INFO - recall on REM: 0.888
[2024-01-06 20:27:46,477] {result_logger:112} INFO - F1-score on REM: 0.752
[2024-01-06 20:27:46,477] {result_logger:113} INFO - 
[2024-01-06 20:27:46,498] {result_logger:116} INFO - average precision on sleep stages: 0.822
[2024-01-06 20:27:46,519] {result_logger:118} INFO - average recall on sleep stages: 0.882
[2024-01-06 20:27:46,540] {result_logger:120} INFO - average F1-score on sleep stages: 0.845
[2024-01-06 20:27:46,622] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.882
[2024-01-06 20:27:46,625] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.886
[2024-01-06 20:27:46,626] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 20:27:47,283] {result_logger:143} INFO - 
[[320513   9266   2275      1]
 [  3204 228621   7364      1]
 [   309   1100  37262      0]
 [  1924    231     33      0]]
[2024-01-06 20:27:47,939] {result_logger:150} INFO - 
[[ 96.52%   2.79%   0.69%   0.00%]
 [  1.34%  95.58%   3.08%   0.00%]
 [  0.80%   2.84%  96.36%   0.00%]
 [ 87.93%  10.56%   1.51%   0.00%]]
[2024-01-06 20:27:48,581] {result_logger:154} INFO - 
[[ 98.33%   3.87%   4.85%  50.00%]
 [  0.98%  95.57%  15.69%  50.00%]
 [  0.09%   0.46%  79.39%   0.00%]
 [  0.59%   0.10%   0.07%   0.00%]]
[2024-01-06 20:27:48,581] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 20:27:48,669] {result_logger:143} INFO - 
[[44705  2689   925     0]
 [ 4308 29198  1599     0]
 [  280   319  4742     0]
 [  510   248    76     0]]
[2024-01-06 20:27:49,008] {result_logger:150} INFO - 
[[ 92.52%   5.57%   1.91%   0.00%]
 [ 12.27%  83.17%   4.55%   0.00%]
 [  5.24%   5.97%  88.78%   0.00%]
 [ 61.15%  29.74%   9.11%   0.00%]]
[2024-01-06 20:27:49,226] {result_logger:154} INFO - 
[[ 89.76%   8.29%  12.60%    nan%]
 [  8.65%  89.97%  21.78%    nan%]
 [  0.56%   0.98%  64.59%    nan%]
 [  1.02%   0.76%   1.04%    nan%]]
[2024-01-06 20:27:49,681] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 20:27:49,681] {result_logger:77} INFO - actual:
[2024-01-06 20:27:49,681] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 20:27:49,681] {result_logger:79} INFO - predicted:
[2024-01-06 20:27:49,681] {result_logger:80} INFO - 
[[95.13%  3.76%  1.11%  0.00%]
 [ 5.06% 92.49%  2.45%  0.00%]
 [10.64%  7.72% 81.64%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 20:27:49,723] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it2/model_8conv_2fc-best.pth
[2024-01-06 20:27:49,723] {run_experiment:113} INFO - [epoch  43] execution time: 228.26s	 avg f1-score: 0.8453

[2024-01-06 20:27:49,724] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 20:27:49,785] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 20:28:16,427] {train_model:86} INFO - Train Epoch: 44 [60928/612104 (10%)]	lr:2.19e-05	Loss: 0.122263
[2024-01-06 20:28:28,580] {train_model:86} INFO - Train Epoch: 44 [122112/612104 (20%)]	lr:2.19e-05	Loss: 0.071861
[2024-01-06 20:28:41,088] {train_model:86} INFO - Train Epoch: 44 [183296/612104 (30%)]	lr:2.19e-05	Loss: 0.044700
[2024-01-06 20:28:53,647] {train_model:86} INFO - Train Epoch: 44 [244480/612104 (40%)]	lr:2.19e-05	Loss: 0.069445
[2024-01-06 20:29:18,665] {train_model:86} INFO - Train Epoch: 44 [305664/612104 (50%)]	lr:2.19e-05	Loss: 0.208633
[2024-01-06 20:29:48,678] {train_model:86} INFO - Train Epoch: 44 [366848/612104 (60%)]	lr:2.19e-05	Loss: 0.513264
[2024-01-06 20:30:16,969] {train_model:86} INFO - Train Epoch: 44 [428032/612104 (70%)]	lr:2.19e-05	Loss: 0.121000
[2024-01-06 20:30:43,894] {train_model:86} INFO - Train Epoch: 44 [489216/612104 (80%)]	lr:2.19e-05	Loss: 0.053929
[2024-01-06 20:30:56,425] {train_model:86} INFO - Train Epoch: 44 [550400/612104 (90%)]	lr:2.19e-05	Loss: 0.058759
[2024-01-06 20:31:08,858] {train_model:86} INFO - Train Epoch: 44 [611584/612104 (100%)]	lr:2.19e-05	Loss: 0.099643
[2024-01-06 20:31:23,106] {run_experiment:78} INFO - 
[2024-01-06 20:31:23,113] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 20:31:24,557] {result_logger:108} INFO - precision on WAKE: 0.990
[2024-01-06 20:31:25,517] {result_logger:109} INFO - recall on WAKE: 0.965
[2024-01-06 20:31:26,477] {result_logger:112} INFO - F1-score on WAKE: 0.977
[2024-01-06 20:31:26,477] {result_logger:113} INFO - 
[2024-01-06 20:31:27,883] {result_logger:108} INFO - precision on NREM: 0.956
[2024-01-06 20:31:28,801] {result_logger:109} INFO - recall on NREM: 0.957
[2024-01-06 20:31:29,708] {result_logger:112} INFO - F1-score on NREM: 0.957
[2024-01-06 20:31:29,708] {result_logger:113} INFO - 
[2024-01-06 20:31:30,960] {result_logger:108} INFO - precision on REM: 0.799
[2024-01-06 20:31:31,759] {result_logger:109} INFO - recall on REM: 0.964
[2024-01-06 20:31:32,563] {result_logger:112} INFO - F1-score on REM: 0.874
[2024-01-06 20:31:32,563] {result_logger:113} INFO - 
[2024-01-06 20:31:32,773] {result_logger:116} INFO - average precision on sleep stages: 0.915
[2024-01-06 20:31:32,985] {result_logger:118} INFO - average recall on sleep stages: 0.962
[2024-01-06 20:31:33,192] {result_logger:120} INFO - average F1-score on sleep stages: 0.936
[2024-01-06 20:31:33,785] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.962
[2024-01-06 20:31:33,814] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.962
[2024-01-06 20:31:33,818] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 20:31:33,993] {result_logger:108} INFO - precision on WAKE: 0.880
[2024-01-06 20:31:34,103] {result_logger:109} INFO - recall on WAKE: 0.959
[2024-01-06 20:31:34,214] {result_logger:112} INFO - F1-score on WAKE: 0.917
[2024-01-06 20:31:34,214] {result_logger:113} INFO - 
[2024-01-06 20:31:34,393] {result_logger:108} INFO - precision on NREM: 0.940
[2024-01-06 20:31:34,505] {result_logger:109} INFO - recall on NREM: 0.790
[2024-01-06 20:31:34,617] {result_logger:112} INFO - F1-score on NREM: 0.858
[2024-01-06 20:31:34,617] {result_logger:113} INFO - 
[2024-01-06 20:31:34,791] {result_logger:108} INFO - precision on REM: 0.701
[2024-01-06 20:31:34,897] {result_logger:109} INFO - recall on REM: 0.866
[2024-01-06 20:31:35,003] {result_logger:112} INFO - F1-score on REM: 0.775
[2024-01-06 20:31:35,004] {result_logger:113} INFO - 
[2024-01-06 20:31:35,024] {result_logger:116} INFO - average precision on sleep stages: 0.840
[2024-01-06 20:31:35,044] {result_logger:118} INFO - average recall on sleep stages: 0.871
[2024-01-06 20:31:35,064] {result_logger:120} INFO - average F1-score on sleep stages: 0.850
[2024-01-06 20:31:35,144] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.871
[2024-01-06 20:31:35,147] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.886
[2024-01-06 20:31:35,148] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 20:31:35,785] {result_logger:143} INFO - 
[[320401   9416   2238      0]
 [  3090 228971   7129      0]
 [   307   1076  37288      0]
 [  1921    231     36      0]]
[2024-01-06 20:31:36,425] {result_logger:150} INFO - 
[[ 96.49%   2.84%   0.67%   0.00%]
 [  1.29%  95.73%   2.98%   0.00%]
 [  0.79%   2.78%  96.42%   0.00%]
 [ 87.80%  10.56%   1.65%   0.00%]]
[2024-01-06 20:31:37,065] {result_logger:154} INFO - 
[[ 98.37%   3.93%   4.79%    nan%]
 [  0.95%  95.53%  15.27%    nan%]
 [  0.09%   0.45%  79.86%    nan%]
 [  0.59%   0.10%   0.08%    nan%]]
[2024-01-06 20:31:37,065] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 20:31:37,151] {result_logger:143} INFO - 
[[46318  1532   469     0]
 [ 5865 27736  1504     0]
 [  469   248  4624     0]
 [  684   109    41     0]]
[2024-01-06 20:31:37,371] {result_logger:150} INFO - 
[[ 95.86%   3.17%   0.97%   0.00%]
 [ 16.71%  79.01%   4.28%   0.00%]
 [  8.78%   4.64%  86.58%   0.00%]
 [ 82.01%  13.07%   4.92%   0.00%]]
[2024-01-06 20:31:37,587] {result_logger:154} INFO - 
[[ 86.84%   5.17%   7.07%    nan%]
 [ 11.00%  93.62%  22.66%    nan%]
 [  0.88%   0.84%  69.66%    nan%]
 [  1.28%   0.37%   0.62%    nan%]]
[2024-01-06 20:31:38,045] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 20:31:38,045] {result_logger:77} INFO - actual:
[2024-01-06 20:31:38,046] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 20:31:38,046] {result_logger:79} INFO - predicted:
[2024-01-06 20:31:38,046] {result_logger:80} INFO - 
[[95.89%  3.25%  0.86%  0.00%]
 [ 5.10% 92.83%  2.07%  0.00%]
 [10.24%  5.92% 83.84%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 20:31:38,082] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it2/model_8conv_2fc-best.pth
[2024-01-06 20:31:38,083] {run_experiment:113} INFO - [epoch  44] execution time: 228.36s	 avg f1-score: 0.8502

[2024-01-06 20:31:38,083] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 20:31:38,142] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 20:32:05,972] {train_model:86} INFO - Train Epoch: 45 [60928/612104 (10%)]	lr:2.06e-05	Loss: 0.072262
[2024-01-06 20:32:18,481] {train_model:86} INFO - Train Epoch: 45 [122112/612104 (20%)]	lr:2.06e-05	Loss: 0.117175
[2024-01-06 20:32:30,642] {train_model:86} INFO - Train Epoch: 45 [183296/612104 (30%)]	lr:2.06e-05	Loss: 0.243786
[2024-01-06 20:32:57,479] {train_model:86} INFO - Train Epoch: 45 [244480/612104 (40%)]	lr:2.06e-05	Loss: 0.098598
[2024-01-06 20:33:24,739] {train_model:86} INFO - Train Epoch: 45 [305664/612104 (50%)]	lr:2.06e-05	Loss: 0.254245
[2024-01-06 20:33:51,905] {train_model:86} INFO - Train Epoch: 45 [366848/612104 (60%)]	lr:2.06e-05	Loss: 0.158089
[2024-01-06 20:34:19,569] {train_model:86} INFO - Train Epoch: 45 [428032/612104 (70%)]	lr:2.06e-05	Loss: 0.050812
[2024-01-06 20:34:32,919] {train_model:86} INFO - Train Epoch: 45 [489216/612104 (80%)]	lr:2.06e-05	Loss: 0.041992
[2024-01-06 20:34:45,358] {train_model:86} INFO - Train Epoch: 45 [550400/612104 (90%)]	lr:2.06e-05	Loss: 0.067308
[2024-01-06 20:34:58,027] {train_model:86} INFO - Train Epoch: 45 [611584/612104 (100%)]	lr:2.06e-05	Loss: 0.075012
[2024-01-06 20:35:11,786] {run_experiment:78} INFO - 
[2024-01-06 20:35:11,793] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 20:35:13,125] {result_logger:108} INFO - precision on WAKE: 0.989
[2024-01-06 20:35:13,993] {result_logger:109} INFO - recall on WAKE: 0.965
[2024-01-06 20:35:14,872] {result_logger:112} INFO - F1-score on WAKE: 0.977
[2024-01-06 20:35:14,872] {result_logger:113} INFO - 
[2024-01-06 20:35:16,227] {result_logger:108} INFO - precision on NREM: 0.957
[2024-01-06 20:35:17,135] {result_logger:109} INFO - recall on NREM: 0.957
[2024-01-06 20:35:18,064] {result_logger:112} INFO - F1-score on NREM: 0.957
[2024-01-06 20:35:18,064] {result_logger:113} INFO - 
[2024-01-06 20:35:19,349] {result_logger:108} INFO - precision on REM: 0.799
[2024-01-06 20:35:20,148] {result_logger:109} INFO - recall on REM: 0.964
[2024-01-06 20:35:20,941] {result_logger:112} INFO - F1-score on REM: 0.873
[2024-01-06 20:35:20,941] {result_logger:113} INFO - 
[2024-01-06 20:35:21,151] {result_logger:116} INFO - average precision on sleep stages: 0.915
[2024-01-06 20:35:21,359] {result_logger:118} INFO - average recall on sleep stages: 0.962
[2024-01-06 20:35:21,567] {result_logger:120} INFO - average F1-score on sleep stages: 0.936
[2024-01-06 20:35:22,151] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.962
[2024-01-06 20:35:22,181] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.962
[2024-01-06 20:35:22,185] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 20:35:22,368] {result_logger:108} INFO - precision on WAKE: 0.869
[2024-01-06 20:35:22,481] {result_logger:109} INFO - recall on WAKE: 0.960
[2024-01-06 20:35:22,591] {result_logger:112} INFO - F1-score on WAKE: 0.913
[2024-01-06 20:35:22,592] {result_logger:113} INFO - 
[2024-01-06 20:35:22,773] {result_logger:108} INFO - precision on NREM: 0.923
[2024-01-06 20:35:22,885] {result_logger:109} INFO - recall on NREM: 0.777
[2024-01-06 20:35:23,000] {result_logger:112} INFO - F1-score on NREM: 0.844
[2024-01-06 20:35:23,000] {result_logger:113} INFO - 
[2024-01-06 20:35:23,183] {result_logger:108} INFO - precision on REM: 0.729
[2024-01-06 20:35:23,293] {result_logger:109} INFO - recall on REM: 0.795
[2024-01-06 20:35:23,404] {result_logger:112} INFO - F1-score on REM: 0.761
[2024-01-06 20:35:23,404] {result_logger:113} INFO - 
[2024-01-06 20:35:23,424] {result_logger:116} INFO - average precision on sleep stages: 0.840
[2024-01-06 20:35:23,445] {result_logger:118} INFO - average recall on sleep stages: 0.844
[2024-01-06 20:35:23,465] {result_logger:120} INFO - average F1-score on sleep stages: 0.839
[2024-01-06 20:35:23,547] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.844
[2024-01-06 20:35:23,550] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.878
[2024-01-06 20:35:23,550] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 20:35:24,182] {result_logger:143} INFO - 
[[320430   9330   2295      0]
 [  3209 228878   7102      1]
 [   326   1077  37268      0]
 [  1923    231     34      0]]
[2024-01-06 20:35:24,835] {result_logger:150} INFO - 
[[ 96.50%   2.81%   0.69%   0.00%]
 [  1.34%  95.69%   2.97%   0.00%]
 [  0.84%   2.79%  96.37%   0.00%]
 [ 87.89%  10.56%   1.55%   0.00%]]
[2024-01-06 20:35:25,486] {result_logger:154} INFO - 
[[ 98.33%   3.90%   4.91%   0.00%]
 [  0.98%  95.56%  15.21% 100.00%]
 [  0.10%   0.45%  79.80%   0.00%]
 [  0.59%   0.10%   0.07%   0.00%]]
[2024-01-06 20:35:25,486] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 20:35:25,571] {result_logger:143} INFO - 
[[46401  1773   145     0]
 [ 6392 27281  1432     0]
 [  580   515  4246     0]
 [  674   142    18     0]]
[2024-01-06 20:35:25,785] {result_logger:150} INFO - 
[[ 96.03%   3.67%   0.30%   0.00%]
 [ 18.21%  77.71%   4.08%   0.00%]
 [ 10.86%   9.64%  79.50%   0.00%]
 [ 80.82%  17.03%   2.16%   0.00%]]
[2024-01-06 20:35:25,996] {result_logger:154} INFO - 
[[ 85.85%   5.97%   2.48%    nan%]
 [ 11.83%  91.82%  24.52%    nan%]
 [  1.07%   1.73%  72.69%    nan%]
 [  1.25%   0.48%   0.31%    nan%]]
[2024-01-06 20:35:26,453] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 20:35:26,453] {result_logger:77} INFO - actual:
[2024-01-06 20:35:26,453] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 20:35:26,453] {result_logger:79} INFO - predicted:
[2024-01-06 20:35:26,453] {result_logger:80} INFO - 
[[95.99%  3.40%  0.61%  0.00%]
 [ 5.47% 92.57%  1.96%  0.00%]
 [ 9.23%  6.39% 84.39%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 20:35:26,490] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it2/model_8conv_2fc-best.pth
[2024-01-06 20:35:26,490] {run_experiment:113} INFO - [epoch  45] execution time: 228.41s	 avg f1-score: 0.8390

[2024-01-06 20:35:26,490] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 20:35:26,551] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 20:35:55,019] {train_model:86} INFO - Train Epoch: 46 [60928/612104 (10%)]	lr:1.94e-05	Loss: 0.062580
[2024-01-06 20:36:08,349] {train_model:86} INFO - Train Epoch: 46 [122112/612104 (20%)]	lr:1.94e-05	Loss: 0.080222
[2024-01-06 20:36:36,049] {train_model:86} INFO - Train Epoch: 46 [183296/612104 (30%)]	lr:1.94e-05	Loss: 0.104152
[2024-01-06 20:36:48,333] {train_model:86} INFO - Train Epoch: 46 [244480/612104 (40%)]	lr:1.94e-05	Loss: 0.146760
[2024-01-06 20:37:01,282] {train_model:86} INFO - Train Epoch: 46 [305664/612104 (50%)]	lr:1.94e-05	Loss: 0.140596
[2024-01-06 20:37:27,518] {train_model:86} INFO - Train Epoch: 46 [366848/612104 (60%)]	lr:1.94e-05	Loss: 0.052968
[2024-01-06 20:37:53,073] {train_model:86} INFO - Train Epoch: 46 [428032/612104 (70%)]	lr:1.94e-05	Loss: 0.108613
[2024-01-06 20:38:06,450] {train_model:86} INFO - Train Epoch: 46 [489216/612104 (80%)]	lr:1.94e-05	Loss: 0.050985
[2024-01-06 20:38:19,284] {train_model:86} INFO - Train Epoch: 46 [550400/612104 (90%)]	lr:1.94e-05	Loss: 0.163232
[2024-01-06 20:38:32,254] {train_model:86} INFO - Train Epoch: 46 [611584/612104 (100%)]	lr:1.94e-05	Loss: 0.088938
[2024-01-06 20:38:45,864] {run_experiment:78} INFO - 
[2024-01-06 20:38:45,871] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 20:38:47,259] {result_logger:108} INFO - precision on WAKE: 0.989
[2024-01-06 20:38:48,173] {result_logger:109} INFO - recall on WAKE: 0.965
[2024-01-06 20:38:49,091] {result_logger:112} INFO - F1-score on WAKE: 0.977
[2024-01-06 20:38:49,092] {result_logger:113} INFO - 
[2024-01-06 20:38:50,461] {result_logger:108} INFO - precision on NREM: 0.957
[2024-01-06 20:38:51,354] {result_logger:109} INFO - recall on NREM: 0.956
[2024-01-06 20:38:52,248] {result_logger:112} INFO - F1-score on NREM: 0.957
[2024-01-06 20:38:52,248] {result_logger:113} INFO - 
[2024-01-06 20:38:53,494] {result_logger:108} INFO - precision on REM: 0.795
[2024-01-06 20:38:54,277] {result_logger:109} INFO - recall on REM: 0.964
[2024-01-06 20:38:55,075] {result_logger:112} INFO - F1-score on REM: 0.871
[2024-01-06 20:38:55,075] {result_logger:113} INFO - 
[2024-01-06 20:38:55,287] {result_logger:116} INFO - average precision on sleep stages: 0.914
[2024-01-06 20:38:55,500] {result_logger:118} INFO - average recall on sleep stages: 0.962
[2024-01-06 20:38:55,714] {result_logger:120} INFO - average F1-score on sleep stages: 0.935
[2024-01-06 20:38:56,282] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.962
[2024-01-06 20:38:56,311] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.962
[2024-01-06 20:38:56,316] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 20:38:56,497] {result_logger:108} INFO - precision on WAKE: 0.874
[2024-01-06 20:38:56,605] {result_logger:109} INFO - recall on WAKE: 0.954
[2024-01-06 20:38:56,715] {result_logger:112} INFO - F1-score on WAKE: 0.912
[2024-01-06 20:38:56,715] {result_logger:113} INFO - 
[2024-01-06 20:38:56,897] {result_logger:108} INFO - precision on NREM: 0.922
[2024-01-06 20:38:57,006] {result_logger:109} INFO - recall on NREM: 0.776
[2024-01-06 20:38:57,106] {result_logger:112} INFO - F1-score on NREM: 0.843
[2024-01-06 20:38:57,107] {result_logger:113} INFO - 
[2024-01-06 20:38:57,292] {result_logger:108} INFO - precision on REM: 0.687
[2024-01-06 20:38:57,401] {result_logger:109} INFO - recall on REM: 0.832
[2024-01-06 20:38:57,509] {result_logger:112} INFO - F1-score on REM: 0.753
[2024-01-06 20:38:57,509] {result_logger:113} INFO - 
[2024-01-06 20:38:57,529] {result_logger:116} INFO - average precision on sleep stages: 0.828
[2024-01-06 20:38:57,548] {result_logger:118} INFO - average recall on sleep stages: 0.854
[2024-01-06 20:38:57,568] {result_logger:120} INFO - average F1-score on sleep stages: 0.836
[2024-01-06 20:38:57,645] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.854
[2024-01-06 20:38:57,649] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.876
[2024-01-06 20:38:57,649] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 20:38:58,277] {result_logger:143} INFO - 
[[320487   9242   2323      3]
 [  3175 228717   7296      2]
 [   321   1063  37287      0]
 [  1915    239     34      0]]
[2024-01-06 20:38:58,902] {result_logger:150} INFO - 
[[ 96.52%   2.78%   0.70%   0.00%]
 [  1.33%  95.62%   3.05%   0.00%]
 [  0.83%   2.75%  96.42%   0.00%]
 [ 87.52%  10.92%   1.55%   0.00%]]
[2024-01-06 20:38:59,528] {result_logger:154} INFO - 
[[ 98.34%   3.86%   4.95%  60.00%]
 [  0.97%  95.59%  15.54%  40.00%]
 [  0.10%   0.44%  79.44%   0.00%]
 [  0.59%   0.10%   0.07%   0.00%]]
[2024-01-06 20:38:59,529] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 20:38:59,614] {result_logger:143} INFO - 
[[46091  1934   294     0]
 [ 6120 27255  1730     0]
 [  532   363  4446     0]
 [  637   170    27     0]]
[2024-01-06 20:38:59,831] {result_logger:150} INFO - 
[[ 95.39%   4.00%   0.61%   0.00%]
 [ 17.43%  77.64%   4.93%   0.00%]
 [  9.96%   6.80%  83.24%   0.00%]
 [ 76.38%  20.38%   3.24%   0.00%]]
[2024-01-06 20:39:00,028] {result_logger:154} INFO - 
[[ 86.35%   6.51%   4.53%    nan%]
 [ 11.46%  91.70%  26.63%    nan%]
 [  1.00%   1.22%  68.43%    nan%]
 [  1.19%   0.57%   0.42%    nan%]]
[2024-01-06 20:39:00,579] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 20:39:00,579] {result_logger:77} INFO - actual:
[2024-01-06 20:39:00,580] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 20:39:00,580] {result_logger:79} INFO - predicted:
[2024-01-06 20:39:00,580] {result_logger:80} INFO - 
[[95.80%  3.51%  0.69%  0.00%]
 [ 5.52% 92.20%  2.28%  0.00%]
 [ 9.19%  6.90% 83.92%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 20:39:00,616] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it2/model_8conv_2fc-best.pth
[2024-01-06 20:39:00,616] {run_experiment:113} INFO - [epoch  46] execution time: 214.13s	 avg f1-score: 0.8360

[2024-01-06 20:39:00,617] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 20:39:00,677] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 20:39:26,632] {train_model:86} INFO - Train Epoch: 47 [60928/612104 (10%)]	lr:1.83e-05	Loss: 0.062172
[2024-01-06 20:39:38,682] {train_model:86} INFO - Train Epoch: 47 [122112/612104 (20%)]	lr:1.83e-05	Loss: 0.051392
[2024-01-06 20:39:51,812] {train_model:86} INFO - Train Epoch: 47 [183296/612104 (30%)]	lr:1.83e-05	Loss: 0.060046
[2024-01-06 20:40:05,129] {train_model:86} INFO - Train Epoch: 47 [244480/612104 (40%)]	lr:1.83e-05	Loss: 0.080643
[2024-01-06 20:40:30,632] {train_model:86} INFO - Train Epoch: 47 [305664/612104 (50%)]	lr:1.83e-05	Loss: 0.136637
[2024-01-06 20:40:55,551] {train_model:86} INFO - Train Epoch: 47 [366848/612104 (60%)]	lr:1.83e-05	Loss: 0.211403
[2024-01-06 20:41:09,472] {train_model:86} INFO - Train Epoch: 47 [428032/612104 (70%)]	lr:1.83e-05	Loss: 0.050941
[2024-01-06 20:41:23,885] {train_model:86} INFO - Train Epoch: 47 [489216/612104 (80%)]	lr:1.83e-05	Loss: 0.263201
[2024-01-06 20:41:36,513] {train_model:86} INFO - Train Epoch: 47 [550400/612104 (90%)]	lr:1.83e-05	Loss: 0.068825
[2024-01-06 20:41:49,296] {train_model:86} INFO - Train Epoch: 47 [611584/612104 (100%)]	lr:1.83e-05	Loss: 0.091114
[2024-01-06 20:42:03,226] {run_experiment:78} INFO - 
[2024-01-06 20:42:03,232] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 20:42:04,674] {result_logger:108} INFO - precision on WAKE: 0.989
[2024-01-06 20:42:05,614] {result_logger:109} INFO - recall on WAKE: 0.965
[2024-01-06 20:42:06,560] {result_logger:112} INFO - F1-score on WAKE: 0.977
[2024-01-06 20:42:06,560] {result_logger:113} INFO - 
[2024-01-06 20:42:07,964] {result_logger:108} INFO - precision on NREM: 0.956
[2024-01-06 20:42:08,887] {result_logger:109} INFO - recall on NREM: 0.958
[2024-01-06 20:42:09,800] {result_logger:112} INFO - F1-score on NREM: 0.957
[2024-01-06 20:42:09,800] {result_logger:113} INFO - 
[2024-01-06 20:42:11,067] {result_logger:108} INFO - precision on REM: 0.803
[2024-01-06 20:42:11,868] {result_logger:109} INFO - recall on REM: 0.964
[2024-01-06 20:42:12,673] {result_logger:112} INFO - F1-score on REM: 0.876
[2024-01-06 20:42:12,673] {result_logger:113} INFO - 
[2024-01-06 20:42:12,878] {result_logger:116} INFO - average precision on sleep stages: 0.916
[2024-01-06 20:42:13,083] {result_logger:118} INFO - average recall on sleep stages: 0.962
[2024-01-06 20:42:13,291] {result_logger:120} INFO - average F1-score on sleep stages: 0.937
[2024-01-06 20:42:13,863] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.962
[2024-01-06 20:42:13,892] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.962
[2024-01-06 20:42:13,896] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 20:42:14,073] {result_logger:108} INFO - precision on WAKE: 0.917
[2024-01-06 20:42:14,184] {result_logger:109} INFO - recall on WAKE: 0.919
[2024-01-06 20:42:14,295] {result_logger:112} INFO - F1-score on WAKE: 0.918
[2024-01-06 20:42:14,295] {result_logger:113} INFO - 
[2024-01-06 20:42:14,475] {result_logger:108} INFO - precision on NREM: 0.915
[2024-01-06 20:42:14,583] {result_logger:109} INFO - recall on NREM: 0.835
[2024-01-06 20:42:14,694] {result_logger:112} INFO - F1-score on NREM: 0.873
[2024-01-06 20:42:14,695] {result_logger:113} INFO - 
[2024-01-06 20:42:14,870] {result_logger:108} INFO - precision on REM: 0.587
[2024-01-06 20:42:14,981] {result_logger:109} INFO - recall on REM: 0.912
[2024-01-06 20:42:15,091] {result_logger:112} INFO - F1-score on REM: 0.714
[2024-01-06 20:42:15,091] {result_logger:113} INFO - 
[2024-01-06 20:42:15,113] {result_logger:116} INFO - average precision on sleep stages: 0.806
[2024-01-06 20:42:15,134] {result_logger:118} INFO - average recall on sleep stages: 0.889
[2024-01-06 20:42:15,155] {result_logger:120} INFO - average F1-score on sleep stages: 0.835
[2024-01-06 20:42:15,232] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.889
[2024-01-06 20:42:15,235] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.885
[2024-01-06 20:42:15,236] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 20:42:15,874] {result_logger:143} INFO - 
[[320547   9353   2154      1]
 [  3169 229039   6982      0]
 [   310   1082  37279      0]
 [  1927    230     31      0]]
[2024-01-06 20:42:16,502] {result_logger:150} INFO - 
[[ 96.53%   2.82%   0.65%   0.00%]
 [  1.32%  95.76%   2.92%   0.00%]
 [  0.80%   2.80%  96.40%   0.00%]
 [ 88.07%  10.51%   1.42%   0.00%]]
[2024-01-06 20:42:17,141] {result_logger:154} INFO - 
[[ 98.34%   3.90%   4.64% 100.00%]
 [  0.97%  95.55%  15.03%   0.00%]
 [  0.10%   0.45%  80.26%   0.00%]
 [  0.59%   0.10%   0.07%   0.00%]]
[2024-01-06 20:42:17,141] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 20:42:17,223] {result_logger:143} INFO - 
[[44402  2445  1472     0]
 [ 3819 29327  1959     0]
 [  180   292  4869     0]
 [  500   216   118     0]]
[2024-01-06 20:42:17,448] {result_logger:150} INFO - 
[[ 91.89%   5.06%   3.05%   0.00%]
 [ 10.88%  83.54%   5.58%   0.00%]
 [  3.37%   5.47%  91.16%   0.00%]
 [ 59.95%  25.90%  14.15%   0.00%]]
[2024-01-06 20:42:17,662] {result_logger:154} INFO - 
[[ 90.80%   7.57%  17.49%    nan%]
 [  7.81%  90.85%  23.27%    nan%]
 [  0.37%   0.90%  57.84%    nan%]
 [  1.02%   0.67%   1.40%    nan%]]
[2024-01-06 20:42:18,119] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 20:42:18,119] {result_logger:77} INFO - actual:
[2024-01-06 20:42:18,120] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 20:42:18,120] {result_logger:79} INFO - predicted:
[2024-01-06 20:42:18,120] {result_logger:80} INFO - 
[[94.86%  3.63%  1.51%  0.00%]
 [ 4.67% 92.52%  2.80%  0.00%]
 [11.91%  7.61% 80.47%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 20:42:18,159] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it2/model_8conv_2fc-best.pth
[2024-01-06 20:42:18,160] {run_experiment:113} INFO - [epoch  47] execution time: 197.54s	 avg f1-score: 0.8351

[2024-01-06 20:42:18,160] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 20:42:18,218] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 20:42:44,493] {train_model:86} INFO - Train Epoch: 48 [60928/612104 (10%)]	lr:1.72e-05	Loss: 0.333979
[2024-01-06 20:42:57,983] {train_model:86} INFO - Train Epoch: 48 [122112/612104 (20%)]	lr:1.72e-05	Loss: 0.140735
[2024-01-06 20:43:10,034] {train_model:86} INFO - Train Epoch: 48 [183296/612104 (30%)]	lr:1.72e-05	Loss: 0.072927
[2024-01-06 20:43:22,224] {train_model:86} INFO - Train Epoch: 48 [244480/612104 (40%)]	lr:1.72e-05	Loss: 0.086884
[2024-01-06 20:43:48,407] {train_model:86} INFO - Train Epoch: 48 [305664/612104 (50%)]	lr:1.72e-05	Loss: 0.050742
[2024-01-06 20:44:00,508] {train_model:86} INFO - Train Epoch: 48 [366848/612104 (60%)]	lr:1.72e-05	Loss: 0.083770
[2024-01-06 20:44:12,438] {train_model:86} INFO - Train Epoch: 48 [428032/612104 (70%)]	lr:1.72e-05	Loss: 0.101878
[2024-01-06 20:44:24,759] {train_model:86} INFO - Train Epoch: 48 [489216/612104 (80%)]	lr:1.72e-05	Loss: 0.039129
[2024-01-06 20:44:36,840] {train_model:86} INFO - Train Epoch: 48 [550400/612104 (90%)]	lr:1.72e-05	Loss: 0.068145
[2024-01-06 20:44:49,007] {train_model:86} INFO - Train Epoch: 48 [611584/612104 (100%)]	lr:1.72e-05	Loss: 0.080477
[2024-01-06 20:45:01,991] {run_experiment:78} INFO - 
[2024-01-06 20:45:01,998] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 20:45:03,280] {result_logger:108} INFO - precision on WAKE: 0.989
[2024-01-06 20:45:04,129] {result_logger:109} INFO - recall on WAKE: 0.966
[2024-01-06 20:45:04,971] {result_logger:112} INFO - F1-score on WAKE: 0.977
[2024-01-06 20:45:04,972] {result_logger:113} INFO - 
[2024-01-06 20:45:06,241] {result_logger:108} INFO - precision on NREM: 0.957
[2024-01-06 20:45:07,071] {result_logger:109} INFO - recall on NREM: 0.958
[2024-01-06 20:45:07,907] {result_logger:112} INFO - F1-score on NREM: 0.957
[2024-01-06 20:45:07,907] {result_logger:113} INFO - 
[2024-01-06 20:45:09,064] {result_logger:108} INFO - precision on REM: 0.809
[2024-01-06 20:45:09,786] {result_logger:109} INFO - recall on REM: 0.964
[2024-01-06 20:45:10,521] {result_logger:112} INFO - F1-score on REM: 0.880
[2024-01-06 20:45:10,521] {result_logger:113} INFO - 
[2024-01-06 20:45:10,708] {result_logger:116} INFO - average precision on sleep stages: 0.918
[2024-01-06 20:45:10,903] {result_logger:118} INFO - average recall on sleep stages: 0.963
[2024-01-06 20:45:11,104] {result_logger:120} INFO - average F1-score on sleep stages: 0.938
[2024-01-06 20:45:11,647] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.963
[2024-01-06 20:45:11,674] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.963
[2024-01-06 20:45:11,677] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 20:45:11,839] {result_logger:108} INFO - precision on WAKE: 0.903
[2024-01-06 20:45:11,940] {result_logger:109} INFO - recall on WAKE: 0.879
[2024-01-06 20:45:12,044] {result_logger:112} INFO - F1-score on WAKE: 0.890
[2024-01-06 20:45:12,044] {result_logger:113} INFO - 
[2024-01-06 20:45:12,213] {result_logger:108} INFO - precision on NREM: 0.916
[2024-01-06 20:45:12,313] {result_logger:109} INFO - recall on NREM: 0.813
[2024-01-06 20:45:12,413] {result_logger:112} INFO - F1-score on NREM: 0.861
[2024-01-06 20:45:12,414] {result_logger:113} INFO - 
[2024-01-06 20:45:12,582] {result_logger:108} INFO - precision on REM: 0.452
[2024-01-06 20:45:12,685] {result_logger:109} INFO - recall on REM: 0.893
[2024-01-06 20:45:12,787] {result_logger:112} INFO - F1-score on REM: 0.600
[2024-01-06 20:45:12,787] {result_logger:113} INFO - 
[2024-01-06 20:45:12,805] {result_logger:116} INFO - average precision on sleep stages: 0.757
[2024-01-06 20:45:12,823] {result_logger:118} INFO - average recall on sleep stages: 0.862
[2024-01-06 20:45:12,842] {result_logger:120} INFO - average F1-score on sleep stages: 0.784
[2024-01-06 20:45:12,916] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.862
[2024-01-06 20:45:12,919] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.854
[2024-01-06 20:45:12,919] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 20:45:13,506] {result_logger:143} INFO - 
[[320700   9334   2021      0]
 [  3197 229235   6757      1]
 [   305   1091  37275      0]
 [  1925    231     32      0]]
[2024-01-06 20:45:14,093] {result_logger:150} INFO - 
[[ 96.58%   2.81%   0.61%   0.00%]
 [  1.34%  95.84%   2.82%   0.00%]
 [  0.79%   2.82%  96.39%   0.00%]
 [ 87.98%  10.56%   1.46%   0.00%]]
[2024-01-06 20:45:14,683] {result_logger:154} INFO - 
[[ 98.34%   3.89%   4.39%   0.00%]
 [  0.98%  95.56%  14.66% 100.00%]
 [  0.09%   0.45%  80.88%   0.00%]
 [  0.59%   0.10%   0.07%   0.00%]]
[2024-01-06 20:45:14,683] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 20:45:14,762] {result_logger:143} INFO - 
[[42463  2313  3543     0]
 [ 4325 28537  2243     0]
 [  262   310  4769     0]
 [  371   184   279     0]]
[2024-01-06 20:45:14,975] {result_logger:150} INFO - 
[[ 87.88%   4.79%   7.33%   0.00%]
 [ 12.32%  81.29%   6.39%   0.00%]
 [  4.91%   5.80%  89.29%   0.00%]
 [ 44.48%  22.06%  33.45%   0.00%]]
[2024-01-06 20:45:15,177] {result_logger:154} INFO - 
[[ 89.54%   7.38%  32.70%    nan%]
 [  9.12%  91.04%  20.70%    nan%]
 [  0.55%   0.99%  44.02%    nan%]
 [  0.78%   0.59%   2.58%    nan%]]
[2024-01-06 20:45:15,603] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 20:45:15,603] {result_logger:77} INFO - actual:
[2024-01-06 20:45:15,603] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 20:45:15,603] {result_logger:79} INFO - predicted:
[2024-01-06 20:45:15,603] {result_logger:80} INFO - 
[[93.92%  3.45%  2.63%  0.00%]
 [ 4.50% 91.92%  3.58%  0.00%]
 [13.59%  8.27% 78.14%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 20:45:15,639] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it2/model_8conv_2fc-best.pth
[2024-01-06 20:45:15,639] {run_experiment:113} INFO - [epoch  48] execution time: 177.48s	 avg f1-score: 0.7839

[2024-01-06 20:45:15,639] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 20:45:15,694] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 20:45:39,327] {train_model:86} INFO - Train Epoch: 49 [60928/612104 (10%)]	lr:1.62e-05	Loss: 0.057142
[2024-01-06 20:45:51,549] {train_model:86} INFO - Train Epoch: 49 [122112/612104 (20%)]	lr:1.62e-05	Loss: 0.241563
[2024-01-06 20:46:03,602] {train_model:86} INFO - Train Epoch: 49 [183296/612104 (30%)]	lr:1.62e-05	Loss: 0.061755
[2024-01-06 20:46:15,958] {train_model:86} INFO - Train Epoch: 49 [244480/612104 (40%)]	lr:1.62e-05	Loss: 0.053667
[2024-01-06 20:46:28,644] {train_model:86} INFO - Train Epoch: 49 [305664/612104 (50%)]	lr:1.62e-05	Loss: 0.069214
[2024-01-06 20:46:41,170] {train_model:86} INFO - Train Epoch: 49 [366848/612104 (60%)]	lr:1.62e-05	Loss: 0.122005
[2024-01-06 20:46:52,821] {train_model:86} INFO - Train Epoch: 49 [428032/612104 (70%)]	lr:1.62e-05	Loss: 0.148447
[2024-01-06 20:47:04,556] {train_model:86} INFO - Train Epoch: 49 [489216/612104 (80%)]	lr:1.62e-05	Loss: 0.069512
[2024-01-06 20:47:16,583] {train_model:86} INFO - Train Epoch: 49 [550400/612104 (90%)]	lr:1.62e-05	Loss: 0.075923
[2024-01-06 20:47:28,520] {train_model:86} INFO - Train Epoch: 49 [611584/612104 (100%)]	lr:1.62e-05	Loss: 0.027128
[2024-01-06 20:47:41,424] {run_experiment:78} INFO - 
[2024-01-06 20:47:41,430] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 20:47:42,717] {result_logger:108} INFO - precision on WAKE: 0.989
[2024-01-06 20:47:43,490] {result_logger:109} INFO - recall on WAKE: 0.965
[2024-01-06 20:47:44,278] {result_logger:112} INFO - F1-score on WAKE: 0.977
[2024-01-06 20:47:44,278] {result_logger:113} INFO - 
[2024-01-06 20:47:45,433] {result_logger:108} INFO - precision on NREM: 0.956
[2024-01-06 20:47:46,187] {result_logger:109} INFO - recall on NREM: 0.958
[2024-01-06 20:47:46,960] {result_logger:112} INFO - F1-score on NREM: 0.957
[2024-01-06 20:47:46,960] {result_logger:113} INFO - 
[2024-01-06 20:47:48,054] {result_logger:108} INFO - precision on REM: 0.807
[2024-01-06 20:47:48,725] {result_logger:109} INFO - recall on REM: 0.964
[2024-01-06 20:47:49,399] {result_logger:112} INFO - F1-score on REM: 0.878
[2024-01-06 20:47:49,399] {result_logger:113} INFO - 
[2024-01-06 20:47:49,574] {result_logger:116} INFO - average precision on sleep stages: 0.917
[2024-01-06 20:47:49,743] {result_logger:118} INFO - average recall on sleep stages: 0.962
[2024-01-06 20:47:49,916] {result_logger:120} INFO - average F1-score on sleep stages: 0.937
[2024-01-06 20:47:50,412] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.962
[2024-01-06 20:47:50,437] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.962
[2024-01-06 20:47:50,441] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 20:47:50,592] {result_logger:108} INFO - precision on WAKE: 0.872
[2024-01-06 20:47:50,684] {result_logger:109} INFO - recall on WAKE: 0.950
[2024-01-06 20:47:50,776] {result_logger:112} INFO - F1-score on WAKE: 0.910
[2024-01-06 20:47:50,776] {result_logger:113} INFO - 
[2024-01-06 20:47:50,928] {result_logger:108} INFO - precision on NREM: 0.936
[2024-01-06 20:47:51,024] {result_logger:109} INFO - recall on NREM: 0.781
[2024-01-06 20:47:51,117] {result_logger:112} INFO - F1-score on NREM: 0.852
[2024-01-06 20:47:51,117] {result_logger:113} INFO - 
[2024-01-06 20:47:51,267] {result_logger:108} INFO - precision on REM: 0.669
[2024-01-06 20:47:51,358] {result_logger:109} INFO - recall on REM: 0.858
[2024-01-06 20:47:51,450] {result_logger:112} INFO - F1-score on REM: 0.752
[2024-01-06 20:47:51,450] {result_logger:113} INFO - 
[2024-01-06 20:47:51,467] {result_logger:116} INFO - average precision on sleep stages: 0.826
[2024-01-06 20:47:51,485] {result_logger:118} INFO - average recall on sleep stages: 0.863
[2024-01-06 20:47:51,502] {result_logger:120} INFO - average F1-score on sleep stages: 0.838
[2024-01-06 20:47:51,573] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.863
[2024-01-06 20:47:51,576] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.878
[2024-01-06 20:47:51,576] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 20:47:52,109] {result_logger:143} INFO - 
[[320572   9420   2060      3]
 [  3242 229070   6878      0]
 [   340   1059  37272      0]
 [  1920    235     33      0]]
[2024-01-06 20:47:52,656] {result_logger:150} INFO - 
[[ 96.54%   2.84%   0.62%   0.00%]
 [  1.36%  95.77%   2.88%   0.00%]
 [  0.88%   2.74%  96.38%   0.00%]
 [ 87.75%  10.74%   1.51%   0.00%]]
[2024-01-06 20:47:53,194] {result_logger:154} INFO - 
[[ 98.31%   3.93%   4.45% 100.00%]
 [  0.99%  95.53%  14.87%   0.00%]
 [  0.10%   0.44%  80.60%   0.00%]
 [  0.59%   0.10%   0.07%   0.00%]]
[2024-01-06 20:47:53,194] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 20:47:53,267] {result_logger:143} INFO - 
[[45905  1634   780     0]
 [ 6197 27420  1488     0]
 [  524   236  4581     0]
 [  655   106    73     0]]
[2024-01-06 20:47:53,458] {result_logger:150} INFO - 
[[ 95.00%   3.38%   1.61%   0.00%]
 [ 17.65%  78.11%   4.24%   0.00%]
 [  9.81%   4.42%  85.77%   0.00%]
 [ 78.54%  12.71%   8.75%   0.00%]]
[2024-01-06 20:47:53,634] {result_logger:154} INFO - 
[[ 86.16%   5.56%  11.27%    nan%]
 [ 11.63%  93.28%  21.50%    nan%]
 [  0.98%   0.80%  66.18%    nan%]
 [  1.23%   0.36%   1.05%    nan%]]
[2024-01-06 20:47:54,027] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 20:47:54,028] {result_logger:77} INFO - actual:
[2024-01-06 20:47:54,028] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 20:47:54,028] {result_logger:79} INFO - predicted:
[2024-01-06 20:47:54,028] {result_logger:80} INFO - 
[[95.92%  3.01%  1.07%  0.00%]
 [ 4.75% 93.13%  2.12%  0.00%]
 [11.25%  6.00% 82.75%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 20:47:54,064] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it2/model_8conv_2fc-best.pth
[2024-01-06 20:47:54,064] {run_experiment:113} INFO - [epoch  49] execution time: 158.43s	 avg f1-score: 0.8376

[2024-01-06 20:47:54,065] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 20:47:54,112] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 20:48:18,477] {train_model:86} INFO - Train Epoch: 50 [60928/612104 (10%)]	lr:1.53e-05	Loss: 0.064859
[2024-01-06 20:48:30,933] {train_model:86} INFO - Train Epoch: 50 [122112/612104 (20%)]	lr:1.53e-05	Loss: 0.054280
[2024-01-06 20:48:43,170] {train_model:86} INFO - Train Epoch: 50 [183296/612104 (30%)]	lr:1.53e-05	Loss: 0.091916
[2024-01-06 20:48:55,171] {train_model:86} INFO - Train Epoch: 50 [244480/612104 (40%)]	lr:1.53e-05	Loss: 0.301550
[2024-01-06 20:49:07,406] {train_model:86} INFO - Train Epoch: 50 [305664/612104 (50%)]	lr:1.53e-05	Loss: 0.132074
[2024-01-06 20:49:19,182] {train_model:86} INFO - Train Epoch: 50 [366848/612104 (60%)]	lr:1.53e-05	Loss: 0.054136
[2024-01-06 20:49:31,370] {train_model:86} INFO - Train Epoch: 50 [428032/612104 (70%)]	lr:1.53e-05	Loss: 0.077478
[2024-01-06 20:49:42,835] {train_model:86} INFO - Train Epoch: 50 [489216/612104 (80%)]	lr:1.53e-05	Loss: 0.070127
[2024-01-06 20:49:54,774] {train_model:86} INFO - Train Epoch: 50 [550400/612104 (90%)]	lr:1.53e-05	Loss: 0.071127
[2024-01-06 20:50:07,031] {train_model:86} INFO - Train Epoch: 50 [611584/612104 (100%)]	lr:1.53e-05	Loss: 0.063434
[2024-01-06 20:50:20,098] {run_experiment:78} INFO - 
[2024-01-06 20:50:20,104] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 20:50:21,388] {result_logger:108} INFO - precision on WAKE: 0.989
[2024-01-06 20:50:22,235] {result_logger:109} INFO - recall on WAKE: 0.966
[2024-01-06 20:50:23,070] {result_logger:112} INFO - F1-score on WAKE: 0.977
[2024-01-06 20:50:23,070] {result_logger:113} INFO - 
[2024-01-06 20:50:24,355] {result_logger:108} INFO - precision on NREM: 0.957
[2024-01-06 20:50:25,182] {result_logger:109} INFO - recall on NREM: 0.959
[2024-01-06 20:50:26,030] {result_logger:112} INFO - F1-score on NREM: 0.958
[2024-01-06 20:50:26,030] {result_logger:113} INFO - 
[2024-01-06 20:50:27,177] {result_logger:108} INFO - precision on REM: 0.810
[2024-01-06 20:50:27,887] {result_logger:109} INFO - recall on REM: 0.964
[2024-01-06 20:50:28,596] {result_logger:112} INFO - F1-score on REM: 0.880
[2024-01-06 20:50:28,596] {result_logger:113} INFO - 
[2024-01-06 20:50:28,785] {result_logger:116} INFO - average precision on sleep stages: 0.919
[2024-01-06 20:50:28,981] {result_logger:118} INFO - average recall on sleep stages: 0.963
[2024-01-06 20:50:29,171] {result_logger:120} INFO - average F1-score on sleep stages: 0.939
[2024-01-06 20:50:29,707] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.963
[2024-01-06 20:50:29,735] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.963
[2024-01-06 20:50:29,739] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 20:50:29,908] {result_logger:108} INFO - precision on WAKE: 0.868
[2024-01-06 20:50:30,010] {result_logger:109} INFO - recall on WAKE: 0.956
[2024-01-06 20:50:30,108] {result_logger:112} INFO - F1-score on WAKE: 0.910
[2024-01-06 20:50:30,108] {result_logger:113} INFO - 
[2024-01-06 20:50:30,281] {result_logger:108} INFO - precision on NREM: 0.937
[2024-01-06 20:50:30,381] {result_logger:109} INFO - recall on NREM: 0.773
[2024-01-06 20:50:30,487] {result_logger:112} INFO - F1-score on NREM: 0.847
[2024-01-06 20:50:30,487] {result_logger:113} INFO - 
[2024-01-06 20:50:30,657] {result_logger:108} INFO - precision on REM: 0.689
[2024-01-06 20:50:30,759] {result_logger:109} INFO - recall on REM: 0.848
[2024-01-06 20:50:30,860] {result_logger:112} INFO - F1-score on REM: 0.760
[2024-01-06 20:50:30,860] {result_logger:113} INFO - 
[2024-01-06 20:50:30,878] {result_logger:116} INFO - average precision on sleep stages: 0.831
[2024-01-06 20:50:30,896] {result_logger:118} INFO - average recall on sleep stages: 0.859
[2024-01-06 20:50:30,914] {result_logger:120} INFO - average F1-score on sleep stages: 0.839
[2024-01-06 20:50:30,985] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.859
[2024-01-06 20:50:30,988] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.877
[2024-01-06 20:50:30,988] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 20:50:31,581] {result_logger:143} INFO - 
[[320734   9214   2106      1]
 [  3266 229280   6644      0]
 [   336   1042  37293      0]
 [  1923    233     32      0]]
[2024-01-06 20:50:32,151] {result_logger:150} INFO - 
[[ 96.59%   2.77%   0.63%   0.00%]
 [  1.37%  95.86%   2.78%   0.00%]
 [  0.87%   2.69%  96.44%   0.00%]
 [ 87.89%  10.65%   1.46%   0.00%]]
[2024-01-06 20:50:32,714] {result_logger:154} INFO - 
[[ 98.31%   3.84%   4.57% 100.00%]
 [  1.00%  95.63%  14.42%   0.00%]
 [  0.10%   0.43%  80.94%   0.00%]
 [  0.59%   0.10%   0.07%   0.00%]]
[2024-01-06 20:50:32,715] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 20:50:32,790] {result_logger:143} INFO - 
[[46212  1574   533     0]
 [ 6441 27151  1513     0]
 [  565   248  4528     0]
 [  673   102    59     0]]
[2024-01-06 20:50:32,983] {result_logger:150} INFO - 
[[ 95.64%   3.26%   1.10%   0.00%]
 [ 18.35%  77.34%   4.31%   0.00%]
 [ 10.58%   4.64%  84.78%   0.00%]
 [ 80.70%  12.23%   7.07%   0.00%]]
[2024-01-06 20:50:33,167] {result_logger:154} INFO - 
[[ 85.75%   5.41%   8.04%    nan%]
 [ 11.95%  93.38%  22.81%    nan%]
 [  1.05%   0.85%  68.26%    nan%]
 [  1.25%   0.35%   0.89%    nan%]]
[2024-01-06 20:50:33,670] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 20:50:33,670] {result_logger:77} INFO - actual:
[2024-01-06 20:50:33,670] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 20:50:33,670] {result_logger:79} INFO - predicted:
[2024-01-06 20:50:33,670] {result_logger:80} INFO - 
[[95.99%  3.15%  0.86%  0.00%]
 [ 5.09% 92.66%  2.25%  0.00%]
 [10.30%  6.59% 83.11%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 20:50:33,706] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it2/model_8conv_2fc-best.pth
[2024-01-06 20:50:33,706] {run_experiment:113} INFO - [epoch  50] execution time: 159.64s	 avg f1-score: 0.8392

[2024-01-06 20:50:33,942] {result_logger:56} INFO - final F1-scores on train:
	WAKE                : [0.5026987242394505, 0.8448220280756369, 0.9145840853839691, 0.9453096096030742, 0.9612352501982034, 0.9652244852809004, 0.9671294349479578, 0.9685284231703427, 0.969491463095105, 0.97087304332918, 0.9713803039322052, 0.9719426001285072, 0.9723596684567392, 0.972859633560701, 0.9731474688187821, 0.9735596390273419, 0.9737310577409413, 0.9741528226009687, 0.974344965670692, 0.9748527367844517, 0.9748350760840857, 0.9751403686288513, 0.9752440033337709, 0.9750881312510592, 0.9753672626815326, 0.9758455727049938, 0.9758009039006837, 0.9757784095068447, 0.9758666737887934, 0.9761259611863786, 0.9760688168368118, 0.9763874184208038, 0.9762339925000838, 0.9762863152500026, 0.9763260998534393, 0.9763839090311531, 0.976558627831044, 0.9767571621967729, 0.976781056537388, 0.9769083576650682, 0.9767493623644883, 0.9768273771494181, 0.9770531382557947, 0.9770512599622171, 0.9768909484466938, 0.9770379154866029, 0.9771567839946591, 0.9773610033873925, 0.9770423752188707, 0.977265075237168]
	NREM                : [0.5795935402344158, 0.8012105724490108, 0.883311553539857, 0.9061978399086018, 0.9219517247647855, 0.9310912051088173, 0.9359445793518139, 0.9383255098567399, 0.9404029968586739, 0.9425765366132339, 0.9430357814176892, 0.9444360510986891, 0.9452312472445573, 0.9458096443344729, 0.947351653395765, 0.9478239709331353, 0.9484657049166589, 0.949152613491887, 0.9497361820637358, 0.9504355813553564, 0.9504592845888229, 0.9514847379245923, 0.9513329271637428, 0.9520185370080817, 0.9520737886592006, 0.9529787652790748, 0.9527389700877702, 0.9528530056601522, 0.9536410264992092, 0.9539936984547406, 0.9538503372901741, 0.9544535492275106, 0.954051464034181, 0.9549290769021712, 0.9548811975371878, 0.9552776099558692, 0.9559655647958544, 0.9557225351347057, 0.9562561370521259, 0.956043428031846, 0.9558786941113748, 0.956644928883809, 0.9562191406111126, 0.956730658744435, 0.9566978421025132, 0.9565506511756291, 0.9569927966172515, 0.9574396992795239, 0.956972379522036, 0.957875695074009]
	REM                 : [0.13612967166469517, 0.3771537310654376, 0.5364509274496333, 0.6533314391248757, 0.7175707668553782, 0.7502310217001072, 0.7710200643614609, 0.7835516707718464, 0.7932979319898413, 0.8010482203474165, 0.8040715853901936, 0.8114327805182919, 0.81446884405306, 0.816436457914264, 0.82483781278962, 0.826992038611606, 0.8319001701644924, 0.8319220376923337, 0.8373026278287636, 0.8400982464157194, 0.8412169106730922, 0.8462430133936257, 0.8452722721113433, 0.847967115612047, 0.8505665070007369, 0.8541461891601235, 0.8538913870632998, 0.8541565611068764, 0.8568193110779861, 0.8591068473493573, 0.8594032340267803, 0.8613618672522161, 0.859483287246474, 0.8650675360968794, 0.8659092233292548, 0.866438955013348, 0.8698702209750964, 0.8691608440632814, 0.8711827805553599, 0.8716379411419862, 0.8701808495724099, 0.8729690499602003, 0.8708923479642874, 0.8740126104587114, 0.8734414549545326, 0.8714257335499024, 0.8762663657946077, 0.8799159624191492, 0.8782177401303001, 0.8804447907075572]
	ARTIFACT            : [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
	avg                 : [0.40614064537952044, 0.6743954438633617, 0.7781155221244864, 0.834946296212184, 0.866919247272789, 0.8821822373632751, 0.8913646928870774, 0.8968018679329764, 0.9010641306478734, 0.9048326000966102, 0.9061625569133627, 0.9092704772484961, 0.9106865865847854, 0.9117019119364794, 0.9151123116680556, 0.9161252161906944, 0.9180323109406975, 0.9184091579283965, 0.9204612585210638, 0.9217955215185092, 0.9221704237820002, 0.9242893733156898, 0.9239497342029525, 0.9250245946237293, 0.9260025194471567, 0.9276568423813973, 0.9274770870172512, 0.9275959920912911, 0.9287756704553297, 0.9297421689968255, 0.9297741293845888, 0.9307342783001769, 0.9299229145935796, 0.9320943094163511, 0.9323721735732939, 0.9327001580001234, 0.934131471200665, 0.93388018046492, 0.9347399913816247, 0.9348632422796336, 0.9342696353494243, 0.9354804519978092, 0.9347215422770648, 0.9359315097217878, 0.9356767485012464, 0.9350047667373782, 0.9368053154688395, 0.9382388883620219, 0.9374108316237355, 0.938528520339578]
[2024-01-06 20:50:33,943] {result_logger:56} INFO - final F1-scores on valid:
	WAKE                : [0.5050059678438531, 0.833541862162444, 0.705069460658417, 0.7690920766646907, 0.6689663375758296, 0.8916723631830794, 0.9015413411769201, 0.8485304266275017, 0.9200370785968678, 0.8535987584952105, 0.8552769116687959, 0.8605421781803263, 0.9001887851420992, 0.8307256620598458, 0.8033963385367859, 0.8669062282754503, 0.9167463741240313, 0.8859874617705931, 0.919865704411866, 0.9279691987770102, 0.8543272211887677, 0.8422435222474302, 0.8705834353325174, 0.8857909549054257, 0.9296659003676211, 0.8932289286330906, 0.9052936596327652, 0.8790244832664131, 0.874442528090461, 0.8631862523282857, 0.8274864703024553, 0.9237714808804561, 0.8954470088239218, 0.8722761893664128, 0.9097551836122908, 0.9077247355478357, 0.9103087367655378, 0.8971297573726958, 0.906400431512635, 0.9188113637962396, 0.8644889312119494, 0.90934805508954, 0.9159734458878006, 0.9174515454932605, 0.912579160602604, 0.9121331459895905, 0.918155500413565, 0.8904990091119755, 0.9095051760859875, 0.9102494657120065]
	NREM                : [0.6573126874988354, 0.6841754333975404, 0.001309422146313692, 0.7785559615644877, 0.8401343140390151, 0.8229449991042199, 0.8567356758661905, 0.7641834455774658, 0.8661380741474897, 0.8509988508099429, 0.7435671794149742, 0.8552664420316985, 0.7530332139086486, 0.9000420539741005, 0.849688264541078, 0.7755440414507773, 0.8649847518713611, 0.8458539932017338, 0.8617395363311032, 0.8939857588418761, 0.8683812405446293, 0.8572277698525916, 0.8404831843671949, 0.8024821410935905, 0.8805191726426835, 0.8513084112149534, 0.8439450686641697, 0.8666420827494652, 0.8319841244842033, 0.8510902459843253, 0.8814645308924486, 0.8836580166139821, 0.8072212940584905, 0.861385538517486, 0.8774409466465464, 0.8424952717576659, 0.8533894172153134, 0.8700945395518014, 0.8618754277891855, 0.8549446829463447, 0.860715155945419, 0.8423985768486013, 0.8675550801503469, 0.8584206372541434, 0.8436465967776849, 0.8430641693861454, 0.8732302103649004, 0.861299328453935, 0.8516189145119962, 0.8474359374512314]
	REM                 : [0.16412946386148963, 0.4690977977740942, 0.0, 0.28417285401420866, 0.2696366364075572, 0.5992194536175323, 0.5048286810424659, 0.36511938306391817, 0.7160729634227867, 0.49611121913280193, 0.586038036670083, 0.522188946365369, 0.4616233109660815, 0.4463188857167575, 0.36911770220105744, 0.5210854885972735, 0.7463039621525724, 0.6391133070708419, 0.7659283331907978, 0.7348417747000564, 0.4680655677487488, 0.48743857324278067, 0.547981552846042, 0.6940853099867658, 0.7698981850376272, 0.6412860698190623, 0.7450162649095003, 0.6225234619395204, 0.5724967287681476, 0.5290015497011291, 0.4447054401954336, 0.7364566987969813, 0.7137240559568437, 0.5617741464838051, 0.6732291594961107, 0.7366325369738339, 0.751585460170147, 0.6471152528436344, 0.6998373502883336, 0.7420196439533455, 0.5104047813094268, 0.7717892903787548, 0.7522804790989133, 0.7746691238063326, 0.7606592619132926, 0.7528575057150113, 0.7138772817242138, 0.6000251635631606, 0.7515996718621821, 0.7600503566932438]
	ARTIFACT            : [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
	avg                 : [0.4421493730680594, 0.6622716977780262, 0.2354596276015769, 0.610606964081129, 0.5929124293408007, 0.7712789386349438, 0.7543685660285254, 0.6592777517562952, 0.834082705389048, 0.7335696094793184, 0.7282940425846176, 0.7459991888591313, 0.7049484366722765, 0.7256955339169012, 0.6740674350929737, 0.7211785861078338, 0.8426783627159883, 0.7903182540143896, 0.8491778579779222, 0.8522655774396476, 0.730258009827382, 0.7289699551142675, 0.7530160575152514, 0.7941194686619273, 0.8600277526826439, 0.7952744698890354, 0.8314183310688117, 0.7893966759851329, 0.7596411271142706, 0.7477593493379134, 0.7178854804634458, 0.8479620654304733, 0.8054641196130854, 0.7651452914559013, 0.8201417632516493, 0.8289508480931119, 0.838427871383666, 0.8047798499227105, 0.822704403196718, 0.8385918968986433, 0.7452029561555985, 0.8411786407722986, 0.8452696683790203, 0.8501804355179122, 0.8389616730978604, 0.8360182736969156, 0.8350876641675598, 0.7839411670430237, 0.837574587486722, 0.8392452532854939]
[2024-01-06 20:50:34,062] {logger:50} INFO - 
[2024-01-06 20:50:34,062] {logger:51} INFO - ================================================================================
[2024-01-06 20:50:34,062] {logger:52} INFO - finished training
[2024-01-06 20:50:34,062] {logger:53} INFO - ================================================================================
[2024-01-06 20:50:34,062] {logger:54} INFO - 
[2024-01-06 20:50:34,062] {logger:50} INFO - 
[2024-01-06 20:50:34,062] {logger:51} INFO - ================================================================================
[2024-01-06 20:50:34,062] {logger:52} INFO - best model on epoch: 50 	f1-score: 0.8392
[2024-01-06 20:50:34,063] {logger:53} INFO - ================================================================================
[2024-01-06 20:50:34,063] {logger:54} INFO - 
