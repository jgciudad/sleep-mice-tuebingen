[2024-01-06 17:46:12,417] {logger:50} INFO - 
[2024-01-06 17:46:12,417] {logger:51} INFO - ================================================================================
[2024-01-06 17:46:12,417] {logger:52} INFO - start training with model: model_8conv_2fc
[2024-01-06 17:46:12,417] {logger:53} INFO - ================================================================================
[2024-01-06 17:46:12,417] {logger:54} INFO - 
[2024-01-06 17:46:44,986] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 17:46:45,054] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 17:47:00,035] {dataloader:107} INFO - data distribution in database for dataset valid:
	WAKE                : 48319
	NREM                : 35104
	REM                 : 5341
	ARTIFACT            : 835
[2024-01-06 17:47:00,051] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 48319
	NREM                : 35104
	REM                 : 5341
	ARTIFACT            : 835
[2024-01-06 17:47:01,394] {run_experiment:47} INFO - classifier:
Model(
  (feature_extractor): Sequential(
    (0): BatchNorm1d(3, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (1): Conv1d(3, 96, kernel_size=(5,), stride=(1,))
    (2): ReLU(inplace=True)
    (3): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (4): Dropout(p=0.0, inplace=False)
    (5): Conv1d(96, 96, kernel_size=(5,), stride=(2,))
    (6): ReLU(inplace=True)
    (7): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (8): Dropout(p=0.2, inplace=False)
    (9): Conv1d(96, 96, kernel_size=(5,), stride=(1,))
    (10): ReLU(inplace=True)
    (11): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (12): Dropout(p=0.0, inplace=False)
    (13): Conv1d(96, 96, kernel_size=(5,), stride=(2,))
    (14): ReLU(inplace=True)
    (15): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (16): Dropout(p=0.2, inplace=False)
    (17): Conv1d(96, 96, kernel_size=(5,), stride=(1,))
    (18): ReLU(inplace=True)
    (19): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (20): Dropout(p=0.0, inplace=False)
    (21): Conv1d(96, 96, kernel_size=(5,), stride=(2,))
    (22): ReLU(inplace=True)
    (23): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (24): Dropout(p=0.2, inplace=False)
    (25): Conv1d(96, 96, kernel_size=(5,), stride=(1,))
    (26): ReLU(inplace=True)
    (27): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (28): Dropout(p=0.0, inplace=False)
    (29): Conv1d(96, 96, kernel_size=(5,), stride=(2,))
    (30): ReLU(inplace=True)
    (31): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (32): Dropout(p=0.2, inplace=False)
  )
  (classifier): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=3936, out_features=80, bias=True)
    (2): ReLU(inplace=True)
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=80, out_features=4, bias=True)
  )
)
[2024-01-06 17:47:27,644] {train_model:86} INFO - Train Epoch: 1 [60928/612104 (10%)]	lr:2.56e-05	Loss: 28.870613
[2024-01-06 17:47:39,164] {train_model:86} INFO - Train Epoch: 1 [122112/612104 (20%)]	lr:2.56e-05	Loss: 26.499416
[2024-01-06 17:47:50,886] {train_model:86} INFO - Train Epoch: 1 [183296/612104 (30%)]	lr:2.56e-05	Loss: 33.327202
[2024-01-06 17:48:03,385] {train_model:86} INFO - Train Epoch: 1 [244480/612104 (40%)]	lr:2.56e-05	Loss: 59.242802
[2024-01-06 17:48:15,713] {train_model:86} INFO - Train Epoch: 1 [305664/612104 (50%)]	lr:2.56e-05	Loss: 10.174158
[2024-01-06 17:48:28,109] {train_model:86} INFO - Train Epoch: 1 [366848/612104 (60%)]	lr:2.56e-05	Loss: 21.165186
[2024-01-06 17:48:40,232] {train_model:86} INFO - Train Epoch: 1 [428032/612104 (70%)]	lr:2.56e-05	Loss: 10.930544
[2024-01-06 17:49:07,050] {train_model:86} INFO - Train Epoch: 1 [489216/612104 (80%)]	lr:2.56e-05	Loss: 12.670002
[2024-01-06 17:49:33,019] {train_model:86} INFO - Train Epoch: 1 [550400/612104 (90%)]	lr:2.56e-05	Loss: 10.342737
[2024-01-06 17:49:44,967] {train_model:86} INFO - Train Epoch: 1 [611584/612104 (100%)]	lr:2.56e-05	Loss: 7.444222
[2024-01-06 17:49:58,348] {run_experiment:78} INFO - 
[2024-01-06 17:49:58,355] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 17:49:59,700] {result_logger:108} INFO - precision on WAKE: 0.653
[2024-01-06 17:50:00,582] {result_logger:109} INFO - recall on WAKE: 0.382
[2024-01-06 17:50:01,472] {result_logger:112} INFO - F1-score on WAKE: 0.482
[2024-01-06 17:50:01,472] {result_logger:113} INFO - 
[2024-01-06 17:50:02,879] {result_logger:108} INFO - precision on NREM: 0.622
[2024-01-06 17:50:03,793] {result_logger:109} INFO - recall on NREM: 0.531
[2024-01-06 17:50:04,718] {result_logger:112} INFO - F1-score on NREM: 0.573
[2024-01-06 17:50:04,718] {result_logger:113} INFO - 
[2024-01-06 17:50:06,067] {result_logger:108} INFO - precision on REM: 0.086
[2024-01-06 17:50:06,913] {result_logger:109} INFO - recall on REM: 0.327
[2024-01-06 17:50:07,761] {result_logger:112} INFO - F1-score on REM: 0.136
[2024-01-06 17:50:07,761] {result_logger:113} INFO - 
[2024-01-06 17:50:07,985] {result_logger:116} INFO - average precision on sleep stages: 0.454
[2024-01-06 17:50:08,209] {result_logger:118} INFO - average recall on sleep stages: 0.413
[2024-01-06 17:50:08,434] {result_logger:120} INFO - average F1-score on sleep stages: 0.397
[2024-01-06 17:50:09,017] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.413
[2024-01-06 17:50:09,048] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.437
[2024-01-06 17:50:09,053] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 17:50:09,227] {result_logger:108} INFO - precision on WAKE: 0.292
[2024-01-06 17:50:09,336] {result_logger:109} INFO - recall on WAKE: 0.029
[2024-01-06 17:50:09,446] {result_logger:112} INFO - F1-score on WAKE: 0.053
[2024-01-06 17:50:09,446] {result_logger:113} INFO - 
[2024-01-06 17:50:09,621] {result_logger:108} INFO - precision on NREM: 0.945
[2024-01-06 17:50:09,731] {result_logger:109} INFO - recall on NREM: 0.429
[2024-01-06 17:50:09,841] {result_logger:112} INFO - F1-score on NREM: 0.590
[2024-01-06 17:50:09,841] {result_logger:113} INFO - 
[2024-01-06 17:50:10,015] {result_logger:108} INFO - precision on REM: 0.077
[2024-01-06 17:50:10,126] {result_logger:109} INFO - recall on REM: 0.986
[2024-01-06 17:50:10,238] {result_logger:112} INFO - F1-score on REM: 0.144
[2024-01-06 17:50:10,238] {result_logger:113} INFO - 
[2024-01-06 17:50:10,259] {result_logger:116} INFO - average precision on sleep stages: 0.438
[2024-01-06 17:50:10,280] {result_logger:118} INFO - average recall on sleep stages: 0.481
[2024-01-06 17:50:10,301] {result_logger:120} INFO - average F1-score on sleep stages: 0.262
[2024-01-06 17:50:10,375] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.481
[2024-01-06 17:50:10,378] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.245
[2024-01-06 17:50:10,379] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 17:50:11,007] {result_logger:143} INFO - 
[[127002  69192 104310  31551]
 [ 53016 126918  30096  29160]
 [ 14432   8013  12631   3595]
 [   639    881    286    382]]
[2024-01-06 17:50:11,622] {result_logger:150} INFO - 
[[ 38.25%  20.84%  31.41%   9.50%]
 [ 22.16%  53.06%  12.58%  12.19%]
 [ 37.32%  20.72%  32.66%   9.30%]
 [ 29.20%  40.27%  13.07%  17.46%]]
[2024-01-06 17:50:12,264] {result_logger:154} INFO - 
[[ 65.10%  33.75%  70.80%  48.77%]
 [ 27.18%  61.91%  20.43%  45.08%]
 [  7.40%   3.91%   8.57%   5.56%]
 [  0.33%   0.43%   0.19%   0.59%]]
[2024-01-06 17:50:12,264] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 17:50:12,346] {result_logger:143} INFO - 
[[ 1414   864 46014    27]
 [ 3376 15047 16681     1]
 [   59    18  5264     0]
 [  300   150   351    33]]
[2024-01-06 17:50:12,591] {result_logger:150} INFO - 
[[  2.93%   1.79%  95.23%   0.06%]
 [  9.62%  42.86%  47.52%   0.00%]
 [  1.10%   0.34%  98.56%   0.00%]
 [ 35.97%  17.99%  42.09%   3.96%]]
[2024-01-06 17:50:12,803] {result_logger:154} INFO - 
[[ 27.46%   5.37%  67.36%  44.26%]
 [ 65.57%  93.58%  24.42%   1.64%]
 [  1.15%   0.11%   7.71%   0.00%]
 [  5.83%   0.93%   0.51%  54.10%]]
[2024-01-06 17:50:13,315] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 17:50:13,315] {result_logger:77} INFO - actual:
[2024-01-06 17:50:13,315] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 17:50:13,315] {result_logger:79} INFO - predicted:
[2024-01-06 17:50:13,315] {result_logger:80} INFO - 
[[17.83% 22.86% 58.90%  0.41%]
 [ 7.99% 71.64% 20.31%  0.06%]
 [ 4.27%  4.92% 90.76%  0.04%]
 [47.54% 32.79% 18.03%  1.64%]]
[2024-01-06 17:50:13,356] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it1/model_8conv_2fc-best.pth
[2024-01-06 17:50:13,356] {run_experiment:113} INFO - [epoch   1] execution time: 191.96s	 avg f1-score: 0.2622

[2024-01-06 17:50:13,356] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 17:50:13,415] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 17:50:48,162] {train_model:86} INFO - Train Epoch: 2 [60928/612104 (10%)]	lr:1.41e-04	Loss: 9.289818
[2024-01-06 17:51:00,445] {train_model:86} INFO - Train Epoch: 2 [122112/612104 (20%)]	lr:1.41e-04	Loss: 4.073687
[2024-01-06 17:51:12,179] {train_model:86} INFO - Train Epoch: 2 [183296/612104 (30%)]	lr:1.41e-04	Loss: 6.774325
[2024-01-06 17:51:23,985] {train_model:86} INFO - Train Epoch: 2 [244480/612104 (40%)]	lr:1.41e-04	Loss: 11.857091
[2024-01-06 17:51:36,387] {train_model:86} INFO - Train Epoch: 2 [305664/612104 (50%)]	lr:1.41e-04	Loss: 1.907114
[2024-01-06 17:51:49,507] {train_model:86} INFO - Train Epoch: 2 [366848/612104 (60%)]	lr:1.41e-04	Loss: 2.093151
[2024-01-06 17:52:02,190] {train_model:86} INFO - Train Epoch: 2 [428032/612104 (70%)]	lr:1.41e-04	Loss: 2.532772
[2024-01-06 17:52:30,096] {train_model:86} INFO - Train Epoch: 2 [489216/612104 (80%)]	lr:1.41e-04	Loss: 1.727029
[2024-01-06 17:52:55,950] {train_model:86} INFO - Train Epoch: 2 [550400/612104 (90%)]	lr:1.41e-04	Loss: 0.323688
[2024-01-06 17:53:07,895] {train_model:86} INFO - Train Epoch: 2 [611584/612104 (100%)]	lr:1.41e-04	Loss: 0.456998
[2024-01-06 17:53:20,666] {run_experiment:78} INFO - 
[2024-01-06 17:53:20,672] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 17:53:22,100] {result_logger:108} INFO - precision on WAKE: 0.875
[2024-01-06 17:53:23,004] {result_logger:109} INFO - recall on WAKE: 0.643
[2024-01-06 17:53:23,925] {result_logger:112} INFO - F1-score on WAKE: 0.742
[2024-01-06 17:53:23,925] {result_logger:113} INFO - 
[2024-01-06 17:53:25,346] {result_logger:108} INFO - precision on NREM: 0.813
[2024-01-06 17:53:26,259] {result_logger:109} INFO - recall on NREM: 0.751
[2024-01-06 17:53:27,188] {result_logger:112} INFO - F1-score on NREM: 0.781
[2024-01-06 17:53:27,189] {result_logger:113} INFO - 
[2024-01-06 17:53:28,521] {result_logger:108} INFO - precision on REM: 0.163
[2024-01-06 17:53:29,332] {result_logger:109} INFO - recall on REM: 0.600
[2024-01-06 17:53:30,155] {result_logger:112} INFO - F1-score on REM: 0.256
[2024-01-06 17:53:30,155] {result_logger:113} INFO - 
[2024-01-06 17:53:30,369] {result_logger:116} INFO - average precision on sleep stages: 0.617
[2024-01-06 17:53:30,583] {result_logger:118} INFO - average recall on sleep stages: 0.665
[2024-01-06 17:53:30,790] {result_logger:120} INFO - average F1-score on sleep stages: 0.593
[2024-01-06 17:53:31,360] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.665
[2024-01-06 17:53:31,388] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.683
[2024-01-06 17:53:31,391] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 17:53:31,560] {result_logger:108} INFO - precision on WAKE: 0.619
[2024-01-06 17:53:31,671] {result_logger:109} INFO - recall on WAKE: 0.995
[2024-01-06 17:53:31,781] {result_logger:112} INFO - F1-score on WAKE: 0.763
[2024-01-06 17:53:31,781] {result_logger:113} INFO - 
[2024-01-06 17:53:31,957] {result_logger:108} INFO - precision on NREM: 0.950
[2024-01-06 17:53:32,068] {result_logger:109} INFO - recall on NREM: 0.081
[2024-01-06 17:53:32,177] {result_logger:112} INFO - F1-score on NREM: 0.149
[2024-01-06 17:53:32,177] {result_logger:113} INFO - 
[2024-01-06 17:53:32,351] {result_logger:108} INFO - precision on REM: 0.254
[2024-01-06 17:53:32,462] {result_logger:109} INFO - recall on REM: 0.382
[2024-01-06 17:53:32,570] {result_logger:112} INFO - F1-score on REM: 0.305
[2024-01-06 17:53:32,570] {result_logger:113} INFO - 
[2024-01-06 17:53:32,591] {result_logger:116} INFO - average precision on sleep stages: 0.607
[2024-01-06 17:53:32,611] {result_logger:118} INFO - average recall on sleep stages: 0.486
[2024-01-06 17:53:32,631] {result_logger:120} INFO - average F1-score on sleep stages: 0.406
[2024-01-06 17:53:32,709] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.486
[2024-01-06 17:53:32,712] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.597
[2024-01-06 17:53:32,713] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 17:53:33,335] {result_logger:143} INFO - 
[[213599  34997  81920   1539]
 [ 21333 179737  37291    829]
 [  9077   6283  23188    123]
 [  1013    700    437     38]]
[2024-01-06 17:53:33,944] {result_logger:150} INFO - 
[[ 64.33%  10.54%  24.67%   0.46%]
 [  8.92%  75.14%  15.59%   0.35%]
 [ 23.47%  16.25%  59.96%   0.32%]
 [ 46.30%  31.99%  19.97%   1.74%]]
[2024-01-06 17:53:34,541] {result_logger:154} INFO - 
[[ 87.18%  15.78%  57.35%  60.85%]
 [  8.71%  81.07%  26.11%  32.78%]
 [  3.70%   2.83%  16.23%   4.86%]
 [  0.41%   0.32%   0.31%   1.50%]]
[2024-01-06 17:53:34,541] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 17:53:34,628] {result_logger:143} INFO - 
[[48070   147   102     0]
 [26355  2841  5909     0]
 [ 3295     4  2042     0]
 [  820     6     8     0]]
[2024-01-06 17:53:34,892] {result_logger:150} INFO - 
[[ 99.48%   0.30%   0.21%   0.00%]
 [ 75.07%   8.09%  16.83%   0.00%]
 [ 61.69%   0.07%  38.23%   0.00%]
 [ 98.32%   0.72%   0.96%   0.00%]]
[2024-01-06 17:53:35,153] {result_logger:154} INFO - 
[[ 61.20%   4.90%   1.27%    nan%]
 [ 33.56%  94.76%  73.30%    nan%]
 [  4.20%   0.13%  25.33%    nan%]
 [  1.04%   0.20%   0.10%    nan%]]
[2024-01-06 17:53:35,665] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 17:53:35,665] {result_logger:77} INFO - actual:
[2024-01-06 17:53:35,666] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 17:53:35,666] {result_logger:79} INFO - predicted:
[2024-01-06 17:53:35,666] {result_logger:80} INFO - 
[[94.98%  1.16%  3.86%  0.00%]
 [22.68% 55.20% 22.11%  0.00%]
 [40.48%  5.37% 54.15%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 17:53:35,724] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it1/model_8conv_2fc-best.pth
[2024-01-06 17:53:35,724] {run_experiment:113} INFO - [epoch   2] execution time: 202.37s	 avg f1-score: 0.4056

[2024-01-06 17:53:35,724] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 17:53:35,786] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 17:54:03,122] {train_model:86} INFO - Train Epoch: 3 [60928/612104 (10%)]	lr:2.56e-04	Loss: 0.388930
[2024-01-06 17:54:29,520] {train_model:86} INFO - Train Epoch: 3 [122112/612104 (20%)]	lr:2.56e-04	Loss: 0.287078
[2024-01-06 17:54:41,886] {train_model:86} INFO - Train Epoch: 3 [183296/612104 (30%)]	lr:2.56e-04	Loss: 1.012434
[2024-01-06 17:54:54,303] {train_model:86} INFO - Train Epoch: 3 [244480/612104 (40%)]	lr:2.56e-04	Loss: 0.518479
[2024-01-06 17:55:06,921] {train_model:86} INFO - Train Epoch: 3 [305664/612104 (50%)]	lr:2.56e-04	Loss: 0.236995
[2024-01-06 17:55:19,390] {train_model:86} INFO - Train Epoch: 3 [366848/612104 (60%)]	lr:2.56e-04	Loss: 4.849968
[2024-01-06 17:55:41,399] {train_model:86} INFO - Train Epoch: 3 [428032/612104 (70%)]	lr:2.56e-04	Loss: 0.815125
[2024-01-06 17:56:13,056] {train_model:86} INFO - Train Epoch: 3 [489216/612104 (80%)]	lr:2.56e-04	Loss: 0.337529
[2024-01-06 17:56:25,895] {train_model:86} INFO - Train Epoch: 3 [550400/612104 (90%)]	lr:2.56e-04	Loss: 0.344209
[2024-01-06 17:56:37,456] {train_model:86} INFO - Train Epoch: 3 [611584/612104 (100%)]	lr:2.56e-04	Loss: 0.346909
[2024-01-06 17:56:50,775] {run_experiment:78} INFO - 
[2024-01-06 17:56:50,783] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 17:56:52,268] {result_logger:108} INFO - precision on WAKE: 0.956
[2024-01-06 17:56:53,242] {result_logger:109} INFO - recall on WAKE: 0.867
[2024-01-06 17:56:54,220] {result_logger:112} INFO - F1-score on WAKE: 0.909
[2024-01-06 17:56:54,220] {result_logger:113} INFO - 
[2024-01-06 17:56:55,772] {result_logger:108} INFO - precision on NREM: 0.893
[2024-01-06 17:56:56,741] {result_logger:109} INFO - recall on NREM: 0.853
[2024-01-06 17:56:57,660] {result_logger:112} INFO - F1-score on NREM: 0.872
[2024-01-06 17:56:57,661] {result_logger:113} INFO - 
[2024-01-06 17:56:58,976] {result_logger:108} INFO - precision on REM: 0.394
[2024-01-06 17:56:59,803] {result_logger:109} INFO - recall on REM: 0.817
[2024-01-06 17:57:00,633] {result_logger:112} INFO - F1-score on REM: 0.532
[2024-01-06 17:57:00,634] {result_logger:113} INFO - 
[2024-01-06 17:57:00,855] {result_logger:116} INFO - average precision on sleep stages: 0.748
[2024-01-06 17:57:01,073] {result_logger:118} INFO - average recall on sleep stages: 0.845
[2024-01-06 17:57:01,293] {result_logger:120} INFO - average F1-score on sleep stages: 0.771
[2024-01-06 17:57:01,894] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.845
[2024-01-06 17:57:01,924] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.858
[2024-01-06 17:57:01,928] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 17:57:02,111] {result_logger:108} INFO - precision on WAKE: 0.550
[2024-01-06 17:57:02,222] {result_logger:109} INFO - recall on WAKE: 0.999
[2024-01-06 17:57:02,335] {result_logger:112} INFO - F1-score on WAKE: 0.709
[2024-01-06 17:57:02,335] {result_logger:113} INFO - 
[2024-01-06 17:57:02,523] {result_logger:108} INFO - precision on NREM: 0.948
[2024-01-06 17:57:02,633] {result_logger:109} INFO - recall on NREM: 0.026
[2024-01-06 17:57:02,744] {result_logger:112} INFO - F1-score on NREM: 0.050
[2024-01-06 17:57:02,744] {result_logger:113} INFO - 
[2024-01-06 17:57:02,928] {result_logger:108} INFO - precision on REM: 0.000
[2024-01-06 17:57:03,039] {result_logger:109} INFO - recall on REM: 0.000
[2024-01-06 17:57:03,151] {result_logger:112} INFO - F1-score on REM: 0.000
[2024-01-06 17:57:03,151] {result_logger:113} INFO - 
[2024-01-06 17:57:03,171] {result_logger:116} INFO - average precision on sleep stages: 0.499
[2024-01-06 17:57:03,190] {result_logger:118} INFO - average recall on sleep stages: 0.342
[2024-01-06 17:57:03,209] {result_logger:120} INFO - average F1-score on sleep stages: 0.253
[2024-01-06 17:57:03,290] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.342
[2024-01-06 17:57:03,293] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.554
[2024-01-06 17:57:03,293] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 17:57:03,954] {result_logger:143} INFO - 
[[287883  20134  23929    109]
 [ 10548 203946  24542    154]
 [  2750   4325  31579     17]
 [  1476    543    161      8]]
[2024-01-06 17:57:04,612] {result_logger:150} INFO - 
[[ 86.70%   6.06%   7.21%   0.03%]
 [  4.41%  85.27%  10.26%   0.06%]
 [  7.11%  11.18%  81.66%   0.04%]
 [ 67.46%  24.82%   7.36%   0.37%]]
[2024-01-06 17:57:05,264] {result_logger:154} INFO - 
[[ 95.12%   8.79%  29.83%  37.85%]
 [  3.49%  89.08%  30.60%  53.47%]
 [  0.91%   1.89%  39.37%   5.90%]
 [  0.49%   0.24%   0.20%   2.78%]]
[2024-01-06 17:57:05,264] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 17:57:05,349] {result_logger:143} INFO - 
[[48268    50     1     0]
 [34195   910     0     0]
 [ 5341     0     0     0]
 [  834     0     0     0]]
[2024-01-06 17:57:05,565] {result_logger:150} INFO - 
[[ 99.89%   0.10%   0.00%   0.00%]
 [ 97.41%   2.59%   0.00%   0.00%]
 [100.00%   0.00%   0.00%   0.00%]
 [100.00%   0.00%   0.00%   0.00%]]
[2024-01-06 17:57:05,778] {result_logger:154} INFO - 
[[ 54.46%   5.21% 100.00%    nan%]
 [ 38.58%  94.79%   0.00%    nan%]
 [  6.03%   0.00%   0.00%    nan%]
 [  0.94%   0.00%   0.00%    nan%]]
[2024-01-06 17:57:06,239] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 17:57:06,239] {result_logger:77} INFO - actual:
[2024-01-06 17:57:06,239] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 17:57:06,239] {result_logger:79} INFO - predicted:
[2024-01-06 17:57:06,240] {result_logger:80} INFO - 
[[99.50%  0.50%  0.00%  0.00%]
 [45.83% 54.17%  0.00%  0.00%]
 [100.00%  0.00%  0.00%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 17:57:06,279] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it1/model_8conv_2fc-best.pth
[2024-01-06 17:57:06,279] {run_experiment:113} INFO - [epoch   3] execution time: 210.55s	 avg f1-score: 0.2532

[2024-01-06 17:57:06,279] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 17:57:06,341] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 17:57:48,259] {train_model:86} INFO - Train Epoch: 4 [60928/612104 (10%)]	lr:2.41e-04	Loss: 0.560646
[2024-01-06 17:58:13,644] {train_model:86} INFO - Train Epoch: 4 [122112/612104 (20%)]	lr:2.41e-04	Loss: 0.242892
[2024-01-06 17:58:26,624] {train_model:86} INFO - Train Epoch: 4 [183296/612104 (30%)]	lr:2.41e-04	Loss: 0.301621
[2024-01-06 17:58:38,689] {train_model:86} INFO - Train Epoch: 4 [244480/612104 (40%)]	lr:2.41e-04	Loss: 0.219630
[2024-01-06 17:58:51,501] {train_model:86} INFO - Train Epoch: 4 [305664/612104 (50%)]	lr:2.41e-04	Loss: 0.267022
[2024-01-06 17:59:03,519] {train_model:86} INFO - Train Epoch: 4 [366848/612104 (60%)]	lr:2.41e-04	Loss: 0.321719
[2024-01-06 17:59:36,728] {train_model:86} INFO - Train Epoch: 4 [428032/612104 (70%)]	lr:2.41e-04	Loss: 0.403298
[2024-01-06 17:59:57,629] {train_model:86} INFO - Train Epoch: 4 [489216/612104 (80%)]	lr:2.41e-04	Loss: 0.293486
[2024-01-06 18:00:09,708] {train_model:86} INFO - Train Epoch: 4 [550400/612104 (90%)]	lr:2.41e-04	Loss: 0.235684
[2024-01-06 18:00:21,560] {train_model:86} INFO - Train Epoch: 4 [611584/612104 (100%)]	lr:2.41e-04	Loss: 0.081173
[2024-01-06 18:00:34,701] {run_experiment:78} INFO - 
[2024-01-06 18:00:34,708] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 18:00:36,085] {result_logger:108} INFO - precision on WAKE: 0.975
[2024-01-06 18:00:37,000] {result_logger:109} INFO - recall on WAKE: 0.919
[2024-01-06 18:00:37,925] {result_logger:112} INFO - F1-score on WAKE: 0.946
[2024-01-06 18:00:37,925] {result_logger:113} INFO - 
[2024-01-06 18:00:39,324] {result_logger:108} INFO - precision on NREM: 0.920
[2024-01-06 18:00:40,232] {result_logger:109} INFO - recall on NREM: 0.887
[2024-01-06 18:00:41,136] {result_logger:112} INFO - F1-score on NREM: 0.903
[2024-01-06 18:00:41,137] {result_logger:113} INFO - 
[2024-01-06 18:00:42,430] {result_logger:108} INFO - precision on REM: 0.511
[2024-01-06 18:00:43,251] {result_logger:109} INFO - recall on REM: 0.876
[2024-01-06 18:00:44,068] {result_logger:112} INFO - F1-score on REM: 0.645
[2024-01-06 18:00:44,068] {result_logger:113} INFO - 
[2024-01-06 18:00:44,282] {result_logger:116} INFO - average precision on sleep stages: 0.802
[2024-01-06 18:00:44,496] {result_logger:118} INFO - average recall on sleep stages: 0.894
[2024-01-06 18:00:44,711] {result_logger:120} INFO - average F1-score on sleep stages: 0.831
[2024-01-06 18:00:45,297] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.894
[2024-01-06 18:00:45,327] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.903
[2024-01-06 18:00:45,331] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 18:00:45,518] {result_logger:108} INFO - precision on WAKE: 0.551
[2024-01-06 18:00:45,631] {result_logger:109} INFO - recall on WAKE: 0.998
[2024-01-06 18:00:45,744] {result_logger:112} INFO - F1-score on WAKE: 0.710
[2024-01-06 18:00:45,744] {result_logger:113} INFO - 
[2024-01-06 18:00:45,928] {result_logger:108} INFO - precision on NREM: 0.910
[2024-01-06 18:00:46,037] {result_logger:109} INFO - recall on NREM: 0.032
[2024-01-06 18:00:46,146] {result_logger:112} INFO - F1-score on NREM: 0.061
[2024-01-06 18:00:46,147] {result_logger:113} INFO - 
[2024-01-06 18:00:46,329] {result_logger:108} INFO - precision on REM: 0.000
[2024-01-06 18:00:46,436] {result_logger:109} INFO - recall on REM: 0.000
[2024-01-06 18:00:46,545] {result_logger:112} INFO - F1-score on REM: 0.000
[2024-01-06 18:00:46,546] {result_logger:113} INFO - 
[2024-01-06 18:00:46,565] {result_logger:116} INFO - average precision on sleep stages: 0.487
[2024-01-06 18:00:46,585] {result_logger:118} INFO - average recall on sleep stages: 0.343
[2024-01-06 18:00:46,604] {result_logger:120} INFO - average F1-score on sleep stages: 0.257
[2024-01-06 18:00:46,683] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.343
[2024-01-06 18:00:46,686] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.556
[2024-01-06 18:00:46,687] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 18:00:47,336] {result_logger:143} INFO - 
[[305126  15096  11793     40]
 [  6413 212052  20649     76]
 [  1442   3348  33876      5]
 [  1579    499    101      9]]
[2024-01-06 18:00:47,992] {result_logger:150} INFO - 
[[ 91.89%   4.55%   3.55%   0.01%]
 [  2.68%  88.65%   8.63%   0.03%]
 [  3.73%   8.66%  87.60%   0.01%]
 [ 72.17%  22.81%   4.62%   0.41%]]
[2024-01-06 18:00:48,640] {result_logger:154} INFO - 
[[ 97.00%   6.54%  17.76%  30.77%]
 [  2.04%  91.80%  31.09%  58.46%]
 [  0.46%   1.45%  51.00%   3.85%]
 [  0.50%   0.22%   0.15%   6.92%]]
[2024-01-06 18:00:48,641] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 18:00:48,727] {result_logger:143} INFO - 
[[48211   108     0     0]
 [33988  1117     0     0]
 [ 5339     2     0     0]
 [  830     4     0     0]]
[2024-01-06 18:00:48,943] {result_logger:150} INFO - 
[[ 99.78%   0.22%   0.00%   0.00%]
 [ 96.82%   3.18%   0.00%   0.00%]
 [ 99.96%   0.04%   0.00%   0.00%]
 [ 99.52%   0.48%   0.00%   0.00%]]
[2024-01-06 18:00:49,159] {result_logger:154} INFO - 
[[ 54.56%   8.77%    nan%    nan%]
 [ 38.46%  90.74%    nan%    nan%]
 [  6.04%   0.16%    nan%    nan%]
 [  0.94%   0.32%    nan%    nan%]]
[2024-01-06 18:00:49,622] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 18:00:49,622] {result_logger:77} INFO - actual:
[2024-01-06 18:00:49,622] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 18:00:49,623] {result_logger:79} INFO - predicted:
[2024-01-06 18:00:49,623] {result_logger:80} INFO - 
[[99.36%  0.64%  0.00%  0.00%]
 [45.98% 54.02%  0.00%  0.00%]
 [  nan%   nan%   nan%   nan%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 18:00:49,658] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it1/model_8conv_2fc-best.pth
[2024-01-06 18:00:49,659] {run_experiment:113} INFO - [epoch   4] execution time: 223.38s	 avg f1-score: 0.2571

[2024-01-06 18:00:49,659] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 18:00:49,717] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 18:01:31,606] {train_model:86} INFO - Train Epoch: 5 [60928/612104 (10%)]	lr:2.27e-04	Loss: 0.229764
[2024-01-06 18:01:57,024] {train_model:86} INFO - Train Epoch: 5 [122112/612104 (20%)]	lr:2.27e-04	Loss: 0.228908
[2024-01-06 18:02:09,705] {train_model:86} INFO - Train Epoch: 5 [183296/612104 (30%)]	lr:2.27e-04	Loss: 0.325689
[2024-01-06 18:02:21,975] {train_model:86} INFO - Train Epoch: 5 [244480/612104 (40%)]	lr:2.27e-04	Loss: 0.214208
[2024-01-06 18:02:34,196] {train_model:86} INFO - Train Epoch: 5 [305664/612104 (50%)]	lr:2.27e-04	Loss: 0.174909
[2024-01-06 18:03:02,171] {train_model:86} INFO - Train Epoch: 5 [366848/612104 (60%)]	lr:2.27e-04	Loss: 0.123169
[2024-01-06 18:03:28,150] {train_model:86} INFO - Train Epoch: 5 [428032/612104 (70%)]	lr:2.27e-04	Loss: 0.110803
[2024-01-06 18:03:40,209] {train_model:86} INFO - Train Epoch: 5 [489216/612104 (80%)]	lr:2.27e-04	Loss: 0.257772
[2024-01-06 18:03:52,326] {train_model:86} INFO - Train Epoch: 5 [550400/612104 (90%)]	lr:2.27e-04	Loss: 0.142269
[2024-01-06 18:04:04,320] {train_model:86} INFO - Train Epoch: 5 [611584/612104 (100%)]	lr:2.27e-04	Loss: 0.155734
[2024-01-06 18:04:17,371] {run_experiment:78} INFO - 
[2024-01-06 18:04:17,377] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 18:04:18,693] {result_logger:108} INFO - precision on WAKE: 0.982
[2024-01-06 18:04:19,574] {result_logger:109} INFO - recall on WAKE: 0.933
[2024-01-06 18:04:20,466] {result_logger:112} INFO - F1-score on WAKE: 0.957
[2024-01-06 18:04:20,466] {result_logger:113} INFO - 
[2024-01-06 18:04:21,801] {result_logger:108} INFO - precision on NREM: 0.929
[2024-01-06 18:04:22,692] {result_logger:109} INFO - recall on NREM: 0.912
[2024-01-06 18:04:23,590] {result_logger:112} INFO - F1-score on NREM: 0.920
[2024-01-06 18:04:23,590] {result_logger:113} INFO - 
[2024-01-06 18:04:24,888] {result_logger:108} INFO - precision on REM: 0.583
[2024-01-06 18:04:25,673] {result_logger:109} INFO - recall on REM: 0.898
[2024-01-06 18:04:26,469] {result_logger:112} INFO - F1-score on REM: 0.707
[2024-01-06 18:04:26,469] {result_logger:113} INFO - 
[2024-01-06 18:04:26,676] {result_logger:116} INFO - average precision on sleep stages: 0.831
[2024-01-06 18:04:26,885] {result_logger:118} INFO - average recall on sleep stages: 0.914
[2024-01-06 18:04:27,090] {result_logger:120} INFO - average F1-score on sleep stages: 0.861
[2024-01-06 18:04:27,663] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.914
[2024-01-06 18:04:27,692] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.922
[2024-01-06 18:04:27,695] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 18:04:27,878] {result_logger:108} INFO - precision on WAKE: 0.998
[2024-01-06 18:04:27,989] {result_logger:109} INFO - recall on WAKE: 0.554
[2024-01-06 18:04:28,098] {result_logger:112} INFO - F1-score on WAKE: 0.713
[2024-01-06 18:04:28,098] {result_logger:113} INFO - 
[2024-01-06 18:04:28,273] {result_logger:108} INFO - precision on NREM: 0.826
[2024-01-06 18:04:28,387] {result_logger:109} INFO - recall on NREM: 0.904
[2024-01-06 18:04:28,495] {result_logger:112} INFO - F1-score on NREM: 0.863
[2024-01-06 18:04:28,495] {result_logger:113} INFO - 
[2024-01-06 18:04:28,677] {result_logger:108} INFO - precision on REM: 0.223
[2024-01-06 18:04:28,787] {result_logger:109} INFO - recall on REM: 0.979
[2024-01-06 18:04:28,893] {result_logger:112} INFO - F1-score on REM: 0.363
[2024-01-06 18:04:28,894] {result_logger:113} INFO - 
[2024-01-06 18:04:28,913] {result_logger:116} INFO - average precision on sleep stages: 0.682
[2024-01-06 18:04:28,931] {result_logger:118} INFO - average recall on sleep stages: 0.812
[2024-01-06 18:04:28,950] {result_logger:120} INFO - average F1-score on sleep stages: 0.646
[2024-01-06 18:04:29,026] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.812
[2024-01-06 18:04:29,030] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.718
[2024-01-06 18:04:29,030] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 18:04:29,664] {result_logger:143} INFO - 
[[309825  13705   8489     36]
 [  4711 218107  16301     71]
 [   919   3032  34709     11]
 [  1601    481    102      4]]
[2024-01-06 18:04:30,300] {result_logger:150} INFO - 
[[ 93.31%   4.13%   2.56%   0.01%]
 [  1.97%  91.19%   6.82%   0.03%]
 [  2.38%   7.84%  89.75%   0.03%]
 [ 73.17%  21.98%   4.66%   0.18%]]
[2024-01-06 18:04:30,931] {result_logger:154} INFO - 
[[ 97.72%   5.82%  14.24%  29.51%]
 [  1.49%  92.68%  27.35%  58.20%]
 [  0.29%   1.29%  58.24%   9.02%]
 [  0.50%   0.20%   0.17%   3.28%]]
[2024-01-06 18:04:30,931] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 18:04:31,011] {result_logger:143} INFO - 
[[26787  6586 14946     0]
 [   60 31727  3318     0]
 [    3   110  5228     0]
 [   27   233   574     0]]
[2024-01-06 18:04:31,219] {result_logger:150} INFO - 
[[ 55.44%  13.63%  30.93%   0.00%]
 [  0.17%  90.38%   9.45%   0.00%]
 [  0.06%   2.06%  97.88%   0.00%]
 [  3.24%  27.94%  68.82%   0.00%]]
[2024-01-06 18:04:31,424] {result_logger:154} INFO - 
[[ 99.67%  17.04%  62.10%    nan%]
 [  0.22%  82.08%  13.79%    nan%]
 [  0.01%   0.28%  21.72%    nan%]
 [  0.10%   0.60%   2.39%    nan%]]
[2024-01-06 18:04:31,983] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 18:04:31,983] {result_logger:77} INFO - actual:
[2024-01-06 18:04:31,983] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 18:04:31,983] {result_logger:79} INFO - predicted:
[2024-01-06 18:04:31,983] {result_logger:80} INFO - 
[[91.57%  4.59%  3.84%  0.00%]
 [ 3.00% 91.71%  5.29%  0.00%]
 [ 4.60%  8.19% 87.21%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 18:04:32,019] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it1/model_8conv_2fc-best.pth
[2024-01-06 18:04:32,019] {run_experiment:113} INFO - [epoch   5] execution time: 222.36s	 avg f1-score: 0.6461

[2024-01-06 18:04:32,019] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 18:04:32,081] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 18:04:59,052] {train_model:86} INFO - Train Epoch: 6 [60928/612104 (10%)]	lr:2.14e-04	Loss: 0.146603
[2024-01-06 18:05:26,544] {train_model:86} INFO - Train Epoch: 6 [122112/612104 (20%)]	lr:2.14e-04	Loss: 0.428452
[2024-01-06 18:05:52,571] {train_model:86} INFO - Train Epoch: 6 [183296/612104 (30%)]	lr:2.14e-04	Loss: 0.097872
[2024-01-06 18:06:05,159] {train_model:86} INFO - Train Epoch: 6 [244480/612104 (40%)]	lr:2.14e-04	Loss: 0.288633
[2024-01-06 18:06:33,346] {train_model:86} INFO - Train Epoch: 6 [305664/612104 (50%)]	lr:2.14e-04	Loss: 0.212617
[2024-01-06 18:06:59,408] {train_model:86} INFO - Train Epoch: 6 [366848/612104 (60%)]	lr:2.14e-04	Loss: 0.178534
[2024-01-06 18:07:11,747] {train_model:86} INFO - Train Epoch: 6 [428032/612104 (70%)]	lr:2.14e-04	Loss: 0.148180
[2024-01-06 18:07:24,206] {train_model:86} INFO - Train Epoch: 6 [489216/612104 (80%)]	lr:2.14e-04	Loss: 0.191250
[2024-01-06 18:07:36,213] {train_model:86} INFO - Train Epoch: 6 [550400/612104 (90%)]	lr:2.14e-04	Loss: 6.723034
[2024-01-06 18:07:48,702] {train_model:86} INFO - Train Epoch: 6 [611584/612104 (100%)]	lr:2.14e-04	Loss: 0.412168
[2024-01-06 18:08:01,868] {run_experiment:78} INFO - 
[2024-01-06 18:08:01,875] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 18:08:03,219] {result_logger:108} INFO - precision on WAKE: 0.985
[2024-01-06 18:08:04,113] {result_logger:109} INFO - recall on WAKE: 0.940
[2024-01-06 18:08:05,006] {result_logger:112} INFO - F1-score on WAKE: 0.962
[2024-01-06 18:08:05,006] {result_logger:113} INFO - 
[2024-01-06 18:08:06,355] {result_logger:108} INFO - precision on NREM: 0.934
[2024-01-06 18:08:07,264] {result_logger:109} INFO - recall on NREM: 0.925
[2024-01-06 18:08:08,168] {result_logger:112} INFO - F1-score on NREM: 0.929
[2024-01-06 18:08:08,168] {result_logger:113} INFO - 
[2024-01-06 18:08:09,413] {result_logger:108} INFO - precision on REM: 0.633
[2024-01-06 18:08:10,221] {result_logger:109} INFO - recall on REM: 0.914
[2024-01-06 18:08:11,016] {result_logger:112} INFO - F1-score on REM: 0.748
[2024-01-06 18:08:11,016] {result_logger:113} INFO - 
[2024-01-06 18:08:11,230] {result_logger:116} INFO - average precision on sleep stages: 0.851
[2024-01-06 18:08:11,440] {result_logger:118} INFO - average recall on sleep stages: 0.926
[2024-01-06 18:08:11,651] {result_logger:120} INFO - average F1-score on sleep stages: 0.880
[2024-01-06 18:08:12,222] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.926
[2024-01-06 18:08:12,250] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.933
[2024-01-06 18:08:12,253] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 18:08:12,425] {result_logger:108} INFO - precision on WAKE: 0.989
[2024-01-06 18:08:12,533] {result_logger:109} INFO - recall on WAKE: 0.542
[2024-01-06 18:08:12,638] {result_logger:112} INFO - F1-score on WAKE: 0.701
[2024-01-06 18:08:12,638] {result_logger:113} INFO - 
[2024-01-06 18:08:12,815] {result_logger:108} INFO - precision on NREM: 0.934
[2024-01-06 18:08:12,927] {result_logger:109} INFO - recall on NREM: 0.768
[2024-01-06 18:08:13,039] {result_logger:112} INFO - F1-score on NREM: 0.843
[2024-01-06 18:08:13,039] {result_logger:113} INFO - 
[2024-01-06 18:08:13,219] {result_logger:108} INFO - precision on REM: 0.159
[2024-01-06 18:08:13,331] {result_logger:109} INFO - recall on REM: 0.995
[2024-01-06 18:08:13,444] {result_logger:112} INFO - F1-score on REM: 0.274
[2024-01-06 18:08:13,444] {result_logger:113} INFO - 
[2024-01-06 18:08:13,466] {result_logger:116} INFO - average precision on sleep stages: 0.694
[2024-01-06 18:08:13,486] {result_logger:118} INFO - average recall on sleep stages: 0.768
[2024-01-06 18:08:13,507] {result_logger:120} INFO - average F1-score on sleep stages: 0.606
[2024-01-06 18:08:13,586] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.768
[2024-01-06 18:08:13,590] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.659
[2024-01-06 18:08:13,590] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 18:08:14,214] {result_logger:143} INFO - 
[[312272  13125   6623     35]
 [  4166 221148  13835     41]
 [   749   2560  35356      6]
 [  1587    501     90     10]]
[2024-01-06 18:08:14,828] {result_logger:150} INFO - 
[[ 94.04%   3.95%   1.99%   0.01%]
 [  1.74%  92.46%   5.78%   0.02%]
 [  1.94%   6.62%  91.43%   0.02%]
 [ 72.53%  22.90%   4.11%   0.46%]]
[2024-01-06 18:08:15,442] {result_logger:154} INFO - 
[[ 97.96%   5.53%  11.85%  38.04%]
 [  1.31%  93.18%  24.75%  44.57%]
 [  0.23%   1.08%  63.24%   6.52%]
 [  0.50%   0.21%   0.16%  10.87%]]
[2024-01-06 18:08:15,442] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 18:08:15,523] {result_logger:143} INFO - 
[[26212  1873 20234     0]
 [  290 26945  7870     0]
 [    1    26  5314     0]
 [   38    74   722     0]]
[2024-01-06 18:08:15,724] {result_logger:150} INFO - 
[[ 54.25%   3.88%  41.88%   0.00%]
 [  0.83%  76.76%  22.42%   0.00%]
 [  0.02%   0.49%  99.49%   0.00%]
 [  4.56%   8.87%  86.57%   0.00%]]
[2024-01-06 18:08:15,928] {result_logger:154} INFO - 
[[ 98.76%   6.48%  59.27%    nan%]
 [  1.09%  93.18%  23.05%    nan%]
 [  0.00%   0.09%  15.57%    nan%]
 [  0.14%   0.26%   2.11%    nan%]]
[2024-01-06 18:08:16,365] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 18:08:16,366] {result_logger:77} INFO - actual:
[2024-01-06 18:08:16,366] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 18:08:16,366] {result_logger:79} INFO - predicted:
[2024-01-06 18:08:16,366] {result_logger:80} INFO - 
[[90.54%  1.78%  7.68%  0.00%]
 [ 1.62% 91.08%  7.30%  0.00%]
 [ 5.98%  6.17% 87.85%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 18:08:16,402] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it1/model_8conv_2fc-best.pth
[2024-01-06 18:08:16,402] {run_experiment:113} INFO - [epoch   6] execution time: 224.38s	 avg f1-score: 0.6059

[2024-01-06 18:08:16,403] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 18:08:16,462] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 18:08:42,290] {train_model:86} INFO - Train Epoch: 7 [60928/612104 (10%)]	lr:2.01e-04	Loss: 0.126636
[2024-01-06 18:09:09,202] {train_model:86} INFO - Train Epoch: 7 [122112/612104 (20%)]	lr:2.01e-04	Loss: 0.141861
[2024-01-06 18:09:21,755] {train_model:86} INFO - Train Epoch: 7 [183296/612104 (30%)]	lr:2.01e-04	Loss: 0.109877
[2024-01-06 18:09:47,286] {train_model:86} INFO - Train Epoch: 7 [244480/612104 (40%)]	lr:2.01e-04	Loss: 0.139864
[2024-01-06 18:10:15,034] {train_model:86} INFO - Train Epoch: 7 [305664/612104 (50%)]	lr:2.01e-04	Loss: 0.209630
[2024-01-06 18:10:40,822] {train_model:86} INFO - Train Epoch: 7 [366848/612104 (60%)]	lr:2.01e-04	Loss: 0.135803
[2024-01-06 18:10:53,208] {train_model:86} INFO - Train Epoch: 7 [428032/612104 (70%)]	lr:2.01e-04	Loss: 0.792069
[2024-01-06 18:11:05,805] {train_model:86} INFO - Train Epoch: 7 [489216/612104 (80%)]	lr:2.01e-04	Loss: 0.150473
[2024-01-06 18:11:18,189] {train_model:86} INFO - Train Epoch: 7 [550400/612104 (90%)]	lr:2.01e-04	Loss: 0.096424
[2024-01-06 18:11:30,428] {train_model:86} INFO - Train Epoch: 7 [611584/612104 (100%)]	lr:2.01e-04	Loss: 0.092960
[2024-01-06 18:11:44,804] {run_experiment:78} INFO - 
[2024-01-06 18:11:44,810] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 18:11:46,143] {result_logger:108} INFO - precision on WAKE: 0.985
[2024-01-06 18:11:47,040] {result_logger:109} INFO - recall on WAKE: 0.945
[2024-01-06 18:11:47,957] {result_logger:112} INFO - F1-score on WAKE: 0.965
[2024-01-06 18:11:47,957] {result_logger:113} INFO - 
[2024-01-06 18:11:49,337] {result_logger:108} INFO - precision on NREM: 0.937
[2024-01-06 18:11:50,236] {result_logger:109} INFO - recall on NREM: 0.931
[2024-01-06 18:11:51,134] {result_logger:112} INFO - F1-score on NREM: 0.934
[2024-01-06 18:11:51,134] {result_logger:113} INFO - 
[2024-01-06 18:11:52,352] {result_logger:108} INFO - precision on REM: 0.662
[2024-01-06 18:11:53,128] {result_logger:109} INFO - recall on REM: 0.921
[2024-01-06 18:11:53,901] {result_logger:112} INFO - F1-score on REM: 0.770
[2024-01-06 18:11:53,901] {result_logger:113} INFO - 
[2024-01-06 18:11:54,108] {result_logger:116} INFO - average precision on sleep stages: 0.862
[2024-01-06 18:11:54,315] {result_logger:118} INFO - average recall on sleep stages: 0.932
[2024-01-06 18:11:54,521] {result_logger:120} INFO - average F1-score on sleep stages: 0.890
[2024-01-06 18:11:55,060] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.932
[2024-01-06 18:11:55,086] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.938
[2024-01-06 18:11:55,092] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 18:11:55,259] {result_logger:108} INFO - precision on WAKE: 0.978
[2024-01-06 18:11:55,362] {result_logger:109} INFO - recall on WAKE: 0.608
[2024-01-06 18:11:55,469] {result_logger:112} INFO - F1-score on WAKE: 0.750
[2024-01-06 18:11:55,469] {result_logger:113} INFO - 
[2024-01-06 18:11:55,648] {result_logger:108} INFO - precision on NREM: 0.950
[2024-01-06 18:11:55,751] {result_logger:109} INFO - recall on NREM: 0.808
[2024-01-06 18:11:55,859] {result_logger:112} INFO - F1-score on NREM: 0.874
[2024-01-06 18:11:55,859] {result_logger:113} INFO - 
[2024-01-06 18:11:56,036] {result_logger:108} INFO - precision on REM: 0.183
[2024-01-06 18:11:56,144] {result_logger:109} INFO - recall on REM: 0.988
[2024-01-06 18:11:56,250] {result_logger:112} INFO - F1-score on REM: 0.309
[2024-01-06 18:11:56,250] {result_logger:113} INFO - 
[2024-01-06 18:11:56,270] {result_logger:116} INFO - average precision on sleep stages: 0.704
[2024-01-06 18:11:56,289] {result_logger:118} INFO - average recall on sleep stages: 0.801
[2024-01-06 18:11:56,309] {result_logger:120} INFO - average F1-score on sleep stages: 0.644
[2024-01-06 18:11:56,384] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.801
[2024-01-06 18:11:56,387] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.710
[2024-01-06 18:11:56,387] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 18:11:57,015] {result_logger:143} INFO - 
[[313710  12550   5773     22]
 [  4003 222781  12369     37]
 [   673   2394  35600      4]
 [  1657    463     60      8]]
[2024-01-06 18:11:57,635] {result_logger:150} INFO - 
[[ 94.48%   3.78%   1.74%   0.01%]
 [  1.67%  93.14%   5.17%   0.02%]
 [  1.74%   6.19%  92.06%   0.01%]
 [ 75.73%  21.16%   2.74%   0.37%]]
[2024-01-06 18:11:58,273] {result_logger:154} INFO - 
[[ 98.02%   5.27%  10.73%  30.99%]
 [  1.25%  93.53%  22.99%  52.11%]
 [  0.21%   1.01%  66.17%   5.63%]
 [  0.52%   0.19%   0.11%  11.27%]]
[2024-01-06 18:11:58,273] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 18:11:58,354] {result_logger:143} INFO - 
[[29395  1427 17497     0]
 [  672 28380  6053     0]
 [    3    63  5275     0]
 [   60    56   718     0]]
[2024-01-06 18:11:58,565] {result_logger:150} INFO - 
[[ 60.84%   2.95%  36.21%   0.00%]
 [  1.91%  80.84%  17.24%   0.00%]
 [  0.06%   1.18%  98.76%   0.00%]
 [  7.19%   6.71%  86.09%   0.00%]]
[2024-01-06 18:11:58,768] {result_logger:154} INFO - 
[[ 97.56%   4.77%  59.23%    nan%]
 [  2.23%  94.83%  20.49%    nan%]
 [  0.01%   0.21%  17.86%    nan%]
 [  0.20%   0.19%   2.43%    nan%]]
[2024-01-06 18:11:59,242] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 18:11:59,242] {result_logger:77} INFO - actual:
[2024-01-06 18:11:59,242] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 18:11:59,242] {result_logger:79} INFO - predicted:
[2024-01-06 18:11:59,243] {result_logger:80} INFO - 
[[92.27%  1.49%  6.25%  0.00%]
 [ 1.42% 93.20%  5.38%  0.00%]
 [ 6.44%  5.38% 88.18%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 18:11:59,281] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it1/model_8conv_2fc-best.pth
[2024-01-06 18:11:59,282] {run_experiment:113} INFO - [epoch   7] execution time: 222.88s	 avg f1-score: 0.6441

[2024-01-06 18:11:59,282] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 18:11:59,340] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 18:12:25,328] {train_model:86} INFO - Train Epoch: 8 [60928/612104 (10%)]	lr:1.90e-04	Loss: 0.106943
[2024-01-06 18:12:37,108] {train_model:86} INFO - Train Epoch: 8 [122112/612104 (20%)]	lr:1.90e-04	Loss: 0.180070
[2024-01-06 18:13:04,222] {train_model:86} INFO - Train Epoch: 8 [183296/612104 (30%)]	lr:1.90e-04	Loss: 0.643439
[2024-01-06 18:13:45,025] {train_model:86} INFO - Train Epoch: 8 [244480/612104 (40%)]	lr:1.90e-04	Loss: 0.079590
[2024-01-06 18:14:10,769] {train_model:86} INFO - Train Epoch: 8 [305664/612104 (50%)]	lr:1.90e-04	Loss: 0.127732
[2024-01-06 18:14:22,851] {train_model:86} INFO - Train Epoch: 8 [366848/612104 (60%)]	lr:1.90e-04	Loss: 0.223275
[2024-01-06 18:14:34,855] {train_model:86} INFO - Train Epoch: 8 [428032/612104 (70%)]	lr:1.90e-04	Loss: 0.168188
[2024-01-06 18:14:47,096] {train_model:86} INFO - Train Epoch: 8 [489216/612104 (80%)]	lr:1.90e-04	Loss: 0.125143
[2024-01-06 18:14:59,322] {train_model:86} INFO - Train Epoch: 8 [550400/612104 (90%)]	lr:1.90e-04	Loss: 0.195612
[2024-01-06 18:15:12,114] {train_model:86} INFO - Train Epoch: 8 [611584/612104 (100%)]	lr:1.90e-04	Loss: 0.166773
[2024-01-06 18:15:24,963] {run_experiment:78} INFO - 
[2024-01-06 18:15:24,969] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 18:15:26,279] {result_logger:108} INFO - precision on WAKE: 0.986
[2024-01-06 18:15:27,166] {result_logger:109} INFO - recall on WAKE: 0.948
[2024-01-06 18:15:28,070] {result_logger:112} INFO - F1-score on WAKE: 0.967
[2024-01-06 18:15:28,070] {result_logger:113} INFO - 
[2024-01-06 18:15:29,440] {result_logger:108} INFO - precision on NREM: 0.940
[2024-01-06 18:15:30,341] {result_logger:109} INFO - recall on NREM: 0.934
[2024-01-06 18:15:31,298] {result_logger:112} INFO - F1-score on NREM: 0.937
[2024-01-06 18:15:31,298] {result_logger:113} INFO - 
[2024-01-06 18:15:32,617] {result_logger:108} INFO - precision on REM: 0.680
[2024-01-06 18:15:33,435] {result_logger:109} INFO - recall on REM: 0.929
[2024-01-06 18:15:34,238] {result_logger:112} INFO - F1-score on REM: 0.785
[2024-01-06 18:15:34,238] {result_logger:113} INFO - 
[2024-01-06 18:15:34,447] {result_logger:116} INFO - average precision on sleep stages: 0.869
[2024-01-06 18:15:34,658] {result_logger:118} INFO - average recall on sleep stages: 0.937
[2024-01-06 18:15:34,870] {result_logger:120} INFO - average F1-score on sleep stages: 0.896
[2024-01-06 18:15:35,449] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.937
[2024-01-06 18:15:35,478] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.941
[2024-01-06 18:15:35,482] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 18:15:35,662] {result_logger:108} INFO - precision on WAKE: 0.872
[2024-01-06 18:15:35,772] {result_logger:109} INFO - recall on WAKE: 0.976
[2024-01-06 18:15:35,881] {result_logger:112} INFO - F1-score on WAKE: 0.921
[2024-01-06 18:15:35,881] {result_logger:113} INFO - 
[2024-01-06 18:15:36,065] {result_logger:108} INFO - precision on NREM: 0.956
[2024-01-06 18:15:36,172] {result_logger:109} INFO - recall on NREM: 0.769
[2024-01-06 18:15:36,280] {result_logger:112} INFO - F1-score on NREM: 0.852
[2024-01-06 18:15:36,280] {result_logger:113} INFO - 
[2024-01-06 18:15:36,460] {result_logger:108} INFO - precision on REM: 0.615
[2024-01-06 18:15:36,562] {result_logger:109} INFO - recall on REM: 0.742
[2024-01-06 18:15:36,668] {result_logger:112} INFO - F1-score on REM: 0.673
[2024-01-06 18:15:36,668] {result_logger:113} INFO - 
[2024-01-06 18:15:36,688] {result_logger:116} INFO - average precision on sleep stages: 0.814
[2024-01-06 18:15:36,708] {result_logger:118} INFO - average recall on sleep stages: 0.829
[2024-01-06 18:15:36,727] {result_logger:120} INFO - average F1-score on sleep stages: 0.815
[2024-01-06 18:15:36,805] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.829
[2024-01-06 18:15:36,808] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.880
[2024-01-06 18:15:36,808] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 18:15:37,416] {result_logger:143} INFO - 
[[314882  12036   5119     18]
 [  3975 223410  11780     25]
 [   597   2154  35917      3]
 [  1701    423     60      4]]
[2024-01-06 18:15:38,037] {result_logger:150} INFO - 
[[ 94.83%   3.62%   1.54%   0.01%]
 [  1.66%  93.40%   4.92%   0.01%]
 [  1.54%   5.57%  92.88%   0.01%]
 [ 77.74%  19.33%   2.74%   0.18%]]
[2024-01-06 18:15:38,654] {result_logger:154} INFO - 
[[ 98.05%   5.06%   9.68%  36.00%]
 [  1.24%  93.86%  22.28%  50.00%]
 [  0.19%   0.90%  67.93%   6.00%]
 [  0.53%   0.18%   0.11%   8.00%]]
[2024-01-06 18:15:38,655] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 18:15:38,737] {result_logger:143} INFO - 
[[47156  1033   130     0]
 [ 5772 26984  2349     0]
 [ 1176   201  3964     0]
 [  782    35    17     0]]
[2024-01-06 18:15:38,952] {result_logger:150} INFO - 
[[ 97.59%   2.14%   0.27%   0.00%]
 [ 16.44%  76.87%   6.69%   0.00%]
 [ 22.02%   3.76%  74.22%   0.00%]
 [ 93.76%   4.20%   2.04%   0.00%]]
[2024-01-06 18:15:39,163] {result_logger:154} INFO - 
[[ 85.92%   3.66%   2.01%    nan%]
 [ 10.52%  95.51%  36.36%    nan%]
 [  2.14%   0.71%  61.36%    nan%]
 [  1.42%   0.12%   0.26%    nan%]]
[2024-01-06 18:15:39,624] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 18:15:39,624] {result_logger:77} INFO - actual:
[2024-01-06 18:15:39,624] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 18:15:39,624] {result_logger:79} INFO - predicted:
[2024-01-06 18:15:39,624] {result_logger:80} INFO - 
[[96.27%  2.96%  0.78%  0.00%]
 [ 4.77% 92.79%  2.44%  0.00%]
 [10.84%  6.42% 82.74%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 18:15:39,661] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it1/model_8conv_2fc-best.pth
[2024-01-06 18:15:39,661] {run_experiment:113} INFO - [epoch   8] execution time: 220.38s	 avg f1-score: 0.8153

[2024-01-06 18:15:39,661] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 18:15:39,721] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 18:16:06,494] {train_model:86} INFO - Train Epoch: 9 [60928/612104 (10%)]	lr:1.79e-04	Loss: 0.144515
[2024-01-06 18:16:19,469] {train_model:86} INFO - Train Epoch: 9 [122112/612104 (20%)]	lr:1.79e-04	Loss: 0.370376
[2024-01-06 18:16:44,343] {train_model:86} INFO - Train Epoch: 9 [183296/612104 (30%)]	lr:1.79e-04	Loss: 0.226461
[2024-01-06 18:17:31,889] {train_model:86} INFO - Train Epoch: 9 [244480/612104 (40%)]	lr:1.79e-04	Loss: 0.153781
[2024-01-06 18:17:44,514] {train_model:86} INFO - Train Epoch: 9 [305664/612104 (50%)]	lr:1.79e-04	Loss: 0.213749
[2024-01-06 18:17:56,308] {train_model:86} INFO - Train Epoch: 9 [366848/612104 (60%)]	lr:1.79e-04	Loss: 0.120609
[2024-01-06 18:18:08,815] {train_model:86} INFO - Train Epoch: 9 [428032/612104 (70%)]	lr:1.79e-04	Loss: 0.148966
[2024-01-06 18:18:20,895] {train_model:86} INFO - Train Epoch: 9 [489216/612104 (80%)]	lr:1.79e-04	Loss: 0.120610
[2024-01-06 18:18:33,803] {train_model:86} INFO - Train Epoch: 9 [550400/612104 (90%)]	lr:1.79e-04	Loss: 0.127739
[2024-01-06 18:18:45,793] {train_model:86} INFO - Train Epoch: 9 [611584/612104 (100%)]	lr:1.79e-04	Loss: 0.568602
[2024-01-06 18:18:59,134] {run_experiment:78} INFO - 
[2024-01-06 18:18:59,140] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 18:19:00,533] {result_logger:108} INFO - precision on WAKE: 0.986
[2024-01-06 18:19:01,459] {result_logger:109} INFO - recall on WAKE: 0.951
[2024-01-06 18:19:02,381] {result_logger:112} INFO - F1-score on WAKE: 0.968
[2024-01-06 18:19:02,381] {result_logger:113} INFO - 
[2024-01-06 18:19:03,830] {result_logger:108} INFO - precision on NREM: 0.942
[2024-01-06 18:19:04,766] {result_logger:109} INFO - recall on NREM: 0.937
[2024-01-06 18:19:05,712] {result_logger:112} INFO - F1-score on NREM: 0.939
[2024-01-06 18:19:05,712] {result_logger:113} INFO - 
[2024-01-06 18:19:07,020] {result_logger:108} INFO - precision on REM: 0.697
[2024-01-06 18:19:07,831] {result_logger:109} INFO - recall on REM: 0.930
[2024-01-06 18:19:08,640] {result_logger:112} INFO - F1-score on REM: 0.797
[2024-01-06 18:19:08,640] {result_logger:113} INFO - 
[2024-01-06 18:19:08,857] {result_logger:116} INFO - average precision on sleep stages: 0.875
[2024-01-06 18:19:09,073] {result_logger:118} INFO - average recall on sleep stages: 0.939
[2024-01-06 18:19:09,283] {result_logger:120} INFO - average F1-score on sleep stages: 0.901
[2024-01-06 18:19:09,849] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.939
[2024-01-06 18:19:09,878] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.944
[2024-01-06 18:19:09,882] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 18:19:10,062] {result_logger:108} INFO - precision on WAKE: 0.935
[2024-01-06 18:19:10,174] {result_logger:109} INFO - recall on WAKE: 0.939
[2024-01-06 18:19:10,285] {result_logger:112} INFO - F1-score on WAKE: 0.937
[2024-01-06 18:19:10,285] {result_logger:113} INFO - 
[2024-01-06 18:19:10,469] {result_logger:108} INFO - precision on NREM: 0.934
[2024-01-06 18:19:10,581] {result_logger:109} INFO - recall on NREM: 0.853
[2024-01-06 18:19:10,693] {result_logger:112} INFO - F1-score on NREM: 0.892
[2024-01-06 18:19:10,693] {result_logger:113} INFO - 
[2024-01-06 18:19:10,876] {result_logger:108} INFO - precision on REM: 0.588
[2024-01-06 18:19:10,988] {result_logger:109} INFO - recall on REM: 0.900
[2024-01-06 18:19:11,098] {result_logger:112} INFO - F1-score on REM: 0.711
[2024-01-06 18:19:11,098] {result_logger:113} INFO - 
[2024-01-06 18:19:11,119] {result_logger:116} INFO - average precision on sleep stages: 0.819
[2024-01-06 18:19:11,138] {result_logger:118} INFO - average recall on sleep stages: 0.897
[2024-01-06 18:19:11,159] {result_logger:120} INFO - average F1-score on sleep stages: 0.847
[2024-01-06 18:19:11,238] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.897
[2024-01-06 18:19:11,242] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.903
[2024-01-06 18:19:11,242] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 18:19:11,874] {result_logger:143} INFO - 
[[315710  11822   4510     13]
 [  3875 224168  11125     22]
 [   621   2069  35978      3]
 [  1683    442     59      4]]
[2024-01-06 18:19:12,511] {result_logger:150} INFO - 
[[ 95.08%   3.56%   1.36%   0.00%]
 [  1.62%  93.72%   4.65%   0.01%]
 [  1.61%   5.35%  93.04%   0.01%]
 [ 76.92%  20.20%   2.70%   0.18%]]
[2024-01-06 18:19:13,146] {result_logger:154} INFO - 
[[ 98.08%   4.96%   8.73%  30.95%]
 [  1.20%  93.99%  21.53%  52.38%]
 [  0.19%   0.87%  69.63%   7.14%]
 [  0.52%   0.19%   0.11%   9.52%]]
[2024-01-06 18:19:13,147] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 18:19:13,229] {result_logger:143} INFO - 
[[45378  1882  1059     0]
 [ 2850 29940  2315     0]
 [  294   239  4808     0]
 [  614    80   140     0]]
[2024-01-06 18:19:13,441] {result_logger:150} INFO - 
[[ 93.91%   3.89%   2.19%   0.00%]
 [  8.12%  85.29%   6.59%   0.00%]
 [  5.50%   4.47%  90.02%   0.00%]
 [ 73.62%   9.59%  16.79%   0.00%]]
[2024-01-06 18:19:13,751] {result_logger:154} INFO - 
[[ 92.35%   5.86%  12.73%    nan%]
 [  5.80%  93.15%  27.82%    nan%]
 [  0.60%   0.74%  57.77%    nan%]
 [  1.25%   0.25%   1.68%    nan%]]
[2024-01-06 18:19:14,203] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 18:19:14,204] {result_logger:77} INFO - actual:
[2024-01-06 18:19:14,204] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 18:19:14,204] {result_logger:79} INFO - predicted:
[2024-01-06 18:19:14,204] {result_logger:80} INFO - 
[[95.44%  3.01%  1.54%  0.00%]
 [ 3.77% 93.91%  2.31%  0.00%]
 [12.34%  5.72% 81.94%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 18:19:14,240] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it1/model_8conv_2fc-best.pth
[2024-01-06 18:19:14,240] {run_experiment:113} INFO - [epoch   9] execution time: 214.58s	 avg f1-score: 0.8466

[2024-01-06 18:19:14,240] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 18:19:14,299] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 18:19:40,564] {train_model:86} INFO - Train Epoch: 10 [60928/612104 (10%)]	lr:1.68e-04	Loss: 0.144667
[2024-01-06 18:20:07,487] {train_model:86} INFO - Train Epoch: 10 [122112/612104 (20%)]	lr:1.68e-04	Loss: 0.091533
[2024-01-06 18:20:33,180] {train_model:86} INFO - Train Epoch: 10 [183296/612104 (30%)]	lr:1.68e-04	Loss: 0.164837
[2024-01-06 18:21:00,553] {train_model:86} INFO - Train Epoch: 10 [244480/612104 (40%)]	lr:1.68e-04	Loss: 0.356114
[2024-01-06 18:21:26,291] {train_model:86} INFO - Train Epoch: 10 [305664/612104 (50%)]	lr:1.68e-04	Loss: 0.229692
[2024-01-06 18:21:39,046] {train_model:86} INFO - Train Epoch: 10 [366848/612104 (60%)]	lr:1.68e-04	Loss: 0.041880
[2024-01-06 18:21:51,677] {train_model:86} INFO - Train Epoch: 10 [428032/612104 (70%)]	lr:1.68e-04	Loss: 0.120187
[2024-01-06 18:22:04,415] {train_model:86} INFO - Train Epoch: 10 [489216/612104 (80%)]	lr:1.68e-04	Loss: 0.310527
[2024-01-06 18:22:16,790] {train_model:86} INFO - Train Epoch: 10 [550400/612104 (90%)]	lr:1.68e-04	Loss: 0.082808
[2024-01-06 18:22:29,612] {train_model:86} INFO - Train Epoch: 10 [611584/612104 (100%)]	lr:1.68e-04	Loss: 0.078250
[2024-01-06 18:22:42,097] {run_experiment:78} INFO - 
[2024-01-06 18:22:42,104] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 18:22:43,555] {result_logger:108} INFO - precision on WAKE: 0.987
[2024-01-06 18:22:44,479] {result_logger:109} INFO - recall on WAKE: 0.952
[2024-01-06 18:22:45,417] {result_logger:112} INFO - F1-score on WAKE: 0.969
[2024-01-06 18:22:45,417] {result_logger:113} INFO - 
[2024-01-06 18:22:46,848] {result_logger:108} INFO - precision on NREM: 0.944
[2024-01-06 18:22:47,764] {result_logger:109} INFO - recall on NREM: 0.940
[2024-01-06 18:22:48,679] {result_logger:112} INFO - F1-score on NREM: 0.942
[2024-01-06 18:22:48,679] {result_logger:113} INFO - 
[2024-01-06 18:22:50,007] {result_logger:108} INFO - precision on REM: 0.705
[2024-01-06 18:22:50,829] {result_logger:109} INFO - recall on REM: 0.936
[2024-01-06 18:22:51,631] {result_logger:112} INFO - F1-score on REM: 0.804
[2024-01-06 18:22:51,631] {result_logger:113} INFO - 
[2024-01-06 18:22:51,839] {result_logger:116} INFO - average precision on sleep stages: 0.879
[2024-01-06 18:22:52,046] {result_logger:118} INFO - average recall on sleep stages: 0.942
[2024-01-06 18:22:52,250] {result_logger:120} INFO - average F1-score on sleep stages: 0.905
[2024-01-06 18:22:52,841] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.942
[2024-01-06 18:22:52,870] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.946
[2024-01-06 18:22:52,874] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 18:22:53,054] {result_logger:108} INFO - precision on WAKE: 0.875
[2024-01-06 18:22:53,167] {result_logger:109} INFO - recall on WAKE: 0.969
[2024-01-06 18:22:53,280] {result_logger:112} INFO - F1-score on WAKE: 0.919
[2024-01-06 18:22:53,280] {result_logger:113} INFO - 
[2024-01-06 18:22:53,463] {result_logger:108} INFO - precision on NREM: 0.951
[2024-01-06 18:22:53,575] {result_logger:109} INFO - recall on NREM: 0.795
[2024-01-06 18:22:53,688] {result_logger:112} INFO - F1-score on NREM: 0.866
[2024-01-06 18:22:53,688] {result_logger:113} INFO - 
[2024-01-06 18:22:53,865] {result_logger:108} INFO - precision on REM: 0.729
[2024-01-06 18:22:53,977] {result_logger:109} INFO - recall on REM: 0.806
[2024-01-06 18:22:54,088] {result_logger:112} INFO - F1-score on REM: 0.766
[2024-01-06 18:22:54,088] {result_logger:113} INFO - 
[2024-01-06 18:22:54,108] {result_logger:116} INFO - average precision on sleep stages: 0.852
[2024-01-06 18:22:54,129] {result_logger:118} INFO - average recall on sleep stages: 0.857
[2024-01-06 18:22:54,149] {result_logger:120} INFO - average F1-score on sleep stages: 0.850
[2024-01-06 18:22:54,230] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.857
[2024-01-06 18:22:54,233] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.890
[2024-01-06 18:22:54,234] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 18:22:54,877] {result_logger:143} INFO - 
[[316250  11373   4414     18]
 [  3703 224727  10741     19]
 [   550   1941  36178      2]
 [  1713    422     50      3]]
[2024-01-06 18:22:55,508] {result_logger:150} INFO - 
[[ 95.24%   3.43%   1.33%   0.01%]
 [  1.55%  93.95%   4.49%   0.01%]
 [  1.42%   5.02%  93.55%   0.01%]
 [ 78.29%  19.29%   2.29%   0.14%]]
[2024-01-06 18:22:56,137] {result_logger:154} INFO - 
[[ 98.15%   4.77%   8.59%  42.86%]
 [  1.15%  94.24%  20.90%  45.24%]
 [  0.17%   0.81%  70.41%   4.76%]
 [  0.53%   0.18%   0.10%   7.14%]]
[2024-01-06 18:22:56,138] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 18:22:56,224] {result_logger:143} INFO - 
[[46803  1220   296     0]
 [ 5887 27910  1308     0]
 [  827   207  4307     0]
 [  763    40    31     0]]
[2024-01-06 18:22:56,444] {result_logger:150} INFO - 
[[ 96.86%   2.52%   0.61%   0.00%]
 [ 16.77%  79.50%   3.73%   0.00%]
 [ 15.48%   3.88%  80.64%   0.00%]
 [ 91.49%   4.80%   3.72%   0.00%]]
[2024-01-06 18:22:56,657] {result_logger:154} INFO - 
[[ 86.23%   4.15%   4.98%    nan%]
 [ 10.85%  95.01%  22.01%    nan%]
 [  1.52%   0.70%  72.48%    nan%]
 [  1.41%   0.14%   0.52%    nan%]]
[2024-01-06 18:22:57,119] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 18:22:57,119] {result_logger:77} INFO - actual:
[2024-01-06 18:22:57,119] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 18:22:57,119] {result_logger:79} INFO - predicted:
[2024-01-06 18:22:57,119] {result_logger:80} INFO - 
[[96.54%  2.79%  0.67%  0.00%]
 [ 4.44% 93.89%  1.66%  0.00%]
 [ 9.63%  4.73% 85.64%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 18:22:57,155] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it1/model_8conv_2fc-best.pth
[2024-01-06 18:22:57,156] {run_experiment:113} INFO - [epoch  10] execution time: 222.92s	 avg f1-score: 0.8503

[2024-01-06 18:22:57,156] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 18:22:57,216] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 18:23:24,362] {train_model:86} INFO - Train Epoch: 11 [60928/612104 (10%)]	lr:1.58e-04	Loss: 0.275172
[2024-01-06 18:24:04,806] {train_model:86} INFO - Train Epoch: 11 [122112/612104 (20%)]	lr:1.58e-04	Loss: 0.109808
[2024-01-06 18:24:17,277] {train_model:86} INFO - Train Epoch: 11 [183296/612104 (30%)]	lr:1.58e-04	Loss: 0.078215
[2024-01-06 18:24:29,188] {train_model:86} INFO - Train Epoch: 11 [244480/612104 (40%)]	lr:1.58e-04	Loss: 0.122978
[2024-01-06 18:24:57,192] {train_model:86} INFO - Train Epoch: 11 [305664/612104 (50%)]	lr:1.58e-04	Loss: 0.094457
[2024-01-06 18:25:23,261] {train_model:86} INFO - Train Epoch: 11 [366848/612104 (60%)]	lr:1.58e-04	Loss: 0.132619
[2024-01-06 18:25:35,602] {train_model:86} INFO - Train Epoch: 11 [428032/612104 (70%)]	lr:1.58e-04	Loss: 0.093401
[2024-01-06 18:25:48,315] {train_model:86} INFO - Train Epoch: 11 [489216/612104 (80%)]	lr:1.58e-04	Loss: 0.080490
[2024-01-06 18:26:00,636] {train_model:86} INFO - Train Epoch: 11 [550400/612104 (90%)]	lr:1.58e-04	Loss: 0.105257
[2024-01-06 18:26:13,120] {train_model:86} INFO - Train Epoch: 11 [611584/612104 (100%)]	lr:1.58e-04	Loss: 0.081791
[2024-01-06 18:26:25,886] {run_experiment:78} INFO - 
[2024-01-06 18:26:25,893] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 18:26:27,281] {result_logger:108} INFO - precision on WAKE: 0.987
[2024-01-06 18:26:28,212] {result_logger:109} INFO - recall on WAKE: 0.954
[2024-01-06 18:26:29,145] {result_logger:112} INFO - F1-score on WAKE: 0.970
[2024-01-06 18:26:29,145] {result_logger:113} INFO - 
[2024-01-06 18:26:30,589] {result_logger:108} INFO - precision on NREM: 0.945
[2024-01-06 18:26:31,529] {result_logger:109} INFO - recall on NREM: 0.941
[2024-01-06 18:26:32,442] {result_logger:112} INFO - F1-score on NREM: 0.943
[2024-01-06 18:26:32,443] {result_logger:113} INFO - 
[2024-01-06 18:26:33,685] {result_logger:108} INFO - precision on REM: 0.714
[2024-01-06 18:26:34,484] {result_logger:109} INFO - recall on REM: 0.937
[2024-01-06 18:26:35,280] {result_logger:112} INFO - F1-score on REM: 0.811
[2024-01-06 18:26:35,280] {result_logger:113} INFO - 
[2024-01-06 18:26:35,489] {result_logger:116} INFO - average precision on sleep stages: 0.882
[2024-01-06 18:26:35,699] {result_logger:118} INFO - average recall on sleep stages: 0.944
[2024-01-06 18:26:35,911] {result_logger:120} INFO - average F1-score on sleep stages: 0.908
[2024-01-06 18:26:36,488] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.944
[2024-01-06 18:26:36,516] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.948
[2024-01-06 18:26:36,520] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 18:26:36,691] {result_logger:108} INFO - precision on WAKE: 0.882
[2024-01-06 18:26:36,798] {result_logger:109} INFO - recall on WAKE: 0.945
[2024-01-06 18:26:36,905] {result_logger:112} INFO - F1-score on WAKE: 0.912
[2024-01-06 18:26:36,905] {result_logger:113} INFO - 
[2024-01-06 18:26:37,085] {result_logger:108} INFO - precision on NREM: 0.960
[2024-01-06 18:26:37,189] {result_logger:109} INFO - recall on NREM: 0.759
[2024-01-06 18:26:37,292] {result_logger:112} INFO - F1-score on NREM: 0.848
[2024-01-06 18:26:37,292] {result_logger:113} INFO - 
[2024-01-06 18:26:37,468] {result_logger:108} INFO - precision on REM: 0.525
[2024-01-06 18:26:37,573] {result_logger:109} INFO - recall on REM: 0.908
[2024-01-06 18:26:37,675] {result_logger:112} INFO - F1-score on REM: 0.665
[2024-01-06 18:26:37,675] {result_logger:113} INFO - 
[2024-01-06 18:26:37,695] {result_logger:116} INFO - average precision on sleep stages: 0.789
[2024-01-06 18:26:37,715] {result_logger:118} INFO - average recall on sleep stages: 0.871
[2024-01-06 18:26:37,735] {result_logger:120} INFO - average F1-score on sleep stages: 0.808
[2024-01-06 18:26:37,811] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.871
[2024-01-06 18:26:37,814] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.869
[2024-01-06 18:26:37,814] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 18:26:38,426] {result_logger:143} INFO - 
[[316728  11152   4171      4]
 [  3660 225164  10346     20]
 [   537   1884  36249      1]
 [  1689    435     61      3]]
[2024-01-06 18:26:39,053] {result_logger:150} INFO - 
[[ 95.38%   3.36%   1.26%   0.00%]
 [  1.53%  94.14%   4.33%   0.01%]
 [  1.39%   4.87%  93.74%   0.00%]
 [ 77.19%  19.88%   2.79%   0.14%]]
[2024-01-06 18:26:39,682] {result_logger:154} INFO - 
[[ 98.18%   4.67%   8.21%  14.29%]
 [  1.13%  94.35%  20.36%  71.43%]
 [  0.17%   0.79%  71.32%   3.57%]
 [  0.52%   0.18%   0.12%  10.71%]]
[2024-01-06 18:26:39,683] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 18:26:39,764] {result_logger:143} INFO - 
[[45646  1028  1645     0]
 [ 5700 26654  2751     0]
 [  402    87  4852     0]
 [  633    36   165     0]]
[2024-01-06 18:26:39,973] {result_logger:150} INFO - 
[[ 94.47%   2.13%   3.40%   0.00%]
 [ 16.24%  75.93%   7.84%   0.00%]
 [  7.53%   1.63%  90.84%   0.00%]
 [ 75.90%   4.32%  19.78%   0.00%]]
[2024-01-06 18:26:40,171] {result_logger:154} INFO - 
[[ 87.14%   3.70%  17.48%    nan%]
 [ 10.88%  95.86%  29.23%    nan%]
 [  0.77%   0.31%  51.55%    nan%]
 [  1.21%   0.13%   1.75%    nan%]]
[2024-01-06 18:26:40,616] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 18:26:40,617] {result_logger:77} INFO - actual:
[2024-01-06 18:26:40,617] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 18:26:40,617] {result_logger:79} INFO - predicted:
[2024-01-06 18:26:40,617] {result_logger:80} INFO - 
[[95.86%  2.47%  1.67%  0.00%]
 [ 4.05% 93.24%  2.71%  0.00%]
 [11.07%  6.21% 82.72%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 18:26:40,653] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it1/model_8conv_2fc-best.pth
[2024-01-06 18:26:40,653] {run_experiment:113} INFO - [epoch  11] execution time: 223.50s	 avg f1-score: 0.8084

[2024-01-06 18:26:40,653] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 18:26:40,712] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 18:27:22,653] {train_model:86} INFO - Train Epoch: 12 [60928/612104 (10%)]	lr:1.49e-04	Loss: 0.156475
[2024-01-06 18:27:48,557] {train_model:86} INFO - Train Epoch: 12 [122112/612104 (20%)]	lr:1.49e-04	Loss: 0.103670
[2024-01-06 18:27:59,773] {train_model:86} INFO - Train Epoch: 12 [183296/612104 (30%)]	lr:1.49e-04	Loss: 0.132907
[2024-01-06 18:28:12,703] {train_model:86} INFO - Train Epoch: 12 [244480/612104 (40%)]	lr:1.49e-04	Loss: 0.182551
[2024-01-06 18:28:39,018] {train_model:86} INFO - Train Epoch: 12 [305664/612104 (50%)]	lr:1.49e-04	Loss: 0.121094
[2024-01-06 18:28:53,086] {train_model:86} INFO - Train Epoch: 12 [366848/612104 (60%)]	lr:1.49e-04	Loss: 0.082806
[2024-01-06 18:29:19,224] {train_model:86} INFO - Train Epoch: 12 [428032/612104 (70%)]	lr:1.49e-04	Loss: 0.142880
[2024-01-06 18:29:31,596] {train_model:86} INFO - Train Epoch: 12 [489216/612104 (80%)]	lr:1.49e-04	Loss: 0.154524
[2024-01-06 18:29:44,291] {train_model:86} INFO - Train Epoch: 12 [550400/612104 (90%)]	lr:1.49e-04	Loss: 0.120524
[2024-01-06 18:29:56,906] {train_model:86} INFO - Train Epoch: 12 [611584/612104 (100%)]	lr:1.49e-04	Loss: 0.100472
[2024-01-06 18:30:10,403] {run_experiment:78} INFO - 
[2024-01-06 18:30:10,409] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 18:30:11,823] {result_logger:108} INFO - precision on WAKE: 0.986
[2024-01-06 18:30:12,725] {result_logger:109} INFO - recall on WAKE: 0.957
[2024-01-06 18:30:13,661] {result_logger:112} INFO - F1-score on WAKE: 0.971
[2024-01-06 18:30:13,661] {result_logger:113} INFO - 
[2024-01-06 18:30:15,070] {result_logger:108} INFO - precision on NREM: 0.948
[2024-01-06 18:30:15,970] {result_logger:109} INFO - recall on NREM: 0.942
[2024-01-06 18:30:16,859] {result_logger:112} INFO - F1-score on NREM: 0.945
[2024-01-06 18:30:16,860] {result_logger:113} INFO - 
[2024-01-06 18:30:18,085] {result_logger:108} INFO - precision on REM: 0.723
[2024-01-06 18:30:18,862] {result_logger:109} INFO - recall on REM: 0.938
[2024-01-06 18:30:19,641] {result_logger:112} INFO - F1-score on REM: 0.817
[2024-01-06 18:30:19,641] {result_logger:113} INFO - 
[2024-01-06 18:30:19,836] {result_logger:116} INFO - average precision on sleep stages: 0.886
[2024-01-06 18:30:20,038] {result_logger:118} INFO - average recall on sleep stages: 0.945
[2024-01-06 18:30:20,244] {result_logger:120} INFO - average F1-score on sleep stages: 0.911
[2024-01-06 18:30:20,809] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.945
[2024-01-06 18:30:20,837] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.950
[2024-01-06 18:30:20,841] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 18:30:21,007] {result_logger:108} INFO - precision on WAKE: 0.847
[2024-01-06 18:30:21,108] {result_logger:109} INFO - recall on WAKE: 0.976
[2024-01-06 18:30:21,204] {result_logger:112} INFO - F1-score on WAKE: 0.907
[2024-01-06 18:30:21,204] {result_logger:113} INFO - 
[2024-01-06 18:30:21,369] {result_logger:108} INFO - precision on NREM: 0.965
[2024-01-06 18:30:21,470] {result_logger:109} INFO - recall on NREM: 0.723
[2024-01-06 18:30:21,573] {result_logger:112} INFO - F1-score on NREM: 0.827
[2024-01-06 18:30:21,574] {result_logger:113} INFO - 
[2024-01-06 18:30:21,743] {result_logger:108} INFO - precision on REM: 0.623
[2024-01-06 18:30:21,847] {result_logger:109} INFO - recall on REM: 0.789
[2024-01-06 18:30:21,950] {result_logger:112} INFO - F1-score on REM: 0.696
[2024-01-06 18:30:21,950] {result_logger:113} INFO - 
[2024-01-06 18:30:21,969] {result_logger:116} INFO - average precision on sleep stages: 0.811
[2024-01-06 18:30:21,988] {result_logger:118} INFO - average recall on sleep stages: 0.829
[2024-01-06 18:30:22,007] {result_logger:120} INFO - average F1-score on sleep stages: 0.810
[2024-01-06 18:30:22,083] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.829
[2024-01-06 18:30:22,086] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.865
[2024-01-06 18:30:22,086] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 18:30:22,701] {result_logger:143} INFO - 
[[317636  10518   3897      4]
 [  3870 225322   9980     18]
 [   537   1871  36263      0]
 [  1773    357     57      1]]
[2024-01-06 18:30:23,317] {result_logger:150} INFO - 
[[ 95.66%   3.17%   1.17%   0.00%]
 [  1.62%  94.20%   4.17%   0.01%]
 [  1.39%   4.84%  93.77%   0.00%]
 [ 81.03%  16.32%   2.61%   0.05%]]
[2024-01-06 18:30:23,926] {result_logger:154} INFO - 
[[ 98.09%   4.42%   7.76%  17.39%]
 [  1.20%  94.65%  19.88%  78.26%]
 [  0.17%   0.79%  72.24%   0.00%]
 [  0.55%   0.15%   0.11%   4.35%]]
[2024-01-06 18:30:23,926] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 18:30:24,009] {result_logger:143} INFO - 
[[47162   840   317     0]
 [ 7492 25380  2233     0]
 [ 1041    88  4212     0]
 [  783    29    22     0]]
[2024-01-06 18:30:24,257] {result_logger:150} INFO - 
[[ 97.61%   1.74%   0.66%   0.00%]
 [ 21.34%  72.30%   6.36%   0.00%]
 [ 19.49%   1.65%  78.86%   0.00%]
 [ 93.88%   3.48%   2.64%   0.00%]]
[2024-01-06 18:30:24,471] {result_logger:154} INFO - 
[[ 83.51%   3.19%   4.67%    nan%]
 [ 13.27%  96.37%  32.92%    nan%]
 [  1.84%   0.33%  62.09%    nan%]
 [  1.39%   0.11%   0.32%    nan%]]
[2024-01-06 18:30:24,930] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 18:30:24,930] {result_logger:77} INFO - actual:
[2024-01-06 18:30:24,930] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 18:30:24,930] {result_logger:79} INFO - predicted:
[2024-01-06 18:30:24,930] {result_logger:80} INFO - 
[[96.62%  2.54%  0.84%  0.00%]
 [ 4.58% 93.02%  2.40%  0.00%]
 [10.35%  5.91% 83.74%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 18:30:24,983] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it1/model_8conv_2fc-best.pth
[2024-01-06 18:30:24,983] {run_experiment:113} INFO - [epoch  12] execution time: 224.33s	 avg f1-score: 0.8098

[2024-01-06 18:30:24,983] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 18:30:25,041] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 18:31:05,807] {train_model:86} INFO - Train Epoch: 13 [60928/612104 (10%)]	lr:1.40e-04	Loss: 0.134319
[2024-01-06 18:31:17,998] {train_model:86} INFO - Train Epoch: 13 [122112/612104 (20%)]	lr:1.40e-04	Loss: 0.173317
[2024-01-06 18:31:30,160] {train_model:86} INFO - Train Epoch: 13 [183296/612104 (30%)]	lr:1.40e-04	Loss: 0.123168
[2024-01-06 18:31:41,895] {train_model:86} INFO - Train Epoch: 13 [244480/612104 (40%)]	lr:1.40e-04	Loss: 0.110765
[2024-01-06 18:31:54,220] {train_model:86} INFO - Train Epoch: 13 [305664/612104 (50%)]	lr:1.40e-04	Loss: 0.143552
[2024-01-06 18:32:22,441] {train_model:86} INFO - Train Epoch: 13 [366848/612104 (60%)]	lr:1.40e-04	Loss: 0.131073
[2024-01-06 18:32:46,873] {train_model:86} INFO - Train Epoch: 13 [428032/612104 (70%)]	lr:1.40e-04	Loss: 0.157994
[2024-01-06 18:32:59,662] {train_model:86} INFO - Train Epoch: 13 [489216/612104 (80%)]	lr:1.40e-04	Loss: 0.143403
[2024-01-06 18:33:11,808] {train_model:86} INFO - Train Epoch: 13 [550400/612104 (90%)]	lr:1.40e-04	Loss: 0.415320
[2024-01-06 18:33:24,172] {train_model:86} INFO - Train Epoch: 13 [611584/612104 (100%)]	lr:1.40e-04	Loss: 0.103155
[2024-01-06 18:33:37,807] {run_experiment:78} INFO - 
[2024-01-06 18:33:37,814] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 18:33:39,288] {result_logger:108} INFO - precision on WAKE: 0.987
[2024-01-06 18:33:40,232] {result_logger:109} INFO - recall on WAKE: 0.957
[2024-01-06 18:33:41,166] {result_logger:112} INFO - F1-score on WAKE: 0.972
[2024-01-06 18:33:41,166] {result_logger:113} INFO - 
[2024-01-06 18:33:42,567] {result_logger:108} INFO - precision on NREM: 0.949
[2024-01-06 18:33:43,485] {result_logger:109} INFO - recall on NREM: 0.943
[2024-01-06 18:33:44,391] {result_logger:112} INFO - F1-score on NREM: 0.946
[2024-01-06 18:33:44,391] {result_logger:113} INFO - 
[2024-01-06 18:33:45,684] {result_logger:108} INFO - precision on REM: 0.726
[2024-01-06 18:33:46,481] {result_logger:109} INFO - recall on REM: 0.941
[2024-01-06 18:33:47,264] {result_logger:112} INFO - F1-score on REM: 0.820
[2024-01-06 18:33:47,264] {result_logger:113} INFO - 
[2024-01-06 18:33:47,473] {result_logger:116} INFO - average precision on sleep stages: 0.887
[2024-01-06 18:33:47,682] {result_logger:118} INFO - average recall on sleep stages: 0.947
[2024-01-06 18:33:47,891] {result_logger:120} INFO - average F1-score on sleep stages: 0.912
[2024-01-06 18:33:48,506] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.947
[2024-01-06 18:33:48,537] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.951
[2024-01-06 18:33:48,541] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 18:33:48,725] {result_logger:108} INFO - precision on WAKE: 0.868
[2024-01-06 18:33:48,833] {result_logger:109} INFO - recall on WAKE: 0.970
[2024-01-06 18:33:48,945] {result_logger:112} INFO - F1-score on WAKE: 0.916
[2024-01-06 18:33:48,945] {result_logger:113} INFO - 
[2024-01-06 18:33:49,127] {result_logger:108} INFO - precision on NREM: 0.958
[2024-01-06 18:33:49,239] {result_logger:109} INFO - recall on NREM: 0.752
[2024-01-06 18:33:49,347] {result_logger:112} INFO - F1-score on NREM: 0.843
[2024-01-06 18:33:49,347] {result_logger:113} INFO - 
[2024-01-06 18:33:49,541] {result_logger:108} INFO - precision on REM: 0.612
[2024-01-06 18:33:49,655] {result_logger:109} INFO - recall on REM: 0.821
[2024-01-06 18:33:49,767] {result_logger:112} INFO - F1-score on REM: 0.701
[2024-01-06 18:33:49,767] {result_logger:113} INFO - 
[2024-01-06 18:33:49,787] {result_logger:116} INFO - average precision on sleep stages: 0.812
[2024-01-06 18:33:49,806] {result_logger:118} INFO - average recall on sleep stages: 0.848
[2024-01-06 18:33:49,826] {result_logger:120} INFO - average F1-score on sleep stages: 0.820
[2024-01-06 18:33:49,909] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.848
[2024-01-06 18:33:49,912] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.875
[2024-01-06 18:33:49,912] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 18:33:50,582] {result_logger:143} INFO - 
[[317741  10408   3904      2]
 [  3730 225594   9858      8]
 [   533   1735  36401      2]
 [  1778    354     54      2]]
[2024-01-06 18:33:51,241] {result_logger:150} INFO - 
[[ 95.69%   3.13%   1.18%   0.00%]
 [  1.56%  94.32%   4.12%   0.00%]
 [  1.38%   4.49%  94.13%   0.01%]
 [ 81.26%  16.18%   2.47%   0.09%]]
[2024-01-06 18:33:51,881] {result_logger:154} INFO - 
[[ 98.13%   4.37%   7.77%  14.29%]
 [  1.15%  94.75%  19.63%  57.14%]
 [  0.16%   0.73%  72.49%  14.29%]
 [  0.55%   0.15%   0.11%  14.29%]]
[2024-01-06 18:33:51,881] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 18:33:51,966] {result_logger:143} INFO - 
[[46865  1037   417     0]
 [ 6324 26415  2366     0]
 [  822   133  4386     0]
 [  748    47    39     0]]
[2024-01-06 18:33:52,336] {result_logger:150} INFO - 
[[ 96.99%   2.15%   0.86%   0.00%]
 [ 18.01%  75.25%   6.74%   0.00%]
 [ 15.39%   2.49%  82.12%   0.00%]
 [ 89.69%   5.64%   4.68%   0.00%]]
[2024-01-06 18:33:52,565] {result_logger:154} INFO - 
[[ 85.58%   3.75%   5.79%    nan%]
 [ 11.55%  95.60%  32.82%    nan%]
 [  1.50%   0.48%  60.85%    nan%]
 [  1.37%   0.17%   0.54%    nan%]]
[2024-01-06 18:33:53,067] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 18:33:53,068] {result_logger:77} INFO - actual:
[2024-01-06 18:33:53,068] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 18:33:53,068] {result_logger:79} INFO - predicted:
[2024-01-06 18:33:53,068] {result_logger:80} INFO - 
[[96.37%  2.70%  0.93%  0.00%]
 [ 4.52% 92.75%  2.73%  0.00%]
 [10.24%  7.33% 82.44%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 18:33:53,120] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it1/model_8conv_2fc-best.pth
[2024-01-06 18:33:53,120] {run_experiment:113} INFO - [epoch  13] execution time: 208.14s	 avg f1-score: 0.8200

[2024-01-06 18:33:53,120] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 18:33:53,181] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 18:34:33,791] {train_model:86} INFO - Train Epoch: 14 [60928/612104 (10%)]	lr:1.32e-04	Loss: 0.107439
[2024-01-06 18:34:46,698] {train_model:86} INFO - Train Epoch: 14 [122112/612104 (20%)]	lr:1.32e-04	Loss: 0.118145
[2024-01-06 18:34:59,711] {train_model:86} INFO - Train Epoch: 14 [183296/612104 (30%)]	lr:1.32e-04	Loss: 0.077345
[2024-01-06 18:35:12,315] {train_model:86} INFO - Train Epoch: 14 [244480/612104 (40%)]	lr:1.32e-04	Loss: 0.111817
[2024-01-06 18:35:24,843] {train_model:86} INFO - Train Epoch: 14 [305664/612104 (50%)]	lr:1.32e-04	Loss: 0.069488
[2024-01-06 18:35:37,200] {train_model:86} INFO - Train Epoch: 14 [366848/612104 (60%)]	lr:1.32e-04	Loss: 0.105548
[2024-01-06 18:35:49,434] {train_model:86} INFO - Train Epoch: 14 [428032/612104 (70%)]	lr:1.32e-04	Loss: 0.194364
[2024-01-06 18:36:17,157] {train_model:86} INFO - Train Epoch: 14 [489216/612104 (80%)]	lr:1.32e-04	Loss: 0.199340
[2024-01-06 18:36:43,827] {train_model:86} INFO - Train Epoch: 14 [550400/612104 (90%)]	lr:1.32e-04	Loss: 0.110779
[2024-01-06 18:37:11,537] {train_model:86} INFO - Train Epoch: 14 [611584/612104 (100%)]	lr:1.32e-04	Loss: 0.141404
[2024-01-06 18:37:24,116] {run_experiment:78} INFO - 
[2024-01-06 18:37:24,122] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 18:37:25,572] {result_logger:108} INFO - precision on WAKE: 0.987
[2024-01-06 18:37:26,516] {result_logger:109} INFO - recall on WAKE: 0.959
[2024-01-06 18:37:27,448] {result_logger:112} INFO - F1-score on WAKE: 0.973
[2024-01-06 18:37:27,448] {result_logger:113} INFO - 
[2024-01-06 18:37:28,855] {result_logger:108} INFO - precision on NREM: 0.950
[2024-01-06 18:37:29,747] {result_logger:109} INFO - recall on NREM: 0.945
[2024-01-06 18:37:30,645] {result_logger:112} INFO - F1-score on NREM: 0.947
[2024-01-06 18:37:30,645] {result_logger:113} INFO - 
[2024-01-06 18:37:31,940] {result_logger:108} INFO - precision on REM: 0.736
[2024-01-06 18:37:32,725] {result_logger:109} INFO - recall on REM: 0.943
[2024-01-06 18:37:33,506] {result_logger:112} INFO - F1-score on REM: 0.827
[2024-01-06 18:37:33,506] {result_logger:113} INFO - 
[2024-01-06 18:37:33,707] {result_logger:116} INFO - average precision on sleep stages: 0.891
[2024-01-06 18:37:33,915] {result_logger:118} INFO - average recall on sleep stages: 0.949
[2024-01-06 18:37:34,126] {result_logger:120} INFO - average F1-score on sleep stages: 0.916
[2024-01-06 18:37:34,714] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.949
[2024-01-06 18:37:34,742] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.952
[2024-01-06 18:37:34,746] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 18:37:34,920] {result_logger:108} INFO - precision on WAKE: 0.918
[2024-01-06 18:37:35,028] {result_logger:109} INFO - recall on WAKE: 0.611
[2024-01-06 18:37:35,135] {result_logger:112} INFO - F1-score on WAKE: 0.733
[2024-01-06 18:37:35,135] {result_logger:113} INFO - 
[2024-01-06 18:37:35,316] {result_logger:108} INFO - precision on NREM: 0.925
[2024-01-06 18:37:35,427] {result_logger:109} INFO - recall on NREM: 0.820
[2024-01-06 18:37:35,538] {result_logger:112} INFO - F1-score on NREM: 0.869
[2024-01-06 18:37:35,538] {result_logger:113} INFO - 
[2024-01-06 18:37:35,721] {result_logger:108} INFO - precision on REM: 0.202
[2024-01-06 18:37:35,833] {result_logger:109} INFO - recall on REM: 0.966
[2024-01-06 18:37:35,945] {result_logger:112} INFO - F1-score on REM: 0.335
[2024-01-06 18:37:35,945] {result_logger:113} INFO - 
[2024-01-06 18:37:35,966] {result_logger:116} INFO - average precision on sleep stages: 0.682
[2024-01-06 18:37:35,987] {result_logger:118} INFO - average recall on sleep stages: 0.799
[2024-01-06 18:37:36,007] {result_logger:120} INFO - average F1-score on sleep stages: 0.646
[2024-01-06 18:37:36,087] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.799
[2024-01-06 18:37:36,090] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.715
[2024-01-06 18:37:36,091] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 18:37:36,726] {result_logger:143} INFO - 
[[318345  10219   3491      0]
 [  3698 225926   9560      6]
 [   498   1698  36475      0]
 [  1790    348     50      0]]
[2024-01-06 18:37:37,353] {result_logger:150} INFO - 
[[ 95.87%   3.08%   1.05%   0.00%]
 [  1.55%  94.45%   4.00%   0.00%]
 [  1.29%   4.39%  94.32%   0.00%]
 [ 81.81%  15.90%   2.29%   0.00%]]
[2024-01-06 18:37:37,985] {result_logger:154} INFO - 
[[ 98.15%   4.29%   7.04%   0.00%]
 [  1.14%  94.85%  19.28% 100.00%]
 [  0.15%   0.71%  73.57%   0.00%]
 [  0.55%   0.15%   0.10%   0.00%]]
[2024-01-06 18:37:37,985] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 18:37:38,071] {result_logger:143} INFO - 
[[29501  2162 16656     0]
 [ 2631 28794  3680     0]
 [    3   177  5161     0]
 [   51   100   683     0]]
[2024-01-06 18:37:38,284] {result_logger:150} INFO - 
[[ 61.05%   4.47%  34.47%   0.00%]
 [  7.49%  82.02%  10.48%   0.00%]
 [  0.06%   3.31%  96.63%   0.00%]
 [  6.12%  11.99%  81.89%   0.00%]]
[2024-01-06 18:37:38,491] {result_logger:154} INFO - 
[[ 91.66%   6.92%  63.62%    nan%]
 [  8.17%  92.19%  14.06%    nan%]
 [  0.01%   0.57%  19.71%    nan%]
 [  0.16%   0.32%   2.61%    nan%]]
[2024-01-06 18:37:38,941] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 18:37:38,941] {result_logger:77} INFO - actual:
[2024-01-06 18:37:38,942] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 18:37:38,942] {result_logger:79} INFO - predicted:
[2024-01-06 18:37:38,942] {result_logger:80} INFO - 
[[92.50%  2.80%  4.69%  0.00%]
 [ 2.67% 92.97%  4.35%  0.00%]
 [ 6.03%  4.94% 89.03%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 18:37:38,979] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it1/model_8conv_2fc-best.pth
[2024-01-06 18:37:38,979] {run_experiment:113} INFO - [epoch  14] execution time: 225.86s	 avg f1-score: 0.6458

[2024-01-06 18:37:38,979] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 18:37:39,038] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 18:38:05,570] {train_model:86} INFO - Train Epoch: 15 [60928/612104 (10%)]	lr:1.25e-04	Loss: 0.162773
[2024-01-06 18:38:17,485] {train_model:86} INFO - Train Epoch: 15 [122112/612104 (20%)]	lr:1.25e-04	Loss: 0.132762
[2024-01-06 18:38:29,168] {train_model:86} INFO - Train Epoch: 15 [183296/612104 (30%)]	lr:1.25e-04	Loss: 0.067558
[2024-01-06 18:38:41,329] {train_model:86} INFO - Train Epoch: 15 [244480/612104 (40%)]	lr:1.25e-04	Loss: 0.122028
[2024-01-06 18:38:53,337] {train_model:86} INFO - Train Epoch: 15 [305664/612104 (50%)]	lr:1.25e-04	Loss: 0.128085
[2024-01-06 18:39:04,526] {train_model:86} INFO - Train Epoch: 15 [366848/612104 (60%)]	lr:1.25e-04	Loss: 0.179347
[2024-01-06 18:39:17,442] {train_model:86} INFO - Train Epoch: 15 [428032/612104 (70%)]	lr:1.25e-04	Loss: 0.113778
[2024-01-06 18:39:29,935] {train_model:86} INFO - Train Epoch: 15 [489216/612104 (80%)]	lr:1.25e-04	Loss: 0.095445
[2024-01-06 18:39:57,407] {train_model:86} INFO - Train Epoch: 15 [550400/612104 (90%)]	lr:1.25e-04	Loss: 0.068632
[2024-01-06 18:40:42,582] {train_model:86} INFO - Train Epoch: 15 [611584/612104 (100%)]	lr:1.25e-04	Loss: 0.104730
[2024-01-06 18:40:55,860] {run_experiment:78} INFO - 
[2024-01-06 18:40:55,867] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 18:40:57,280] {result_logger:108} INFO - precision on WAKE: 0.988
[2024-01-06 18:40:58,184] {result_logger:109} INFO - recall on WAKE: 0.958
[2024-01-06 18:40:59,114] {result_logger:112} INFO - F1-score on WAKE: 0.973
[2024-01-06 18:40:59,114] {result_logger:113} INFO - 
[2024-01-06 18:41:00,529] {result_logger:108} INFO - precision on NREM: 0.949
[2024-01-06 18:41:01,456] {result_logger:109} INFO - recall on NREM: 0.947
[2024-01-06 18:41:02,377] {result_logger:112} INFO - F1-score on NREM: 0.948
[2024-01-06 18:41:02,377] {result_logger:113} INFO - 
[2024-01-06 18:41:03,668] {result_logger:108} INFO - precision on REM: 0.745
[2024-01-06 18:41:04,478] {result_logger:109} INFO - recall on REM: 0.945
[2024-01-06 18:41:05,284] {result_logger:112} INFO - F1-score on REM: 0.833
[2024-01-06 18:41:05,284] {result_logger:113} INFO - 
[2024-01-06 18:41:05,495] {result_logger:116} INFO - average precision on sleep stages: 0.894
[2024-01-06 18:41:05,709] {result_logger:118} INFO - average recall on sleep stages: 0.950
[2024-01-06 18:41:05,925] {result_logger:120} INFO - average F1-score on sleep stages: 0.918
[2024-01-06 18:41:06,515] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.950
[2024-01-06 18:41:06,545] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.953
[2024-01-06 18:41:06,549] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 18:41:06,729] {result_logger:108} INFO - precision on WAKE: 0.926
[2024-01-06 18:41:06,837] {result_logger:109} INFO - recall on WAKE: 0.703
[2024-01-06 18:41:06,944] {result_logger:112} INFO - F1-score on WAKE: 0.800
[2024-01-06 18:41:06,945] {result_logger:113} INFO - 
[2024-01-06 18:41:07,119] {result_logger:108} INFO - precision on NREM: 0.935
[2024-01-06 18:41:07,230] {result_logger:109} INFO - recall on NREM: 0.841
[2024-01-06 18:41:07,341] {result_logger:112} INFO - F1-score on NREM: 0.885
[2024-01-06 18:41:07,341] {result_logger:113} INFO - 
[2024-01-06 18:41:07,515] {result_logger:108} INFO - precision on REM: 0.252
[2024-01-06 18:41:07,623] {result_logger:109} INFO - recall on REM: 0.969
[2024-01-06 18:41:07,734] {result_logger:112} INFO - F1-score on REM: 0.401
[2024-01-06 18:41:07,734] {result_logger:113} INFO - 
[2024-01-06 18:41:07,755] {result_logger:116} INFO - average precision on sleep stages: 0.705
[2024-01-06 18:41:07,775] {result_logger:118} INFO - average recall on sleep stages: 0.838
[2024-01-06 18:41:07,795] {result_logger:120} INFO - average F1-score on sleep stages: 0.695
[2024-01-06 18:41:07,877] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.838
[2024-01-06 18:41:07,880] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.774
[2024-01-06 18:41:07,881] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 18:41:08,523] {result_logger:143} INFO - 
[[318238  10471   3341      5]
 [  3514 226517   9149     10]
 [   450   1693  36528      0]
 [  1765    379     44      0]]
[2024-01-06 18:41:09,165] {result_logger:150} INFO - 
[[ 95.84%   3.15%   1.01%   0.00%]
 [  1.47%  94.70%   3.82%   0.00%]
 [  1.16%   4.38%  94.46%   0.00%]
 [ 80.67%  17.32%   2.01%   0.00%]]
[2024-01-06 18:41:09,779] {result_logger:154} INFO - 
[[ 98.23%   4.38%   6.81%  33.33%]
 [  1.08%  94.75%  18.65%  66.67%]
 [  0.14%   0.71%  74.45%   0.00%]
 [  0.54%   0.16%   0.09%   0.00%]]
[2024-01-06 18:41:09,779] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 18:41:09,861] {result_logger:143} INFO - 
[[33991  1911 12417     0]
 [ 2683 29507  2915     0]
 [   23   140  5178     0]
 [  113    80   641     0]]
[2024-01-06 18:41:10,074] {result_logger:150} INFO - 
[[ 70.35%   3.95%  25.70%   0.00%]
 [  7.64%  84.05%   8.30%   0.00%]
 [  0.43%   2.62%  96.95%   0.00%]
 [ 13.55%   9.59%  76.86%   0.00%]]
[2024-01-06 18:41:10,283] {result_logger:154} INFO - 
[[ 92.34%   6.04%  58.71%    nan%]
 [  7.29%  93.26%  13.78%    nan%]
 [  0.06%   0.44%  24.48%    nan%]
 [  0.31%   0.25%   3.03%    nan%]]
[2024-01-06 18:41:10,722] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 18:41:10,722] {result_logger:77} INFO - actual:
[2024-01-06 18:41:10,722] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 18:41:10,722] {result_logger:79} INFO - predicted:
[2024-01-06 18:41:10,722] {result_logger:80} INFO - 
[[94.87%  2.72%  2.41%  0.00%]
 [ 2.74% 93.75%  3.51%  0.00%]
 [ 4.84%  4.61% 90.55%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 18:41:10,758] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it1/model_8conv_2fc-best.pth
[2024-01-06 18:41:10,758] {run_experiment:113} INFO - [epoch  15] execution time: 211.78s	 avg f1-score: 0.6952

[2024-01-06 18:41:10,759] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 18:41:10,818] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 18:41:37,059] {train_model:86} INFO - Train Epoch: 16 [60928/612104 (10%)]	lr:1.17e-04	Loss: 0.119844
[2024-01-06 18:41:49,218] {train_model:86} INFO - Train Epoch: 16 [122112/612104 (20%)]	lr:1.17e-04	Loss: 0.155282
[2024-01-06 18:42:01,830] {train_model:86} INFO - Train Epoch: 16 [183296/612104 (30%)]	lr:1.17e-04	Loss: 0.230995
[2024-01-06 18:42:14,316] {train_model:86} INFO - Train Epoch: 16 [244480/612104 (40%)]	lr:1.17e-04	Loss: 0.090276
[2024-01-06 18:42:26,211] {train_model:86} INFO - Train Epoch: 16 [305664/612104 (50%)]	lr:1.17e-04	Loss: 0.202121
[2024-01-06 18:42:38,255] {train_model:86} INFO - Train Epoch: 16 [366848/612104 (60%)]	lr:1.17e-04	Loss: 0.102555
[2024-01-06 18:42:51,192] {train_model:86} INFO - Train Epoch: 16 [428032/612104 (70%)]	lr:1.17e-04	Loss: 0.081162
[2024-01-06 18:43:03,337] {train_model:86} INFO - Train Epoch: 16 [489216/612104 (80%)]	lr:1.17e-04	Loss: 0.169207
[2024-01-06 18:43:43,732] {train_model:86} INFO - Train Epoch: 16 [550400/612104 (90%)]	lr:1.17e-04	Loss: 0.099864
[2024-01-06 18:43:57,915] {train_model:86} INFO - Train Epoch: 16 [611584/612104 (100%)]	lr:1.17e-04	Loss: 0.072884
[2024-01-06 18:44:10,650] {run_experiment:78} INFO - 
[2024-01-06 18:44:10,656] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 18:44:12,099] {result_logger:108} INFO - precision on WAKE: 0.988
[2024-01-06 18:44:13,019] {result_logger:109} INFO - recall on WAKE: 0.959
[2024-01-06 18:44:13,972] {result_logger:112} INFO - F1-score on WAKE: 0.973
[2024-01-06 18:44:13,972] {result_logger:113} INFO - 
[2024-01-06 18:44:15,368] {result_logger:108} INFO - precision on NREM: 0.951
[2024-01-06 18:44:16,275] {result_logger:109} INFO - recall on NREM: 0.947
[2024-01-06 18:44:17,198] {result_logger:112} INFO - F1-score on NREM: 0.949
[2024-01-06 18:44:17,198] {result_logger:113} INFO - 
[2024-01-06 18:44:18,491] {result_logger:108} INFO - precision on REM: 0.742
[2024-01-06 18:44:19,307] {result_logger:109} INFO - recall on REM: 0.947
[2024-01-06 18:44:20,118] {result_logger:112} INFO - F1-score on REM: 0.832
[2024-01-06 18:44:20,119] {result_logger:113} INFO - 
[2024-01-06 18:44:20,337] {result_logger:116} INFO - average precision on sleep stages: 0.894
[2024-01-06 18:44:20,554] {result_logger:118} INFO - average recall on sleep stages: 0.951
[2024-01-06 18:44:20,773] {result_logger:120} INFO - average F1-score on sleep stages: 0.918
[2024-01-06 18:44:21,365] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.951
[2024-01-06 18:44:21,395] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.953
[2024-01-06 18:44:21,399] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 18:44:21,580] {result_logger:108} INFO - precision on WAKE: 0.855
[2024-01-06 18:44:21,694] {result_logger:109} INFO - recall on WAKE: 0.972
[2024-01-06 18:44:21,808] {result_logger:112} INFO - F1-score on WAKE: 0.909
[2024-01-06 18:44:21,808] {result_logger:113} INFO - 
[2024-01-06 18:44:21,990] {result_logger:108} INFO - precision on NREM: 0.954
[2024-01-06 18:44:22,104] {result_logger:109} INFO - recall on NREM: 0.734
[2024-01-06 18:44:22,218] {result_logger:112} INFO - F1-score on NREM: 0.830
[2024-01-06 18:44:22,218] {result_logger:113} INFO - 
[2024-01-06 18:44:22,399] {result_logger:108} INFO - precision on REM: 0.614
[2024-01-06 18:44:22,512] {result_logger:109} INFO - recall on REM: 0.780
[2024-01-06 18:44:22,623] {result_logger:112} INFO - F1-score on REM: 0.687
[2024-01-06 18:44:22,623] {result_logger:113} INFO - 
[2024-01-06 18:44:22,644] {result_logger:116} INFO - average precision on sleep stages: 0.808
[2024-01-06 18:44:22,664] {result_logger:118} INFO - average recall on sleep stages: 0.829
[2024-01-06 18:44:22,685] {result_logger:120} INFO - average F1-score on sleep stages: 0.809
[2024-01-06 18:44:22,767] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.829
[2024-01-06 18:44:22,770] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.866
[2024-01-06 18:44:22,770] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 18:44:23,433] {result_logger:143} INFO - 
[[318443  10153   3456      3]
 [  3470 226471   9247      2]
 [   447   1595  36629      0]
 [  1815    321     50      2]]
[2024-01-06 18:44:24,098] {result_logger:150} INFO - 
[[ 95.90%   3.06%   1.04%   0.00%]
 [  1.45%  94.68%   3.87%   0.00%]
 [  1.16%   4.12%  94.72%   0.00%]
 [ 82.95%  14.67%   2.29%   0.09%]]
[2024-01-06 18:44:24,761] {result_logger:154} INFO - 
[[ 98.23%   4.26%   7.00%  42.86%]
 [  1.07%  94.94%  18.73%  28.57%]
 [  0.14%   0.67%  74.17%   0.00%]
 [  0.56%   0.13%   0.10%  28.57%]]
[2024-01-06 18:44:24,761] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 18:44:24,847] {result_logger:143} INFO - 
[[46957  1100   262     0]
 [ 6973 25779  2353     0]
 [ 1021   153  4167     0]
 [  731    58    45     0]]
[2024-01-06 18:44:25,066] {result_logger:150} INFO - 
[[ 97.18%   2.28%   0.54%   0.00%]
 [ 19.86%  73.43%   6.70%   0.00%]
 [ 19.12%   2.86%  78.02%   0.00%]
 [ 87.65%   6.95%   5.40%   0.00%]]
[2024-01-06 18:44:25,274] {result_logger:154} INFO - 
[[ 84.33%   4.06%   3.84%    nan%]
 [ 12.52%  95.16%  34.47%    nan%]
 [  1.83%   0.56%  61.04%    nan%]
 [  1.31%   0.21%   0.66%    nan%]]
[2024-01-06 18:44:25,832] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 18:44:25,832] {result_logger:77} INFO - actual:
[2024-01-06 18:44:25,833] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 18:44:25,833] {result_logger:79} INFO - predicted:
[2024-01-06 18:44:25,833] {result_logger:80} INFO - 
[[96.41%  2.69%  0.90%  0.00%]
 [ 4.55% 92.71%  2.74%  0.00%]
 [11.23%  7.00% 81.76%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 18:44:25,869] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it1/model_8conv_2fc-best.pth
[2024-01-06 18:44:25,870] {run_experiment:113} INFO - [epoch  16] execution time: 195.11s	 avg f1-score: 0.8089

[2024-01-06 18:44:25,870] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 18:44:25,931] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 18:44:52,691] {train_model:86} INFO - Train Epoch: 17 [60928/612104 (10%)]	lr:1.11e-04	Loss: 0.117247
[2024-01-06 18:45:04,606] {train_model:86} INFO - Train Epoch: 17 [122112/612104 (20%)]	lr:1.11e-04	Loss: 0.083671
[2024-01-06 18:45:16,666] {train_model:86} INFO - Train Epoch: 17 [183296/612104 (30%)]	lr:1.11e-04	Loss: 0.245698
[2024-01-06 18:45:29,486] {train_model:86} INFO - Train Epoch: 17 [244480/612104 (40%)]	lr:1.11e-04	Loss: 0.071101
[2024-01-06 18:45:42,133] {train_model:86} INFO - Train Epoch: 17 [305664/612104 (50%)]	lr:1.11e-04	Loss: 0.130039
[2024-01-06 18:45:54,964] {train_model:86} INFO - Train Epoch: 17 [366848/612104 (60%)]	lr:1.11e-04	Loss: 0.864935
[2024-01-06 18:46:07,992] {train_model:86} INFO - Train Epoch: 17 [428032/612104 (70%)]	lr:1.11e-04	Loss: 0.148110
[2024-01-06 18:46:35,578] {train_model:86} INFO - Train Epoch: 17 [489216/612104 (80%)]	lr:1.11e-04	Loss: 0.108743
[2024-01-06 18:47:01,691] {train_model:86} INFO - Train Epoch: 17 [550400/612104 (90%)]	lr:1.11e-04	Loss: 0.126446
[2024-01-06 18:47:29,162] {train_model:86} INFO - Train Epoch: 17 [611584/612104 (100%)]	lr:1.11e-04	Loss: 0.068663
[2024-01-06 18:47:41,881] {run_experiment:78} INFO - 
[2024-01-06 18:47:41,887] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 18:47:43,333] {result_logger:108} INFO - precision on WAKE: 0.988
[2024-01-06 18:47:44,260] {result_logger:109} INFO - recall on WAKE: 0.961
[2024-01-06 18:47:45,185] {result_logger:112} INFO - F1-score on WAKE: 0.974
[2024-01-06 18:47:45,185] {result_logger:113} INFO - 
[2024-01-06 18:47:46,565] {result_logger:108} INFO - precision on NREM: 0.951
[2024-01-06 18:47:47,497] {result_logger:109} INFO - recall on NREM: 0.948
[2024-01-06 18:47:48,391] {result_logger:112} INFO - F1-score on NREM: 0.950
[2024-01-06 18:47:48,392] {result_logger:113} INFO - 
[2024-01-06 18:47:49,713] {result_logger:108} INFO - precision on REM: 0.752
[2024-01-06 18:47:50,516] {result_logger:109} INFO - recall on REM: 0.948
[2024-01-06 18:47:51,318] {result_logger:112} INFO - F1-score on REM: 0.839
[2024-01-06 18:47:51,318] {result_logger:113} INFO - 
[2024-01-06 18:47:51,536] {result_logger:116} INFO - average precision on sleep stages: 0.897
[2024-01-06 18:47:51,756] {result_logger:118} INFO - average recall on sleep stages: 0.952
[2024-01-06 18:47:51,974] {result_logger:120} INFO - average F1-score on sleep stages: 0.921
[2024-01-06 18:47:52,561] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.952
[2024-01-06 18:47:52,591] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.955
[2024-01-06 18:47:52,595] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 18:47:52,777] {result_logger:108} INFO - precision on WAKE: 0.907
[2024-01-06 18:47:52,892] {result_logger:109} INFO - recall on WAKE: 0.975
[2024-01-06 18:47:53,006] {result_logger:112} INFO - F1-score on WAKE: 0.939
[2024-01-06 18:47:53,006] {result_logger:113} INFO - 
[2024-01-06 18:47:53,190] {result_logger:108} INFO - precision on NREM: 0.950
[2024-01-06 18:47:53,308] {result_logger:109} INFO - recall on NREM: 0.793
[2024-01-06 18:47:53,424] {result_logger:112} INFO - F1-score on NREM: 0.864
[2024-01-06 18:47:53,424] {result_logger:113} INFO - 
[2024-01-06 18:47:53,602] {result_logger:108} INFO - precision on REM: 0.487
[2024-01-06 18:47:53,716] {result_logger:109} INFO - recall on REM: 0.689
[2024-01-06 18:47:53,831] {result_logger:112} INFO - F1-score on REM: 0.571
[2024-01-06 18:47:53,831] {result_logger:113} INFO - 
[2024-01-06 18:47:53,852] {result_logger:116} INFO - average precision on sleep stages: 0.781
[2024-01-06 18:47:53,872] {result_logger:118} INFO - average recall on sleep stages: 0.819
[2024-01-06 18:47:53,893] {result_logger:120} INFO - average F1-score on sleep stages: 0.791
[2024-01-06 18:47:53,973] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.819
[2024-01-06 18:47:53,976] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.885
[2024-01-06 18:47:53,976] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 18:47:54,626] {result_logger:143} INFO - 
[[318952   9982   3118      3]
 [  3421 226826   8942      1]
 [   428   1587  36656      0]
 [  1884    269     35      0]]
[2024-01-06 18:47:55,275] {result_logger:150} INFO - 
[[ 96.05%   3.01%   0.94%   0.00%]
 [  1.43%  94.83%   3.74%   0.00%]
 [  1.11%   4.10%  94.79%   0.00%]
 [ 86.11%  12.29%   1.60%   0.00%]]
[2024-01-06 18:47:55,924] {result_logger:154} INFO - 
[[ 98.23%   4.18%   6.40%  75.00%]
 [  1.05%  95.04%  18.34%  25.00%]
 [  0.13%   0.66%  75.19%   0.00%]
 [  0.58%   0.11%   0.07%   0.00%]]
[2024-01-06 18:47:55,925] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 18:47:56,011] {result_logger:143} INFO - 
[[47089  1039   191     0]
 [ 3598 27824  3683     0]
 [ 1250   413  3678     0]
 [  736    50    48     0]]
[2024-01-06 18:47:56,228] {result_logger:150} INFO - 
[[ 97.45%   2.15%   0.40%   0.00%]
 [ 10.25%  79.26%  10.49%   0.00%]
 [ 23.40%   7.73%  68.86%   0.00%]
 [ 88.25%   6.00%   5.76%   0.00%]]
[2024-01-06 18:47:56,443] {result_logger:154} INFO - 
[[ 89.40%   3.54%   2.51%    nan%]
 [  6.83%  94.88%  48.46%    nan%]
 [  2.37%   1.41%  48.39%    nan%]
 [  1.40%   0.17%   0.63%    nan%]]
[2024-01-06 18:47:56,896] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 18:47:56,896] {result_logger:77} INFO - actual:
[2024-01-06 18:47:56,896] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 18:47:56,896] {result_logger:79} INFO - predicted:
[2024-01-06 18:47:56,896] {result_logger:80} INFO - 
[[95.90%  3.09%  1.02%  0.00%]
 [ 4.33% 92.05%  3.61%  0.00%]
 [11.70%  9.29% 79.01%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 18:47:56,936] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it1/model_8conv_2fc-best.pth
[2024-01-06 18:47:56,936] {run_experiment:113} INFO - [epoch  17] execution time: 211.07s	 avg f1-score: 0.7914

[2024-01-06 18:47:56,936] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 18:47:56,997] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 18:48:23,110] {train_model:86} INFO - Train Epoch: 18 [60928/612104 (10%)]	lr:1.04e-04	Loss: 0.083103
[2024-01-06 18:48:35,309] {train_model:86} INFO - Train Epoch: 18 [122112/612104 (20%)]	lr:1.04e-04	Loss: 0.054047
[2024-01-06 18:48:47,803] {train_model:86} INFO - Train Epoch: 18 [183296/612104 (30%)]	lr:1.04e-04	Loss: 0.158726
[2024-01-06 18:49:00,579] {train_model:86} INFO - Train Epoch: 18 [244480/612104 (40%)]	lr:1.04e-04	Loss: 0.068090
[2024-01-06 18:49:13,555] {train_model:86} INFO - Train Epoch: 18 [305664/612104 (50%)]	lr:1.04e-04	Loss: 0.045480
[2024-01-06 18:49:26,117] {train_model:86} INFO - Train Epoch: 18 [366848/612104 (60%)]	lr:1.04e-04	Loss: 0.124836
[2024-01-06 18:49:52,650] {train_model:86} INFO - Train Epoch: 18 [428032/612104 (70%)]	lr:1.04e-04	Loss: 0.109353
[2024-01-06 18:50:19,695] {train_model:86} INFO - Train Epoch: 18 [489216/612104 (80%)]	lr:1.04e-04	Loss: 0.088281
[2024-01-06 18:50:32,316] {train_model:86} INFO - Train Epoch: 18 [550400/612104 (90%)]	lr:1.04e-04	Loss: 0.130275
[2024-01-06 18:51:00,032] {train_model:86} INFO - Train Epoch: 18 [611584/612104 (100%)]	lr:1.04e-04	Loss: 0.083742
[2024-01-06 18:51:12,657] {run_experiment:78} INFO - 
[2024-01-06 18:51:12,664] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 18:51:13,996] {result_logger:108} INFO - precision on WAKE: 0.988
[2024-01-06 18:51:14,848] {result_logger:109} INFO - recall on WAKE: 0.962
[2024-01-06 18:51:15,732] {result_logger:112} INFO - F1-score on WAKE: 0.975
[2024-01-06 18:51:15,732] {result_logger:113} INFO - 
[2024-01-06 18:51:17,057] {result_logger:108} INFO - precision on NREM: 0.953
[2024-01-06 18:51:17,927] {result_logger:109} INFO - recall on NREM: 0.949
[2024-01-06 18:51:18,790] {result_logger:112} INFO - F1-score on NREM: 0.951
[2024-01-06 18:51:18,790] {result_logger:113} INFO - 
[2024-01-06 18:51:20,039] {result_logger:108} INFO - precision on REM: 0.759
[2024-01-06 18:51:20,805] {result_logger:109} INFO - recall on REM: 0.950
[2024-01-06 18:51:21,581] {result_logger:112} INFO - F1-score on REM: 0.844
[2024-01-06 18:51:21,581] {result_logger:113} INFO - 
[2024-01-06 18:51:21,800] {result_logger:116} INFO - average precision on sleep stages: 0.900
[2024-01-06 18:51:22,011] {result_logger:118} INFO - average recall on sleep stages: 0.954
[2024-01-06 18:51:22,221] {result_logger:120} INFO - average F1-score on sleep stages: 0.923
[2024-01-06 18:51:22,813] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.954
[2024-01-06 18:51:22,842] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.956
[2024-01-06 18:51:22,846] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 18:51:23,034] {result_logger:108} INFO - precision on WAKE: 0.924
[2024-01-06 18:51:23,140] {result_logger:109} INFO - recall on WAKE: 0.961
[2024-01-06 18:51:23,249] {result_logger:112} INFO - F1-score on WAKE: 0.942
[2024-01-06 18:51:23,249] {result_logger:113} INFO - 
[2024-01-06 18:51:23,433] {result_logger:108} INFO - precision on NREM: 0.962
[2024-01-06 18:51:23,545] {result_logger:109} INFO - recall on NREM: 0.793
[2024-01-06 18:51:23,657] {result_logger:112} INFO - F1-score on NREM: 0.869
[2024-01-06 18:51:23,658] {result_logger:113} INFO - 
[2024-01-06 18:51:23,844] {result_logger:108} INFO - precision on REM: 0.511
[2024-01-06 18:51:23,955] {result_logger:109} INFO - recall on REM: 0.911
[2024-01-06 18:51:24,067] {result_logger:112} INFO - F1-score on REM: 0.654
[2024-01-06 18:51:24,067] {result_logger:113} INFO - 
[2024-01-06 18:51:24,088] {result_logger:116} INFO - average precision on sleep stages: 0.799
[2024-01-06 18:51:24,109] {result_logger:118} INFO - average recall on sleep stages: 0.889
[2024-01-06 18:51:24,129] {result_logger:120} INFO - average F1-score on sleep stages: 0.822
[2024-01-06 18:51:24,208] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.889
[2024-01-06 18:51:24,212] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.892
[2024-01-06 18:51:24,212] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 18:51:24,853] {result_logger:143} INFO - 
[[319424   9617   3014      0]
 [  3452 227091   8643      4]
 [   420   1513  36738      0]
 [  1917    234     37      0]]
[2024-01-06 18:51:25,520] {result_logger:150} INFO - 
[[ 96.20%   2.90%   0.91%   0.00%]
 [  1.44%  94.94%   3.61%   0.00%]
 [  1.09%   3.91%  95.00%   0.00%]
 [ 87.61%  10.69%   1.69%   0.00%]]
[2024-01-06 18:51:26,181] {result_logger:154} INFO - 
[[ 98.22%   4.03%   6.22%   0.00%]
 [  1.06%  95.23%  17.85% 100.00%]
 [  0.13%   0.63%  75.85%   0.00%]
 [  0.59%   0.10%   0.08%   0.00%]]
[2024-01-06 18:51:26,181] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 18:51:26,269] {result_logger:143} INFO - 
[[46434  1033   852     0]
 [ 3437 27853  3815     0]
 [  395    78  4868     0]
 [  705    35    94     0]]
[2024-01-06 18:51:26,516] {result_logger:150} INFO - 
[[ 96.10%   2.14%   1.76%   0.00%]
 [  9.79%  79.34%  10.87%   0.00%]
 [  7.40%   1.46%  91.14%   0.00%]
 [ 84.53%   4.20%  11.27%   0.00%]]
[2024-01-06 18:51:26,741] {result_logger:154} INFO - 
[[ 91.10%   3.56%   8.85%    nan%]
 [  6.74%  96.05%  39.62%    nan%]
 [  0.77%   0.27%  50.56%    nan%]
 [  1.38%   0.12%   0.98%    nan%]]
[2024-01-06 18:51:27,207] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 18:51:27,207] {result_logger:77} INFO - actual:
[2024-01-06 18:51:27,208] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 18:51:27,208] {result_logger:79} INFO - predicted:
[2024-01-06 18:51:27,208] {result_logger:80} INFO - 
[[95.93%  2.54%  1.53%  0.00%]
 [ 3.53% 93.16%  3.30%  0.00%]
 [10.91%  7.16% 81.93%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 18:51:27,257] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it1/model_8conv_2fc-best.pth
[2024-01-06 18:51:27,257] {run_experiment:113} INFO - [epoch  18] execution time: 210.32s	 avg f1-score: 0.8220

[2024-01-06 18:51:27,257] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 18:51:27,319] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 18:51:53,840] {train_model:86} INFO - Train Epoch: 19 [60928/612104 (10%)]	lr:9.80e-05	Loss: 0.170683
[2024-01-06 18:52:06,315] {train_model:86} INFO - Train Epoch: 19 [122112/612104 (20%)]	lr:9.80e-05	Loss: 0.102820
[2024-01-06 18:52:17,709] {train_model:86} INFO - Train Epoch: 19 [183296/612104 (30%)]	lr:9.80e-05	Loss: 0.086724
[2024-01-06 18:52:29,395] {train_model:86} INFO - Train Epoch: 19 [244480/612104 (40%)]	lr:9.80e-05	Loss: 0.050853
[2024-01-06 18:52:40,924] {train_model:86} INFO - Train Epoch: 19 [305664/612104 (50%)]	lr:9.80e-05	Loss: 0.079148
[2024-01-06 18:52:52,766] {train_model:86} INFO - Train Epoch: 19 [366848/612104 (60%)]	lr:9.80e-05	Loss: 0.218593
[2024-01-06 18:53:04,679] {train_model:86} INFO - Train Epoch: 19 [428032/612104 (70%)]	lr:9.80e-05	Loss: 0.164656
[2024-01-06 18:53:40,713] {train_model:86} INFO - Train Epoch: 19 [489216/612104 (80%)]	lr:9.80e-05	Loss: 0.134870
[2024-01-06 18:53:57,799] {train_model:86} INFO - Train Epoch: 19 [550400/612104 (90%)]	lr:9.80e-05	Loss: 0.088331
[2024-01-06 18:54:10,312] {train_model:86} INFO - Train Epoch: 19 [611584/612104 (100%)]	lr:9.80e-05	Loss: 0.070422
[2024-01-06 18:54:24,255] {run_experiment:78} INFO - 
[2024-01-06 18:54:24,261] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 18:54:25,655] {result_logger:108} INFO - precision on WAKE: 0.988
[2024-01-06 18:54:26,563] {result_logger:109} INFO - recall on WAKE: 0.962
[2024-01-06 18:54:27,474] {result_logger:112} INFO - F1-score on WAKE: 0.975
[2024-01-06 18:54:27,474] {result_logger:113} INFO - 
[2024-01-06 18:54:28,834] {result_logger:108} INFO - precision on NREM: 0.953
[2024-01-06 18:54:29,717] {result_logger:109} INFO - recall on NREM: 0.950
[2024-01-06 18:54:30,604] {result_logger:112} INFO - F1-score on NREM: 0.952
[2024-01-06 18:54:30,604] {result_logger:113} INFO - 
[2024-01-06 18:54:31,860] {result_logger:108} INFO - precision on REM: 0.764
[2024-01-06 18:54:32,646] {result_logger:109} INFO - recall on REM: 0.951
[2024-01-06 18:54:33,435] {result_logger:112} INFO - F1-score on REM: 0.847
[2024-01-06 18:54:33,436] {result_logger:113} INFO - 
[2024-01-06 18:54:33,644] {result_logger:116} INFO - average precision on sleep stages: 0.902
[2024-01-06 18:54:33,851] {result_logger:118} INFO - average recall on sleep stages: 0.954
[2024-01-06 18:54:34,057] {result_logger:120} INFO - average F1-score on sleep stages: 0.925
[2024-01-06 18:54:34,640] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.954
[2024-01-06 18:54:34,669] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.957
[2024-01-06 18:54:34,673] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 18:54:34,853] {result_logger:108} INFO - precision on WAKE: 0.921
[2024-01-06 18:54:34,960] {result_logger:109} INFO - recall on WAKE: 0.669
[2024-01-06 18:54:35,069] {result_logger:112} INFO - F1-score on WAKE: 0.775
[2024-01-06 18:54:35,069] {result_logger:113} INFO - 
[2024-01-06 18:54:35,251] {result_logger:108} INFO - precision on NREM: 0.915
[2024-01-06 18:54:35,360] {result_logger:109} INFO - recall on NREM: 0.834
[2024-01-06 18:54:35,468] {result_logger:112} INFO - F1-score on NREM: 0.873
[2024-01-06 18:54:35,469] {result_logger:113} INFO - 
[2024-01-06 18:54:35,647] {result_logger:108} INFO - precision on REM: 0.226
[2024-01-06 18:54:35,754] {result_logger:109} INFO - recall on REM: 0.918
[2024-01-06 18:54:35,858] {result_logger:112} INFO - F1-score on REM: 0.363
[2024-01-06 18:54:35,858] {result_logger:113} INFO - 
[2024-01-06 18:54:35,879] {result_logger:116} INFO - average precision on sleep stages: 0.687
[2024-01-06 18:54:35,899] {result_logger:118} INFO - average recall on sleep stages: 0.807
[2024-01-06 18:54:35,920] {result_logger:120} INFO - average F1-score on sleep stages: 0.670
[2024-01-06 18:54:35,997] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.807
[2024-01-06 18:54:36,001] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.749
[2024-01-06 18:54:36,001] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 18:54:36,653] {result_logger:143} INFO - 
[[319504   9698   2852      1]
 [  3356 227341   8491      2]
 [   408   1500  36763      0]
 [  1917    237     34      0]]
[2024-01-06 18:54:37,282] {result_logger:150} INFO - 
[[ 96.22%   2.92%   0.86%   0.00%]
 [  1.40%  95.05%   3.55%   0.00%]
 [  1.06%   3.88%  95.07%   0.00%]
 [ 87.61%  10.83%   1.55%   0.00%]]
[2024-01-06 18:54:37,916] {result_logger:154} INFO - 
[[ 98.25%   4.06%   5.92%  33.33%]
 [  1.03%  95.21%  17.64%  66.67%]
 [  0.13%   0.63%  76.37%   0.00%]
 [  0.59%   0.10%   0.07%   0.00%]]
[2024-01-06 18:54:37,916] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 18:54:38,001] {result_logger:143} INFO - 
[[32304  2296 13719     0]
 [ 2771 29273  3061     0]
 [   15   422  4904     0]
 [   56   107   671     0]]
[2024-01-06 18:54:38,241] {result_logger:150} INFO - 
[[ 66.86%   4.75%  28.39%   0.00%]
 [  7.89%  83.39%   8.72%   0.00%]
 [  0.28%   7.90%  91.82%   0.00%]
 [  6.71%  12.83%  80.46%   0.00%]]
[2024-01-06 18:54:38,454] {result_logger:154} INFO - 
[[ 91.91%   7.15%  61.37%    nan%]
 [  7.88%  91.20%  13.69%    nan%]
 [  0.04%   1.31%  21.94%    nan%]
 [  0.16%   0.33%   3.00%    nan%]]
[2024-01-06 18:54:38,908] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 18:54:38,908] {result_logger:77} INFO - actual:
[2024-01-06 18:54:38,908] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 18:54:38,908] {result_logger:79} INFO - predicted:
[2024-01-06 18:54:38,908] {result_logger:80} INFO - 
[[94.85%  2.78%  2.37%  0.00%]
 [ 2.85% 93.39%  3.76%  0.00%]
 [ 4.00%  5.12% 90.87%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 18:54:38,953] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it1/model_8conv_2fc-best.pth
[2024-01-06 18:54:38,954] {run_experiment:113} INFO - [epoch  19] execution time: 191.70s	 avg f1-score: 0.6700

[2024-01-06 18:54:38,954] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 18:54:39,012] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 18:55:16,962] {train_model:86} INFO - Train Epoch: 20 [60928/612104 (10%)]	lr:9.23e-05	Loss: 0.080483
[2024-01-06 18:55:28,516] {train_model:86} INFO - Train Epoch: 20 [122112/612104 (20%)]	lr:9.23e-05	Loss: 0.068372
[2024-01-06 18:55:40,067] {train_model:86} INFO - Train Epoch: 20 [183296/612104 (30%)]	lr:9.23e-05	Loss: 0.112385
[2024-01-06 18:55:51,846] {train_model:86} INFO - Train Epoch: 20 [244480/612104 (40%)]	lr:9.23e-05	Loss: 0.076645
[2024-01-06 18:56:03,846] {train_model:86} INFO - Train Epoch: 20 [305664/612104 (50%)]	lr:9.23e-05	Loss: 0.148476
[2024-01-06 18:56:15,569] {train_model:86} INFO - Train Epoch: 20 [366848/612104 (60%)]	lr:9.23e-05	Loss: 0.088718
[2024-01-06 18:56:27,241] {train_model:86} INFO - Train Epoch: 20 [428032/612104 (70%)]	lr:9.23e-05	Loss: 0.115281
[2024-01-06 18:56:54,857] {train_model:86} INFO - Train Epoch: 20 [489216/612104 (80%)]	lr:9.23e-05	Loss: 0.082070
[2024-01-06 18:57:20,441] {train_model:86} INFO - Train Epoch: 20 [550400/612104 (90%)]	lr:9.23e-05	Loss: 0.312872
[2024-01-06 18:57:32,307] {train_model:86} INFO - Train Epoch: 20 [611584/612104 (100%)]	lr:9.23e-05	Loss: 0.091976
[2024-01-06 18:57:45,311] {run_experiment:78} INFO - 
[2024-01-06 18:57:45,317] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 18:57:46,655] {result_logger:108} INFO - precision on WAKE: 0.988
[2024-01-06 18:57:47,551] {result_logger:109} INFO - recall on WAKE: 0.963
[2024-01-06 18:57:48,443] {result_logger:112} INFO - F1-score on WAKE: 0.975
[2024-01-06 18:57:48,444] {result_logger:113} INFO - 
[2024-01-06 18:57:49,769] {result_logger:108} INFO - precision on NREM: 0.954
[2024-01-06 18:57:50,661] {result_logger:109} INFO - recall on NREM: 0.951
[2024-01-06 18:57:51,559] {result_logger:112} INFO - F1-score on NREM: 0.952
[2024-01-06 18:57:51,559] {result_logger:113} INFO - 
[2024-01-06 18:57:52,853] {result_logger:108} INFO - precision on REM: 0.769
[2024-01-06 18:57:53,646] {result_logger:109} INFO - recall on REM: 0.953
[2024-01-06 18:57:54,429] {result_logger:112} INFO - F1-score on REM: 0.851
[2024-01-06 18:57:54,429] {result_logger:113} INFO - 
[2024-01-06 18:57:54,632] {result_logger:116} INFO - average precision on sleep stages: 0.903
[2024-01-06 18:57:54,844] {result_logger:118} INFO - average recall on sleep stages: 0.955
[2024-01-06 18:57:55,047] {result_logger:120} INFO - average F1-score on sleep stages: 0.926
[2024-01-06 18:57:55,620] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.955
[2024-01-06 18:57:55,649] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.957
[2024-01-06 18:57:55,653] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 18:57:55,821] {result_logger:108} INFO - precision on WAKE: 0.921
[2024-01-06 18:57:55,917] {result_logger:109} INFO - recall on WAKE: 0.938
[2024-01-06 18:57:56,015] {result_logger:112} INFO - F1-score on WAKE: 0.929
[2024-01-06 18:57:56,016] {result_logger:113} INFO - 
[2024-01-06 18:57:56,192] {result_logger:108} INFO - precision on NREM: 0.903
[2024-01-06 18:57:56,293] {result_logger:109} INFO - recall on NREM: 0.840
[2024-01-06 18:57:56,385] {result_logger:112} INFO - F1-score on NREM: 0.870
[2024-01-06 18:57:56,385] {result_logger:113} INFO - 
[2024-01-06 18:57:56,547] {result_logger:108} INFO - precision on REM: 0.618
[2024-01-06 18:57:56,656] {result_logger:109} INFO - recall on REM: 0.799
[2024-01-06 18:57:56,765] {result_logger:112} INFO - F1-score on REM: 0.697
[2024-01-06 18:57:56,765] {result_logger:113} INFO - 
[2024-01-06 18:57:56,785] {result_logger:116} INFO - average precision on sleep stages: 0.814
[2024-01-06 18:57:56,806] {result_logger:118} INFO - average recall on sleep stages: 0.859
[2024-01-06 18:57:56,826] {result_logger:120} INFO - average F1-score on sleep stages: 0.832
[2024-01-06 18:57:56,905] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.859
[2024-01-06 18:57:56,909] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.891
[2024-01-06 18:57:56,909] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 18:57:57,529] {result_logger:143} INFO - 
[[319606   9621   2828      0]
 [  3474 227459   8257      0]
 [   415   1420  36836      0]
 [  1921    231     36      0]]
[2024-01-06 18:57:58,159] {result_logger:150} INFO - 
[[ 96.25%   2.90%   0.85%   0.00%]
 [  1.45%  95.10%   3.45%   0.00%]
 [  1.07%   3.67%  95.25%   0.00%]
 [ 87.80%  10.56%   1.65%   0.00%]]
[2024-01-06 18:57:58,781] {result_logger:154} INFO - 
[[ 98.21%   4.03%   5.90%    nan%]
 [  1.07%  95.28%  17.22%    nan%]
 [  0.13%   0.59%  76.81%    nan%]
 [  0.59%   0.10%   0.08%    nan%]]
[2024-01-06 18:57:58,781] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 18:57:58,868] {result_logger:143} INFO - 
[[45302  2636   381     0]
 [ 3356 29491  2258     0]
 [  532   540  4269     0]
 [  523   274    37     0]]
[2024-01-06 18:57:59,130] {result_logger:150} INFO - 
[[ 93.76%   5.46%   0.79%   0.00%]
 [  9.56%  84.01%   6.43%   0.00%]
 [  9.96%  10.11%  79.93%   0.00%]
 [ 62.71%  32.85%   4.44%   0.00%]]
[2024-01-06 18:57:59,355] {result_logger:154} INFO - 
[[ 91.13%   8.00%   5.49%    nan%]
 [  6.75%  89.53%  32.51%    nan%]
 [  1.07%   1.64%  61.47%    nan%]
 [  1.05%   0.83%   0.53%    nan%]]
[2024-01-06 18:57:59,946] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 18:57:59,946] {result_logger:77} INFO - actual:
[2024-01-06 18:57:59,946] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 18:57:59,946] {result_logger:79} INFO - predicted:
[2024-01-06 18:57:59,947] {result_logger:80} INFO - 
[[95.46%  3.86%  0.67%  0.00%]
 [ 4.89% 92.63%  2.48%  0.00%]
 [ 9.26%  7.34% 83.40%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 18:58:00,000] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it1/model_8conv_2fc-best.pth
[2024-01-06 18:58:00,000] {run_experiment:113} INFO - [epoch  20] execution time: 201.05s	 avg f1-score: 0.8322

[2024-01-06 18:58:00,000] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 18:58:00,061] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 18:58:40,960] {train_model:86} INFO - Train Epoch: 21 [60928/612104 (10%)]	lr:8.69e-05	Loss: 0.133281
[2024-01-06 18:58:52,890] {train_model:86} INFO - Train Epoch: 21 [122112/612104 (20%)]	lr:8.69e-05	Loss: 0.081440
[2024-01-06 18:59:04,384] {train_model:86} INFO - Train Epoch: 21 [183296/612104 (30%)]	lr:8.69e-05	Loss: 0.104048
[2024-01-06 18:59:15,509] {train_model:86} INFO - Train Epoch: 21 [244480/612104 (40%)]	lr:8.69e-05	Loss: 0.079291
[2024-01-06 18:59:27,999] {train_model:86} INFO - Train Epoch: 21 [305664/612104 (50%)]	lr:8.69e-05	Loss: 0.090164
[2024-01-06 18:59:39,966] {train_model:86} INFO - Train Epoch: 21 [366848/612104 (60%)]	lr:8.69e-05	Loss: 0.101757
[2024-01-06 18:59:51,488] {train_model:86} INFO - Train Epoch: 21 [428032/612104 (70%)]	lr:8.69e-05	Loss: 0.208761
[2024-01-06 19:00:18,882] {train_model:86} INFO - Train Epoch: 21 [489216/612104 (80%)]	lr:8.69e-05	Loss: 0.069780
[2024-01-06 19:00:44,474] {train_model:86} INFO - Train Epoch: 21 [550400/612104 (90%)]	lr:8.69e-05	Loss: 0.100864
[2024-01-06 19:00:56,337] {train_model:86} INFO - Train Epoch: 21 [611584/612104 (100%)]	lr:8.69e-05	Loss: 0.119242
[2024-01-06 19:01:08,736] {run_experiment:78} INFO - 
[2024-01-06 19:01:08,742] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 19:01:10,044] {result_logger:108} INFO - precision on WAKE: 0.988
[2024-01-06 19:01:10,927] {result_logger:109} INFO - recall on WAKE: 0.963
[2024-01-06 19:01:11,812] {result_logger:112} INFO - F1-score on WAKE: 0.975
[2024-01-06 19:01:11,812] {result_logger:113} INFO - 
[2024-01-06 19:01:13,131] {result_logger:108} INFO - precision on NREM: 0.954
[2024-01-06 19:01:14,010] {result_logger:109} INFO - recall on NREM: 0.950
[2024-01-06 19:01:14,909] {result_logger:112} INFO - F1-score on NREM: 0.952
[2024-01-06 19:01:14,910] {result_logger:113} INFO - 
[2024-01-06 19:01:16,167] {result_logger:108} INFO - precision on REM: 0.768
[2024-01-06 19:01:16,964] {result_logger:109} INFO - recall on REM: 0.953
[2024-01-06 19:01:17,760] {result_logger:112} INFO - F1-score on REM: 0.850
[2024-01-06 19:01:17,760] {result_logger:113} INFO - 
[2024-01-06 19:01:17,968] {result_logger:116} INFO - average precision on sleep stages: 0.903
[2024-01-06 19:01:18,175] {result_logger:118} INFO - average recall on sleep stages: 0.955
[2024-01-06 19:01:18,386] {result_logger:120} INFO - average F1-score on sleep stages: 0.926
[2024-01-06 19:01:18,972] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.955
[2024-01-06 19:01:19,001] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.958
[2024-01-06 19:01:19,005] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 19:01:19,177] {result_logger:108} INFO - precision on WAKE: 0.877
[2024-01-06 19:01:19,283] {result_logger:109} INFO - recall on WAKE: 0.805
[2024-01-06 19:01:19,392] {result_logger:112} INFO - F1-score on WAKE: 0.839
[2024-01-06 19:01:19,392] {result_logger:113} INFO - 
[2024-01-06 19:01:19,566] {result_logger:108} INFO - precision on NREM: 0.941
[2024-01-06 19:01:19,674] {result_logger:109} INFO - recall on NREM: 0.771
[2024-01-06 19:01:19,780] {result_logger:112} INFO - F1-score on NREM: 0.848
[2024-01-06 19:01:19,780] {result_logger:113} INFO - 
[2024-01-06 19:01:19,953] {result_logger:108} INFO - precision on REM: 0.317
[2024-01-06 19:01:20,059] {result_logger:109} INFO - recall on REM: 0.929
[2024-01-06 19:01:20,168] {result_logger:112} INFO - F1-score on REM: 0.473
[2024-01-06 19:01:20,168] {result_logger:113} INFO - 
[2024-01-06 19:01:20,188] {result_logger:116} INFO - average precision on sleep stages: 0.712
[2024-01-06 19:01:20,208] {result_logger:118} INFO - average recall on sleep stages: 0.835
[2024-01-06 19:01:20,228] {result_logger:120} INFO - average F1-score on sleep stages: 0.720
[2024-01-06 19:01:20,305] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.835
[2024-01-06 19:01:20,308] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.799
[2024-01-06 19:01:20,308] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 19:01:20,931] {result_logger:143} INFO - 
[[319830   9492   2733      0]
 [  3462 227334   8393      1]
 [   411   1420  36840      0]
 [  1917    237     34      0]]
[2024-01-06 19:01:21,549] {result_logger:150} INFO - 
[[ 96.32%   2.86%   0.82%   0.00%]
 [  1.45%  95.04%   3.51%   0.00%]
 [  1.06%   3.67%  95.27%   0.00%]
 [ 87.61%  10.83%   1.55%   0.00%]]
[2024-01-06 19:01:22,182] {result_logger:154} INFO - 
[[ 98.22%   3.98%   5.69%   0.00%]
 [  1.06%  95.33%  17.49% 100.00%]
 [  0.13%   0.60%  76.75%   0.00%]
 [  0.59%   0.10%   0.07%   0.00%]]
[2024-01-06 19:01:22,182] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 19:01:22,266] {result_logger:143} INFO - 
[[38894  1529  7896     0]
 [ 5237 27077  2791     0]
 [  210   168  4963     0]
 [  261    75   498     0]]
[2024-01-06 19:01:22,483] {result_logger:150} INFO - 
[[ 80.49%   3.16%  16.34%   0.00%]
 [ 14.92%  77.13%   7.95%   0.00%]
 [  3.93%   3.15%  92.92%   0.00%]
 [ 31.29%   8.99%  59.71%   0.00%]]
[2024-01-06 19:01:22,693] {result_logger:154} INFO - 
[[ 87.20%   5.30%  48.90%    nan%]
 [ 11.74%  93.86%  17.28%    nan%]
 [  0.47%   0.58%  30.73%    nan%]
 [  0.59%   0.26%   3.08%    nan%]]
[2024-01-06 19:01:23,130] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 19:01:23,131] {result_logger:77} INFO - actual:
[2024-01-06 19:01:23,131] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 19:01:23,131] {result_logger:79} INFO - predicted:
[2024-01-06 19:01:23,131] {result_logger:80} INFO - 
[[93.97%  2.60%  3.43%  0.00%]
 [ 3.58% 93.22%  3.21%  0.00%]
 [10.26%  4.95% 84.79%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 19:01:23,167] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it1/model_8conv_2fc-best.pth
[2024-01-06 19:01:23,168] {run_experiment:113} INFO - [epoch  21] execution time: 203.17s	 avg f1-score: 0.7200

[2024-01-06 19:01:23,168] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 19:01:23,227] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 19:02:05,118] {train_model:86} INFO - Train Epoch: 22 [60928/612104 (10%)]	lr:8.19e-05	Loss: 0.077940
[2024-01-06 19:02:30,578] {train_model:86} INFO - Train Epoch: 22 [122112/612104 (20%)]	lr:8.19e-05	Loss: 0.049437
[2024-01-06 19:02:42,309] {train_model:86} INFO - Train Epoch: 22 [183296/612104 (30%)]	lr:8.19e-05	Loss: 0.091146
[2024-01-06 19:02:53,849] {train_model:86} INFO - Train Epoch: 22 [244480/612104 (40%)]	lr:8.19e-05	Loss: 0.146402
[2024-01-06 19:03:06,091] {train_model:86} INFO - Train Epoch: 22 [305664/612104 (50%)]	lr:8.19e-05	Loss: 0.080474
[2024-01-06 19:03:17,915] {train_model:86} INFO - Train Epoch: 22 [366848/612104 (60%)]	lr:8.19e-05	Loss: 0.116700
[2024-01-06 19:03:38,770] {train_model:86} INFO - Train Epoch: 22 [428032/612104 (70%)]	lr:8.19e-05	Loss: 0.062848
[2024-01-06 19:04:11,223] {train_model:86} INFO - Train Epoch: 22 [489216/612104 (80%)]	lr:8.19e-05	Loss: 0.161746
[2024-01-06 19:04:23,041] {train_model:86} INFO - Train Epoch: 22 [550400/612104 (90%)]	lr:8.19e-05	Loss: 0.141711
[2024-01-06 19:04:35,197] {train_model:86} INFO - Train Epoch: 22 [611584/612104 (100%)]	lr:8.19e-05	Loss: 0.139776
[2024-01-06 19:04:47,933] {run_experiment:78} INFO - 
[2024-01-06 19:04:47,939] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 19:04:49,315] {result_logger:108} INFO - precision on WAKE: 0.988
[2024-01-06 19:04:50,170] {result_logger:109} INFO - recall on WAKE: 0.962
[2024-01-06 19:04:51,037] {result_logger:112} INFO - F1-score on WAKE: 0.975
[2024-01-06 19:04:51,037] {result_logger:113} INFO - 
[2024-01-06 19:04:52,403] {result_logger:108} INFO - precision on NREM: 0.954
[2024-01-06 19:04:53,308] {result_logger:109} INFO - recall on NREM: 0.952
[2024-01-06 19:04:54,216] {result_logger:112} INFO - F1-score on NREM: 0.953
[2024-01-06 19:04:54,216] {result_logger:113} INFO - 
[2024-01-06 19:04:55,495] {result_logger:108} INFO - precision on REM: 0.772
[2024-01-06 19:04:56,272] {result_logger:109} INFO - recall on REM: 0.953
[2024-01-06 19:04:57,040] {result_logger:112} INFO - F1-score on REM: 0.853
[2024-01-06 19:04:57,040] {result_logger:113} INFO - 
[2024-01-06 19:04:57,240] {result_logger:116} INFO - average precision on sleep stages: 0.905
[2024-01-06 19:04:57,438] {result_logger:118} INFO - average recall on sleep stages: 0.956
[2024-01-06 19:04:57,638] {result_logger:120} INFO - average F1-score on sleep stages: 0.927
[2024-01-06 19:04:58,203] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.956
[2024-01-06 19:04:58,231] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.958
[2024-01-06 19:04:58,235] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 19:04:58,408] {result_logger:108} INFO - precision on WAKE: 0.914
[2024-01-06 19:04:58,512] {result_logger:109} INFO - recall on WAKE: 0.939
[2024-01-06 19:04:58,615] {result_logger:112} INFO - F1-score on WAKE: 0.927
[2024-01-06 19:04:58,615] {result_logger:113} INFO - 
[2024-01-06 19:04:58,789] {result_logger:108} INFO - precision on NREM: 0.917
[2024-01-06 19:04:58,896] {result_logger:109} INFO - recall on NREM: 0.831
[2024-01-06 19:04:59,002] {result_logger:112} INFO - F1-score on NREM: 0.872
[2024-01-06 19:04:59,003] {result_logger:113} INFO - 
[2024-01-06 19:04:59,174] {result_logger:108} INFO - precision on REM: 0.639
[2024-01-06 19:04:59,279] {result_logger:109} INFO - recall on REM: 0.871
[2024-01-06 19:04:59,384] {result_logger:112} INFO - F1-score on REM: 0.737
[2024-01-06 19:04:59,384] {result_logger:113} INFO - 
[2024-01-06 19:04:59,404] {result_logger:116} INFO - average precision on sleep stages: 0.823
[2024-01-06 19:04:59,423] {result_logger:118} INFO - average recall on sleep stages: 0.880
[2024-01-06 19:04:59,443] {result_logger:120} INFO - average F1-score on sleep stages: 0.845
[2024-01-06 19:04:59,523] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.880
[2024-01-06 19:04:59,526] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.892
[2024-01-06 19:04:59,527] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 19:05:00,151] {result_logger:143} INFO - 
[[319590   9601   2864      0]
 [  3491 227674   8025      0]
 [   386   1450  36835      0]
 [  1917    234     37      0]]
[2024-01-06 19:05:00,767] {result_logger:150} INFO - 
[[ 96.25%   2.89%   0.86%   0.00%]
 [  1.46%  95.19%   3.36%   0.00%]
 [  1.00%   3.75%  95.25%   0.00%]
 [ 87.61%  10.69%   1.69%   0.00%]]
[2024-01-06 19:05:01,378] {result_logger:154} INFO - 
[[ 98.22%   4.02%   6.00%    nan%]
 [  1.07%  95.28%  16.80%    nan%]
 [  0.12%   0.61%  77.12%    nan%]
 [  0.59%   0.10%   0.08%    nan%]]
[2024-01-06 19:05:01,378] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 19:05:01,462] {result_logger:143} INFO - 
[[45391  2390   538     0]
 [ 3836 29179  2090     0]
 [  434   256  4651     0]
 [  555   227    52     0]]
[2024-01-06 19:05:01,660] {result_logger:150} INFO - 
[[ 93.94%   4.95%   1.11%   0.00%]
 [ 10.93%  83.12%   5.95%   0.00%]
 [  8.13%   4.79%  87.08%   0.00%]
 [ 66.55%  27.22%   6.24%   0.00%]]
[2024-01-06 19:05:01,854] {result_logger:154} INFO - 
[[ 90.39%   7.46%   7.34%    nan%]
 [  7.64%  91.04%  28.51%    nan%]
 [  0.86%   0.80%  63.44%    nan%]
 [  1.11%   0.71%   0.71%    nan%]]
[2024-01-06 19:05:02,291] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 19:05:02,292] {result_logger:77} INFO - actual:
[2024-01-06 19:05:02,292] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 19:05:02,292] {result_logger:79} INFO - predicted:
[2024-01-06 19:05:02,292] {result_logger:80} INFO - 
[[95.47%  3.61%  0.92%  0.00%]
 [ 4.71% 92.97%  2.32%  0.00%]
 [10.44%  6.00% 83.56%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 19:05:02,328] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it1/model_8conv_2fc-best.pth
[2024-01-06 19:05:02,328] {run_experiment:113} INFO - [epoch  22] execution time: 219.16s	 avg f1-score: 0.8452

[2024-01-06 19:05:02,329] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 19:05:02,383] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 19:05:44,159] {train_model:86} INFO - Train Epoch: 23 [60928/612104 (10%)]	lr:7.71e-05	Loss: 0.237749
[2024-01-06 19:06:09,810] {train_model:86} INFO - Train Epoch: 23 [122112/612104 (20%)]	lr:7.71e-05	Loss: 0.090449
[2024-01-06 19:06:21,644] {train_model:86} INFO - Train Epoch: 23 [183296/612104 (30%)]	lr:7.71e-05	Loss: 0.095098
[2024-01-06 19:06:34,342] {train_model:86} INFO - Train Epoch: 23 [244480/612104 (40%)]	lr:7.71e-05	Loss: 0.132821
[2024-01-06 19:06:45,814] {train_model:86} INFO - Train Epoch: 23 [305664/612104 (50%)]	lr:7.71e-05	Loss: 0.060078
[2024-01-06 19:06:57,682] {train_model:86} INFO - Train Epoch: 23 [366848/612104 (60%)]	lr:7.71e-05	Loss: 0.082311
[2024-01-06 19:07:25,043] {train_model:86} INFO - Train Epoch: 23 [428032/612104 (70%)]	lr:7.71e-05	Loss: 0.082747
[2024-01-06 19:07:50,663] {train_model:86} INFO - Train Epoch: 23 [489216/612104 (80%)]	lr:7.71e-05	Loss: 0.062921
[2024-01-06 19:08:02,422] {train_model:86} INFO - Train Epoch: 23 [550400/612104 (90%)]	lr:7.71e-05	Loss: 0.128211
[2024-01-06 19:08:14,497] {train_model:86} INFO - Train Epoch: 23 [611584/612104 (100%)]	lr:7.71e-05	Loss: 0.105000
[2024-01-06 19:08:27,172] {run_experiment:78} INFO - 
[2024-01-06 19:08:27,178] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 19:08:28,501] {result_logger:108} INFO - precision on WAKE: 0.988
[2024-01-06 19:08:29,378] {result_logger:109} INFO - recall on WAKE: 0.963
[2024-01-06 19:08:30,269] {result_logger:112} INFO - F1-score on WAKE: 0.975
[2024-01-06 19:08:30,269] {result_logger:113} INFO - 
[2024-01-06 19:08:31,597] {result_logger:108} INFO - precision on NREM: 0.954
[2024-01-06 19:08:32,480] {result_logger:109} INFO - recall on NREM: 0.953
[2024-01-06 19:08:33,383] {result_logger:112} INFO - F1-score on NREM: 0.953
[2024-01-06 19:08:33,383] {result_logger:113} INFO - 
[2024-01-06 19:08:34,642] {result_logger:108} INFO - precision on REM: 0.775
[2024-01-06 19:08:35,433] {result_logger:109} INFO - recall on REM: 0.957
[2024-01-06 19:08:36,223] {result_logger:112} INFO - F1-score on REM: 0.856
[2024-01-06 19:08:36,223] {result_logger:113} INFO - 
[2024-01-06 19:08:36,425] {result_logger:116} INFO - average precision on sleep stages: 0.906
[2024-01-06 19:08:36,637] {result_logger:118} INFO - average recall on sleep stages: 0.957
[2024-01-06 19:08:36,847] {result_logger:120} INFO - average F1-score on sleep stages: 0.928
[2024-01-06 19:08:37,420] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.957
[2024-01-06 19:08:37,450] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.958
[2024-01-06 19:08:37,454] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 19:08:37,624] {result_logger:108} INFO - precision on WAKE: 0.889
[2024-01-06 19:08:37,730] {result_logger:109} INFO - recall on WAKE: 0.931
[2024-01-06 19:08:37,837] {result_logger:112} INFO - F1-score on WAKE: 0.910
[2024-01-06 19:08:37,837] {result_logger:113} INFO - 
[2024-01-06 19:08:38,011] {result_logger:108} INFO - precision on NREM: 0.897
[2024-01-06 19:08:38,123] {result_logger:109} INFO - recall on NREM: 0.814
[2024-01-06 19:08:38,234] {result_logger:112} INFO - F1-score on NREM: 0.853
[2024-01-06 19:08:38,234] {result_logger:113} INFO - 
[2024-01-06 19:08:38,407] {result_logger:108} INFO - precision on REM: 0.709
[2024-01-06 19:08:38,514] {result_logger:109} INFO - recall on REM: 0.839
[2024-01-06 19:08:38,619] {result_logger:112} INFO - F1-score on REM: 0.769
[2024-01-06 19:08:38,619] {result_logger:113} INFO - 
[2024-01-06 19:08:38,639] {result_logger:116} INFO - average precision on sleep stages: 0.832
[2024-01-06 19:08:38,660] {result_logger:118} INFO - average recall on sleep stages: 0.861
[2024-01-06 19:08:38,679] {result_logger:120} INFO - average F1-score on sleep stages: 0.844
[2024-01-06 19:08:38,755] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.861
[2024-01-06 19:08:38,758] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.879
[2024-01-06 19:08:38,759] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 19:08:39,400] {result_logger:143} INFO - 
[[319656   9669   2730      0]
 [  3369 227831   7990      0]
 [   365   1312  36994      0]
 [  1916    230     42      0]]
[2024-01-06 19:08:40,037] {result_logger:150} INFO - 
[[ 96.27%   2.91%   0.82%   0.00%]
 [  1.41%  95.25%   3.34%   0.00%]
 [  0.94%   3.39%  95.66%   0.00%]
 [ 87.57%  10.51%   1.92%   0.00%]]
[2024-01-06 19:08:40,669] {result_logger:154} INFO - 
[[ 98.26%   4.04%   5.72%    nan%]
 [  1.04%  95.31%  16.73%    nan%]
 [  0.11%   0.55%  77.46%    nan%]
 [  0.59%   0.10%   0.09%    nan%]]
[2024-01-06 19:08:40,669] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 19:08:40,752] {result_logger:143} INFO - 
[[44990  2884   445     0]
 [ 5138 28571  1396     0]
 [  451   407  4483     0]
 [  557   242    35     0]]
[2024-01-06 19:08:40,965] {result_logger:150} INFO - 
[[ 93.11%   5.97%   0.92%   0.00%]
 [ 14.64%  81.39%   3.98%   0.00%]
 [  8.44%   7.62%  83.94%   0.00%]
 [ 66.79%  29.02%   4.20%   0.00%]]
[2024-01-06 19:08:41,172] {result_logger:154} INFO - 
[[ 87.98%   8.98%   7.00%    nan%]
 [ 10.05%  89.00%  21.95%    nan%]
 [  0.88%   1.27%  70.50%    nan%]
 [  1.09%   0.75%   0.55%    nan%]]
[2024-01-06 19:08:41,602] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 19:08:41,602] {result_logger:77} INFO - actual:
[2024-01-06 19:08:41,602] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 19:08:41,602] {result_logger:79} INFO - predicted:
[2024-01-06 19:08:41,602] {result_logger:80} INFO - 
[[95.18%  3.99%  0.83%  0.00%]
 [ 5.65% 92.34%  2.01%  0.00%]
 [10.19%  6.57% 83.24%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 19:08:41,638] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it1/model_8conv_2fc-best.pth
[2024-01-06 19:08:41,638] {run_experiment:113} INFO - [epoch  23] execution time: 219.31s	 avg f1-score: 0.8439

[2024-01-06 19:08:41,638] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 19:08:41,699] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 19:09:07,724] {train_model:86} INFO - Train Epoch: 24 [60928/612104 (10%)]	lr:7.26e-05	Loss: 0.054552
[2024-01-06 19:09:34,720] {train_model:86} INFO - Train Epoch: 24 [122112/612104 (20%)]	lr:7.26e-05	Loss: 0.202487
[2024-01-06 19:10:00,129] {train_model:86} INFO - Train Epoch: 24 [183296/612104 (30%)]	lr:7.26e-05	Loss: 0.074949
[2024-01-06 19:10:11,398] {train_model:86} INFO - Train Epoch: 24 [244480/612104 (40%)]	lr:7.26e-05	Loss: 0.078890
[2024-01-06 19:10:23,202] {train_model:86} INFO - Train Epoch: 24 [305664/612104 (50%)]	lr:7.26e-05	Loss: 0.109331
[2024-01-06 19:10:34,902] {train_model:86} INFO - Train Epoch: 24 [366848/612104 (60%)]	lr:7.26e-05	Loss: 0.242807
[2024-01-06 19:11:02,268] {train_model:86} INFO - Train Epoch: 24 [428032/612104 (70%)]	lr:7.26e-05	Loss: 0.057084
[2024-01-06 19:11:28,104] {train_model:86} INFO - Train Epoch: 24 [489216/612104 (80%)]	lr:7.26e-05	Loss: 0.105313
[2024-01-06 19:11:39,949] {train_model:86} INFO - Train Epoch: 24 [550400/612104 (90%)]	lr:7.26e-05	Loss: 0.133966
[2024-01-06 19:11:51,544] {train_model:86} INFO - Train Epoch: 24 [611584/612104 (100%)]	lr:7.26e-05	Loss: 0.222628
[2024-01-06 19:12:04,515] {run_experiment:78} INFO - 
[2024-01-06 19:12:04,521] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 19:12:05,857] {result_logger:108} INFO - precision on WAKE: 0.988
[2024-01-06 19:12:06,767] {result_logger:109} INFO - recall on WAKE: 0.963
[2024-01-06 19:12:07,670] {result_logger:112} INFO - F1-score on WAKE: 0.976
[2024-01-06 19:12:07,670] {result_logger:113} INFO - 
[2024-01-06 19:12:09,069] {result_logger:108} INFO - precision on NREM: 0.955
[2024-01-06 19:12:09,966] {result_logger:109} INFO - recall on NREM: 0.954
[2024-01-06 19:12:10,862] {result_logger:112} INFO - F1-score on NREM: 0.954
[2024-01-06 19:12:10,862] {result_logger:113} INFO - 
[2024-01-06 19:12:12,124] {result_logger:108} INFO - precision on REM: 0.780
[2024-01-06 19:12:12,884] {result_logger:109} INFO - recall on REM: 0.956
[2024-01-06 19:12:13,640] {result_logger:112} INFO - F1-score on REM: 0.859
[2024-01-06 19:12:13,640] {result_logger:113} INFO - 
[2024-01-06 19:12:13,844] {result_logger:116} INFO - average precision on sleep stages: 0.908
[2024-01-06 19:12:14,043] {result_logger:118} INFO - average recall on sleep stages: 0.958
[2024-01-06 19:12:14,236] {result_logger:120} INFO - average F1-score on sleep stages: 0.930
[2024-01-06 19:12:14,809] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.958
[2024-01-06 19:12:14,839] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.959
[2024-01-06 19:12:14,845] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 19:12:15,017] {result_logger:108} INFO - precision on WAKE: 0.898
[2024-01-06 19:12:15,122] {result_logger:109} INFO - recall on WAKE: 0.963
[2024-01-06 19:12:15,230] {result_logger:112} INFO - F1-score on WAKE: 0.929
[2024-01-06 19:12:15,230] {result_logger:113} INFO - 
[2024-01-06 19:12:15,406] {result_logger:108} INFO - precision on NREM: 0.937
[2024-01-06 19:12:15,512] {result_logger:109} INFO - recall on NREM: 0.804
[2024-01-06 19:12:15,616] {result_logger:112} INFO - F1-score on NREM: 0.865
[2024-01-06 19:12:15,616] {result_logger:113} INFO - 
[2024-01-06 19:12:15,779] {result_logger:108} INFO - precision on REM: 0.639
[2024-01-06 19:12:15,884] {result_logger:109} INFO - recall on REM: 0.817
[2024-01-06 19:12:15,988] {result_logger:112} INFO - F1-score on REM: 0.717
[2024-01-06 19:12:15,988] {result_logger:113} INFO - 
[2024-01-06 19:12:16,007] {result_logger:116} INFO - average precision on sleep stages: 0.825
[2024-01-06 19:12:16,025] {result_logger:118} INFO - average recall on sleep stages: 0.861
[2024-01-06 19:12:16,044] {result_logger:120} INFO - average F1-score on sleep stages: 0.837
[2024-01-06 19:12:16,122] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.861
[2024-01-06 19:12:16,125] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.891
[2024-01-06 19:12:16,126] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 19:12:16,727] {result_logger:143} INFO - 
[[319870   9528   2657      0]
 [  3378 228069   7741      2]
 [   377   1324  36970      0]
 [  1924    229     35      0]]
[2024-01-06 19:12:17,338] {result_logger:150} INFO - 
[[ 96.33%   2.87%   0.80%   0.00%]
 [  1.41%  95.35%   3.24%   0.00%]
 [  0.97%   3.42%  95.60%   0.00%]
 [ 87.93%  10.47%   1.60%   0.00%]]
[2024-01-06 19:12:17,949] {result_logger:154} INFO - 
[[ 98.26%   3.98%   5.61%   0.00%]
 [  1.04%  95.37%  16.33% 100.00%]
 [  0.12%   0.55%  77.99%   0.00%]
 [  0.59%   0.10%   0.07%   0.00%]]
[2024-01-06 19:12:17,950] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 19:12:18,035] {result_logger:143} INFO - 
[[46508  1617   194     0]
 [ 4614 28223  2268     0]
 [  696   283  4362     0]
 [  675   141    18     0]]
[2024-01-06 19:12:18,245] {result_logger:150} INFO - 
[[ 96.25%   3.35%   0.40%   0.00%]
 [ 13.14%  80.40%   6.46%   0.00%]
 [ 13.03%   5.30%  81.67%   0.00%]
 [ 80.94%  16.91%   2.16%   0.00%]]
[2024-01-06 19:12:18,579] {result_logger:154} INFO - 
[[ 88.60%   5.34%   2.84%    nan%]
 [  8.79%  93.26%  33.15%    nan%]
 [  1.33%   0.94%  63.75%    nan%]
 [  1.29%   0.47%   0.26%    nan%]]
[2024-01-06 19:12:19,014] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 19:12:19,014] {result_logger:77} INFO - actual:
[2024-01-06 19:12:19,014] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 19:12:19,014] {result_logger:79} INFO - predicted:
[2024-01-06 19:12:19,014] {result_logger:80} INFO - 
[[95.87%  3.35%  0.78%  0.00%]
 [ 4.85% 92.69%  2.46%  0.00%]
 [10.22%  6.64% 83.15%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 19:12:19,050] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it1/model_8conv_2fc-best.pth
[2024-01-06 19:12:19,050] {run_experiment:113} INFO - [epoch  24] execution time: 217.41s	 avg f1-score: 0.8371

[2024-01-06 19:12:19,050] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 19:12:19,110] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 19:12:45,281] {train_model:86} INFO - Train Epoch: 25 [60928/612104 (10%)]	lr:6.84e-05	Loss: 0.104556
[2024-01-06 19:13:09,798] {train_model:86} INFO - Train Epoch: 25 [122112/612104 (20%)]	lr:6.84e-05	Loss: 0.097116
[2024-01-06 19:13:34,028] {train_model:86} INFO - Train Epoch: 25 [183296/612104 (30%)]	lr:6.84e-05	Loss: 0.085181
[2024-01-06 19:13:50,044] {train_model:86} INFO - Train Epoch: 25 [244480/612104 (40%)]	lr:6.84e-05	Loss: 0.079006
[2024-01-06 19:14:01,775] {train_model:86} INFO - Train Epoch: 25 [305664/612104 (50%)]	lr:6.84e-05	Loss: 0.372341
[2024-01-06 19:14:13,310] {train_model:86} INFO - Train Epoch: 25 [366848/612104 (60%)]	lr:6.84e-05	Loss: 0.140149
[2024-01-06 19:14:46,643] {train_model:86} INFO - Train Epoch: 25 [428032/612104 (70%)]	lr:6.84e-05	Loss: 0.057827
[2024-01-06 19:15:06,518] {train_model:86} INFO - Train Epoch: 25 [489216/612104 (80%)]	lr:6.84e-05	Loss: 0.086440
[2024-01-06 19:15:19,347] {train_model:86} INFO - Train Epoch: 25 [550400/612104 (90%)]	lr:6.84e-05	Loss: 0.081873
[2024-01-06 19:15:31,369] {train_model:86} INFO - Train Epoch: 25 [611584/612104 (100%)]	lr:6.84e-05	Loss: 0.088575
[2024-01-06 19:15:44,073] {run_experiment:78} INFO - 
[2024-01-06 19:15:44,080] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 19:15:45,431] {result_logger:108} INFO - precision on WAKE: 0.989
[2024-01-06 19:15:46,312] {result_logger:109} INFO - recall on WAKE: 0.963
[2024-01-06 19:15:47,198] {result_logger:112} INFO - F1-score on WAKE: 0.976
[2024-01-06 19:15:47,199] {result_logger:113} INFO - 
[2024-01-06 19:15:48,531] {result_logger:108} INFO - precision on NREM: 0.954
[2024-01-06 19:15:49,425] {result_logger:109} INFO - recall on NREM: 0.955
[2024-01-06 19:15:50,334] {result_logger:112} INFO - F1-score on NREM: 0.954
[2024-01-06 19:15:50,334] {result_logger:113} INFO - 
[2024-01-06 19:15:51,596] {result_logger:108} INFO - precision on REM: 0.788
[2024-01-06 19:15:52,391] {result_logger:109} INFO - recall on REM: 0.957
[2024-01-06 19:15:53,172] {result_logger:112} INFO - F1-score on REM: 0.864
[2024-01-06 19:15:53,172] {result_logger:113} INFO - 
[2024-01-06 19:15:53,378] {result_logger:116} INFO - average precision on sleep stages: 0.910
[2024-01-06 19:15:53,581] {result_logger:118} INFO - average recall on sleep stages: 0.958
[2024-01-06 19:15:53,790] {result_logger:120} INFO - average F1-score on sleep stages: 0.931
[2024-01-06 19:15:54,358] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.958
[2024-01-06 19:15:54,387] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.960
[2024-01-06 19:15:54,391] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 19:15:54,565] {result_logger:108} INFO - precision on WAKE: 0.872
[2024-01-06 19:15:54,674] {result_logger:109} INFO - recall on WAKE: 0.775
[2024-01-06 19:15:54,781] {result_logger:112} INFO - F1-score on WAKE: 0.820
[2024-01-06 19:15:54,781] {result_logger:113} INFO - 
[2024-01-06 19:15:54,956] {result_logger:108} INFO - precision on NREM: 0.934
[2024-01-06 19:15:55,065] {result_logger:109} INFO - recall on NREM: 0.781
[2024-01-06 19:15:55,174] {result_logger:112} INFO - F1-score on NREM: 0.850
[2024-01-06 19:15:55,174] {result_logger:113} INFO - 
[2024-01-06 19:15:55,347] {result_logger:108} INFO - precision on REM: 0.293
[2024-01-06 19:15:55,455] {result_logger:109} INFO - recall on REM: 0.903
[2024-01-06 19:15:55,560] {result_logger:112} INFO - F1-score on REM: 0.442
[2024-01-06 19:15:55,560] {result_logger:113} INFO - 
[2024-01-06 19:15:55,581] {result_logger:116} INFO - average precision on sleep stages: 0.699
[2024-01-06 19:15:55,601] {result_logger:118} INFO - average recall on sleep stages: 0.820
[2024-01-06 19:15:55,621] {result_logger:120} INFO - average F1-score on sleep stages: 0.704
[2024-01-06 19:15:55,699] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.820
[2024-01-06 19:15:55,702] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.785
[2024-01-06 19:15:55,702] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 19:15:56,321] {result_logger:143} INFO - 
[[319853   9739   2463      0]
 [  3284 228410   7496      0]
 [   359   1322  36990      0]
 [  1917    236     35      0]]
[2024-01-06 19:15:56,929] {result_logger:150} INFO - 
[[ 96.33%   2.93%   0.74%   0.00%]
 [  1.37%  95.49%   3.13%   0.00%]
 [  0.93%   3.42%  95.65%   0.00%]
 [ 87.61%  10.79%   1.60%   0.00%]]
[2024-01-06 19:15:57,537] {result_logger:154} INFO - 
[[ 98.29%   4.06%   5.24%    nan%]
 [  1.01%  95.29%  15.95%    nan%]
 [  0.11%   0.55%  78.73%    nan%]
 [  0.59%   0.10%   0.07%    nan%]]
[2024-01-06 19:15:57,537] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 19:15:57,635] {result_logger:143} INFO - 
[[37441  1636  9242     0]
 [ 5307 27405  2393     0]
 [  207   311  4823     0]
 [  240    67   527     0]]
[2024-01-06 19:15:57,843] {result_logger:150} INFO - 
[[ 77.49%   3.39%  19.13%   0.00%]
 [ 15.12%  78.07%   6.82%   0.00%]
 [  3.88%   5.82%  90.30%   0.00%]
 [ 28.78%   8.03%  63.19%   0.00%]]
[2024-01-06 19:15:58,046] {result_logger:154} INFO - 
[[ 86.68%   5.56%  54.41%    nan%]
 [ 12.29%  93.15%  14.09%    nan%]
 [  0.48%   1.06%  28.40%    nan%]
 [  0.56%   0.23%   3.10%    nan%]]
[2024-01-06 19:15:58,490] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 19:15:58,490] {result_logger:77} INFO - actual:
[2024-01-06 19:15:58,491] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 19:15:58,491] {result_logger:79} INFO - predicted:
[2024-01-06 19:15:58,491] {result_logger:80} INFO - 
[[94.21%  2.52%  3.27%  0.00%]
 [ 3.42% 93.74%  2.84%  0.00%]
 [ 8.81%  4.43% 86.76%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 19:15:58,527] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it1/model_8conv_2fc-best.pth
[2024-01-06 19:15:58,527] {run_experiment:113} INFO - [epoch  25] execution time: 219.48s	 avg f1-score: 0.7044

[2024-01-06 19:15:58,527] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 19:15:58,585] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 19:16:24,729] {train_model:86} INFO - Train Epoch: 26 [60928/612104 (10%)]	lr:6.44e-05	Loss: 0.057534
[2024-01-06 19:16:36,314] {train_model:86} INFO - Train Epoch: 26 [122112/612104 (20%)]	lr:6.44e-05	Loss: 0.104503
[2024-01-06 19:17:03,587] {train_model:86} INFO - Train Epoch: 26 [183296/612104 (30%)]	lr:6.44e-05	Loss: 0.076820
[2024-01-06 19:17:28,929] {train_model:86} INFO - Train Epoch: 26 [244480/612104 (40%)]	lr:6.44e-05	Loss: 0.106041
[2024-01-06 19:17:40,708] {train_model:86} INFO - Train Epoch: 26 [305664/612104 (50%)]	lr:6.44e-05	Loss: 0.191699
[2024-01-06 19:18:07,398] {train_model:86} INFO - Train Epoch: 26 [366848/612104 (60%)]	lr:6.44e-05	Loss: 0.130134
[2024-01-06 19:18:33,673] {train_model:86} INFO - Train Epoch: 26 [428032/612104 (70%)]	lr:6.44e-05	Loss: 0.076915
[2024-01-06 19:18:45,633] {train_model:86} INFO - Train Epoch: 26 [489216/612104 (80%)]	lr:6.44e-05	Loss: 0.066747
[2024-01-06 19:18:57,753] {train_model:86} INFO - Train Epoch: 26 [550400/612104 (90%)]	lr:6.44e-05	Loss: 0.258981
[2024-01-06 19:19:09,822] {train_model:86} INFO - Train Epoch: 26 [611584/612104 (100%)]	lr:6.44e-05	Loss: 0.085142
[2024-01-06 19:19:22,881] {run_experiment:78} INFO - 
[2024-01-06 19:19:22,888] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 19:19:24,265] {result_logger:108} INFO - precision on WAKE: 0.988
[2024-01-06 19:19:25,148] {result_logger:109} INFO - recall on WAKE: 0.964
[2024-01-06 19:19:26,031] {result_logger:112} INFO - F1-score on WAKE: 0.976
[2024-01-06 19:19:26,031] {result_logger:113} INFO - 
[2024-01-06 19:19:27,390] {result_logger:108} INFO - precision on NREM: 0.955
[2024-01-06 19:19:28,284] {result_logger:109} INFO - recall on NREM: 0.955
[2024-01-06 19:19:29,173] {result_logger:112} INFO - F1-score on NREM: 0.955
[2024-01-06 19:19:29,173] {result_logger:113} INFO - 
[2024-01-06 19:19:30,467] {result_logger:108} INFO - precision on REM: 0.792
[2024-01-06 19:19:31,250] {result_logger:109} INFO - recall on REM: 0.957
[2024-01-06 19:19:32,028] {result_logger:112} INFO - F1-score on REM: 0.866
[2024-01-06 19:19:32,028] {result_logger:113} INFO - 
[2024-01-06 19:19:32,227] {result_logger:116} INFO - average precision on sleep stages: 0.912
[2024-01-06 19:19:32,419] {result_logger:118} INFO - average recall on sleep stages: 0.959
[2024-01-06 19:19:32,612] {result_logger:120} INFO - average F1-score on sleep stages: 0.933
[2024-01-06 19:19:33,192] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.959
[2024-01-06 19:19:33,219] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.960
[2024-01-06 19:19:33,225] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 19:19:33,406] {result_logger:108} INFO - precision on WAKE: 0.907
[2024-01-06 19:19:33,517] {result_logger:109} INFO - recall on WAKE: 0.943
[2024-01-06 19:19:33,626] {result_logger:112} INFO - F1-score on WAKE: 0.925
[2024-01-06 19:19:33,627] {result_logger:113} INFO - 
[2024-01-06 19:19:33,798] {result_logger:108} INFO - precision on NREM: 0.906
[2024-01-06 19:19:33,907] {result_logger:109} INFO - recall on NREM: 0.827
[2024-01-06 19:19:34,016] {result_logger:112} INFO - F1-score on NREM: 0.865
[2024-01-06 19:19:34,016] {result_logger:113} INFO - 
[2024-01-06 19:19:34,197] {result_logger:108} INFO - precision on REM: 0.678
[2024-01-06 19:19:34,306] {result_logger:109} INFO - recall on REM: 0.825
[2024-01-06 19:19:34,413] {result_logger:112} INFO - F1-score on REM: 0.744
[2024-01-06 19:19:34,414] {result_logger:113} INFO - 
[2024-01-06 19:19:34,433] {result_logger:116} INFO - average precision on sleep stages: 0.831
[2024-01-06 19:19:34,453] {result_logger:118} INFO - average recall on sleep stages: 0.865
[2024-01-06 19:19:34,473] {result_logger:120} INFO - average F1-score on sleep stages: 0.845
[2024-01-06 19:19:34,553] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.865
[2024-01-06 19:19:34,556] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.890
[2024-01-06 19:19:34,557] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 19:19:35,200] {result_logger:143} INFO - 
[[320128   9490   2437      0]
 [  3356 228527   7307      0]
 [   372   1294  37005      0]
 [  1925    228     35      0]]
[2024-01-06 19:19:35,843] {result_logger:150} INFO - 
[[ 96.41%   2.86%   0.73%   0.00%]
 [  1.40%  95.54%   3.05%   0.00%]
 [  0.96%   3.35%  95.69%   0.00%]
 [ 87.98%  10.42%   1.60%   0.00%]]
[2024-01-06 19:19:36,485] {result_logger:154} INFO - 
[[ 98.26%   3.96%   5.21%    nan%]
 [  1.03%  95.40%  15.62%    nan%]
 [  0.11%   0.54%  79.10%    nan%]
 [  0.59%   0.10%   0.07%    nan%]]
[2024-01-06 19:19:36,485] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 19:19:36,572] {result_logger:143} INFO - 
[[45579  2523   217     0]
 [ 4193 29036  1876     0]
 [  458   476  4407     0]
 [  569   246    19     0]]
[2024-01-06 19:19:36,784] {result_logger:150} INFO - 
[[ 94.33%   5.22%   0.45%   0.00%]
 [ 11.94%  82.71%   5.34%   0.00%]
 [  8.58%   8.91%  82.51%   0.00%]
 [ 68.23%  29.50%   2.28%   0.00%]]
[2024-01-06 19:19:36,989] {result_logger:154} INFO - 
[[ 89.72%   7.82%   3.33%    nan%]
 [  8.25%  89.95%  28.78%    nan%]
 [  0.90%   1.47%  67.60%    nan%]
 [  1.12%   0.76%   0.29%    nan%]]
[2024-01-06 19:19:37,435] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 19:19:37,435] {result_logger:77} INFO - actual:
[2024-01-06 19:19:37,435] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 19:19:37,436] {result_logger:79} INFO - predicted:
[2024-01-06 19:19:37,436] {result_logger:80} INFO - 
[[95.23%  4.10%  0.67%  0.00%]
 [ 5.57% 92.37%  2.06%  0.00%]
 [ 9.56%  5.86% 84.58%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 19:19:37,472] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it1/model_8conv_2fc-best.pth
[2024-01-06 19:19:37,472] {run_experiment:113} INFO - [epoch  26] execution time: 218.94s	 avg f1-score: 0.8448

[2024-01-06 19:19:37,472] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 19:19:37,529] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 19:20:03,562] {train_model:86} INFO - Train Epoch: 27 [60928/612104 (10%)]	lr:6.07e-05	Loss: 0.066646
[2024-01-06 19:20:15,222] {train_model:86} INFO - Train Epoch: 27 [122112/612104 (20%)]	lr:6.07e-05	Loss: 0.059629
[2024-01-06 19:20:38,785] {train_model:86} INFO - Train Epoch: 27 [183296/612104 (30%)]	lr:6.07e-05	Loss: 0.111336
[2024-01-06 19:20:54,462] {train_model:86} INFO - Train Epoch: 27 [244480/612104 (40%)]	lr:6.07e-05	Loss: 0.090418
[2024-01-06 19:21:19,871] {train_model:86} INFO - Train Epoch: 27 [305664/612104 (50%)]	lr:6.07e-05	Loss: 0.072777
[2024-01-06 19:21:47,153] {train_model:86} INFO - Train Epoch: 27 [366848/612104 (60%)]	lr:6.07e-05	Loss: 0.184609
[2024-01-06 19:22:13,003] {train_model:86} INFO - Train Epoch: 27 [428032/612104 (70%)]	lr:6.07e-05	Loss: 0.075167
[2024-01-06 19:22:24,750] {train_model:86} INFO - Train Epoch: 27 [489216/612104 (80%)]	lr:6.07e-05	Loss: 0.096086
[2024-01-06 19:22:37,411] {train_model:86} INFO - Train Epoch: 27 [550400/612104 (90%)]	lr:6.07e-05	Loss: 0.080983
[2024-01-06 19:22:48,973] {train_model:86} INFO - Train Epoch: 27 [611584/612104 (100%)]	lr:6.07e-05	Loss: 0.161661
[2024-01-06 19:23:02,017] {run_experiment:78} INFO - 
[2024-01-06 19:23:02,023] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 19:23:03,394] {result_logger:108} INFO - precision on WAKE: 0.989
[2024-01-06 19:23:04,299] {result_logger:109} INFO - recall on WAKE: 0.964
[2024-01-06 19:23:05,178] {result_logger:112} INFO - F1-score on WAKE: 0.976
[2024-01-06 19:23:05,178] {result_logger:113} INFO - 
[2024-01-06 19:23:06,502] {result_logger:108} INFO - precision on NREM: 0.955
[2024-01-06 19:23:07,405] {result_logger:109} INFO - recall on NREM: 0.956
[2024-01-06 19:23:08,329] {result_logger:112} INFO - F1-score on NREM: 0.955
[2024-01-06 19:23:08,329] {result_logger:113} INFO - 
[2024-01-06 19:23:09,576] {result_logger:108} INFO - precision on REM: 0.792
[2024-01-06 19:23:10,340] {result_logger:109} INFO - recall on REM: 0.959
[2024-01-06 19:23:11,090] {result_logger:112} INFO - F1-score on REM: 0.867
[2024-01-06 19:23:11,090] {result_logger:113} INFO - 
[2024-01-06 19:23:11,288] {result_logger:116} INFO - average precision on sleep stages: 0.912
[2024-01-06 19:23:11,482] {result_logger:118} INFO - average recall on sleep stages: 0.959
[2024-01-06 19:23:11,667] {result_logger:120} INFO - average F1-score on sleep stages: 0.933
[2024-01-06 19:23:12,195] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.959
[2024-01-06 19:23:12,223] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.960
[2024-01-06 19:23:12,226] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 19:23:12,392] {result_logger:108} INFO - precision on WAKE: 0.924
[2024-01-06 19:23:12,494] {result_logger:109} INFO - recall on WAKE: 0.928
[2024-01-06 19:23:12,599] {result_logger:112} INFO - F1-score on WAKE: 0.926
[2024-01-06 19:23:12,599] {result_logger:113} INFO - 
[2024-01-06 19:23:12,767] {result_logger:108} INFO - precision on NREM: 0.934
[2024-01-06 19:23:12,871] {result_logger:109} INFO - recall on NREM: 0.837
[2024-01-06 19:23:12,974] {result_logger:112} INFO - F1-score on NREM: 0.883
[2024-01-06 19:23:12,974] {result_logger:113} INFO - 
[2024-01-06 19:23:13,134] {result_logger:108} INFO - precision on REM: 0.575
[2024-01-06 19:23:13,234] {result_logger:109} INFO - recall on REM: 0.939
[2024-01-06 19:23:13,333] {result_logger:112} INFO - F1-score on REM: 0.713
[2024-01-06 19:23:13,333] {result_logger:113} INFO - 
[2024-01-06 19:23:13,351] {result_logger:116} INFO - average precision on sleep stages: 0.811
[2024-01-06 19:23:13,369] {result_logger:118} INFO - average recall on sleep stages: 0.901
[2024-01-06 19:23:13,388] {result_logger:120} INFO - average F1-score on sleep stages: 0.841
[2024-01-06 19:23:13,464] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.901
[2024-01-06 19:23:13,467] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.893
[2024-01-06 19:23:13,468] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 19:23:14,074] {result_logger:143} INFO - 
[[319984   9573   2497      1]
 [  3276 228671   7242      1]
 [   338   1261  37072      0]
 [  1928    227     33      0]]
[2024-01-06 19:23:14,689] {result_logger:150} INFO - 
[[ 96.36%   2.88%   0.75%   0.00%]
 [  1.37%  95.60%   3.03%   0.00%]
 [  0.87%   3.26%  95.87%   0.00%]
 [ 88.12%  10.37%   1.51%   0.00%]]
[2024-01-06 19:23:15,293] {result_logger:154} INFO - 
[[ 98.30%   3.99%   5.33%  50.00%]
 [  1.01%  95.39%  15.46%  50.00%]
 [  0.10%   0.53%  79.14%   0.00%]
 [  0.59%   0.09%   0.07%   0.00%]]
[2024-01-06 19:23:15,293] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 19:23:15,375] {result_logger:143} INFO - 
[[44842  1956  1521     0]
 [ 3519 29400  2186     0]
 [  194   133  5014     0]
 [  571   166    97     0]]
[2024-01-06 19:23:15,582] {result_logger:150} INFO - 
[[ 92.80%   4.05%   3.15%   0.00%]
 [ 10.02%  83.75%   6.23%   0.00%]
 [  3.63%   2.49%  93.88%   0.00%]
 [ 68.47%  19.90%  11.63%   0.00%]]
[2024-01-06 19:23:15,782] {result_logger:154} INFO - 
[[ 91.28%   6.18%  17.25%    nan%]
 [  7.16%  92.88%  24.79%    nan%]
 [  0.39%   0.42%  56.86%    nan%]
 [  1.16%   0.52%   1.10%    nan%]]
[2024-01-06 19:23:16,217] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 19:23:16,217] {result_logger:77} INFO - actual:
[2024-01-06 19:23:16,218] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 19:23:16,218] {result_logger:79} INFO - predicted:
[2024-01-06 19:23:16,218] {result_logger:80} INFO - 
[[95.09%  3.45%  1.46%  0.00%]
 [ 4.41% 92.92%  2.66%  0.00%]
 [11.50%  6.18% 82.32%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 19:23:16,255] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it1/model_8conv_2fc-best.pth
[2024-01-06 19:23:16,255] {run_experiment:113} INFO - [epoch  27] execution time: 218.78s	 avg f1-score: 0.8406

[2024-01-06 19:23:16,255] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 19:23:16,316] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 19:23:42,527] {train_model:86} INFO - Train Epoch: 28 [60928/612104 (10%)]	lr:5.71e-05	Loss: 0.091933
[2024-01-06 19:23:54,752] {train_model:86} INFO - Train Epoch: 28 [122112/612104 (20%)]	lr:5.71e-05	Loss: 0.097307
[2024-01-06 19:24:06,481] {train_model:86} INFO - Train Epoch: 28 [183296/612104 (30%)]	lr:5.71e-05	Loss: 0.063109
[2024-01-06 19:24:33,728] {train_model:86} INFO - Train Epoch: 28 [244480/612104 (40%)]	lr:5.71e-05	Loss: 0.199253
[2024-01-06 19:24:59,213] {train_model:86} INFO - Train Epoch: 28 [305664/612104 (50%)]	lr:5.71e-05	Loss: 0.128501
[2024-01-06 19:25:40,205] {train_model:86} INFO - Train Epoch: 28 [366848/612104 (60%)]	lr:5.71e-05	Loss: 0.058388
[2024-01-06 19:25:52,414] {train_model:86} INFO - Train Epoch: 28 [428032/612104 (70%)]	lr:5.71e-05	Loss: 0.085681
[2024-01-06 19:26:03,803] {train_model:86} INFO - Train Epoch: 28 [489216/612104 (80%)]	lr:5.71e-05	Loss: 0.071933
[2024-01-06 19:26:15,213] {train_model:86} INFO - Train Epoch: 28 [550400/612104 (90%)]	lr:5.71e-05	Loss: 0.052539
[2024-01-06 19:26:26,984] {train_model:86} INFO - Train Epoch: 28 [611584/612104 (100%)]	lr:5.71e-05	Loss: 0.057442
[2024-01-06 19:26:39,810] {run_experiment:78} INFO - 
[2024-01-06 19:26:39,816] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 19:26:41,150] {result_logger:108} INFO - precision on WAKE: 0.989
[2024-01-06 19:26:42,030] {result_logger:109} INFO - recall on WAKE: 0.965
[2024-01-06 19:26:42,916] {result_logger:112} INFO - F1-score on WAKE: 0.976
[2024-01-06 19:26:42,916] {result_logger:113} INFO - 
[2024-01-06 19:26:44,279] {result_logger:108} INFO - precision on NREM: 0.956
[2024-01-06 19:26:45,167] {result_logger:109} INFO - recall on NREM: 0.956
[2024-01-06 19:26:46,063] {result_logger:112} INFO - F1-score on NREM: 0.956
[2024-01-06 19:26:46,064] {result_logger:113} INFO - 
[2024-01-06 19:26:47,331] {result_logger:108} INFO - precision on REM: 0.795
[2024-01-06 19:26:48,121] {result_logger:109} INFO - recall on REM: 0.960
[2024-01-06 19:26:48,918] {result_logger:112} INFO - F1-score on REM: 0.869
[2024-01-06 19:26:48,919] {result_logger:113} INFO - 
[2024-01-06 19:26:49,123] {result_logger:116} INFO - average precision on sleep stages: 0.913
[2024-01-06 19:26:49,329] {result_logger:118} INFO - average recall on sleep stages: 0.960
[2024-01-06 19:26:49,530] {result_logger:120} INFO - average F1-score on sleep stages: 0.934
[2024-01-06 19:26:50,101] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.960
[2024-01-06 19:26:50,128] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.961
[2024-01-06 19:26:50,132] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 19:26:50,305] {result_logger:108} INFO - precision on WAKE: 0.918
[2024-01-06 19:26:50,415] {result_logger:109} INFO - recall on WAKE: 0.847
[2024-01-06 19:26:50,523] {result_logger:112} INFO - F1-score on WAKE: 0.881
[2024-01-06 19:26:50,523] {result_logger:113} INFO - 
[2024-01-06 19:26:50,703] {result_logger:108} INFO - precision on NREM: 0.930
[2024-01-06 19:26:50,809] {result_logger:109} INFO - recall on NREM: 0.842
[2024-01-06 19:26:50,917] {result_logger:112} INFO - F1-score on NREM: 0.884
[2024-01-06 19:26:50,917] {result_logger:113} INFO - 
[2024-01-06 19:26:51,099] {result_logger:108} INFO - precision on REM: 0.400
[2024-01-06 19:26:51,205] {result_logger:109} INFO - recall on REM: 0.930
[2024-01-06 19:26:51,313] {result_logger:112} INFO - F1-score on REM: 0.559
[2024-01-06 19:26:51,313] {result_logger:113} INFO - 
[2024-01-06 19:26:51,333] {result_logger:116} INFO - average precision on sleep stages: 0.749
[2024-01-06 19:26:51,353] {result_logger:118} INFO - average recall on sleep stages: 0.873
[2024-01-06 19:26:51,373] {result_logger:120} INFO - average F1-score on sleep stages: 0.775
[2024-01-06 19:26:51,450] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.873
[2024-01-06 19:26:51,453] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.850
[2024-01-06 19:26:51,454] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 19:26:52,059] {result_logger:143} INFO - 
[[320294   9364   2396      1]
 [  3370 228624   7195      1]
 [   339   1219  37113      0]
 [  1924    227     37      0]]
[2024-01-06 19:26:52,682] {result_logger:150} INFO - 
[[ 96.46%   2.82%   0.72%   0.00%]
 [  1.41%  95.58%   3.01%   0.00%]
 [  0.88%   3.15%  95.97%   0.00%]
 [ 87.93%  10.37%   1.69%   0.00%]]
[2024-01-06 19:26:53,290] {result_logger:154} INFO - 
[[ 98.27%   3.91%   5.13%  50.00%]
 [  1.03%  95.49%  15.39%  50.00%]
 [  0.10%   0.51%  79.40%   0.00%]
 [  0.59%   0.09%   0.08%   0.00%]]
[2024-01-06 19:26:53,290] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 19:26:53,372] {result_logger:143} INFO - 
[[40935  2004  5380     0]
 [ 3481 29542  2082     0]
 [  161   214  4966     0]
 [  344   143   347     0]]
[2024-01-06 19:26:53,583] {result_logger:150} INFO - 
[[ 84.72%   4.15%  11.13%   0.00%]
 [  9.92%  84.15%   5.93%   0.00%]
 [  3.01%   4.01%  92.98%   0.00%]
 [ 41.25%  17.15%  41.61%   0.00%]]
[2024-01-06 19:26:53,790] {result_logger:154} INFO - 
[[ 91.13%   6.28%  42.11%    nan%]
 [  7.75%  92.60%  16.30%    nan%]
 [  0.36%   0.67%  38.87%    nan%]
 [  0.77%   0.45%   2.72%    nan%]]
[2024-01-06 19:26:54,227] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 19:26:54,227] {result_logger:77} INFO - actual:
[2024-01-06 19:26:54,227] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 19:26:54,227] {result_logger:79} INFO - predicted:
[2024-01-06 19:26:54,228] {result_logger:80} INFO - 
[[93.74%  3.03%  3.23%  0.00%]
 [ 3.66% 93.49%  2.86%  0.00%]
 [12.86%  5.64% 81.50%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 19:26:54,264] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it1/model_8conv_2fc-best.pth
[2024-01-06 19:26:54,265] {run_experiment:113} INFO - [epoch  28] execution time: 218.01s	 avg f1-score: 0.7746

[2024-01-06 19:26:54,265] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 19:26:54,325] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 19:27:20,641] {train_model:86} INFO - Train Epoch: 29 [60928/612104 (10%)]	lr:5.38e-05	Loss: 0.164232
[2024-01-06 19:27:32,612] {train_model:86} INFO - Train Epoch: 29 [122112/612104 (20%)]	lr:5.38e-05	Loss: 0.063024
[2024-01-06 19:27:44,504] {train_model:86} INFO - Train Epoch: 29 [183296/612104 (30%)]	lr:5.38e-05	Loss: 0.170606
[2024-01-06 19:27:56,182] {train_model:86} INFO - Train Epoch: 29 [244480/612104 (40%)]	lr:5.38e-05	Loss: 0.071752
[2024-01-06 19:28:54,894] {train_model:86} INFO - Train Epoch: 29 [305664/612104 (50%)]	lr:5.38e-05	Loss: 0.175194
[2024-01-06 19:29:10,476] {train_model:86} INFO - Train Epoch: 29 [366848/612104 (60%)]	lr:5.38e-05	Loss: 0.077513
[2024-01-06 19:29:21,924] {train_model:86} INFO - Train Epoch: 29 [428032/612104 (70%)]	lr:5.38e-05	Loss: 0.071254
[2024-01-06 19:29:33,912] {train_model:86} INFO - Train Epoch: 29 [489216/612104 (80%)]	lr:5.38e-05	Loss: 0.085896
[2024-01-06 19:29:45,671] {train_model:86} INFO - Train Epoch: 29 [550400/612104 (90%)]	lr:5.38e-05	Loss: 0.063210
[2024-01-06 19:29:57,427] {train_model:86} INFO - Train Epoch: 29 [611584/612104 (100%)]	lr:5.38e-05	Loss: 0.038371
[2024-01-06 19:30:10,230] {run_experiment:78} INFO - 
[2024-01-06 19:30:10,236] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 19:30:11,579] {result_logger:108} INFO - precision on WAKE: 0.989
[2024-01-06 19:30:12,488] {result_logger:109} INFO - recall on WAKE: 0.964
[2024-01-06 19:30:13,382] {result_logger:112} INFO - F1-score on WAKE: 0.976
[2024-01-06 19:30:13,382] {result_logger:113} INFO - 
[2024-01-06 19:30:14,726] {result_logger:108} INFO - precision on NREM: 0.956
[2024-01-06 19:30:15,631] {result_logger:109} INFO - recall on NREM: 0.957
[2024-01-06 19:30:16,529] {result_logger:112} INFO - F1-score on NREM: 0.956
[2024-01-06 19:30:16,529] {result_logger:113} INFO - 
[2024-01-06 19:30:17,774] {result_logger:108} INFO - precision on REM: 0.798
[2024-01-06 19:30:18,570] {result_logger:109} INFO - recall on REM: 0.960
[2024-01-06 19:30:19,362] {result_logger:112} INFO - F1-score on REM: 0.872
[2024-01-06 19:30:19,362] {result_logger:113} INFO - 
[2024-01-06 19:30:19,570] {result_logger:116} INFO - average precision on sleep stages: 0.914
[2024-01-06 19:30:19,779] {result_logger:118} INFO - average recall on sleep stages: 0.960
[2024-01-06 19:30:19,987] {result_logger:120} INFO - average F1-score on sleep stages: 0.935
[2024-01-06 19:30:20,551] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.960
[2024-01-06 19:30:20,580] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.961
[2024-01-06 19:30:20,584] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 19:30:20,753] {result_logger:108} INFO - precision on WAKE: 0.901
[2024-01-06 19:30:20,860] {result_logger:109} INFO - recall on WAKE: 0.932
[2024-01-06 19:30:20,967] {result_logger:112} INFO - F1-score on WAKE: 0.916
[2024-01-06 19:30:20,967] {result_logger:113} INFO - 
[2024-01-06 19:30:21,141] {result_logger:108} INFO - precision on NREM: 0.902
[2024-01-06 19:30:21,249] {result_logger:109} INFO - recall on NREM: 0.826
[2024-01-06 19:30:21,353] {result_logger:112} INFO - F1-score on NREM: 0.863
[2024-01-06 19:30:21,353] {result_logger:113} INFO - 
[2024-01-06 19:30:21,526] {result_logger:108} INFO - precision on REM: 0.694
[2024-01-06 19:30:21,630] {result_logger:109} INFO - recall on REM: 0.858
[2024-01-06 19:30:21,735] {result_logger:112} INFO - F1-score on REM: 0.767
[2024-01-06 19:30:21,735] {result_logger:113} INFO - 
[2024-01-06 19:30:21,755] {result_logger:116} INFO - average precision on sleep stages: 0.832
[2024-01-06 19:30:21,775] {result_logger:118} INFO - average recall on sleep stages: 0.872
[2024-01-06 19:30:21,795] {result_logger:120} INFO - average F1-score on sleep stages: 0.849
[2024-01-06 19:30:21,871] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.872
[2024-01-06 19:30:21,874] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.886
[2024-01-06 19:30:21,874] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 19:30:22,484] {result_logger:143} INFO - 
[[320261   9401   2392      1]
 [  3362 228837   6990      1]
 [   351   1208  37112      0]
 [  1918    234     36      0]]
[2024-01-06 19:30:23,090] {result_logger:150} INFO - 
[[ 96.45%   2.83%   0.72%   0.00%]
 [  1.41%  95.67%   2.92%   0.00%]
 [  0.91%   3.12%  95.97%   0.00%]
 [ 87.66%  10.69%   1.65%   0.00%]]
[2024-01-06 19:30:23,692] {result_logger:154} INFO - 
[[ 98.27%   3.92%   5.14%  50.00%]
 [  1.03%  95.48%  15.02%  50.00%]
 [  0.11%   0.50%  79.76%   0.00%]
 [  0.59%   0.10%   0.08%   0.00%]]
[2024-01-06 19:30:23,693] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 19:30:23,773] {result_logger:143} INFO - 
[[45057  2832   430     0]
 [ 4508 29007  1590     0]
 [  451   308  4582     0]
 [  523   280    31     0]]
[2024-01-06 19:30:23,980] {result_logger:150} INFO - 
[[ 93.25%   5.86%   0.89%   0.00%]
 [ 12.84%  82.63%   4.53%   0.00%]
 [  8.44%   5.77%  85.79%   0.00%]
 [ 62.71%  33.57%   3.72%   0.00%]]
[2024-01-06 19:30:24,186] {result_logger:154} INFO - 
[[ 89.15%   8.73%   6.48%    nan%]
 [  8.92%  89.45%  23.97%    nan%]
 [  0.89%   0.95%  69.08%    nan%]
 [  1.03%   0.86%   0.47%    nan%]]
[2024-01-06 19:30:24,620] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 19:30:24,621] {result_logger:77} INFO - actual:
[2024-01-06 19:30:24,621] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 19:30:24,621] {result_logger:79} INFO - predicted:
[2024-01-06 19:30:24,621] {result_logger:80} INFO - 
[[94.93%  4.22%  0.84%  0.00%]
 [ 5.77% 92.26%  1.97%  0.00%]
 [10.36%  5.71% 83.93%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 19:30:24,657] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it1/model_8conv_2fc-best.pth
[2024-01-06 19:30:24,657] {run_experiment:113} INFO - [epoch  29] execution time: 210.39s	 avg f1-score: 0.8488

[2024-01-06 19:30:24,657] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 19:30:24,716] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 19:30:51,811] {train_model:86} INFO - Train Epoch: 30 [60928/612104 (10%)]	lr:5.07e-05	Loss: 0.070287
[2024-01-06 19:31:04,432] {train_model:86} INFO - Train Epoch: 30 [122112/612104 (20%)]	lr:5.07e-05	Loss: 0.093248
[2024-01-06 19:31:17,241] {train_model:86} INFO - Train Epoch: 30 [183296/612104 (30%)]	lr:5.07e-05	Loss: 0.190844
[2024-01-06 19:31:45,000] {train_model:86} INFO - Train Epoch: 30 [244480/612104 (40%)]	lr:5.07e-05	Loss: 0.051145
[2024-01-06 19:32:13,623] {train_model:86} INFO - Train Epoch: 30 [305664/612104 (50%)]	lr:5.07e-05	Loss: 0.117380
[2024-01-06 19:32:39,850] {train_model:86} INFO - Train Epoch: 30 [366848/612104 (60%)]	lr:5.07e-05	Loss: 0.081503
[2024-01-06 19:32:52,075] {train_model:86} INFO - Train Epoch: 30 [428032/612104 (70%)]	lr:5.07e-05	Loss: 0.195407
[2024-01-06 19:33:03,713] {train_model:86} INFO - Train Epoch: 30 [489216/612104 (80%)]	lr:5.07e-05	Loss: 0.067359
[2024-01-06 19:33:16,280] {train_model:86} INFO - Train Epoch: 30 [550400/612104 (90%)]	lr:5.07e-05	Loss: 0.093575
[2024-01-06 19:33:28,159] {train_model:86} INFO - Train Epoch: 30 [611584/612104 (100%)]	lr:5.07e-05	Loss: 0.108627
[2024-01-06 19:33:41,050] {run_experiment:78} INFO - 
[2024-01-06 19:33:41,056] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 19:33:42,420] {result_logger:108} INFO - precision on WAKE: 0.988
[2024-01-06 19:33:43,316] {result_logger:109} INFO - recall on WAKE: 0.965
[2024-01-06 19:33:44,216] {result_logger:112} INFO - F1-score on WAKE: 0.976
[2024-01-06 19:33:44,216] {result_logger:113} INFO - 
[2024-01-06 19:33:45,534] {result_logger:108} INFO - precision on NREM: 0.956
[2024-01-06 19:33:46,433] {result_logger:109} INFO - recall on NREM: 0.957
[2024-01-06 19:33:47,340] {result_logger:112} INFO - F1-score on NREM: 0.956
[2024-01-06 19:33:47,340] {result_logger:113} INFO - 
[2024-01-06 19:33:48,620] {result_logger:108} INFO - precision on REM: 0.799
[2024-01-06 19:33:49,411] {result_logger:109} INFO - recall on REM: 0.962
[2024-01-06 19:33:50,199] {result_logger:112} INFO - F1-score on REM: 0.873
[2024-01-06 19:33:50,199] {result_logger:113} INFO - 
[2024-01-06 19:33:50,402] {result_logger:116} INFO - average precision on sleep stages: 0.915
[2024-01-06 19:33:50,602] {result_logger:118} INFO - average recall on sleep stages: 0.961
[2024-01-06 19:33:50,806] {result_logger:120} INFO - average F1-score on sleep stages: 0.935
[2024-01-06 19:33:51,385] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.961
[2024-01-06 19:33:51,413] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.961
[2024-01-06 19:33:51,417] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 19:33:51,594] {result_logger:108} INFO - precision on WAKE: 0.935
[2024-01-06 19:33:51,701] {result_logger:109} INFO - recall on WAKE: 0.901
[2024-01-06 19:33:51,809] {result_logger:112} INFO - F1-score on WAKE: 0.918
[2024-01-06 19:33:51,810] {result_logger:113} INFO - 
[2024-01-06 19:33:51,983] {result_logger:108} INFO - precision on NREM: 0.832
[2024-01-06 19:33:52,087] {result_logger:109} INFO - recall on NREM: 0.874
[2024-01-06 19:33:52,194] {result_logger:112} INFO - F1-score on NREM: 0.853
[2024-01-06 19:33:52,195] {result_logger:113} INFO - 
[2024-01-06 19:33:52,372] {result_logger:108} INFO - precision on REM: 0.571
[2024-01-06 19:33:52,480] {result_logger:109} INFO - recall on REM: 0.576
[2024-01-06 19:33:52,587] {result_logger:112} INFO - F1-score on REM: 0.574
[2024-01-06 19:33:52,587] {result_logger:113} INFO - 
[2024-01-06 19:33:52,606] {result_logger:116} INFO - average precision on sleep stages: 0.780
[2024-01-06 19:33:52,625] {result_logger:118} INFO - average recall on sleep stages: 0.783
[2024-01-06 19:33:52,645] {result_logger:120} INFO - average F1-score on sleep stages: 0.781
[2024-01-06 19:33:52,722] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.783
[2024-01-06 19:33:52,725] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.870
[2024-01-06 19:33:52,725] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 19:33:53,341] {result_logger:143} INFO - 
[[320366   9315   2374      0]
 [  3425 228794   6971      0]
 [   322   1163  37186      0]
 [  1921    229     38      0]]
[2024-01-06 19:33:53,976] {result_logger:150} INFO - 
[[ 96.48%   2.81%   0.71%   0.00%]
 [  1.43%  95.65%   2.91%   0.00%]
 [  0.83%   3.01%  96.16%   0.00%]
 [ 87.80%  10.47%   1.74%   0.00%]]
[2024-01-06 19:33:54,604] {result_logger:154} INFO - 
[[ 98.26%   3.89%   5.10%    nan%]
 [  1.05%  95.53%  14.97%    nan%]
 [  0.10%   0.49%  79.85%    nan%]
 [  0.59%   0.10%   0.08%    nan%]]
[2024-01-06 19:33:54,604] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 19:33:54,688] {result_logger:143} INFO - 
[[43513  4728    78     0]
 [ 2201 30670  2234     0]
 [  817  1446  3078     0]
 [  353   471    10     0]]
[2024-01-06 19:33:54,896] {result_logger:150} INFO - 
[[ 90.05%   9.78%   0.16%   0.00%]
 [  6.27%  87.37%   6.36%   0.00%]
 [ 15.30%  27.07%  57.63%   0.00%]
 [ 42.33%  56.47%   1.20%   0.00%]]
[2024-01-06 19:33:55,091] {result_logger:154} INFO - 
[[ 92.81%  12.67%   1.44%    nan%]
 [  4.69%  82.19%  41.37%    nan%]
 [  1.74%   3.88%  57.00%    nan%]
 [  0.75%   1.26%   0.19%    nan%]]
[2024-01-06 19:33:55,531] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 19:33:55,531] {result_logger:77} INFO - actual:
[2024-01-06 19:33:55,531] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 19:33:55,531] {result_logger:79} INFO - predicted:
[2024-01-06 19:33:55,531] {result_logger:80} INFO - 
[[94.04%  5.43%  0.53%  0.00%]
 [ 6.12% 92.05%  1.83%  0.00%]
 [ 9.43%  7.78% 82.80%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 19:33:55,568] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it1/model_8conv_2fc-best.pth
[2024-01-06 19:33:55,569] {run_experiment:113} INFO - [epoch  30] execution time: 210.91s	 avg f1-score: 0.7812

[2024-01-06 19:33:55,569] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 19:33:55,626] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 19:34:21,711] {train_model:86} INFO - Train Epoch: 31 [60928/612104 (10%)]	lr:4.77e-05	Loss: 0.102694
[2024-01-06 19:34:33,196] {train_model:86} INFO - Train Epoch: 31 [122112/612104 (20%)]	lr:4.77e-05	Loss: 0.091791
[2024-01-06 19:34:57,506] {train_model:86} INFO - Train Epoch: 31 [183296/612104 (30%)]	lr:4.77e-05	Loss: 0.080673
[2024-01-06 19:35:25,528] {train_model:86} INFO - Train Epoch: 31 [244480/612104 (40%)]	lr:4.77e-05	Loss: 0.115803
[2024-01-06 19:35:51,831] {train_model:86} INFO - Train Epoch: 31 [305664/612104 (50%)]	lr:4.77e-05	Loss: 0.101168
[2024-01-06 19:36:15,777] {train_model:86} INFO - Train Epoch: 31 [366848/612104 (60%)]	lr:4.77e-05	Loss: 0.086347
[2024-01-06 19:36:30,035] {train_model:86} INFO - Train Epoch: 31 [428032/612104 (70%)]	lr:4.77e-05	Loss: 0.187907
[2024-01-06 19:36:41,620] {train_model:86} INFO - Train Epoch: 31 [489216/612104 (80%)]	lr:4.77e-05	Loss: 0.159204
[2024-01-06 19:36:53,575] {train_model:86} INFO - Train Epoch: 31 [550400/612104 (90%)]	lr:4.77e-05	Loss: 0.041746
[2024-01-06 19:37:05,521] {train_model:86} INFO - Train Epoch: 31 [611584/612104 (100%)]	lr:4.77e-05	Loss: 0.082361
[2024-01-06 19:37:18,411] {run_experiment:78} INFO - 
[2024-01-06 19:37:18,417] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 19:37:19,740] {result_logger:108} INFO - precision on WAKE: 0.989
[2024-01-06 19:37:20,606] {result_logger:109} INFO - recall on WAKE: 0.965
[2024-01-06 19:37:21,489] {result_logger:112} INFO - F1-score on WAKE: 0.977
[2024-01-06 19:37:21,490] {result_logger:113} INFO - 
[2024-01-06 19:37:22,810] {result_logger:108} INFO - precision on NREM: 0.956
[2024-01-06 19:37:23,675] {result_logger:109} INFO - recall on NREM: 0.957
[2024-01-06 19:37:24,559] {result_logger:112} INFO - F1-score on NREM: 0.957
[2024-01-06 19:37:24,560] {result_logger:113} INFO - 
[2024-01-06 19:37:25,818] {result_logger:108} INFO - precision on REM: 0.801
[2024-01-06 19:37:26,601] {result_logger:109} INFO - recall on REM: 0.962
[2024-01-06 19:37:27,388] {result_logger:112} INFO - F1-score on REM: 0.874
[2024-01-06 19:37:27,388] {result_logger:113} INFO - 
[2024-01-06 19:37:27,595] {result_logger:116} INFO - average precision on sleep stages: 0.915
[2024-01-06 19:37:27,802] {result_logger:118} INFO - average recall on sleep stages: 0.961
[2024-01-06 19:37:28,007] {result_logger:120} INFO - average F1-score on sleep stages: 0.936
[2024-01-06 19:37:28,572] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.961
[2024-01-06 19:37:28,600] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.962
[2024-01-06 19:37:28,604] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 19:37:28,777] {result_logger:108} INFO - precision on WAKE: 0.900
[2024-01-06 19:37:28,884] {result_logger:109} INFO - recall on WAKE: 0.949
[2024-01-06 19:37:28,992] {result_logger:112} INFO - F1-score on WAKE: 0.924
[2024-01-06 19:37:28,992] {result_logger:113} INFO - 
[2024-01-06 19:37:29,165] {result_logger:108} INFO - precision on NREM: 0.925
[2024-01-06 19:37:29,271] {result_logger:109} INFO - recall on NREM: 0.819
[2024-01-06 19:37:29,380] {result_logger:112} INFO - F1-score on NREM: 0.868
[2024-01-06 19:37:29,381] {result_logger:113} INFO - 
[2024-01-06 19:37:29,555] {result_logger:108} INFO - precision on REM: 0.693
[2024-01-06 19:37:29,663] {result_logger:109} INFO - recall on REM: 0.870
[2024-01-06 19:37:29,771] {result_logger:112} INFO - F1-score on REM: 0.772
[2024-01-06 19:37:29,771] {result_logger:113} INFO - 
[2024-01-06 19:37:29,791] {result_logger:116} INFO - average precision on sleep stages: 0.839
[2024-01-06 19:37:29,810] {result_logger:118} INFO - average recall on sleep stages: 0.879
[2024-01-06 19:37:29,829] {result_logger:120} INFO - average F1-score on sleep stages: 0.855
[2024-01-06 19:37:29,907] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.879
[2024-01-06 19:37:29,910] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.893
[2024-01-06 19:37:29,911] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 19:37:30,531] {result_logger:143} INFO - 
[[320539   9308   2208      0]
 [  3311 228840   7038      1]
 [   335   1143  37193      0]
 [  1929    225     34      0]]
[2024-01-06 19:37:31,162] {result_logger:150} INFO - 
[[ 96.53%   2.80%   0.66%   0.00%]
 [  1.38%  95.67%   2.94%   0.00%]
 [  0.87%   2.96%  96.18%   0.00%]
 [ 88.16%  10.28%   1.55%   0.00%]]
[2024-01-06 19:37:31,797] {result_logger:154} INFO - 
[[ 98.29%   3.89%   4.75%   0.00%]
 [  1.02%  95.54%  15.14% 100.00%]
 [  0.10%   0.48%  80.03%   0.00%]
 [  0.59%   0.09%   0.07%   0.00%]]
[2024-01-06 19:37:31,797] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 19:37:31,881] {result_logger:143} INFO - 
[[45865  2084   370     0]
 [ 4683 28737  1685     0]
 [  436   256  4649     0]
 [  617   195    22     0]]
[2024-01-06 19:37:32,091] {result_logger:150} INFO - 
[[ 94.92%   4.31%   0.77%   0.00%]
 [ 13.34%  81.86%   4.80%   0.00%]
 [  8.16%   4.79%  87.04%   0.00%]
 [ 73.98%  23.38%   2.64%   0.00%]]
[2024-01-06 19:37:32,293] {result_logger:154} INFO - 
[[ 88.88%   6.66%   5.50%    nan%]
 [  9.08%  91.89%  25.05%    nan%]
 [  0.84%   0.82%  69.12%    nan%]
 [  1.20%   0.62%   0.33%    nan%]]
[2024-01-06 19:37:32,829] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 19:37:32,829] {result_logger:77} INFO - actual:
[2024-01-06 19:37:32,829] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 19:37:32,829] {result_logger:79} INFO - predicted:
[2024-01-06 19:37:32,829] {result_logger:80} INFO - 
[[95.43%  3.81%  0.77%  0.00%]
 [ 5.40% 92.63%  1.97%  0.00%]
 [ 9.98%  5.08% 84.94%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 19:37:32,865] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it1/model_8conv_2fc-best.pth
[2024-01-06 19:37:32,865] {run_experiment:113} INFO - [epoch  31] execution time: 217.30s	 avg f1-score: 0.8547

[2024-01-06 19:37:32,866] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 19:37:32,923] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 19:37:59,245] {train_model:86} INFO - Train Epoch: 32 [60928/612104 (10%)]	lr:4.49e-05	Loss: 0.026106
[2024-01-06 19:38:10,679] {train_model:86} INFO - Train Epoch: 32 [122112/612104 (20%)]	lr:4.49e-05	Loss: 0.079140
[2024-01-06 19:38:38,100] {train_model:86} INFO - Train Epoch: 32 [183296/612104 (30%)]	lr:4.49e-05	Loss: 0.166233
[2024-01-06 19:39:03,771] {train_model:86} INFO - Train Epoch: 32 [244480/612104 (40%)]	lr:4.49e-05	Loss: 0.083869
[2024-01-06 19:39:15,269] {train_model:86} INFO - Train Epoch: 32 [305664/612104 (50%)]	lr:4.49e-05	Loss: 0.085467
[2024-01-06 19:39:42,366] {train_model:86} INFO - Train Epoch: 32 [366848/612104 (60%)]	lr:4.49e-05	Loss: 0.061056
[2024-01-06 19:40:07,870] {train_model:86} INFO - Train Epoch: 32 [428032/612104 (70%)]	lr:4.49e-05	Loss: 0.073825
[2024-01-06 19:40:19,382] {train_model:86} INFO - Train Epoch: 32 [489216/612104 (80%)]	lr:4.49e-05	Loss: 0.079958
[2024-01-06 19:40:30,779] {train_model:86} INFO - Train Epoch: 32 [550400/612104 (90%)]	lr:4.49e-05	Loss: 0.047180
[2024-01-06 19:40:42,411] {train_model:86} INFO - Train Epoch: 32 [611584/612104 (100%)]	lr:4.49e-05	Loss: 0.075844
[2024-01-06 19:40:55,173] {run_experiment:78} INFO - 
[2024-01-06 19:40:55,180] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 19:40:56,553] {result_logger:108} INFO - precision on WAKE: 0.989
[2024-01-06 19:40:57,473] {result_logger:109} INFO - recall on WAKE: 0.965
[2024-01-06 19:40:58,410] {result_logger:112} INFO - F1-score on WAKE: 0.977
[2024-01-06 19:40:58,410] {result_logger:113} INFO - 
[2024-01-06 19:40:59,855] {result_logger:108} INFO - precision on NREM: 0.956
[2024-01-06 19:41:00,786] {result_logger:109} INFO - recall on NREM: 0.958
[2024-01-06 19:41:01,700] {result_logger:112} INFO - F1-score on NREM: 0.957
[2024-01-06 19:41:01,700] {result_logger:113} INFO - 
[2024-01-06 19:41:02,951] {result_logger:108} INFO - precision on REM: 0.803
[2024-01-06 19:41:03,736] {result_logger:109} INFO - recall on REM: 0.963
[2024-01-06 19:41:04,508] {result_logger:112} INFO - F1-score on REM: 0.876
[2024-01-06 19:41:04,508] {result_logger:113} INFO - 
[2024-01-06 19:41:04,712] {result_logger:116} INFO - average precision on sleep stages: 0.916
[2024-01-06 19:41:04,924] {result_logger:118} INFO - average recall on sleep stages: 0.962
[2024-01-06 19:41:05,138] {result_logger:120} INFO - average F1-score on sleep stages: 0.937
[2024-01-06 19:41:05,712] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.962
[2024-01-06 19:41:05,742] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.962
[2024-01-06 19:41:05,746] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 19:41:05,921] {result_logger:108} INFO - precision on WAKE: 0.903
[2024-01-06 19:41:06,027] {result_logger:109} INFO - recall on WAKE: 0.951
[2024-01-06 19:41:06,135] {result_logger:112} INFO - F1-score on WAKE: 0.926
[2024-01-06 19:41:06,135] {result_logger:113} INFO - 
[2024-01-06 19:41:06,310] {result_logger:108} INFO - precision on NREM: 0.947
[2024-01-06 19:41:06,418] {result_logger:109} INFO - recall on NREM: 0.796
[2024-01-06 19:41:06,528] {result_logger:112} INFO - F1-score on NREM: 0.865
[2024-01-06 19:41:06,528] {result_logger:113} INFO - 
[2024-01-06 19:41:06,702] {result_logger:108} INFO - precision on REM: 0.584
[2024-01-06 19:41:06,806] {result_logger:109} INFO - recall on REM: 0.911
[2024-01-06 19:41:06,915] {result_logger:112} INFO - F1-score on REM: 0.712
[2024-01-06 19:41:06,915] {result_logger:113} INFO - 
[2024-01-06 19:41:06,936] {result_logger:116} INFO - average precision on sleep stages: 0.811
[2024-01-06 19:41:06,956] {result_logger:118} INFO - average recall on sleep stages: 0.886
[2024-01-06 19:41:06,977] {result_logger:120} INFO - average F1-score on sleep stages: 0.834
[2024-01-06 19:41:07,058] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.886
[2024-01-06 19:41:07,061] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.888
[2024-01-06 19:41:07,062] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 19:41:07,681] {result_logger:143} INFO - 
[[320412   9410   2232      1]
 [  3255 229055   6880      0]
 [   324   1099  37248      0]
 [  1924    225     39      0]]
[2024-01-06 19:41:08,288] {result_logger:150} INFO - 
[[ 96.49%   2.83%   0.67%   0.00%]
 [  1.36%  95.76%   2.88%   0.00%]
 [  0.84%   2.84%  96.32%   0.00%]
 [ 87.93%  10.28%   1.78%   0.00%]]
[2024-01-06 19:41:08,908] {result_logger:154} INFO - 
[[ 98.31%   3.92%   4.81% 100.00%]
 [  1.00%  95.52%  14.83%   0.00%]
 [  0.10%   0.46%  80.28%   0.00%]
 [  0.59%   0.09%   0.08%   0.00%]]
[2024-01-06 19:41:08,908] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 19:41:08,990] {result_logger:143} INFO - 
[[45967  1445   907     0]
 [ 4593 27950  2562     0]
 [  356   118  4867     0]
 [  650   117    67     0]]
[2024-01-06 19:41:09,201] {result_logger:150} INFO - 
[[ 95.13%   2.99%   1.88%   0.00%]
 [ 13.08%  79.62%   7.30%   0.00%]
 [  6.67%   2.21%  91.13%   0.00%]
 [ 77.94%  14.03%   8.03%   0.00%]]
[2024-01-06 19:41:09,398] {result_logger:154} INFO - 
[[ 89.14%   4.88%  10.79%    nan%]
 [  8.91%  94.33%  30.49%    nan%]
 [  0.69%   0.40%  57.92%    nan%]
 [  1.26%   0.39%   0.80%    nan%]]
[2024-01-06 19:41:09,842] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 19:41:09,843] {result_logger:77} INFO - actual:
[2024-01-06 19:41:09,843] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 19:41:09,843] {result_logger:79} INFO - predicted:
[2024-01-06 19:41:09,843] {result_logger:80} INFO - 
[[95.42%  3.31%  1.27%  0.00%]
 [ 4.78% 92.38%  2.85%  0.00%]
 [11.26%  6.59% 82.15%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 19:41:09,880] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it1/model_8conv_2fc-best.pth
[2024-01-06 19:41:09,881] {run_experiment:113} INFO - [epoch  32] execution time: 217.02s	 avg f1-score: 0.8344

[2024-01-06 19:41:09,881] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 19:41:09,936] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 19:41:36,139] {train_model:86} INFO - Train Epoch: 33 [60928/612104 (10%)]	lr:4.23e-05	Loss: 0.062850
[2024-01-06 19:41:48,260] {train_model:86} INFO - Train Epoch: 33 [122112/612104 (20%)]	lr:4.23e-05	Loss: 0.078258
[2024-01-06 19:42:16,274] {train_model:86} INFO - Train Epoch: 33 [183296/612104 (30%)]	lr:4.23e-05	Loss: 0.099076
[2024-01-06 19:42:41,868] {train_model:86} INFO - Train Epoch: 33 [244480/612104 (40%)]	lr:4.23e-05	Loss: 0.103555
[2024-01-06 19:42:54,368] {train_model:86} INFO - Train Epoch: 33 [305664/612104 (50%)]	lr:4.23e-05	Loss: 0.054501
[2024-01-06 19:43:06,351] {train_model:86} INFO - Train Epoch: 33 [366848/612104 (60%)]	lr:4.23e-05	Loss: 0.068330
[2024-01-06 19:43:33,586] {train_model:86} INFO - Train Epoch: 33 [428032/612104 (70%)]	lr:4.23e-05	Loss: 0.054566
[2024-01-06 19:43:59,696] {train_model:86} INFO - Train Epoch: 33 [489216/612104 (80%)]	lr:4.23e-05	Loss: 0.063834
[2024-01-06 19:44:11,597] {train_model:86} INFO - Train Epoch: 33 [550400/612104 (90%)]	lr:4.23e-05	Loss: 0.065693
[2024-01-06 19:44:23,698] {train_model:86} INFO - Train Epoch: 33 [611584/612104 (100%)]	lr:4.23e-05	Loss: 0.071894
[2024-01-06 19:44:36,384] {run_experiment:78} INFO - 
[2024-01-06 19:44:36,390] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 19:44:37,815] {result_logger:108} INFO - precision on WAKE: 0.989
[2024-01-06 19:44:38,786] {result_logger:109} INFO - recall on WAKE: 0.965
[2024-01-06 19:44:39,720] {result_logger:112} INFO - F1-score on WAKE: 0.977
[2024-01-06 19:44:39,720] {result_logger:113} INFO - 
[2024-01-06 19:44:41,172] {result_logger:108} INFO - precision on NREM: 0.956
[2024-01-06 19:44:42,133] {result_logger:109} INFO - recall on NREM: 0.958
[2024-01-06 19:44:43,049] {result_logger:112} INFO - F1-score on NREM: 0.957
[2024-01-06 19:44:43,049] {result_logger:113} INFO - 
[2024-01-06 19:44:44,309] {result_logger:108} INFO - precision on REM: 0.807
[2024-01-06 19:44:45,092] {result_logger:109} INFO - recall on REM: 0.963
[2024-01-06 19:44:45,866] {result_logger:112} INFO - F1-score on REM: 0.878
[2024-01-06 19:44:45,866] {result_logger:113} INFO - 
[2024-01-06 19:44:46,071] {result_logger:116} INFO - average precision on sleep stages: 0.917
[2024-01-06 19:44:46,275] {result_logger:118} INFO - average recall on sleep stages: 0.962
[2024-01-06 19:44:46,481] {result_logger:120} INFO - average F1-score on sleep stages: 0.937
[2024-01-06 19:44:47,038] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.962
[2024-01-06 19:44:47,065] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.962
[2024-01-06 19:44:47,069] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 19:44:47,246] {result_logger:108} INFO - precision on WAKE: 0.880
[2024-01-06 19:44:47,353] {result_logger:109} INFO - recall on WAKE: 0.924
[2024-01-06 19:44:47,461] {result_logger:112} INFO - F1-score on WAKE: 0.902
[2024-01-06 19:44:47,461] {result_logger:113} INFO - 
[2024-01-06 19:44:47,634] {result_logger:108} INFO - precision on NREM: 0.931
[2024-01-06 19:44:47,738] {result_logger:109} INFO - recall on NREM: 0.795
[2024-01-06 19:44:47,842] {result_logger:112} INFO - F1-score on NREM: 0.858
[2024-01-06 19:44:47,842] {result_logger:113} INFO - 
[2024-01-06 19:44:48,014] {result_logger:108} INFO - precision on REM: 0.577
[2024-01-06 19:44:48,117] {result_logger:109} INFO - recall on REM: 0.872
[2024-01-06 19:44:48,222] {result_logger:112} INFO - F1-score on REM: 0.695
[2024-01-06 19:44:48,222] {result_logger:113} INFO - 
[2024-01-06 19:44:48,242] {result_logger:116} INFO - average precision on sleep stages: 0.796
[2024-01-06 19:44:48,261] {result_logger:118} INFO - average recall on sleep stages: 0.864
[2024-01-06 19:44:48,281] {result_logger:120} INFO - average F1-score on sleep stages: 0.818
[2024-01-06 19:44:48,356] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.864
[2024-01-06 19:44:48,359] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.870
[2024-01-06 19:44:48,359] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 19:44:48,970] {result_logger:143} INFO - 
[[320441   9347   2267      0]
 [  3363 229173   6654      0]
 [   323   1105  37243      0]
 [  1921    238     29      0]]
[2024-01-06 19:44:49,590] {result_logger:150} INFO - 
[[ 96.50%   2.81%   0.68%   0.00%]
 [  1.41%  95.81%   2.78%   0.00%]
 [  0.84%   2.86%  96.31%   0.00%]
 [ 87.80%  10.88%   1.33%   0.00%]]
[2024-01-06 19:44:50,208] {result_logger:154} INFO - 
[[ 98.28%   3.90%   4.91%    nan%]
 [  1.03%  95.54%  14.40%    nan%]
 [  0.10%   0.46%  80.62%    nan%]
 [  0.59%   0.10%   0.06%    nan%]]
[2024-01-06 19:44:50,208] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 19:44:50,290] {result_logger:143} INFO - 
[[44661  1817  1841     0]
 [ 5625 27911  1569     0]
 [  444   241  4656     0]
 [  550   143   141     0]]
[2024-01-06 19:44:50,496] {result_logger:150} INFO - 
[[ 92.43%   3.76%   3.81%   0.00%]
 [ 16.02%  79.51%   4.47%   0.00%]
 [  8.31%   4.51%  87.17%   0.00%]
 [ 65.95%  17.15%  16.91%   0.00%]]
[2024-01-06 19:44:50,705] {result_logger:154} INFO - 
[[ 87.09%   6.03%  22.43%    nan%]
 [ 10.97%  92.69%  19.12%    nan%]
 [  0.87%   0.80%  56.73%    nan%]
 [  1.07%   0.47%   1.72%    nan%]]
[2024-01-06 19:44:51,157] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 19:44:51,158] {result_logger:77} INFO - actual:
[2024-01-06 19:44:51,158] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 19:44:51,158] {result_logger:79} INFO - predicted:
[2024-01-06 19:44:51,158] {result_logger:80} INFO - 
[[95.19%  3.08%  1.73%  0.00%]
 [ 4.55% 93.13%  2.32%  0.00%]
 [13.34%  5.96% 80.70%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 19:44:51,195] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it1/model_8conv_2fc-best.pth
[2024-01-06 19:44:51,195] {run_experiment:113} INFO - [epoch  33] execution time: 221.31s	 avg f1-score: 0.8181

[2024-01-06 19:44:51,196] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 19:44:51,257] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 19:45:17,259] {train_model:86} INFO - Train Epoch: 34 [60928/612104 (10%)]	lr:3.99e-05	Loss: 0.092813
[2024-01-06 19:45:43,757] {train_model:86} INFO - Train Epoch: 34 [122112/612104 (20%)]	lr:3.99e-05	Loss: 0.059398
[2024-01-06 19:46:10,248] {train_model:86} INFO - Train Epoch: 34 [183296/612104 (30%)]	lr:3.99e-05	Loss: 0.083201
[2024-01-06 19:46:22,013] {train_model:86} INFO - Train Epoch: 34 [244480/612104 (40%)]	lr:3.99e-05	Loss: 0.085587
[2024-01-06 19:46:33,943] {train_model:86} INFO - Train Epoch: 34 [305664/612104 (50%)]	lr:3.99e-05	Loss: 0.212774
[2024-01-06 19:46:45,742] {train_model:86} INFO - Train Epoch: 34 [366848/612104 (60%)]	lr:3.99e-05	Loss: 0.063384
[2024-01-06 19:47:12,638] {train_model:86} INFO - Train Epoch: 34 [428032/612104 (70%)]	lr:3.99e-05	Loss: 0.055446
[2024-01-06 19:47:38,119] {train_model:86} INFO - Train Epoch: 34 [489216/612104 (80%)]	lr:3.99e-05	Loss: 0.140628
[2024-01-06 19:47:49,688] {train_model:86} INFO - Train Epoch: 34 [550400/612104 (90%)]	lr:3.99e-05	Loss: 0.096169
[2024-01-06 19:48:01,311] {train_model:86} INFO - Train Epoch: 34 [611584/612104 (100%)]	lr:3.99e-05	Loss: 0.105944
[2024-01-06 19:48:14,148] {run_experiment:78} INFO - 
[2024-01-06 19:48:14,154] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 19:48:15,478] {result_logger:108} INFO - precision on WAKE: 0.989
[2024-01-06 19:48:16,329] {result_logger:109} INFO - recall on WAKE: 0.965
[2024-01-06 19:48:17,218] {result_logger:112} INFO - F1-score on WAKE: 0.977
[2024-01-06 19:48:17,219] {result_logger:113} INFO - 
[2024-01-06 19:48:18,577] {result_logger:108} INFO - precision on NREM: 0.957
[2024-01-06 19:48:19,452] {result_logger:109} INFO - recall on NREM: 0.959
[2024-01-06 19:48:20,342] {result_logger:112} INFO - F1-score on NREM: 0.958
[2024-01-06 19:48:20,343] {result_logger:113} INFO - 
[2024-01-06 19:48:21,603] {result_logger:108} INFO - precision on REM: 0.810
[2024-01-06 19:48:22,398] {result_logger:109} INFO - recall on REM: 0.963
[2024-01-06 19:48:23,182] {result_logger:112} INFO - F1-score on REM: 0.880
[2024-01-06 19:48:23,182] {result_logger:113} INFO - 
[2024-01-06 19:48:23,393] {result_logger:116} INFO - average precision on sleep stages: 0.918
[2024-01-06 19:48:23,598] {result_logger:118} INFO - average recall on sleep stages: 0.962
[2024-01-06 19:48:23,802] {result_logger:120} INFO - average F1-score on sleep stages: 0.938
[2024-01-06 19:48:24,382] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.962
[2024-01-06 19:48:24,412] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.963
[2024-01-06 19:48:24,416] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 19:48:24,598] {result_logger:108} INFO - precision on WAKE: 0.900
[2024-01-06 19:48:24,705] {result_logger:109} INFO - recall on WAKE: 0.950
[2024-01-06 19:48:24,814] {result_logger:112} INFO - F1-score on WAKE: 0.925
[2024-01-06 19:48:24,814] {result_logger:113} INFO - 
[2024-01-06 19:48:24,987] {result_logger:108} INFO - precision on NREM: 0.930
[2024-01-06 19:48:25,094] {result_logger:109} INFO - recall on NREM: 0.831
[2024-01-06 19:48:25,203] {result_logger:112} INFO - F1-score on NREM: 0.878
[2024-01-06 19:48:25,203] {result_logger:113} INFO - 
[2024-01-06 19:48:25,378] {result_logger:108} INFO - precision on REM: 0.724
[2024-01-06 19:48:25,483] {result_logger:109} INFO - recall on REM: 0.865
[2024-01-06 19:48:25,591] {result_logger:112} INFO - F1-score on REM: 0.788
[2024-01-06 19:48:25,591] {result_logger:113} INFO - 
[2024-01-06 19:48:25,611] {result_logger:116} INFO - average precision on sleep stages: 0.851
[2024-01-06 19:48:25,631] {result_logger:118} INFO - average recall on sleep stages: 0.882
[2024-01-06 19:48:25,651] {result_logger:120} INFO - average F1-score on sleep stages: 0.864
[2024-01-06 19:48:25,729] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.882
[2024-01-06 19:48:25,732] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.898
[2024-01-06 19:48:25,733] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 19:48:26,350] {result_logger:143} INFO - 
[[320529   9283   2243      0]
 [  3355 229315   6520      0]
 [   334   1098  37239      0]
 [  1916    235     37      0]]
[2024-01-06 19:48:26,975] {result_logger:150} INFO - 
[[ 96.53%   2.80%   0.68%   0.00%]
 [  1.40%  95.87%   2.73%   0.00%]
 [  0.86%   2.84%  96.30%   0.00%]
 [ 87.57%  10.74%   1.69%   0.00%]]
[2024-01-06 19:48:27,608] {result_logger:154} INFO - 
[[ 98.28%   3.87%   4.87%    nan%]
 [  1.03%  95.58%  14.16%    nan%]
 [  0.10%   0.46%  80.89%    nan%]
 [  0.59%   0.10%   0.08%    nan%]]
[2024-01-06 19:48:27,609] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 19:48:27,693] {result_logger:143} INFO - 
[[45924  1955   440     0]
 [ 4614 29169  1322     0]
 [  471   249  4621     0]
 [  655   150    29     0]]
[2024-01-06 19:48:27,903] {result_logger:150} INFO - 
[[ 95.04%   4.05%   0.91%   0.00%]
 [ 13.14%  83.09%   3.77%   0.00%]
 [  8.82%   4.66%  86.52%   0.00%]
 [ 78.54%  17.99%   3.48%   0.00%]]
[2024-01-06 19:48:28,115] {result_logger:154} INFO - 
[[ 88.89%   6.20%   6.86%    nan%]
 [  8.93%  92.53%  20.62%    nan%]
 [  0.91%   0.79%  72.07%    nan%]
 [  1.27%   0.48%   0.45%    nan%]]
[2024-01-06 19:48:28,558] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 19:48:28,558] {result_logger:77} INFO - actual:
[2024-01-06 19:48:28,558] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 19:48:28,559] {result_logger:79} INFO - predicted:
[2024-01-06 19:48:28,559] {result_logger:80} INFO - 
[[95.46%  3.76%  0.77%  0.00%]
 [ 5.37% 92.88%  1.74%  0.00%]
 [10.15%  4.66% 85.18%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 19:48:28,596] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it1/model_8conv_2fc-best.pth
[2024-01-06 19:48:28,596] {run_experiment:113} INFO - [epoch  34] execution time: 217.40s	 avg f1-score: 0.8635

[2024-01-06 19:48:28,596] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 19:48:28,655] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 19:48:54,843] {train_model:86} INFO - Train Epoch: 35 [60928/612104 (10%)]	lr:3.75e-05	Loss: 0.267982
[2024-01-06 19:49:22,281] {train_model:86} INFO - Train Epoch: 35 [122112/612104 (20%)]	lr:3.75e-05	Loss: 0.106568
[2024-01-06 19:49:47,826] {train_model:86} INFO - Train Epoch: 35 [183296/612104 (30%)]	lr:3.75e-05	Loss: 0.143336
[2024-01-06 19:49:59,961] {train_model:86} INFO - Train Epoch: 35 [244480/612104 (40%)]	lr:3.75e-05	Loss: 0.048165
[2024-01-06 19:50:11,518] {train_model:86} INFO - Train Epoch: 35 [305664/612104 (50%)]	lr:3.75e-05	Loss: 0.048687
[2024-01-06 19:50:23,347] {train_model:86} INFO - Train Epoch: 35 [366848/612104 (60%)]	lr:3.75e-05	Loss: 0.044966
[2024-01-06 19:50:35,332] {train_model:86} INFO - Train Epoch: 35 [428032/612104 (70%)]	lr:3.75e-05	Loss: 0.056375
[2024-01-06 19:51:02,450] {train_model:86} INFO - Train Epoch: 35 [489216/612104 (80%)]	lr:3.75e-05	Loss: 0.068189
[2024-01-06 19:51:28,424] {train_model:86} INFO - Train Epoch: 35 [550400/612104 (90%)]	lr:3.75e-05	Loss: 0.028908
[2024-01-06 19:51:40,694] {train_model:86} INFO - Train Epoch: 35 [611584/612104 (100%)]	lr:3.75e-05	Loss: 0.063967
[2024-01-06 19:51:53,485] {run_experiment:78} INFO - 
[2024-01-06 19:51:53,492] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 19:51:54,872] {result_logger:108} INFO - precision on WAKE: 0.989
[2024-01-06 19:51:55,749] {result_logger:109} INFO - recall on WAKE: 0.966
[2024-01-06 19:51:56,636] {result_logger:112} INFO - F1-score on WAKE: 0.977
[2024-01-06 19:51:56,636] {result_logger:113} INFO - 
[2024-01-06 19:51:57,946] {result_logger:108} INFO - precision on NREM: 0.957
[2024-01-06 19:51:58,802] {result_logger:109} INFO - recall on NREM: 0.959
[2024-01-06 19:51:59,694] {result_logger:112} INFO - F1-score on NREM: 0.958
[2024-01-06 19:51:59,694] {result_logger:113} INFO - 
[2024-01-06 19:52:00,973] {result_logger:108} INFO - precision on REM: 0.812
[2024-01-06 19:52:01,762] {result_logger:109} INFO - recall on REM: 0.964
[2024-01-06 19:52:02,531] {result_logger:112} INFO - F1-score on REM: 0.882
[2024-01-06 19:52:02,532] {result_logger:113} INFO - 
[2024-01-06 19:52:02,741] {result_logger:116} INFO - average precision on sleep stages: 0.919
[2024-01-06 19:52:02,948] {result_logger:118} INFO - average recall on sleep stages: 0.963
[2024-01-06 19:52:03,152] {result_logger:120} INFO - average F1-score on sleep stages: 0.939
[2024-01-06 19:52:03,729] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.963
[2024-01-06 19:52:03,758] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.963
[2024-01-06 19:52:03,763] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 19:52:03,934] {result_logger:108} INFO - precision on WAKE: 0.911
[2024-01-06 19:52:04,041] {result_logger:109} INFO - recall on WAKE: 0.929
[2024-01-06 19:52:04,147] {result_logger:112} INFO - F1-score on WAKE: 0.920
[2024-01-06 19:52:04,147] {result_logger:113} INFO - 
[2024-01-06 19:52:04,325] {result_logger:108} INFO - precision on NREM: 0.902
[2024-01-06 19:52:04,436] {result_logger:109} INFO - recall on NREM: 0.833
[2024-01-06 19:52:04,545] {result_logger:112} INFO - F1-score on NREM: 0.866
[2024-01-06 19:52:04,546] {result_logger:113} INFO - 
[2024-01-06 19:52:04,721] {result_logger:108} INFO - precision on REM: 0.665
[2024-01-06 19:52:04,832] {result_logger:109} INFO - recall on REM: 0.881
[2024-01-06 19:52:04,937] {result_logger:112} INFO - F1-score on REM: 0.758
[2024-01-06 19:52:04,937] {result_logger:113} INFO - 
[2024-01-06 19:52:04,957] {result_logger:116} INFO - average precision on sleep stages: 0.826
[2024-01-06 19:52:04,977] {result_logger:118} INFO - average recall on sleep stages: 0.881
[2024-01-06 19:52:04,996] {result_logger:120} INFO - average F1-score on sleep stages: 0.848
[2024-01-06 19:52:05,073] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.881
[2024-01-06 19:52:05,076] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.888
[2024-01-06 19:52:05,076] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 19:52:05,713] {result_logger:143} INFO - 
[[320690   9212   2153      0]
 [  3322 229403   6465      0]
 [   305   1069  37297      0]
 [  1931    228     29      0]]
[2024-01-06 19:52:06,348] {result_logger:150} INFO - 
[[ 96.58%   2.77%   0.65%   0.00%]
 [  1.39%  95.91%   2.70%   0.00%]
 [  0.79%   2.76%  96.45%   0.00%]
 [ 88.25%  10.42%   1.33%   0.00%]]
[2024-01-06 19:52:06,979] {result_logger:154} INFO - 
[[ 98.30%   3.84%   4.69%    nan%]
 [  1.02%  95.62%  14.07%    nan%]
 [  0.09%   0.45%  81.18%    nan%]
 [  0.59%   0.10%   0.06%    nan%]]
[2024-01-06 19:52:06,979] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 19:52:07,060] {result_logger:143} INFO - 
[[44901  2898   520     0]
 [ 4020 29237  1848     0]
 [  342   292  4707     0]
 [  488   313    33     0]]
[2024-01-06 19:52:07,263] {result_logger:150} INFO - 
[[ 92.93%   6.00%   1.08%   0.00%]
 [ 11.45%  83.28%   5.26%   0.00%]
 [  6.40%   5.47%  88.13%   0.00%]
 [ 58.51%  37.53%   3.96%   0.00%]]
[2024-01-06 19:52:07,465] {result_logger:154} INFO - 
[[ 90.25%   8.85%   7.32%    nan%]
 [  8.08%  89.30%  26.00%    nan%]
 [  0.69%   0.89%  66.22%    nan%]
 [  0.98%   0.96%   0.46%    nan%]]
[2024-01-06 19:52:07,992] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 19:52:07,992] {result_logger:77} INFO - actual:
[2024-01-06 19:52:07,993] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 19:52:07,993] {result_logger:79} INFO - predicted:
[2024-01-06 19:52:07,993] {result_logger:80} INFO - 
[[95.03%  4.10%  0.87%  0.00%]
 [ 5.36% 92.25%  2.39%  0.00%]
 [10.09%  7.01% 82.91%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 19:52:08,029] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it1/model_8conv_2fc-best.pth
[2024-01-06 19:52:08,029] {run_experiment:113} INFO - [epoch  35] execution time: 219.43s	 avg f1-score: 0.8481

[2024-01-06 19:52:08,029] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 19:52:08,089] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 19:52:34,238] {train_model:86} INFO - Train Epoch: 36 [60928/612104 (10%)]	lr:3.53e-05	Loss: 0.128729
[2024-01-06 19:53:01,302] {train_model:86} INFO - Train Epoch: 36 [122112/612104 (20%)]	lr:3.53e-05	Loss: 0.180444
[2024-01-06 19:53:27,184] {train_model:86} INFO - Train Epoch: 36 [183296/612104 (30%)]	lr:3.53e-05	Loss: 0.078126
[2024-01-06 19:53:38,861] {train_model:86} INFO - Train Epoch: 36 [244480/612104 (40%)]	lr:3.53e-05	Loss: 0.054377
[2024-01-06 19:53:50,476] {train_model:86} INFO - Train Epoch: 36 [305664/612104 (50%)]	lr:3.53e-05	Loss: 0.073767
[2024-01-06 19:54:02,165] {train_model:86} INFO - Train Epoch: 36 [366848/612104 (60%)]	lr:3.53e-05	Loss: 0.128456
[2024-01-06 19:54:14,073] {train_model:86} INFO - Train Epoch: 36 [428032/612104 (70%)]	lr:3.53e-05	Loss: 0.053988
[2024-01-06 19:54:41,004] {train_model:86} INFO - Train Epoch: 36 [489216/612104 (80%)]	lr:3.53e-05	Loss: 0.053429
[2024-01-06 19:55:06,778] {train_model:86} INFO - Train Epoch: 36 [550400/612104 (90%)]	lr:3.53e-05	Loss: 0.036183
[2024-01-06 19:55:19,038] {train_model:86} INFO - Train Epoch: 36 [611584/612104 (100%)]	lr:3.53e-05	Loss: 0.042939
[2024-01-06 19:55:31,877] {run_experiment:78} INFO - 
[2024-01-06 19:55:31,884] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 19:55:33,242] {result_logger:108} INFO - precision on WAKE: 0.989
[2024-01-06 19:55:34,132] {result_logger:109} INFO - recall on WAKE: 0.966
[2024-01-06 19:55:35,021] {result_logger:112} INFO - F1-score on WAKE: 0.977
[2024-01-06 19:55:35,021] {result_logger:113} INFO - 
[2024-01-06 19:55:36,351] {result_logger:108} INFO - precision on NREM: 0.957
[2024-01-06 19:55:37,251] {result_logger:109} INFO - recall on NREM: 0.959
[2024-01-06 19:55:38,148] {result_logger:112} INFO - F1-score on NREM: 0.958
[2024-01-06 19:55:38,148] {result_logger:113} INFO - 
[2024-01-06 19:55:39,435] {result_logger:108} INFO - precision on REM: 0.813
[2024-01-06 19:55:40,220] {result_logger:109} INFO - recall on REM: 0.964
[2024-01-06 19:55:41,000] {result_logger:112} INFO - F1-score on REM: 0.882
[2024-01-06 19:55:41,000] {result_logger:113} INFO - 
[2024-01-06 19:55:41,208] {result_logger:116} INFO - average precision on sleep stages: 0.919
[2024-01-06 19:55:41,412] {result_logger:118} INFO - average recall on sleep stages: 0.963
[2024-01-06 19:55:41,617] {result_logger:120} INFO - average F1-score on sleep stages: 0.939
[2024-01-06 19:55:42,195] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.963
[2024-01-06 19:55:42,223] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.963
[2024-01-06 19:55:42,226] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 19:55:42,400] {result_logger:108} INFO - precision on WAKE: 0.883
[2024-01-06 19:55:42,509] {result_logger:109} INFO - recall on WAKE: 0.922
[2024-01-06 19:55:42,620] {result_logger:112} INFO - F1-score on WAKE: 0.902
[2024-01-06 19:55:42,620] {result_logger:113} INFO - 
[2024-01-06 19:55:42,797] {result_logger:108} INFO - precision on NREM: 0.929
[2024-01-06 19:55:42,907] {result_logger:109} INFO - recall on NREM: 0.792
[2024-01-06 19:55:43,018] {result_logger:112} INFO - F1-score on NREM: 0.855
[2024-01-06 19:55:43,018] {result_logger:113} INFO - 
[2024-01-06 19:55:43,196] {result_logger:108} INFO - precision on REM: 0.559
[2024-01-06 19:55:43,306] {result_logger:109} INFO - recall on REM: 0.878
[2024-01-06 19:55:43,416] {result_logger:112} INFO - F1-score on REM: 0.683
[2024-01-06 19:55:43,416] {result_logger:113} INFO - 
[2024-01-06 19:55:43,436] {result_logger:116} INFO - average precision on sleep stages: 0.790
[2024-01-06 19:55:43,457] {result_logger:118} INFO - average recall on sleep stages: 0.864
[2024-01-06 19:55:43,477] {result_logger:120} INFO - average F1-score on sleep stages: 0.813
[2024-01-06 19:55:43,559] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.864
[2024-01-06 19:55:43,562] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.868
[2024-01-06 19:55:43,563] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 19:55:44,180] {result_logger:143} INFO - 
[[320668   9251   2135      1]
 [  3385 229360   6445      0]
 [   273   1118  37280      0]
 [  1922    232     34      0]]
[2024-01-06 19:55:44,796] {result_logger:150} INFO - 
[[ 96.57%   2.79%   0.64%   0.00%]
 [  1.42%  95.89%   2.69%   0.00%]
 [  0.71%   2.89%  96.40%   0.00%]
 [ 87.84%  10.60%   1.55%   0.00%]]
[2024-01-06 19:55:45,404] {result_logger:154} INFO - 
[[ 98.29%   3.86%   4.65% 100.00%]
 [  1.04%  95.58%  14.04%   0.00%]
 [  0.08%   0.47%  81.23%   0.00%]
 [  0.59%   0.10%   0.07%   0.00%]]
[2024-01-06 19:55:45,404] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 19:55:45,483] {result_logger:143} INFO - 
[[44551  1962  1806     0]
 [ 5406 27800  1899     0]
 [  486   164  4691     0]
 [  537   167   130     0]]
[2024-01-06 19:55:45,692] {result_logger:150} INFO - 
[[ 92.20%   4.06%   3.74%   0.00%]
 [ 15.40%  79.19%   5.41%   0.00%]
 [  9.10%   3.07%  87.83%   0.00%]
 [ 64.39%  20.02%  15.59%   0.00%]]
[2024-01-06 19:55:45,903] {result_logger:154} INFO - 
[[ 87.39%   6.52%  21.18%    nan%]
 [ 10.60%  92.38%  22.27%    nan%]
 [  0.95%   0.54%  55.02%    nan%]
 [  1.05%   0.55%   1.52%    nan%]]
[2024-01-06 19:55:46,342] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 19:55:46,342] {result_logger:77} INFO - actual:
[2024-01-06 19:55:46,342] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 19:55:46,342] {result_logger:79} INFO - predicted:
[2024-01-06 19:55:46,342] {result_logger:80} INFO - 
[[94.87%  3.38%  1.75%  0.00%]
 [ 4.94% 92.32%  2.74%  0.00%]
 [13.23%  6.90% 79.87%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 19:55:46,383] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it1/model_8conv_2fc-best.pth
[2024-01-06 19:55:46,383] {run_experiment:113} INFO - [epoch  36] execution time: 218.35s	 avg f1-score: 0.8134

[2024-01-06 19:55:46,384] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 19:55:46,444] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 19:56:27,639] {train_model:86} INFO - Train Epoch: 37 [60928/612104 (10%)]	lr:3.33e-05	Loss: 0.077123
[2024-01-06 19:56:54,010] {train_model:86} INFO - Train Epoch: 37 [122112/612104 (20%)]	lr:3.33e-05	Loss: 0.064406
[2024-01-06 19:57:05,544] {train_model:86} INFO - Train Epoch: 37 [183296/612104 (30%)]	lr:3.33e-05	Loss: 0.064615
[2024-01-06 19:57:17,496] {train_model:86} INFO - Train Epoch: 37 [244480/612104 (40%)]	lr:3.33e-05	Loss: 0.079640
[2024-01-06 19:57:29,226] {train_model:86} INFO - Train Epoch: 37 [305664/612104 (50%)]	lr:3.33e-05	Loss: 0.225461
[2024-01-06 19:57:40,988] {train_model:86} INFO - Train Epoch: 37 [366848/612104 (60%)]	lr:3.33e-05	Loss: 0.065104
[2024-01-06 19:57:52,523] {train_model:86} INFO - Train Epoch: 37 [428032/612104 (70%)]	lr:3.33e-05	Loss: 0.084313
[2024-01-06 19:58:04,112] {train_model:86} INFO - Train Epoch: 37 [489216/612104 (80%)]	lr:3.33e-05	Loss: 0.123314
[2024-01-06 19:58:31,293] {train_model:86} INFO - Train Epoch: 37 [550400/612104 (90%)]	lr:3.33e-05	Loss: 0.069050
[2024-01-06 19:58:57,141] {train_model:86} INFO - Train Epoch: 37 [611584/612104 (100%)]	lr:3.33e-05	Loss: 0.101173
[2024-01-06 19:59:09,789] {run_experiment:78} INFO - 
[2024-01-06 19:59:09,796] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 19:59:11,172] {result_logger:108} INFO - precision on WAKE: 0.988
[2024-01-06 19:59:12,052] {result_logger:109} INFO - recall on WAKE: 0.966
[2024-01-06 19:59:12,939] {result_logger:112} INFO - F1-score on WAKE: 0.977
[2024-01-06 19:59:12,940] {result_logger:113} INFO - 
[2024-01-06 19:59:14,275] {result_logger:108} INFO - precision on NREM: 0.957
[2024-01-06 19:59:15,147] {result_logger:109} INFO - recall on NREM: 0.959
[2024-01-06 19:59:16,030] {result_logger:112} INFO - F1-score on NREM: 0.958
[2024-01-06 19:59:16,030] {result_logger:113} INFO - 
[2024-01-06 19:59:17,322] {result_logger:108} INFO - precision on REM: 0.819
[2024-01-06 19:59:18,117] {result_logger:109} INFO - recall on REM: 0.966
[2024-01-06 19:59:18,893] {result_logger:112} INFO - F1-score on REM: 0.886
[2024-01-06 19:59:18,894] {result_logger:113} INFO - 
[2024-01-06 19:59:19,091] {result_logger:116} INFO - average precision on sleep stages: 0.921
[2024-01-06 19:59:19,286] {result_logger:118} INFO - average recall on sleep stages: 0.964
[2024-01-06 19:59:19,485] {result_logger:120} INFO - average F1-score on sleep stages: 0.941
[2024-01-06 19:59:20,042] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.964
[2024-01-06 19:59:20,069] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.964
[2024-01-06 19:59:20,073] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 19:59:20,246] {result_logger:108} INFO - precision on WAKE: 0.868
[2024-01-06 19:59:20,349] {result_logger:109} INFO - recall on WAKE: 0.757
[2024-01-06 19:59:20,453] {result_logger:112} INFO - F1-score on WAKE: 0.809
[2024-01-06 19:59:20,454] {result_logger:113} INFO - 
[2024-01-06 19:59:20,626] {result_logger:108} INFO - precision on NREM: 0.911
[2024-01-06 19:59:20,732] {result_logger:109} INFO - recall on NREM: 0.790
[2024-01-06 19:59:20,837] {result_logger:112} INFO - F1-score on NREM: 0.846
[2024-01-06 19:59:20,837] {result_logger:113} INFO - 
[2024-01-06 19:59:21,014] {result_logger:108} INFO - precision on REM: 0.275
[2024-01-06 19:59:21,120] {result_logger:109} INFO - recall on REM: 0.834
[2024-01-06 19:59:21,226] {result_logger:112} INFO - F1-score on REM: 0.414
[2024-01-06 19:59:21,226] {result_logger:113} INFO - 
[2024-01-06 19:59:21,245] {result_logger:116} INFO - average precision on sleep stages: 0.685
[2024-01-06 19:59:21,265] {result_logger:118} INFO - average recall on sleep stages: 0.794
[2024-01-06 19:59:21,285] {result_logger:120} INFO - average F1-score on sleep stages: 0.690
[2024-01-06 19:59:21,364] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.794
[2024-01-06 19:59:21,367] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.775
[2024-01-06 19:59:21,368] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 19:59:21,998] {result_logger:143} INFO - 
[[320827   9212   2016      0]
 [  3428 229498   6264      0]
 [   306   1018  37347      0]
 [  1925    226     36      1]]
[2024-01-06 19:59:22,619] {result_logger:150} INFO - 
[[ 96.62%   2.77%   0.61%   0.00%]
 [  1.43%  95.95%   2.62%   0.00%]
 [  0.79%   2.63%  96.58%   0.00%]
 [ 87.98%  10.33%   1.65%   0.05%]]
[2024-01-06 19:59:23,243] {result_logger:154} INFO - 
[[ 98.27%   3.84%   4.41%   0.00%]
 [  1.05%  95.64%  13.72%   0.00%]
 [  0.09%   0.42%  81.79%   0.00%]
 [  0.59%   0.09%   0.08% 100.00%]]
[2024-01-06 19:59:23,243] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 19:59:23,327] {result_logger:143} INFO - 
[[36563  2089  9667     0]
 [ 5309 27749  2047     0]
 [  249   638  4454     0]
 [  211   108   515     0]]
[2024-01-06 19:59:23,538] {result_logger:150} INFO - 
[[ 75.67%   4.32%  20.01%   0.00%]
 [ 15.12%  79.05%   5.83%   0.00%]
 [  4.66%  11.95%  83.39%   0.00%]
 [ 25.30%  12.95%  61.75%   0.00%]]
[2024-01-06 19:59:23,752] {result_logger:154} INFO - 
[[ 86.37%   6.83%  57.95%    nan%]
 [ 12.54%  90.73%  12.27%    nan%]
 [  0.59%   2.09%  26.70%    nan%]
 [  0.50%   0.35%   3.09%    nan%]]
[2024-01-06 19:59:24,182] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 19:59:24,182] {result_logger:77} INFO - actual:
[2024-01-06 19:59:24,182] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 19:59:24,182] {result_logger:79} INFO - predicted:
[2024-01-06 19:59:24,183] {result_logger:80} INFO - 
[[94.36%  2.74%  2.90%  0.00%]
 [ 3.35% 93.38%  3.27%  0.00%]
 [ 8.16%  5.18% 86.66%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 19:59:24,220] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it1/model_8conv_2fc-best.pth
[2024-01-06 19:59:24,220] {run_experiment:113} INFO - [epoch  37] execution time: 217.84s	 avg f1-score: 0.6897

[2024-01-06 19:59:24,221] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 19:59:24,280] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 20:00:06,019] {train_model:86} INFO - Train Epoch: 38 [60928/612104 (10%)]	lr:3.13e-05	Loss: 0.060783
[2024-01-06 20:00:31,688] {train_model:86} INFO - Train Epoch: 38 [122112/612104 (20%)]	lr:3.13e-05	Loss: 0.084849
[2024-01-06 20:00:43,106] {train_model:86} INFO - Train Epoch: 38 [183296/612104 (30%)]	lr:3.13e-05	Loss: 0.075057
[2024-01-06 20:00:54,526] {train_model:86} INFO - Train Epoch: 38 [244480/612104 (40%)]	lr:3.13e-05	Loss: 0.143064
[2024-01-06 20:01:06,137] {train_model:86} INFO - Train Epoch: 38 [305664/612104 (50%)]	lr:3.13e-05	Loss: 0.093788
[2024-01-06 20:01:18,191] {train_model:86} INFO - Train Epoch: 38 [366848/612104 (60%)]	lr:3.13e-05	Loss: 0.113811
[2024-01-06 20:01:29,763] {train_model:86} INFO - Train Epoch: 38 [428032/612104 (70%)]	lr:3.13e-05	Loss: 0.024256
[2024-01-06 20:01:41,573] {train_model:86} INFO - Train Epoch: 38 [489216/612104 (80%)]	lr:3.13e-05	Loss: 0.082083
[2024-01-06 20:01:53,433] {train_model:86} INFO - Train Epoch: 38 [550400/612104 (90%)]	lr:3.13e-05	Loss: 0.074598
[2024-01-06 20:02:20,787] {train_model:86} INFO - Train Epoch: 38 [611584/612104 (100%)]	lr:3.13e-05	Loss: 0.118956
[2024-01-06 20:02:33,208] {run_experiment:78} INFO - 
[2024-01-06 20:02:33,215] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 20:02:34,549] {result_logger:108} INFO - precision on WAKE: 0.989
[2024-01-06 20:02:35,442] {result_logger:109} INFO - recall on WAKE: 0.966
[2024-01-06 20:02:36,333] {result_logger:112} INFO - F1-score on WAKE: 0.977
[2024-01-06 20:02:36,333] {result_logger:113} INFO - 
[2024-01-06 20:02:37,606] {result_logger:108} INFO - precision on NREM: 0.957
[2024-01-06 20:02:38,471] {result_logger:109} INFO - recall on NREM: 0.959
[2024-01-06 20:02:39,347] {result_logger:112} INFO - F1-score on NREM: 0.958
[2024-01-06 20:02:39,347] {result_logger:113} INFO - 
[2024-01-06 20:02:40,612] {result_logger:108} INFO - precision on REM: 0.815
[2024-01-06 20:02:41,418] {result_logger:109} INFO - recall on REM: 0.964
[2024-01-06 20:02:42,203] {result_logger:112} INFO - F1-score on REM: 0.884
[2024-01-06 20:02:42,203] {result_logger:113} INFO - 
[2024-01-06 20:02:42,411] {result_logger:116} INFO - average precision on sleep stages: 0.920
[2024-01-06 20:02:42,622] {result_logger:118} INFO - average recall on sleep stages: 0.963
[2024-01-06 20:02:42,832] {result_logger:120} INFO - average F1-score on sleep stages: 0.940
[2024-01-06 20:02:43,408] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.963
[2024-01-06 20:02:43,437] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.963
[2024-01-06 20:02:43,443] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 20:02:43,619] {result_logger:108} INFO - precision on WAKE: 0.879
[2024-01-06 20:02:43,727] {result_logger:109} INFO - recall on WAKE: 0.950
[2024-01-06 20:02:43,835] {result_logger:112} INFO - F1-score on WAKE: 0.913
[2024-01-06 20:02:43,835] {result_logger:113} INFO - 
[2024-01-06 20:02:44,015] {result_logger:108} INFO - precision on NREM: 0.907
[2024-01-06 20:02:44,123] {result_logger:109} INFO - recall on NREM: 0.795
[2024-01-06 20:02:44,227] {result_logger:112} INFO - F1-score on NREM: 0.847
[2024-01-06 20:02:44,227] {result_logger:113} INFO - 
[2024-01-06 20:02:44,396] {result_logger:108} INFO - precision on REM: 0.707
[2024-01-06 20:02:44,499] {result_logger:109} INFO - recall on REM: 0.769
[2024-01-06 20:02:44,603] {result_logger:112} INFO - F1-score on REM: 0.736
[2024-01-06 20:02:44,603] {result_logger:113} INFO - 
[2024-01-06 20:02:44,622] {result_logger:116} INFO - average precision on sleep stages: 0.831
[2024-01-06 20:02:44,642] {result_logger:118} INFO - average recall on sleep stages: 0.838
[2024-01-06 20:02:44,661] {result_logger:120} INFO - average F1-score on sleep stages: 0.832
[2024-01-06 20:02:44,739] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.838
[2024-01-06 20:02:44,742] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.878
[2024-01-06 20:02:44,743] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 20:02:45,349] {result_logger:143} INFO - 
[[320755   9201   2099      0]
 [  3344 229500   6346      0]
 [   300   1081  37290      0]
 [  1925    233     30      0]]
[2024-01-06 20:02:45,969] {result_logger:150} INFO - 
[[ 96.60%   2.77%   0.63%   0.00%]
 [  1.40%  95.95%   2.65%   0.00%]
 [  0.78%   2.80%  96.43%   0.00%]
 [ 87.98%  10.65%   1.37%   0.00%]]
[2024-01-06 20:02:46,571] {result_logger:154} INFO - 
[[ 98.29%   3.83%   4.59%    nan%]
 [  1.02%  95.62%  13.87%    nan%]
 [  0.09%   0.45%  81.48%    nan%]
 [  0.59%   0.10%   0.07%    nan%]]
[2024-01-06 20:02:46,571] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 20:02:46,655] {result_logger:143} INFO - 
[[45894  2301   124     0]
 [ 5628 27897  1580     0]
 [  678   558  4105     0]
 [  588   235    11     0]]
[2024-01-06 20:02:46,863] {result_logger:150} INFO - 
[[ 94.98%   4.76%   0.26%   0.00%]
 [ 16.03%  79.47%   4.50%   0.00%]
 [ 12.69%  10.45%  76.86%   0.00%]
 [ 70.50%  28.18%   1.32%   0.00%]]
[2024-01-06 20:02:47,051] {result_logger:154} INFO - 
[[ 86.94%   7.42%   2.13%    nan%]
 [ 10.66%  90.02%  27.15%    nan%]
 [  1.28%   1.80%  70.53%    nan%]
 [  1.11%   0.76%   0.19%    nan%]]
[2024-01-06 20:02:47,477] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 20:02:47,478] {result_logger:77} INFO - actual:
[2024-01-06 20:02:47,478] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 20:02:47,478] {result_logger:79} INFO - predicted:
[2024-01-06 20:02:47,478] {result_logger:80} INFO - 
[[95.44%  3.86%  0.70%  0.00%]
 [ 5.81% 92.28%  1.91%  0.00%]
 [10.43%  6.07% 83.51%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 20:02:47,514] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it1/model_8conv_2fc-best.pth
[2024-01-06 20:02:47,514] {run_experiment:113} INFO - [epoch  38] execution time: 203.29s	 avg f1-score: 0.8322

[2024-01-06 20:02:47,514] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 20:02:47,573] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 20:03:29,641] {train_model:86} INFO - Train Epoch: 39 [60928/612104 (10%)]	lr:2.95e-05	Loss: 0.047336
[2024-01-06 20:03:55,439] {train_model:86} INFO - Train Epoch: 39 [122112/612104 (20%)]	lr:2.95e-05	Loss: 0.062541
[2024-01-06 20:04:07,578] {train_model:86} INFO - Train Epoch: 39 [183296/612104 (30%)]	lr:2.95e-05	Loss: 0.072451
[2024-01-06 20:04:20,247] {train_model:86} INFO - Train Epoch: 39 [244480/612104 (40%)]	lr:2.95e-05	Loss: 0.078231
[2024-01-06 20:04:32,367] {train_model:86} INFO - Train Epoch: 39 [305664/612104 (50%)]	lr:2.95e-05	Loss: 0.083619
[2024-01-06 20:04:44,098] {train_model:86} INFO - Train Epoch: 39 [366848/612104 (60%)]	lr:2.95e-05	Loss: 0.154012
[2024-01-06 20:04:55,908] {train_model:86} INFO - Train Epoch: 39 [428032/612104 (70%)]	lr:2.95e-05	Loss: 0.148731
[2024-01-06 20:05:07,815] {train_model:86} INFO - Train Epoch: 39 [489216/612104 (80%)]	lr:2.95e-05	Loss: 0.053484
[2024-01-06 20:05:20,238] {train_model:86} INFO - Train Epoch: 39 [550400/612104 (90%)]	lr:2.95e-05	Loss: 0.075965
[2024-01-06 20:05:47,883] {train_model:86} INFO - Train Epoch: 39 [611584/612104 (100%)]	lr:2.95e-05	Loss: 0.076403
[2024-01-06 20:06:00,043] {run_experiment:78} INFO - 
[2024-01-06 20:06:00,049] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 20:06:01,340] {result_logger:108} INFO - precision on WAKE: 0.989
[2024-01-06 20:06:02,210] {result_logger:109} INFO - recall on WAKE: 0.966
[2024-01-06 20:06:03,114] {result_logger:112} INFO - F1-score on WAKE: 0.977
[2024-01-06 20:06:03,114] {result_logger:113} INFO - 
[2024-01-06 20:06:04,492] {result_logger:108} INFO - precision on NREM: 0.957
[2024-01-06 20:06:05,350] {result_logger:109} INFO - recall on NREM: 0.961
[2024-01-06 20:06:06,256] {result_logger:112} INFO - F1-score on NREM: 0.959
[2024-01-06 20:06:06,256] {result_logger:113} INFO - 
[2024-01-06 20:06:07,493] {result_logger:108} INFO - precision on REM: 0.821
[2024-01-06 20:06:08,294] {result_logger:109} INFO - recall on REM: 0.966
[2024-01-06 20:06:09,082] {result_logger:112} INFO - F1-score on REM: 0.888
[2024-01-06 20:06:09,082] {result_logger:113} INFO - 
[2024-01-06 20:06:09,283] {result_logger:116} INFO - average precision on sleep stages: 0.922
[2024-01-06 20:06:09,485] {result_logger:118} INFO - average recall on sleep stages: 0.964
[2024-01-06 20:06:09,690] {result_logger:120} INFO - average F1-score on sleep stages: 0.941
[2024-01-06 20:06:10,282] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.964
[2024-01-06 20:06:10,311] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.964
[2024-01-06 20:06:10,315] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 20:06:10,492] {result_logger:108} INFO - precision on WAKE: 0.905
[2024-01-06 20:06:10,604] {result_logger:109} INFO - recall on WAKE: 0.922
[2024-01-06 20:06:10,715] {result_logger:112} INFO - F1-score on WAKE: 0.913
[2024-01-06 20:06:10,715] {result_logger:113} INFO - 
[2024-01-06 20:06:10,894] {result_logger:108} INFO - precision on NREM: 0.917
[2024-01-06 20:06:11,005] {result_logger:109} INFO - recall on NREM: 0.822
[2024-01-06 20:06:11,117] {result_logger:112} INFO - F1-score on NREM: 0.867
[2024-01-06 20:06:11,117] {result_logger:113} INFO - 
[2024-01-06 20:06:11,298] {result_logger:108} INFO - precision on REM: 0.596
[2024-01-06 20:06:11,408] {result_logger:109} INFO - recall on REM: 0.898
[2024-01-06 20:06:11,519] {result_logger:112} INFO - F1-score on REM: 0.716
[2024-01-06 20:06:11,520] {result_logger:113} INFO - 
[2024-01-06 20:06:11,540] {result_logger:116} INFO - average precision on sleep stages: 0.806
[2024-01-06 20:06:11,561] {result_logger:118} INFO - average recall on sleep stages: 0.881
[2024-01-06 20:06:11,582] {result_logger:120} INFO - average F1-score on sleep stages: 0.832
[2024-01-06 20:06:11,663] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.881
[2024-01-06 20:06:11,666] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.881
[2024-01-06 20:06:11,667] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 20:06:12,313] {result_logger:143} INFO - 
[[320807   9245   2003      0]
 [  3308 229742   6139      1]
 [   306    998  37367      0]
 [  1929    231     28      0]]
[2024-01-06 20:06:12,966] {result_logger:150} INFO - 
[[ 96.61%   2.78%   0.60%   0.00%]
 [  1.38%  96.05%   2.57%   0.00%]
 [  0.79%   2.58%  96.63%   0.00%]
 [ 88.16%  10.56%   1.28%   0.00%]]
[2024-01-06 20:06:13,604] {result_logger:154} INFO - 
[[ 98.30%   3.85%   4.40%   0.00%]
 [  1.01%  95.64%  13.48% 100.00%]
 [  0.09%   0.42%  82.06%   0.00%]
 [  0.59%   0.10%   0.06%   0.00%]]
[2024-01-06 20:06:13,604] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 20:06:13,689] {result_logger:143} INFO - 
[[44554  2313  1452     0]
 [ 4434 28865  1806     0]
 [  242   302  4797     0]
 [  553   188    93     0]]
[2024-01-06 20:06:13,946] {result_logger:150} INFO - 
[[ 92.21%   4.79%   3.01%   0.00%]
 [ 12.63%  82.22%   5.14%   0.00%]
 [  4.53%   5.65%  89.81%   0.00%]
 [ 66.31%  22.54%  11.15%   0.00%]]
[2024-01-06 20:06:14,289] {result_logger:154} INFO - 
[[ 89.50%   7.30%  17.82%    nan%]
 [  8.91%  91.15%  22.16%    nan%]
 [  0.49%   0.95%  58.87%    nan%]
 [  1.11%   0.59%   1.14%    nan%]]
[2024-01-06 20:06:14,771] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 20:06:14,772] {result_logger:77} INFO - actual:
[2024-01-06 20:06:14,772] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 20:06:14,772] {result_logger:79} INFO - predicted:
[2024-01-06 20:06:14,772] {result_logger:80} INFO - 
[[94.75%  3.60%  1.65%  0.00%]
 [ 4.81% 92.62%  2.58%  0.00%]
 [13.41%  6.70% 79.88%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 20:06:14,821] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it1/model_8conv_2fc-best.pth
[2024-01-06 20:06:14,821] {run_experiment:113} INFO - [epoch  39] execution time: 207.31s	 avg f1-score: 0.8322

[2024-01-06 20:06:14,821] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 20:06:14,884] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 20:06:56,542] {train_model:86} INFO - Train Epoch: 40 [60928/612104 (10%)]	lr:2.78e-05	Loss: 0.101369
[2024-01-06 20:07:22,149] {train_model:86} INFO - Train Epoch: 40 [122112/612104 (20%)]	lr:2.78e-05	Loss: 0.079393
[2024-01-06 20:07:33,561] {train_model:86} INFO - Train Epoch: 40 [183296/612104 (30%)]	lr:2.78e-05	Loss: 0.031848
[2024-01-06 20:07:45,407] {train_model:86} INFO - Train Epoch: 40 [244480/612104 (40%)]	lr:2.78e-05	Loss: 0.088644
[2024-01-06 20:07:57,795] {train_model:86} INFO - Train Epoch: 40 [305664/612104 (50%)]	lr:2.78e-05	Loss: 0.203510
[2024-01-06 20:08:09,658] {train_model:86} INFO - Train Epoch: 40 [366848/612104 (60%)]	lr:2.78e-05	Loss: 0.074875
[2024-01-06 20:08:21,293] {train_model:86} INFO - Train Epoch: 40 [428032/612104 (70%)]	lr:2.78e-05	Loss: 0.093190
[2024-01-06 20:08:33,646] {train_model:86} INFO - Train Epoch: 40 [489216/612104 (80%)]	lr:2.78e-05	Loss: 0.064520
[2024-01-06 20:08:45,380] {train_model:86} INFO - Train Epoch: 40 [550400/612104 (90%)]	lr:2.78e-05	Loss: 0.049682
[2024-01-06 20:08:57,267] {train_model:86} INFO - Train Epoch: 40 [611584/612104 (100%)]	lr:2.78e-05	Loss: 0.072416
[2024-01-06 20:09:10,737] {run_experiment:78} INFO - 
[2024-01-06 20:09:10,743] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 20:09:12,138] {result_logger:108} INFO - precision on WAKE: 0.989
[2024-01-06 20:09:13,128] {result_logger:109} INFO - recall on WAKE: 0.966
[2024-01-06 20:09:14,156] {result_logger:112} INFO - F1-score on WAKE: 0.977
[2024-01-06 20:09:14,156] {result_logger:113} INFO - 
[2024-01-06 20:09:15,606] {result_logger:108} INFO - precision on NREM: 0.957
[2024-01-06 20:09:16,552] {result_logger:109} INFO - recall on NREM: 0.961
[2024-01-06 20:09:17,486] {result_logger:112} INFO - F1-score on NREM: 0.959
[2024-01-06 20:09:17,486] {result_logger:113} INFO - 
[2024-01-06 20:09:18,840] {result_logger:108} INFO - precision on REM: 0.823
[2024-01-06 20:09:19,716] {result_logger:109} INFO - recall on REM: 0.965
[2024-01-06 20:09:20,579] {result_logger:112} INFO - F1-score on REM: 0.889
[2024-01-06 20:09:20,579] {result_logger:113} INFO - 
[2024-01-06 20:09:20,805] {result_logger:116} INFO - average precision on sleep stages: 0.923
[2024-01-06 20:09:21,028] {result_logger:118} INFO - average recall on sleep stages: 0.964
[2024-01-06 20:09:21,249] {result_logger:120} INFO - average F1-score on sleep stages: 0.942
[2024-01-06 20:09:21,901] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.964
[2024-01-06 20:09:21,932] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.964
[2024-01-06 20:09:21,936] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 20:09:22,125] {result_logger:108} INFO - precision on WAKE: 0.902
[2024-01-06 20:09:22,245] {result_logger:109} INFO - recall on WAKE: 0.944
[2024-01-06 20:09:22,363] {result_logger:112} INFO - F1-score on WAKE: 0.922
[2024-01-06 20:09:22,363] {result_logger:113} INFO - 
[2024-01-06 20:09:22,559] {result_logger:108} INFO - precision on NREM: 0.912
[2024-01-06 20:09:22,679] {result_logger:109} INFO - recall on NREM: 0.821
[2024-01-06 20:09:22,800] {result_logger:112} INFO - F1-score on NREM: 0.864
[2024-01-06 20:09:22,800] {result_logger:113} INFO - 
[2024-01-06 20:09:22,988] {result_logger:108} INFO - precision on REM: 0.694
[2024-01-06 20:09:23,102] {result_logger:109} INFO - recall on REM: 0.858
[2024-01-06 20:09:23,220] {result_logger:112} INFO - F1-score on REM: 0.767
[2024-01-06 20:09:23,220] {result_logger:113} INFO - 
[2024-01-06 20:09:23,242] {result_logger:116} INFO - average precision on sleep stages: 0.836
[2024-01-06 20:09:23,264] {result_logger:118} INFO - average recall on sleep stages: 0.874
[2024-01-06 20:09:23,284] {result_logger:120} INFO - average F1-score on sleep stages: 0.851
[2024-01-06 20:09:23,366] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.874
[2024-01-06 20:09:23,369] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.890
[2024-01-06 20:09:23,370] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 20:09:24,041] {result_logger:143} INFO - 
[[320841   9201   2013      0]
 [  3374 229802   6014      0]
 [   326   1016  37329      0]
 [  1925    232     31      0]]
[2024-01-06 20:09:24,721] {result_logger:150} INFO - 
[[ 96.62%   2.77%   0.61%   0.00%]
 [  1.41%  96.08%   2.51%   0.00%]
 [  0.84%   2.63%  96.53%   0.00%]
 [ 87.98%  10.60%   1.42%   0.00%]]
[2024-01-06 20:09:25,391] {result_logger:154} INFO - 
[[ 98.28%   3.83%   4.44%    nan%]
 [  1.03%  95.65%  13.25%    nan%]
 [  0.10%   0.42%  82.25%    nan%]
 [  0.59%   0.10%   0.07%    nan%]]
[2024-01-06 20:09:25,391] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 20:09:25,479] {result_logger:143} INFO - 
[[45605  2419   295     0]
 [ 4551 28831  1723     0]
 [  411   350  4580     0]
 [  569   244    21     0]]
[2024-01-06 20:09:25,730] {result_logger:150} INFO - 
[[ 94.38%   5.01%   0.61%   0.00%]
 [ 12.96%  82.13%   4.91%   0.00%]
 [  7.70%   6.55%  85.75%   0.00%]
 [ 68.23%  29.26%   2.52%   0.00%]]
[2024-01-06 20:09:25,950] {result_logger:154} INFO - 
[[ 89.18%   7.60%   4.46%    nan%]
 [  8.90%  90.54%  26.03%    nan%]
 [  0.80%   1.10%  69.19%    nan%]
 [  1.11%   0.77%   0.32%    nan%]]
[2024-01-06 20:09:26,392] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 20:09:26,392] {result_logger:77} INFO - actual:
[2024-01-06 20:09:26,392] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 20:09:26,392] {result_logger:79} INFO - predicted:
[2024-01-06 20:09:26,392] {result_logger:80} INFO - 
[[95.26%  4.03%  0.72%  0.00%]
 [ 5.61% 92.37%  2.02%  0.00%]
 [ 9.64%  5.61% 84.76%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 20:09:26,443] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it1/model_8conv_2fc-best.pth
[2024-01-06 20:09:26,443] {run_experiment:113} INFO - [epoch  40] execution time: 191.62s	 avg f1-score: 0.8513

[2024-01-06 20:09:26,443] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 20:09:26,501] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 20:10:18,478] {train_model:86} INFO - Train Epoch: 41 [60928/612104 (10%)]	lr:2.62e-05	Loss: 0.025430
[2024-01-06 20:10:44,281] {train_model:86} INFO - Train Epoch: 41 [122112/612104 (20%)]	lr:2.62e-05	Loss: 0.072426
[2024-01-06 20:10:56,437] {train_model:86} INFO - Train Epoch: 41 [183296/612104 (30%)]	lr:2.62e-05	Loss: 0.072310
[2024-01-06 20:11:07,881] {train_model:86} INFO - Train Epoch: 41 [244480/612104 (40%)]	lr:2.62e-05	Loss: 0.082519
[2024-01-06 20:11:19,450] {train_model:86} INFO - Train Epoch: 41 [305664/612104 (50%)]	lr:2.62e-05	Loss: 0.248279
[2024-01-06 20:11:31,546] {train_model:86} INFO - Train Epoch: 41 [366848/612104 (60%)]	lr:2.62e-05	Loss: 0.063906
[2024-01-06 20:11:43,280] {train_model:86} INFO - Train Epoch: 41 [428032/612104 (70%)]	lr:2.62e-05	Loss: 0.108630
[2024-01-06 20:11:55,232] {train_model:86} INFO - Train Epoch: 41 [489216/612104 (80%)]	lr:2.62e-05	Loss: 0.651472
[2024-01-06 20:12:07,301] {train_model:86} INFO - Train Epoch: 41 [550400/612104 (90%)]	lr:2.62e-05	Loss: 0.098639
[2024-01-06 20:12:19,190] {train_model:86} INFO - Train Epoch: 41 [611584/612104 (100%)]	lr:2.62e-05	Loss: 0.060178
[2024-01-06 20:12:32,100] {run_experiment:78} INFO - 
[2024-01-06 20:12:32,107] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 20:12:33,528] {result_logger:108} INFO - precision on WAKE: 0.988
[2024-01-06 20:12:34,460] {result_logger:109} INFO - recall on WAKE: 0.967
[2024-01-06 20:12:35,397] {result_logger:112} INFO - F1-score on WAKE: 0.977
[2024-01-06 20:12:35,397] {result_logger:113} INFO - 
[2024-01-06 20:12:36,844] {result_logger:108} INFO - precision on NREM: 0.958
[2024-01-06 20:12:37,760] {result_logger:109} INFO - recall on NREM: 0.960
[2024-01-06 20:12:38,666] {result_logger:112} INFO - F1-score on NREM: 0.959
[2024-01-06 20:12:38,666] {result_logger:113} INFO - 
[2024-01-06 20:12:39,926] {result_logger:108} INFO - precision on REM: 0.823
[2024-01-06 20:12:40,699] {result_logger:109} INFO - recall on REM: 0.966
[2024-01-06 20:12:41,476] {result_logger:112} INFO - F1-score on REM: 0.889
[2024-01-06 20:12:41,477] {result_logger:113} INFO - 
[2024-01-06 20:12:41,668] {result_logger:116} INFO - average precision on sleep stages: 0.923
[2024-01-06 20:12:41,870] {result_logger:118} INFO - average recall on sleep stages: 0.964
[2024-01-06 20:12:42,052] {result_logger:120} INFO - average F1-score on sleep stages: 0.942
[2024-01-06 20:12:42,638] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.964
[2024-01-06 20:12:42,667] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.964
[2024-01-06 20:12:42,670] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 20:12:42,849] {result_logger:108} INFO - precision on WAKE: 0.894
[2024-01-06 20:12:42,960] {result_logger:109} INFO - recall on WAKE: 0.942
[2024-01-06 20:12:43,067] {result_logger:112} INFO - F1-score on WAKE: 0.917
[2024-01-06 20:12:43,067] {result_logger:113} INFO - 
[2024-01-06 20:12:43,243] {result_logger:108} INFO - precision on NREM: 0.912
[2024-01-06 20:12:43,352] {result_logger:109} INFO - recall on NREM: 0.815
[2024-01-06 20:12:43,462] {result_logger:112} INFO - F1-score on NREM: 0.861
[2024-01-06 20:12:43,462] {result_logger:113} INFO - 
[2024-01-06 20:12:43,637] {result_logger:108} INFO - precision on REM: 0.706
[2024-01-06 20:12:43,745] {result_logger:109} INFO - recall on REM: 0.860
[2024-01-06 20:12:43,854] {result_logger:112} INFO - F1-score on REM: 0.776
[2024-01-06 20:12:43,854] {result_logger:113} INFO - 
[2024-01-06 20:12:43,874] {result_logger:116} INFO - average precision on sleep stages: 0.838
[2024-01-06 20:12:43,894] {result_logger:118} INFO - average recall on sleep stages: 0.872
[2024-01-06 20:12:43,914] {result_logger:120} INFO - average F1-score on sleep stages: 0.851
[2024-01-06 20:12:43,993] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.872
[2024-01-06 20:12:43,996] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.887
[2024-01-06 20:12:43,997] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 20:12:44,638] {result_logger:143} INFO - 
[[320990   9060   2005      0]
 [  3444 229722   6024      0]
 [   304   1020  37347      0]
 [  1920    234     34      0]]
[2024-01-06 20:12:45,282] {result_logger:150} INFO - 
[[ 96.67%   2.73%   0.60%   0.00%]
 [  1.44%  96.04%   2.52%   0.00%]
 [  0.79%   2.64%  96.58%   0.00%]
 [ 87.75%  10.69%   1.55%   0.00%]]
[2024-01-06 20:12:45,934] {result_logger:154} INFO - 
[[ 98.26%   3.77%   4.42%    nan%]
 [  1.05%  95.70%  13.27%    nan%]
 [  0.09%   0.42%  82.24%    nan%]
 [  0.59%   0.10%   0.07%    nan%]]
[2024-01-06 20:12:45,934] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 20:12:46,020] {result_logger:143} INFO - 
[[45506  2441   372     0]
 [ 4963 28604  1538     0]
 [  444   302  4595     0]
 [  569   244    21     0]]
[2024-01-06 20:12:46,280] {result_logger:150} INFO - 
[[ 94.18%   5.05%   0.77%   0.00%]
 [ 14.14%  81.48%   4.38%   0.00%]
 [  8.31%   5.65%  86.03%   0.00%]
 [ 68.23%  29.26%   2.52%   0.00%]]
[2024-01-06 20:12:46,502] {result_logger:154} INFO - 
[[ 88.39%   7.73%   5.70%    nan%]
 [  9.64%  90.54%  23.57%    nan%]
 [  0.86%   0.96%  70.41%    nan%]
 [  1.11%   0.77%   0.32%    nan%]]
[2024-01-06 20:12:46,977] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 20:12:46,977] {result_logger:77} INFO - actual:
[2024-01-06 20:12:46,977] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 20:12:46,977] {result_logger:79} INFO - predicted:
[2024-01-06 20:12:46,977] {result_logger:80} INFO - 
[[95.22%  3.98%  0.80%  0.00%]
 [ 5.69% 92.43%  1.88%  0.00%]
 [10.21%  5.26% 84.54%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 20:12:47,029] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it1/model_8conv_2fc-best.pth
[2024-01-06 20:12:47,029] {run_experiment:113} INFO - [epoch  41] execution time: 200.59s	 avg f1-score: 0.8513

[2024-01-06 20:12:47,029] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 20:12:47,090] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 20:13:30,786] {train_model:86} INFO - Train Epoch: 42 [60928/612104 (10%)]	lr:2.47e-05	Loss: 0.207634
[2024-01-06 20:13:56,241] {train_model:86} INFO - Train Epoch: 42 [122112/612104 (20%)]	lr:2.47e-05	Loss: 0.094877
[2024-01-06 20:14:08,458] {train_model:86} INFO - Train Epoch: 42 [183296/612104 (30%)]	lr:2.47e-05	Loss: 0.055446
[2024-01-06 20:14:20,268] {train_model:86} INFO - Train Epoch: 42 [244480/612104 (40%)]	lr:2.47e-05	Loss: 0.101783
[2024-01-06 20:14:32,039] {train_model:86} INFO - Train Epoch: 42 [305664/612104 (50%)]	lr:2.47e-05	Loss: 0.069038
[2024-01-06 20:14:44,194] {train_model:86} INFO - Train Epoch: 42 [366848/612104 (60%)]	lr:2.47e-05	Loss: 0.060710
[2024-01-06 20:14:56,775] {train_model:86} INFO - Train Epoch: 42 [428032/612104 (70%)]	lr:2.47e-05	Loss: 0.099499
[2024-01-06 20:15:09,129] {train_model:86} INFO - Train Epoch: 42 [489216/612104 (80%)]	lr:2.47e-05	Loss: 0.126337
[2024-01-06 20:15:20,923] {train_model:86} INFO - Train Epoch: 42 [550400/612104 (90%)]	lr:2.47e-05	Loss: 0.119818
[2024-01-06 20:15:33,004] {train_model:86} INFO - Train Epoch: 42 [611584/612104 (100%)]	lr:2.47e-05	Loss: 0.135568
[2024-01-06 20:15:45,803] {run_experiment:78} INFO - 
[2024-01-06 20:15:45,810] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 20:15:47,203] {result_logger:108} INFO - precision on WAKE: 0.989
[2024-01-06 20:15:48,100] {result_logger:109} INFO - recall on WAKE: 0.966
[2024-01-06 20:15:48,994] {result_logger:112} INFO - F1-score on WAKE: 0.977
[2024-01-06 20:15:48,995] {result_logger:113} INFO - 
[2024-01-06 20:15:50,347] {result_logger:108} INFO - precision on NREM: 0.957
[2024-01-06 20:15:51,228] {result_logger:109} INFO - recall on NREM: 0.961
[2024-01-06 20:15:52,141] {result_logger:112} INFO - F1-score on NREM: 0.959
[2024-01-06 20:15:52,141] {result_logger:113} INFO - 
[2024-01-06 20:15:53,401] {result_logger:108} INFO - precision on REM: 0.825
[2024-01-06 20:15:54,197] {result_logger:109} INFO - recall on REM: 0.967
[2024-01-06 20:15:54,981] {result_logger:112} INFO - F1-score on REM: 0.891
[2024-01-06 20:15:54,981] {result_logger:113} INFO - 
[2024-01-06 20:15:55,185] {result_logger:116} INFO - average precision on sleep stages: 0.924
[2024-01-06 20:15:55,382] {result_logger:118} INFO - average recall on sleep stages: 0.965
[2024-01-06 20:15:55,583] {result_logger:120} INFO - average F1-score on sleep stages: 0.942
[2024-01-06 20:15:56,155] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.965
[2024-01-06 20:15:56,184] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.964
[2024-01-06 20:15:56,187] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 20:15:56,358] {result_logger:108} INFO - precision on WAKE: 0.917
[2024-01-06 20:15:56,465] {result_logger:109} INFO - recall on WAKE: 0.929
[2024-01-06 20:15:56,569] {result_logger:112} INFO - F1-score on WAKE: 0.923
[2024-01-06 20:15:56,569] {result_logger:113} INFO - 
[2024-01-06 20:15:56,749] {result_logger:108} INFO - precision on NREM: 0.894
[2024-01-06 20:15:56,855] {result_logger:109} INFO - recall on NREM: 0.848
[2024-01-06 20:15:56,962] {result_logger:112} INFO - F1-score on NREM: 0.870
[2024-01-06 20:15:56,962] {result_logger:113} INFO - 
[2024-01-06 20:15:57,135] {result_logger:108} INFO - precision on REM: 0.701
[2024-01-06 20:15:57,241] {result_logger:109} INFO - recall on REM: 0.847
[2024-01-06 20:15:57,347] {result_logger:112} INFO - F1-score on REM: 0.767
[2024-01-06 20:15:57,347] {result_logger:113} INFO - 
[2024-01-06 20:15:57,367] {result_logger:116} INFO - average precision on sleep stages: 0.837
[2024-01-06 20:15:57,386] {result_logger:118} INFO - average recall on sleep stages: 0.875
[2024-01-06 20:15:57,405] {result_logger:120} INFO - average F1-score on sleep stages: 0.853
[2024-01-06 20:15:57,478] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.875
[2024-01-06 20:15:57,481] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.892
[2024-01-06 20:15:57,482] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 20:15:58,092] {result_logger:143} INFO - 
[[320863   9245   1946      1]
 [  3386 229839   5965      0]
 [   293    985  37393      0]
 [  1927    226     35      0]]
[2024-01-06 20:15:58,719] {result_logger:150} INFO - 
[[ 96.63%   2.78%   0.59%   0.00%]
 [  1.42%  96.09%   2.49%   0.00%]
 [  0.76%   2.55%  96.70%   0.00%]
 [ 88.07%  10.33%   1.60%   0.00%]]
[2024-01-06 20:15:59,329] {result_logger:154} INFO - 
[[ 98.28%   3.85%   4.29% 100.00%]
 [  1.04%  95.65%  13.16%   0.00%]
 [  0.09%   0.41%  82.47%   0.00%]
 [  0.59%   0.09%   0.08%   0.00%]]
[2024-01-06 20:15:59,329] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 20:15:59,410] {result_logger:143} INFO - 
[[44912  3127   280     0]
 [ 3670 29783  1652     0]
 [  398   421  4522     0]
 [  481   335    18     0]]
[2024-01-06 20:15:59,662] {result_logger:150} INFO - 
[[ 92.95%   6.47%   0.58%   0.00%]
 [ 10.45%  84.84%   4.71%   0.00%]
 [  7.45%   7.88%  84.67%   0.00%]
 [ 57.67%  40.17%   2.16%   0.00%]]
[2024-01-06 20:15:59,874] {result_logger:154} INFO - 
[[ 90.80%   9.29%   4.33%    nan%]
 [  7.42%  88.47%  25.53%    nan%]
 [  0.80%   1.25%  69.87%    nan%]
 [  0.97%   1.00%   0.28%    nan%]]
[2024-01-06 20:16:00,335] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 20:16:00,335] {result_logger:77} INFO - actual:
[2024-01-06 20:16:00,335] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 20:16:00,335] {result_logger:79} INFO - predicted:
[2024-01-06 20:16:00,336] {result_logger:80} INFO - 
[[94.89%  4.44%  0.68%  0.00%]
 [ 5.70% 92.35%  1.95%  0.00%]
 [ 9.39%  5.92% 84.69%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 20:16:00,389] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it1/model_8conv_2fc-best.pth
[2024-01-06 20:16:00,389] {run_experiment:113} INFO - [epoch  42] execution time: 193.36s	 avg f1-score: 0.8534

[2024-01-06 20:16:00,389] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 20:16:00,445] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 20:17:01,684] {train_model:86} INFO - Train Epoch: 43 [60928/612104 (10%)]	lr:2.32e-05	Loss: 0.141647
[2024-01-06 20:17:14,334] {train_model:86} INFO - Train Epoch: 43 [122112/612104 (20%)]	lr:2.32e-05	Loss: 0.154558
[2024-01-06 20:17:26,520] {train_model:86} INFO - Train Epoch: 43 [183296/612104 (30%)]	lr:2.32e-05	Loss: 0.070004
[2024-01-06 20:17:39,165] {train_model:86} INFO - Train Epoch: 43 [244480/612104 (40%)]	lr:2.32e-05	Loss: 0.090600
[2024-01-06 20:17:51,533] {train_model:86} INFO - Train Epoch: 43 [305664/612104 (50%)]	lr:2.32e-05	Loss: 0.097325
[2024-01-06 20:18:03,725] {train_model:86} INFO - Train Epoch: 43 [366848/612104 (60%)]	lr:2.32e-05	Loss: 0.083941
[2024-01-06 20:18:15,434] {train_model:86} INFO - Train Epoch: 43 [428032/612104 (70%)]	lr:2.32e-05	Loss: 0.076002
[2024-01-06 20:18:27,067] {train_model:86} INFO - Train Epoch: 43 [489216/612104 (80%)]	lr:2.32e-05	Loss: 0.105546
[2024-01-06 20:18:38,610] {train_model:86} INFO - Train Epoch: 43 [550400/612104 (90%)]	lr:2.32e-05	Loss: 0.029462
[2024-01-06 20:19:06,422] {train_model:86} INFO - Train Epoch: 43 [611584/612104 (100%)]	lr:2.32e-05	Loss: 0.101108
[2024-01-06 20:19:19,414] {run_experiment:78} INFO - 
[2024-01-06 20:19:19,421] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 20:19:20,845] {result_logger:108} INFO - precision on WAKE: 0.989
[2024-01-06 20:19:21,780] {result_logger:109} INFO - recall on WAKE: 0.966
[2024-01-06 20:19:22,700] {result_logger:112} INFO - F1-score on WAKE: 0.978
[2024-01-06 20:19:22,700] {result_logger:113} INFO - 
[2024-01-06 20:19:24,067] {result_logger:108} INFO - precision on NREM: 0.958
[2024-01-06 20:19:24,955] {result_logger:109} INFO - recall on NREM: 0.962
[2024-01-06 20:19:25,848] {result_logger:112} INFO - F1-score on NREM: 0.960
[2024-01-06 20:19:25,848] {result_logger:113} INFO - 
[2024-01-06 20:19:27,104] {result_logger:108} INFO - precision on REM: 0.826
[2024-01-06 20:19:27,882] {result_logger:109} INFO - recall on REM: 0.968
[2024-01-06 20:19:28,659] {result_logger:112} INFO - F1-score on REM: 0.892
[2024-01-06 20:19:28,659] {result_logger:113} INFO - 
[2024-01-06 20:19:28,854] {result_logger:116} INFO - average precision on sleep stages: 0.924
[2024-01-06 20:19:29,051] {result_logger:118} INFO - average recall on sleep stages: 0.965
[2024-01-06 20:19:29,254] {result_logger:120} INFO - average F1-score on sleep stages: 0.943
[2024-01-06 20:19:29,818] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.965
[2024-01-06 20:19:29,846] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.965
[2024-01-06 20:19:29,851] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 20:19:30,023] {result_logger:108} INFO - precision on WAKE: 0.878
[2024-01-06 20:19:30,132] {result_logger:109} INFO - recall on WAKE: 0.937
[2024-01-06 20:19:30,239] {result_logger:112} INFO - F1-score on WAKE: 0.907
[2024-01-06 20:19:30,239] {result_logger:113} INFO - 
[2024-01-06 20:19:30,413] {result_logger:108} INFO - precision on NREM: 0.937
[2024-01-06 20:19:30,522] {result_logger:109} INFO - recall on NREM: 0.787
[2024-01-06 20:19:30,631] {result_logger:112} INFO - F1-score on NREM: 0.855
[2024-01-06 20:19:30,631] {result_logger:113} INFO - 
[2024-01-06 20:19:30,806] {result_logger:108} INFO - precision on REM: 0.611
[2024-01-06 20:19:30,915] {result_logger:109} INFO - recall on REM: 0.878
[2024-01-06 20:19:31,023] {result_logger:112} INFO - F1-score on REM: 0.720
[2024-01-06 20:19:31,023] {result_logger:113} INFO - 
[2024-01-06 20:19:31,044] {result_logger:116} INFO - average precision on sleep stages: 0.808
[2024-01-06 20:19:31,063] {result_logger:118} INFO - average recall on sleep stages: 0.868
[2024-01-06 20:19:31,083] {result_logger:120} INFO - average F1-score on sleep stages: 0.828
[2024-01-06 20:19:31,159] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.868
[2024-01-06 20:19:31,163] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.874
[2024-01-06 20:19:31,163] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 20:19:31,799] {result_logger:143} INFO - 
[[320902   9224   1929      0]
 [  3261 229997   5932      0]
 [   292    944  37435      0]
 [  1933    227     28      0]]
[2024-01-06 20:19:32,427] {result_logger:150} INFO - 
[[ 96.64%   2.78%   0.58%   0.00%]
 [  1.36%  96.16%   2.48%   0.00%]
 [  0.76%   2.44%  96.80%   0.00%]
 [ 88.35%  10.37%   1.28%   0.00%]]
[2024-01-06 20:19:33,051] {result_logger:154} INFO - 
[[ 98.32%   3.84%   4.26%    nan%]
 [  1.00%  95.68%  13.09%    nan%]
 [  0.09%   0.39%  82.59%    nan%]
 [  0.59%   0.09%   0.06%    nan%]]
[2024-01-06 20:19:33,051] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 20:19:33,134] {result_logger:143} INFO - 
[[45286  1639  1394     0]
 [ 5869 27638  1598     0]
 [  418   231  4692     0]
 [  637   108    89     0]]
[2024-01-06 20:19:33,352] {result_logger:150} INFO - 
[[ 93.72%   3.39%   2.88%   0.00%]
 [ 16.72%  78.73%   4.55%   0.00%]
 [  7.83%   4.33%  87.85%   0.00%]
 [ 76.38%  12.95%  10.67%   0.00%]]
[2024-01-06 20:19:33,559] {result_logger:154} INFO - 
[[ 86.74%   5.53%  17.93%    nan%]
 [ 11.24%  93.32%  20.56%    nan%]
 [  0.80%   0.78%  60.36%    nan%]
 [  1.22%   0.36%   1.14%    nan%]]
[2024-01-06 20:19:34,005] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 20:19:34,005] {result_logger:77} INFO - actual:
[2024-01-06 20:19:34,005] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 20:19:34,005] {result_logger:79} INFO - predicted:
[2024-01-06 20:19:34,005] {result_logger:80} INFO - 
[[95.28%  3.11%  1.61%  0.00%]
 [ 4.74% 93.04%  2.23%  0.00%]
 [13.64%  5.66% 80.70%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 20:19:34,045] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it1/model_8conv_2fc-best.pth
[2024-01-06 20:19:34,045] {run_experiment:113} INFO - [epoch  43] execution time: 213.66s	 avg f1-score: 0.8276

[2024-01-06 20:19:34,045] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 20:19:34,104] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 20:20:16,171] {train_model:86} INFO - Train Epoch: 44 [60928/612104 (10%)]	lr:2.19e-05	Loss: 0.036664
[2024-01-06 20:20:41,852] {train_model:86} INFO - Train Epoch: 44 [122112/612104 (20%)]	lr:2.19e-05	Loss: 0.125949
[2024-01-06 20:20:53,688] {train_model:86} INFO - Train Epoch: 44 [183296/612104 (30%)]	lr:2.19e-05	Loss: 0.051031
[2024-01-06 20:21:05,464] {train_model:86} INFO - Train Epoch: 44 [244480/612104 (40%)]	lr:2.19e-05	Loss: 0.062259
[2024-01-06 20:21:18,355] {train_model:86} INFO - Train Epoch: 44 [305664/612104 (50%)]	lr:2.19e-05	Loss: 0.088632
[2024-01-06 20:21:29,946] {train_model:86} INFO - Train Epoch: 44 [366848/612104 (60%)]	lr:2.19e-05	Loss: 0.087000
[2024-01-06 20:21:41,813] {train_model:86} INFO - Train Epoch: 44 [428032/612104 (70%)]	lr:2.19e-05	Loss: 0.091646
[2024-01-06 20:21:54,354] {train_model:86} INFO - Train Epoch: 44 [489216/612104 (80%)]	lr:2.19e-05	Loss: 0.168182
[2024-01-06 20:22:06,360] {train_model:86} INFO - Train Epoch: 44 [550400/612104 (90%)]	lr:2.19e-05	Loss: 0.098574
[2024-01-06 20:22:33,844] {train_model:86} INFO - Train Epoch: 44 [611584/612104 (100%)]	lr:2.19e-05	Loss: 0.068562
[2024-01-06 20:22:46,425] {run_experiment:78} INFO - 
[2024-01-06 20:22:46,431] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 20:22:47,792] {result_logger:108} INFO - precision on WAKE: 0.989
[2024-01-06 20:22:48,663] {result_logger:109} INFO - recall on WAKE: 0.966
[2024-01-06 20:22:49,553] {result_logger:112} INFO - F1-score on WAKE: 0.977
[2024-01-06 20:22:49,553] {result_logger:113} INFO - 
[2024-01-06 20:22:50,905] {result_logger:108} INFO - precision on NREM: 0.957
[2024-01-06 20:22:51,802] {result_logger:109} INFO - recall on NREM: 0.961
[2024-01-06 20:22:52,708] {result_logger:112} INFO - F1-score on NREM: 0.959
[2024-01-06 20:22:52,708] {result_logger:113} INFO - 
[2024-01-06 20:22:54,029] {result_logger:108} INFO - precision on REM: 0.826
[2024-01-06 20:22:54,827] {result_logger:109} INFO - recall on REM: 0.966
[2024-01-06 20:22:55,630] {result_logger:112} INFO - F1-score on REM: 0.890
[2024-01-06 20:22:55,631] {result_logger:113} INFO - 
[2024-01-06 20:22:55,842] {result_logger:116} INFO - average precision on sleep stages: 0.924
[2024-01-06 20:22:56,058] {result_logger:118} INFO - average recall on sleep stages: 0.965
[2024-01-06 20:22:56,267] {result_logger:120} INFO - average F1-score on sleep stages: 0.942
[2024-01-06 20:22:56,832] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.965
[2024-01-06 20:22:56,861] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.964
[2024-01-06 20:22:56,864] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 20:22:57,039] {result_logger:108} INFO - precision on WAKE: 0.902
[2024-01-06 20:22:57,145] {result_logger:109} INFO - recall on WAKE: 0.936
[2024-01-06 20:22:57,254] {result_logger:112} INFO - F1-score on WAKE: 0.919
[2024-01-06 20:22:57,255] {result_logger:113} INFO - 
[2024-01-06 20:22:57,437] {result_logger:108} INFO - precision on NREM: 0.913
[2024-01-06 20:22:57,546] {result_logger:109} INFO - recall on NREM: 0.823
[2024-01-06 20:22:57,656] {result_logger:112} INFO - F1-score on NREM: 0.866
[2024-01-06 20:22:57,656] {result_logger:113} INFO - 
[2024-01-06 20:22:57,835] {result_logger:108} INFO - precision on REM: 0.681
[2024-01-06 20:22:57,941] {result_logger:109} INFO - recall on REM: 0.887
[2024-01-06 20:22:58,047] {result_logger:112} INFO - F1-score on REM: 0.770
[2024-01-06 20:22:58,047] {result_logger:113} INFO - 
[2024-01-06 20:22:58,067] {result_logger:116} INFO - average precision on sleep stages: 0.832
[2024-01-06 20:22:58,086] {result_logger:118} INFO - average recall on sleep stages: 0.882
[2024-01-06 20:22:58,105] {result_logger:120} INFO - average F1-score on sleep stages: 0.852
[2024-01-06 20:22:58,183] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.882
[2024-01-06 20:22:58,186] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.888
[2024-01-06 20:22:58,187] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 20:22:58,828] {result_logger:143} INFO - 
[[320796   9316   1942      1]
 [  3256 229980   5954      0]
 [   294   1014  37363      0]
 [  1927    231     30      0]]
[2024-01-06 20:22:59,462] {result_logger:150} INFO - 
[[ 96.61%   2.81%   0.58%   0.00%]
 [  1.36%  96.15%   2.49%   0.00%]
 [  0.76%   2.62%  96.62%   0.00%]
 [ 88.07%  10.56%   1.37%   0.00%]]
[2024-01-06 20:23:00,102] {result_logger:154} INFO - 
[[ 98.32%   3.87%   4.29% 100.00%]
 [  1.00%  95.61%  13.15%   0.00%]
 [  0.09%   0.42%  82.50%   0.00%]
 [  0.59%   0.10%   0.07%   0.00%]]
[2024-01-06 20:23:00,102] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 20:23:00,184] {result_logger:143} INFO - 
[[45244  2503   572     0]
 [ 4571 28888  1646     0]
 [  366   240  4735     0]
 [  545   245    44     0]]
[2024-01-06 20:23:00,396] {result_logger:150} INFO - 
[[ 93.64%   5.18%   1.18%   0.00%]
 [ 13.02%  82.29%   4.69%   0.00%]
 [  6.85%   4.49%  88.65%   0.00%]
 [ 65.35%  29.38%   5.28%   0.00%]]
[2024-01-06 20:23:00,604] {result_logger:154} INFO - 
[[ 89.19%   7.85%   8.17%    nan%]
 [  9.01%  90.63%  23.52%    nan%]
 [  0.72%   0.75%  67.67%    nan%]
 [  1.07%   0.77%   0.63%    nan%]]
[2024-01-06 20:23:01,049] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 20:23:01,049] {result_logger:77} INFO - actual:
[2024-01-06 20:23:01,049] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 20:23:01,049] {result_logger:79} INFO - predicted:
[2024-01-06 20:23:01,049] {result_logger:80} INFO - 
[[95.17%  3.98%  0.85%  0.00%]
 [ 5.47% 92.33%  2.20%  0.00%]
 [10.06%  6.13% 83.81%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 20:23:01,085] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it1/model_8conv_2fc-best.pth
[2024-01-06 20:23:01,086] {run_experiment:113} INFO - [epoch  44] execution time: 207.04s	 avg f1-score: 0.8516

[2024-01-06 20:23:01,086] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 20:23:01,149] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 20:23:27,461] {train_model:86} INFO - Train Epoch: 45 [60928/612104 (10%)]	lr:2.06e-05	Loss: 0.116066
[2024-01-06 20:23:54,910] {train_model:86} INFO - Train Epoch: 45 [122112/612104 (20%)]	lr:2.06e-05	Loss: 0.139258
[2024-01-06 20:24:20,532] {train_model:86} INFO - Train Epoch: 45 [183296/612104 (30%)]	lr:2.06e-05	Loss: 0.162112
[2024-01-06 20:24:31,931] {train_model:86} INFO - Train Epoch: 45 [244480/612104 (40%)]	lr:2.06e-05	Loss: 0.050352
[2024-01-06 20:24:43,980] {train_model:86} INFO - Train Epoch: 45 [305664/612104 (50%)]	lr:2.06e-05	Loss: 0.075068
[2024-01-06 20:24:55,940] {train_model:86} INFO - Train Epoch: 45 [366848/612104 (60%)]	lr:2.06e-05	Loss: 0.072798
[2024-01-06 20:25:08,014] {train_model:86} INFO - Train Epoch: 45 [428032/612104 (70%)]	lr:2.06e-05	Loss: 0.048766
[2024-01-06 20:25:20,672] {train_model:86} INFO - Train Epoch: 45 [489216/612104 (80%)]	lr:2.06e-05	Loss: 0.114322
[2024-01-06 20:25:48,134] {train_model:86} INFO - Train Epoch: 45 [550400/612104 (90%)]	lr:2.06e-05	Loss: 0.061483
[2024-01-06 20:26:13,960] {train_model:86} INFO - Train Epoch: 45 [611584/612104 (100%)]	lr:2.06e-05	Loss: 0.095212
[2024-01-06 20:26:26,602] {run_experiment:78} INFO - 
[2024-01-06 20:26:26,609] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 20:26:28,012] {result_logger:108} INFO - precision on WAKE: 0.989
[2024-01-06 20:26:28,949] {result_logger:109} INFO - recall on WAKE: 0.966
[2024-01-06 20:26:29,884] {result_logger:112} INFO - F1-score on WAKE: 0.978
[2024-01-06 20:26:29,884] {result_logger:113} INFO - 
[2024-01-06 20:26:31,267] {result_logger:108} INFO - precision on NREM: 0.958
[2024-01-06 20:26:32,189] {result_logger:109} INFO - recall on NREM: 0.961
[2024-01-06 20:26:33,108] {result_logger:112} INFO - F1-score on NREM: 0.960
[2024-01-06 20:26:33,108] {result_logger:113} INFO - 
[2024-01-06 20:26:34,384] {result_logger:108} INFO - precision on REM: 0.827
[2024-01-06 20:26:35,182] {result_logger:109} INFO - recall on REM: 0.968
[2024-01-06 20:26:35,975] {result_logger:112} INFO - F1-score on REM: 0.892
[2024-01-06 20:26:35,975] {result_logger:113} INFO - 
[2024-01-06 20:26:36,186] {result_logger:116} INFO - average precision on sleep stages: 0.924
[2024-01-06 20:26:36,400] {result_logger:118} INFO - average recall on sleep stages: 0.965
[2024-01-06 20:26:36,611] {result_logger:120} INFO - average F1-score on sleep stages: 0.943
[2024-01-06 20:26:37,193] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.965
[2024-01-06 20:26:37,223] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.965
[2024-01-06 20:26:37,228] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 20:26:37,409] {result_logger:108} INFO - precision on WAKE: 0.893
[2024-01-06 20:26:37,522] {result_logger:109} INFO - recall on WAKE: 0.936
[2024-01-06 20:26:37,632] {result_logger:112} INFO - F1-score on WAKE: 0.914
[2024-01-06 20:26:37,632] {result_logger:113} INFO - 
[2024-01-06 20:26:37,809] {result_logger:108} INFO - precision on NREM: 0.892
[2024-01-06 20:26:37,918] {result_logger:109} INFO - recall on NREM: 0.818
[2024-01-06 20:26:38,030] {result_logger:112} INFO - F1-score on NREM: 0.853
[2024-01-06 20:26:38,030] {result_logger:113} INFO - 
[2024-01-06 20:26:38,211] {result_logger:108} INFO - precision on REM: 0.714
[2024-01-06 20:26:38,322] {result_logger:109} INFO - recall on REM: 0.789
[2024-01-06 20:26:38,433] {result_logger:112} INFO - F1-score on REM: 0.749
[2024-01-06 20:26:38,433] {result_logger:113} INFO - 
[2024-01-06 20:26:38,454] {result_logger:116} INFO - average precision on sleep stages: 0.833
[2024-01-06 20:26:38,475] {result_logger:118} INFO - average recall on sleep stages: 0.848
[2024-01-06 20:26:38,496] {result_logger:120} INFO - average F1-score on sleep stages: 0.839
[2024-01-06 20:26:38,575] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.848
[2024-01-06 20:26:38,578] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.881
[2024-01-06 20:26:38,579] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 20:26:39,221] {result_logger:143} INFO - 
[[320893   9207   1955      0]
 [  3313 229979   5898      0]
 [   283    967  37421      0]
 [  1935    218     35      0]]
[2024-01-06 20:26:39,873] {result_logger:150} INFO - 
[[ 96.64%   2.77%   0.59%   0.00%]
 [  1.39%  96.15%   2.47%   0.00%]
 [  0.73%   2.50%  96.77%   0.00%]
 [ 88.44%   9.96%   1.60%   0.00%]]
[2024-01-06 20:26:40,525] {result_logger:154} INFO - 
[[ 98.31%   3.83%   4.31%    nan%]
 [  1.01%  95.68%  13.02%    nan%]
 [  0.09%   0.40%  82.59%    nan%]
 [  0.59%   0.09%   0.08%    nan%]]
[2024-01-06 20:26:40,525] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 20:26:40,611] {result_logger:143} INFO - 
[[45250  2917   152     0]
 [ 4865 28701  1539     0]
 [  556   572  4213     0]
 [  514   308    12     0]]
[2024-01-06 20:26:40,830] {result_logger:150} INFO - 
[[ 93.65%   6.04%   0.31%   0.00%]
 [ 13.86%  81.76%   4.38%   0.00%]
 [ 10.41%  10.71%  78.88%   0.00%]
 [ 61.63%  36.93%   1.44%   0.00%]]
[2024-01-06 20:26:41,040] {result_logger:154} INFO - 
[[ 88.40%   8.98%   2.57%    nan%]
 [  9.50%  88.32%  26.01%    nan%]
 [  1.09%   1.76%  71.21%    nan%]
 [  1.00%   0.95%   0.20%    nan%]]
[2024-01-06 20:26:41,493] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 20:26:41,493] {result_logger:77} INFO - actual:
[2024-01-06 20:26:41,494] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 20:26:41,494] {result_logger:79} INFO - predicted:
[2024-01-06 20:26:41,494] {result_logger:80} INFO - 
[[95.00%  4.39%  0.61%  0.00%]
 [ 6.17% 91.92%  1.91%  0.00%]
 [ 9.31%  6.46% 84.23%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 20:26:41,531] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it1/model_8conv_2fc-best.pth
[2024-01-06 20:26:41,531] {run_experiment:113} INFO - [epoch  45] execution time: 220.45s	 avg f1-score: 0.8388

[2024-01-06 20:26:41,531] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 20:26:41,591] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 20:27:08,018] {train_model:86} INFO - Train Epoch: 46 [60928/612104 (10%)]	lr:1.94e-05	Loss: 0.051199
[2024-01-06 20:27:19,447] {train_model:86} INFO - Train Epoch: 46 [122112/612104 (20%)]	lr:1.94e-05	Loss: 0.113423
[2024-01-06 20:27:46,659] {train_model:86} INFO - Train Epoch: 46 [183296/612104 (30%)]	lr:1.94e-05	Loss: 0.067546
[2024-01-06 20:28:12,640] {train_model:86} INFO - Train Epoch: 46 [244480/612104 (40%)]	lr:1.94e-05	Loss: 0.049114
[2024-01-06 20:28:24,864] {train_model:86} INFO - Train Epoch: 46 [305664/612104 (50%)]	lr:1.94e-05	Loss: 0.129208
[2024-01-06 20:28:36,838] {train_model:86} INFO - Train Epoch: 46 [366848/612104 (60%)]	lr:1.94e-05	Loss: 0.121208
[2024-01-06 20:28:48,715] {train_model:86} INFO - Train Epoch: 46 [428032/612104 (70%)]	lr:1.94e-05	Loss: 0.076458
[2024-01-06 20:29:01,551] {train_model:86} INFO - Train Epoch: 46 [489216/612104 (80%)]	lr:1.94e-05	Loss: 0.100378
[2024-01-06 20:29:29,345] {train_model:86} INFO - Train Epoch: 46 [550400/612104 (90%)]	lr:1.94e-05	Loss: 0.076609
[2024-01-06 20:29:55,294] {train_model:86} INFO - Train Epoch: 46 [611584/612104 (100%)]	lr:1.94e-05	Loss: 0.045483
[2024-01-06 20:30:08,092] {run_experiment:78} INFO - 
[2024-01-06 20:30:08,098] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 20:30:09,508] {result_logger:108} INFO - precision on WAKE: 0.989
[2024-01-06 20:30:10,421] {result_logger:109} INFO - recall on WAKE: 0.967
[2024-01-06 20:30:11,358] {result_logger:112} INFO - F1-score on WAKE: 0.978
[2024-01-06 20:30:11,358] {result_logger:113} INFO - 
[2024-01-06 20:30:12,774] {result_logger:108} INFO - precision on NREM: 0.958
[2024-01-06 20:30:13,696] {result_logger:109} INFO - recall on NREM: 0.962
[2024-01-06 20:30:14,622] {result_logger:112} INFO - F1-score on NREM: 0.960
[2024-01-06 20:30:14,622] {result_logger:113} INFO - 
[2024-01-06 20:30:15,920] {result_logger:108} INFO - precision on REM: 0.829
[2024-01-06 20:30:16,717] {result_logger:109} INFO - recall on REM: 0.969
[2024-01-06 20:30:17,534] {result_logger:112} INFO - F1-score on REM: 0.894
[2024-01-06 20:30:17,534] {result_logger:113} INFO - 
[2024-01-06 20:30:17,748] {result_logger:116} INFO - average precision on sleep stages: 0.925
[2024-01-06 20:30:17,963] {result_logger:118} INFO - average recall on sleep stages: 0.966
[2024-01-06 20:30:18,178] {result_logger:120} INFO - average F1-score on sleep stages: 0.944
[2024-01-06 20:30:18,783] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.966
[2024-01-06 20:30:18,814] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.965
[2024-01-06 20:30:18,818] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 20:30:18,995] {result_logger:108} INFO - precision on WAKE: 0.913
[2024-01-06 20:30:19,105] {result_logger:109} INFO - recall on WAKE: 0.895
[2024-01-06 20:30:19,221] {result_logger:112} INFO - F1-score on WAKE: 0.904
[2024-01-06 20:30:19,221] {result_logger:113} INFO - 
[2024-01-06 20:30:19,411] {result_logger:108} INFO - precision on NREM: 0.913
[2024-01-06 20:30:19,523] {result_logger:109} INFO - recall on NREM: 0.835
[2024-01-06 20:30:19,636] {result_logger:112} INFO - F1-score on NREM: 0.873
[2024-01-06 20:30:19,636] {result_logger:113} INFO - 
[2024-01-06 20:30:19,818] {result_logger:108} INFO - precision on REM: 0.527
[2024-01-06 20:30:19,933] {result_logger:109} INFO - recall on REM: 0.919
[2024-01-06 20:30:20,044] {result_logger:112} INFO - F1-score on REM: 0.670
[2024-01-06 20:30:20,044] {result_logger:113} INFO - 
[2024-01-06 20:30:20,065] {result_logger:116} INFO - average precision on sleep stages: 0.785
[2024-01-06 20:30:20,087] {result_logger:118} INFO - average recall on sleep stages: 0.883
[2024-01-06 20:30:20,108] {result_logger:120} INFO - average F1-score on sleep stages: 0.815
[2024-01-06 20:30:20,188] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.883
[2024-01-06 20:30:20,191] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.873
[2024-01-06 20:30:20,191] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 20:30:20,841] {result_logger:143} INFO - 
[[320957   9144   1954      0]
 [  3365 230060   5764      1]
 [   269    913  37489      0]
 [  1929    226     33      0]]
[2024-01-06 20:30:21,487] {result_logger:150} INFO - 
[[ 96.66%   2.75%   0.59%   0.00%]
 [  1.41%  96.18%   2.41%   0.00%]
 [  0.70%   2.36%  96.94%   0.00%]
 [ 88.16%  10.33%   1.51%   0.00%]]
[2024-01-06 20:30:22,117] {result_logger:154} INFO - 
[[ 98.30%   3.80%   4.32%   0.00%]
 [  1.03%  95.72%  12.74% 100.00%]
 [  0.08%   0.38%  82.87%   0.00%]
 [  0.59%   0.09%   0.07%   0.00%]]
[2024-01-06 20:30:22,117] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 20:30:22,203] {result_logger:143} INFO - 
[[43228  2606  2485     0]
 [ 3866 29326  1913     0]
 [  259   175  4907     0]
 [  440   249   145     0]]
[2024-01-06 20:30:22,419] {result_logger:150} INFO - 
[[ 89.46%   5.39%   5.14%   0.00%]
 [ 11.01%  83.54%   5.45%   0.00%]
 [  4.85%   3.28%  91.87%   0.00%]
 [ 52.76%  29.86%  17.39%   0.00%]]
[2024-01-06 20:30:22,634] {result_logger:154} INFO - 
[[ 90.45%   8.05%  26.30%    nan%]
 [  8.09%  90.64%  20.24%    nan%]
 [  0.54%   0.54%  51.93%    nan%]
 [  0.92%   0.77%   1.53%    nan%]]
[2024-01-06 20:30:23,209] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 20:30:23,209] {result_logger:77} INFO - actual:
[2024-01-06 20:30:23,209] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 20:30:23,209] {result_logger:79} INFO - predicted:
[2024-01-06 20:30:23,209] {result_logger:80} INFO - 
[[94.23%  3.73%  2.04%  0.00%]
 [ 4.62% 92.45%  2.93%  0.00%]
 [13.38%  6.97% 79.65%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 20:30:23,246] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it1/model_8conv_2fc-best.pth
[2024-01-06 20:30:23,246] {run_experiment:113} INFO - [epoch  46] execution time: 221.71s	 avg f1-score: 0.8155

[2024-01-06 20:30:23,246] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 20:30:23,307] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 20:30:49,444] {train_model:86} INFO - Train Epoch: 47 [60928/612104 (10%)]	lr:1.83e-05	Loss: 0.069682
[2024-01-06 20:31:00,957] {train_model:86} INFO - Train Epoch: 47 [122112/612104 (20%)]	lr:1.83e-05	Loss: 0.021922
[2024-01-06 20:31:28,266] {train_model:86} INFO - Train Epoch: 47 [183296/612104 (30%)]	lr:1.83e-05	Loss: 0.077945
[2024-01-06 20:31:53,763] {train_model:86} INFO - Train Epoch: 47 [244480/612104 (40%)]	lr:1.83e-05	Loss: 0.071098
[2024-01-06 20:32:06,301] {train_model:86} INFO - Train Epoch: 47 [305664/612104 (50%)]	lr:1.83e-05	Loss: 0.088695
[2024-01-06 20:32:17,780] {train_model:86} INFO - Train Epoch: 47 [366848/612104 (60%)]	lr:1.83e-05	Loss: 0.051808
[2024-01-06 20:32:29,534] {train_model:86} INFO - Train Epoch: 47 [428032/612104 (70%)]	lr:1.83e-05	Loss: 0.105020
[2024-01-06 20:32:46,380] {train_model:86} INFO - Train Epoch: 47 [489216/612104 (80%)]	lr:1.83e-05	Loss: 0.113013
[2024-01-06 20:33:22,590] {train_model:86} INFO - Train Epoch: 47 [550400/612104 (90%)]	lr:1.83e-05	Loss: 0.044081
[2024-01-06 20:33:34,891] {train_model:86} INFO - Train Epoch: 47 [611584/612104 (100%)]	lr:1.83e-05	Loss: 0.089017
[2024-01-06 20:33:47,640] {run_experiment:78} INFO - 
[2024-01-06 20:33:47,647] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 20:33:49,070] {result_logger:108} INFO - precision on WAKE: 0.989
[2024-01-06 20:33:49,986] {result_logger:109} INFO - recall on WAKE: 0.967
[2024-01-06 20:33:50,915] {result_logger:112} INFO - F1-score on WAKE: 0.978
[2024-01-06 20:33:50,915] {result_logger:113} INFO - 
[2024-01-06 20:33:52,310] {result_logger:108} INFO - precision on NREM: 0.958
[2024-01-06 20:33:53,234] {result_logger:109} INFO - recall on NREM: 0.962
[2024-01-06 20:33:54,168] {result_logger:112} INFO - F1-score on NREM: 0.960
[2024-01-06 20:33:54,168] {result_logger:113} INFO - 
[2024-01-06 20:33:55,496] {result_logger:108} INFO - precision on REM: 0.833
[2024-01-06 20:33:56,304] {result_logger:109} INFO - recall on REM: 0.968
[2024-01-06 20:33:57,109] {result_logger:112} INFO - F1-score on REM: 0.895
[2024-01-06 20:33:57,110] {result_logger:113} INFO - 
[2024-01-06 20:33:57,320] {result_logger:116} INFO - average precision on sleep stages: 0.926
[2024-01-06 20:33:57,533] {result_logger:118} INFO - average recall on sleep stages: 0.966
[2024-01-06 20:33:57,741] {result_logger:120} INFO - average F1-score on sleep stages: 0.944
[2024-01-06 20:33:58,316] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.966
[2024-01-06 20:33:58,345] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.965
[2024-01-06 20:33:58,349] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 20:33:58,525] {result_logger:108} INFO - precision on WAKE: 0.884
[2024-01-06 20:33:58,636] {result_logger:109} INFO - recall on WAKE: 0.932
[2024-01-06 20:33:58,748] {result_logger:112} INFO - F1-score on WAKE: 0.907
[2024-01-06 20:33:58,748] {result_logger:113} INFO - 
[2024-01-06 20:33:58,923] {result_logger:108} INFO - precision on NREM: 0.932
[2024-01-06 20:33:59,034] {result_logger:109} INFO - recall on NREM: 0.790
[2024-01-06 20:33:59,141] {result_logger:112} INFO - F1-score on NREM: 0.855
[2024-01-06 20:33:59,141] {result_logger:113} INFO - 
[2024-01-06 20:33:59,317] {result_logger:108} INFO - precision on REM: 0.592
[2024-01-06 20:33:59,426] {result_logger:109} INFO - recall on REM: 0.894
[2024-01-06 20:33:59,535] {result_logger:112} INFO - F1-score on REM: 0.713
[2024-01-06 20:33:59,536] {result_logger:113} INFO - 
[2024-01-06 20:33:59,556] {result_logger:116} INFO - average precision on sleep stages: 0.803
[2024-01-06 20:33:59,576] {result_logger:118} INFO - average recall on sleep stages: 0.872
[2024-01-06 20:33:59,596] {result_logger:120} INFO - average F1-score on sleep stages: 0.825
[2024-01-06 20:33:59,669] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.872
[2024-01-06 20:33:59,672] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.874
[2024-01-06 20:33:59,673] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 20:34:00,292] {result_logger:143} INFO - 
[[321130   9115   1809      1]
 [  3413 230067   5710      0]
 [   291    961  37419      0]
 [  1926    231     31      0]]
[2024-01-06 20:34:00,918] {result_logger:150} INFO - 
[[ 96.71%   2.75%   0.54%   0.00%]
 [  1.43%  96.19%   2.39%   0.00%]
 [  0.75%   2.49%  96.76%   0.00%]
 [ 88.03%  10.56%   1.42%   0.00%]]
[2024-01-06 20:34:01,546] {result_logger:154} INFO - 
[[ 98.28%   3.79%   4.02% 100.00%]
 [  1.04%  95.71%  12.70%   0.00%]
 [  0.09%   0.40%  83.21%   0.00%]
 [  0.59%   0.10%   0.07%   0.00%]]
[2024-01-06 20:34:01,546] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 20:34:01,629] {result_logger:143} INFO - 
[[45045  1851  1423     0]
 [ 5524 27717  1864     0]
 [  401   163  4777     0]
 [  619   117    98     0]]
[2024-01-06 20:34:01,844] {result_logger:150} INFO - 
[[ 93.22%   3.83%   2.95%   0.00%]
 [ 15.74%  78.95%   5.31%   0.00%]
 [  7.51%   3.05%  89.44%   0.00%]
 [ 74.22%  14.03%  11.75%   0.00%]]
[2024-01-06 20:34:02,054] {result_logger:154} INFO - 
[[ 87.32%   6.20%  17.43%    nan%]
 [ 10.71%  92.86%  22.84%    nan%]
 [  0.78%   0.55%  58.53%    nan%]
 [  1.20%   0.39%   1.20%    nan%]]
[2024-01-06 20:34:02,500] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 20:34:02,500] {result_logger:77} INFO - actual:
[2024-01-06 20:34:02,500] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 20:34:02,500] {result_logger:79} INFO - predicted:
[2024-01-06 20:34:02,500] {result_logger:80} INFO - 
[[95.11%  3.36%  1.53%  0.00%]
 [ 4.94% 92.46%  2.60%  0.00%]
 [12.84%  6.36% 80.80%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 20:34:02,537] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it1/model_8conv_2fc-best.pth
[2024-01-06 20:34:02,537] {run_experiment:113} INFO - [epoch  47] execution time: 219.29s	 avg f1-score: 0.8250

[2024-01-06 20:34:02,537] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 20:34:02,598] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 20:34:29,167] {train_model:86} INFO - Train Epoch: 48 [60928/612104 (10%)]	lr:1.72e-05	Loss: 0.108817
[2024-01-06 20:34:41,424] {train_model:86} INFO - Train Epoch: 48 [122112/612104 (20%)]	lr:1.72e-05	Loss: 0.065884
[2024-01-06 20:34:53,305] {train_model:86} INFO - Train Epoch: 48 [183296/612104 (30%)]	lr:1.72e-05	Loss: 0.112641
[2024-01-06 20:35:20,503] {train_model:86} INFO - Train Epoch: 48 [244480/612104 (40%)]	lr:1.72e-05	Loss: 0.135642
[2024-01-06 20:35:46,332] {train_model:86} INFO - Train Epoch: 48 [305664/612104 (50%)]	lr:1.72e-05	Loss: 0.107921
[2024-01-06 20:35:59,119] {train_model:86} INFO - Train Epoch: 48 [366848/612104 (60%)]	lr:1.72e-05	Loss: 0.027058
[2024-01-06 20:36:11,279] {train_model:86} INFO - Train Epoch: 48 [428032/612104 (70%)]	lr:1.72e-05	Loss: 0.094345
[2024-01-06 20:36:38,636] {train_model:86} INFO - Train Epoch: 48 [489216/612104 (80%)]	lr:1.72e-05	Loss: 0.047528
[2024-01-06 20:36:51,040] {train_model:86} INFO - Train Epoch: 48 [550400/612104 (90%)]	lr:1.72e-05	Loss: 0.161225
[2024-01-06 20:37:03,647] {train_model:86} INFO - Train Epoch: 48 [611584/612104 (100%)]	lr:1.72e-05	Loss: 0.192383
[2024-01-06 20:37:18,654] {run_experiment:78} INFO - 
[2024-01-06 20:37:18,661] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 20:37:20,113] {result_logger:108} INFO - precision on WAKE: 0.989
[2024-01-06 20:37:21,043] {result_logger:109} INFO - recall on WAKE: 0.967
[2024-01-06 20:37:21,952] {result_logger:112} INFO - F1-score on WAKE: 0.978
[2024-01-06 20:37:21,952] {result_logger:113} INFO - 
[2024-01-06 20:37:23,296] {result_logger:108} INFO - precision on NREM: 0.958
[2024-01-06 20:37:24,170] {result_logger:109} INFO - recall on NREM: 0.962
[2024-01-06 20:37:25,060] {result_logger:112} INFO - F1-score on NREM: 0.960
[2024-01-06 20:37:25,060] {result_logger:113} INFO - 
[2024-01-06 20:37:26,320] {result_logger:108} INFO - precision on REM: 0.835
[2024-01-06 20:37:27,101] {result_logger:109} INFO - recall on REM: 0.968
[2024-01-06 20:37:27,883] {result_logger:112} INFO - F1-score on REM: 0.897
[2024-01-06 20:37:27,883] {result_logger:113} INFO - 
[2024-01-06 20:37:28,093] {result_logger:116} INFO - average precision on sleep stages: 0.927
[2024-01-06 20:37:28,293] {result_logger:118} INFO - average recall on sleep stages: 0.966
[2024-01-06 20:37:28,500] {result_logger:120} INFO - average F1-score on sleep stages: 0.945
[2024-01-06 20:37:29,067] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.966
[2024-01-06 20:37:29,094] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.965
[2024-01-06 20:37:29,097] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 20:37:29,273] {result_logger:108} INFO - precision on WAKE: 0.887
[2024-01-06 20:37:29,379] {result_logger:109} INFO - recall on WAKE: 0.951
[2024-01-06 20:37:29,482] {result_logger:112} INFO - F1-score on WAKE: 0.918
[2024-01-06 20:37:29,482] {result_logger:113} INFO - 
[2024-01-06 20:37:29,659] {result_logger:108} INFO - precision on NREM: 0.934
[2024-01-06 20:37:29,766] {result_logger:109} INFO - recall on NREM: 0.799
[2024-01-06 20:37:29,877] {result_logger:112} INFO - F1-score on NREM: 0.861
[2024-01-06 20:37:29,878] {result_logger:113} INFO - 
[2024-01-06 20:37:30,055] {result_logger:108} INFO - precision on REM: 0.681
[2024-01-06 20:37:30,162] {result_logger:109} INFO - recall on REM: 0.884
[2024-01-06 20:37:30,272] {result_logger:112} INFO - F1-score on REM: 0.770
[2024-01-06 20:37:30,272] {result_logger:113} INFO - 
[2024-01-06 20:37:30,292] {result_logger:116} INFO - average precision on sleep stages: 0.834
[2024-01-06 20:37:30,312] {result_logger:118} INFO - average recall on sleep stages: 0.878
[2024-01-06 20:37:30,332] {result_logger:120} INFO - average F1-score on sleep stages: 0.850
[2024-01-06 20:37:30,412] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.878
[2024-01-06 20:37:30,415] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.887
[2024-01-06 20:37:30,416] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 20:37:31,051] {result_logger:143} INFO - 
[[321189   9100   1766      0]
 [  3389 230194   5607      0]
 [   299    943  37429      0]
 [  1931    227     30      0]]
[2024-01-06 20:37:31,681] {result_logger:150} INFO - 
[[ 96.73%   2.74%   0.53%   0.00%]
 [  1.42%  96.24%   2.34%   0.00%]
 [  0.77%   2.44%  96.79%   0.00%]
 [ 88.25%  10.37%   1.37%   0.00%]]
[2024-01-06 20:37:32,315] {result_logger:154} INFO - 
[[ 98.28%   3.78%   3.94%    nan%]
 [  1.04%  95.73%  12.51%    nan%]
 [  0.09%   0.39%  83.49%    nan%]
 [  0.59%   0.09%   0.07%    nan%]]
[2024-01-06 20:37:32,316] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 20:37:32,402] {result_logger:143} INFO - 
[[45961  1781   577     0]
 [ 5420 28054  1631     0]
 [  419   198  4724     0]
 [  659   142    33     0]]
[2024-01-06 20:37:32,620] {result_logger:150} INFO - 
[[ 95.12%   3.69%   1.19%   0.00%]
 [ 15.44%  79.91%   4.65%   0.00%]
 [  7.84%   3.71%  88.45%   0.00%]
 [ 79.02%  17.03%   3.96%   0.00%]]
[2024-01-06 20:37:32,828] {result_logger:154} INFO - 
[[ 87.61%   5.90%   8.28%    nan%]
 [ 10.33%  92.97%  23.42%    nan%]
 [  0.80%   0.66%  67.82%    nan%]
 [  1.26%   0.47%   0.47%    nan%]]
[2024-01-06 20:37:33,269] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 20:37:33,269] {result_logger:77} INFO - actual:
[2024-01-06 20:37:33,269] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 20:37:33,269] {result_logger:79} INFO - predicted:
[2024-01-06 20:37:33,269] {result_logger:80} INFO - 
[[95.48%  3.58%  0.94%  0.00%]
 [ 5.40% 92.59%  2.01%  0.00%]
 [10.64%  5.18% 84.18%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 20:37:33,306] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it1/model_8conv_2fc-best.pth
[2024-01-06 20:37:33,306] {run_experiment:113} INFO - [epoch  48] execution time: 210.77s	 avg f1-score: 0.8498

[2024-01-06 20:37:33,306] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 20:37:33,362] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 20:37:59,113] {train_model:86} INFO - Train Epoch: 49 [60928/612104 (10%)]	lr:1.62e-05	Loss: 0.158206
[2024-01-06 20:38:10,768] {train_model:86} INFO - Train Epoch: 49 [122112/612104 (20%)]	lr:1.62e-05	Loss: 0.035805
[2024-01-06 20:38:23,058] {train_model:86} INFO - Train Epoch: 49 [183296/612104 (30%)]	lr:1.62e-05	Loss: 0.099975
[2024-01-06 20:38:48,779] {train_model:86} INFO - Train Epoch: 49 [244480/612104 (40%)]	lr:1.62e-05	Loss: 0.108073
[2024-01-06 20:39:03,622] {train_model:86} INFO - Train Epoch: 49 [305664/612104 (50%)]	lr:1.62e-05	Loss: 0.061632
[2024-01-06 20:39:26,033] {train_model:86} INFO - Train Epoch: 49 [366848/612104 (60%)]	lr:1.62e-05	Loss: 0.065910
[2024-01-06 20:39:37,955] {train_model:86} INFO - Train Epoch: 49 [428032/612104 (70%)]	lr:1.62e-05	Loss: 0.069743
[2024-01-06 20:39:50,564] {train_model:86} INFO - Train Epoch: 49 [489216/612104 (80%)]	lr:1.62e-05	Loss: 0.075295
[2024-01-06 20:40:02,489] {train_model:86} INFO - Train Epoch: 49 [550400/612104 (90%)]	lr:1.62e-05	Loss: 0.123002
[2024-01-06 20:40:14,812] {train_model:86} INFO - Train Epoch: 49 [611584/612104 (100%)]	lr:1.62e-05	Loss: 0.123311
[2024-01-06 20:40:26,964] {run_experiment:78} INFO - 
[2024-01-06 20:40:26,970] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 20:40:28,351] {result_logger:108} INFO - precision on WAKE: 0.989
[2024-01-06 20:40:29,260] {result_logger:109} INFO - recall on WAKE: 0.967
[2024-01-06 20:40:30,165] {result_logger:112} INFO - F1-score on WAKE: 0.978
[2024-01-06 20:40:30,165] {result_logger:113} INFO - 
[2024-01-06 20:40:31,519] {result_logger:108} INFO - precision on NREM: 0.958
[2024-01-06 20:40:32,422] {result_logger:109} INFO - recall on NREM: 0.962
[2024-01-06 20:40:33,321] {result_logger:112} INFO - F1-score on NREM: 0.960
[2024-01-06 20:40:33,321] {result_logger:113} INFO - 
[2024-01-06 20:40:34,618] {result_logger:108} INFO - precision on REM: 0.832
[2024-01-06 20:40:35,408] {result_logger:109} INFO - recall on REM: 0.969
[2024-01-06 20:40:36,200] {result_logger:112} INFO - F1-score on REM: 0.895
[2024-01-06 20:40:36,200] {result_logger:113} INFO - 
[2024-01-06 20:40:36,403] {result_logger:116} INFO - average precision on sleep stages: 0.926
[2024-01-06 20:40:36,601] {result_logger:118} INFO - average recall on sleep stages: 0.966
[2024-01-06 20:40:36,805] {result_logger:120} INFO - average F1-score on sleep stages: 0.944
[2024-01-06 20:40:37,395] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.966
[2024-01-06 20:40:37,425] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.965
[2024-01-06 20:40:37,428] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 20:40:37,611] {result_logger:108} INFO - precision on WAKE: 0.896
[2024-01-06 20:40:37,723] {result_logger:109} INFO - recall on WAKE: 0.950
[2024-01-06 20:40:37,831] {result_logger:112} INFO - F1-score on WAKE: 0.922
[2024-01-06 20:40:37,831] {result_logger:113} INFO - 
[2024-01-06 20:40:38,007] {result_logger:108} INFO - precision on NREM: 0.919
[2024-01-06 20:40:38,116] {result_logger:109} INFO - recall on NREM: 0.817
[2024-01-06 20:40:38,220] {result_logger:112} INFO - F1-score on NREM: 0.865
[2024-01-06 20:40:38,220] {result_logger:113} INFO - 
[2024-01-06 20:40:38,392] {result_logger:108} INFO - precision on REM: 0.713
[2024-01-06 20:40:38,497] {result_logger:109} INFO - recall on REM: 0.847
[2024-01-06 20:40:38,603] {result_logger:112} INFO - F1-score on REM: 0.774
[2024-01-06 20:40:38,604] {result_logger:113} INFO - 
[2024-01-06 20:40:38,623] {result_logger:116} INFO - average precision on sleep stages: 0.843
[2024-01-06 20:40:38,643] {result_logger:118} INFO - average recall on sleep stages: 0.871
[2024-01-06 20:40:38,663] {result_logger:120} INFO - average F1-score on sleep stages: 0.854
[2024-01-06 20:40:38,739] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.871
[2024-01-06 20:40:38,742] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.891
[2024-01-06 20:40:38,743] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 20:40:39,389] {result_logger:143} INFO - 
[[320975   9187   1893      0]
 [  3319 230212   5659      0]
 [   277    922  37472      0]
 [  1927    228     33      0]]
[2024-01-06 20:40:40,040] {result_logger:150} INFO - 
[[ 96.66%   2.77%   0.57%   0.00%]
 [  1.39%  96.25%   2.37%   0.00%]
 [  0.72%   2.38%  96.90%   0.00%]
 [ 88.07%  10.42%   1.51%   0.00%]]
[2024-01-06 20:40:40,672] {result_logger:154} INFO - 
[[ 98.31%   3.82%   4.20%    nan%]
 [  1.02%  95.70%  12.56%    nan%]
 [  0.08%   0.38%  83.17%    nan%]
 [  0.59%   0.09%   0.07%    nan%]]
[2024-01-06 20:40:40,672] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 20:40:40,757] {result_logger:143} INFO - 
[[45884  2190   245     0]
 [ 4834 28693  1578     0]
 [  491   325  4525     0]
 [  608   208    18     0]]
[2024-01-06 20:40:40,973] {result_logger:150} INFO - 
[[ 94.96%   4.53%   0.51%   0.00%]
 [ 13.77%  81.73%   4.50%   0.00%]
 [  9.19%   6.09%  84.72%   0.00%]
 [ 72.90%  24.94%   2.16%   0.00%]]
[2024-01-06 20:40:41,189] {result_logger:154} INFO - 
[[ 88.55%   6.97%   3.85%    nan%]
 [  9.33%  91.33%  24.79%    nan%]
 [  0.95%   1.03%  71.08%    nan%]
 [  1.17%   0.66%   0.28%    nan%]]
[2024-01-06 20:40:41,653] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 20:40:41,653] {result_logger:77} INFO - actual:
[2024-01-06 20:40:41,653] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 20:40:41,653] {result_logger:79} INFO - predicted:
[2024-01-06 20:40:41,653] {result_logger:80} INFO - 
[[95.39%  3.91%  0.70%  0.00%]
 [ 5.61% 92.50%  1.89%  0.00%]
 [ 9.83%  5.18% 84.98%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 20:40:41,690] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it1/model_8conv_2fc-best.pth
[2024-01-06 20:40:41,690] {run_experiment:113} INFO - [epoch  49] execution time: 188.38s	 avg f1-score: 0.8539

[2024-01-06 20:40:41,690] {dataloader:107} INFO - data distribution in database for dataset train:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 20:40:41,750] {dataloader:134} INFO - data distribution after processing:
	WAKE                : 332054
	NREM                : 239188
	REM                 : 38671
	ARTIFACT            : 2191
[2024-01-06 20:41:07,282] {train_model:86} INFO - Train Epoch: 50 [60928/612104 (10%)]	lr:1.53e-05	Loss: 0.061335
[2024-01-06 20:41:20,377] {train_model:86} INFO - Train Epoch: 50 [122112/612104 (20%)]	lr:1.53e-05	Loss: 0.057083
[2024-01-06 20:41:32,793] {train_model:86} INFO - Train Epoch: 50 [183296/612104 (30%)]	lr:1.53e-05	Loss: 0.048375
[2024-01-06 20:41:44,528] {train_model:86} INFO - Train Epoch: 50 [244480/612104 (40%)]	lr:1.53e-05	Loss: 0.032504
[2024-01-06 20:42:10,550] {train_model:86} INFO - Train Epoch: 50 [305664/612104 (50%)]	lr:1.53e-05	Loss: 0.089490
[2024-01-06 20:42:36,303] {train_model:86} INFO - Train Epoch: 50 [366848/612104 (60%)]	lr:1.53e-05	Loss: 0.171735
[2024-01-06 20:42:49,096] {train_model:86} INFO - Train Epoch: 50 [428032/612104 (70%)]	lr:1.53e-05	Loss: 0.083023
[2024-01-06 20:43:01,098] {train_model:86} INFO - Train Epoch: 50 [489216/612104 (80%)]	lr:1.53e-05	Loss: 0.087825
[2024-01-06 20:43:13,078] {train_model:86} INFO - Train Epoch: 50 [550400/612104 (90%)]	lr:1.53e-05	Loss: 0.136415
[2024-01-06 20:43:24,802] {train_model:86} INFO - Train Epoch: 50 [611584/612104 (100%)]	lr:1.53e-05	Loss: 0.044164
[2024-01-06 20:43:36,828] {run_experiment:78} INFO - 
[2024-01-06 20:43:36,835] {result_logger:102} INFO - scores for sleep stages on dataset: train
[2024-01-06 20:43:38,273] {result_logger:108} INFO - precision on WAKE: 0.989
[2024-01-06 20:43:39,187] {result_logger:109} INFO - recall on WAKE: 0.967
[2024-01-06 20:43:40,119] {result_logger:112} INFO - F1-score on WAKE: 0.978
[2024-01-06 20:43:40,119] {result_logger:113} INFO - 
[2024-01-06 20:43:41,514] {result_logger:108} INFO - precision on NREM: 0.958
[2024-01-06 20:43:42,421] {result_logger:109} INFO - recall on NREM: 0.963
[2024-01-06 20:43:43,328] {result_logger:112} INFO - F1-score on NREM: 0.960
[2024-01-06 20:43:43,329] {result_logger:113} INFO - 
[2024-01-06 20:43:44,658] {result_logger:108} INFO - precision on REM: 0.833
[2024-01-06 20:43:45,468] {result_logger:109} INFO - recall on REM: 0.969
[2024-01-06 20:43:46,277] {result_logger:112} INFO - F1-score on REM: 0.896
[2024-01-06 20:43:46,278] {result_logger:113} INFO - 
[2024-01-06 20:43:46,490] {result_logger:116} INFO - average precision on sleep stages: 0.927
[2024-01-06 20:43:46,701] {result_logger:118} INFO - average recall on sleep stages: 0.966
[2024-01-06 20:43:46,913] {result_logger:120} INFO - average F1-score on sleep stages: 0.945
[2024-01-06 20:43:47,503] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.966
[2024-01-06 20:43:47,533] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.965
[2024-01-06 20:43:47,538] {result_logger:102} INFO - scores for sleep stages on dataset: valid
[2024-01-06 20:43:47,720] {result_logger:108} INFO - precision on WAKE: 0.894
[2024-01-06 20:43:47,832] {result_logger:109} INFO - recall on WAKE: 0.949
[2024-01-06 20:43:47,946] {result_logger:112} INFO - F1-score on WAKE: 0.920
[2024-01-06 20:43:47,946] {result_logger:113} INFO - 
[2024-01-06 20:43:48,128] {result_logger:108} INFO - precision on NREM: 0.931
[2024-01-06 20:43:48,241] {result_logger:109} INFO - recall on NREM: 0.820
[2024-01-06 20:43:48,355] {result_logger:112} INFO - F1-score on NREM: 0.872
[2024-01-06 20:43:48,355] {result_logger:113} INFO - 
[2024-01-06 20:43:48,537] {result_logger:108} INFO - precision on REM: 0.705
[2024-01-06 20:43:48,648] {result_logger:109} INFO - recall on REM: 0.869
[2024-01-06 20:43:48,760] {result_logger:112} INFO - F1-score on REM: 0.779
[2024-01-06 20:43:48,760] {result_logger:113} INFO - 
[2024-01-06 20:43:48,781] {result_logger:116} INFO - average precision on sleep stages: 0.843
[2024-01-06 20:43:48,802] {result_logger:118} INFO - average recall on sleep stages: 0.879
[2024-01-06 20:43:48,823] {result_logger:120} INFO - average F1-score on sleep stages: 0.857
[2024-01-06 20:43:48,903] {result_logger:123} INFO - balanced accuracy on sleep stages ignoring ARTIFACT class: 0.879
[2024-01-06 20:43:48,906] {result_logger:125} INFO - accuracy on sleep stages ignoring ARTIFACT class: 0.893
[2024-01-06 20:43:48,906] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: train
[2024-01-06 20:43:49,542] {result_logger:143} INFO - 
[[321047   9151   1857      0]
 [  3273 230283   5634      0]
 [   273    920  37478      0]
 [  1921    234     33      0]]
[2024-01-06 20:43:50,191] {result_logger:150} INFO - 
[[ 96.68%   2.76%   0.56%   0.00%]
 [  1.37%  96.28%   2.36%   0.00%]
 [  0.71%   2.38%  96.92%   0.00%]
 [ 87.80%  10.69%   1.51%   0.00%]]
[2024-01-06 20:43:50,841] {result_logger:154} INFO - 
[[ 98.33%   3.80%   4.13%    nan%]
 [  1.00%  95.72%  12.52%    nan%]
 [  0.08%   0.38%  83.28%    nan%]
 [  0.59%   0.10%   0.07%    nan%]]
[2024-01-06 20:43:50,842] {result_logger:139} INFO - confusion matrix for sleep stages on dataset: valid
[2024-01-06 20:43:50,929] {result_logger:143} INFO - 
[[45838  1905   576     0]
 [ 4972 28771  1362     0]
 [  473   228  4640     0]
 [  662   132    40     0]]
[2024-01-06 20:43:51,144] {result_logger:150} INFO - 
[[ 94.87%   3.94%   1.19%   0.00%]
 [ 14.16%  81.96%   3.88%   0.00%]
 [  8.86%   4.27%  86.88%   0.00%]
 [ 79.38%  15.83%   4.80%   0.00%]]
[2024-01-06 20:43:51,353] {result_logger:154} INFO - 
[[ 88.24%   6.14%   8.70%    nan%]
 [  9.57%  92.70%  20.58%    nan%]
 [  0.91%   0.73%  70.11%    nan%]
 [  1.27%   0.43%   0.60%    nan%]]
[2024-01-06 20:43:51,932] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-01-06 20:43:51,932] {result_logger:77} INFO - actual:
[2024-01-06 20:43:51,932] {result_logger:78} INFO - 
[[96.41%  3.31%  0.01%  0.28%]
 [ 3.81% 95.39%  0.78%  0.02%]
 [ 4.91%  0.24% 94.66%  0.19%]
 [16.31%  0.96%  0.96% 81.77%]]
[2024-01-06 20:43:51,932] {result_logger:79} INFO - predicted:
[2024-01-06 20:43:51,933] {result_logger:80} INFO - 
[[95.52%  3.60%  0.88%  0.00%]
 [ 5.27% 92.85%  1.88%  0.00%]
 [10.46%  5.24% 84.30%  0.00%]
 [  nan%   nan%   nan%   nan%]]
[2024-01-06 20:43:51,977] {train_model:98} INFO - snapshot saved to /home/s202283/code/sleep-mice-tuebingen/results/kornum_config_it1/model_8conv_2fc-best.pth
[2024-01-06 20:43:51,978] {run_experiment:113} INFO - [epoch  50] execution time: 190.29s	 avg f1-score: 0.8569

[2024-01-06 20:43:52,264] {result_logger:56} INFO - final F1-scores on train:
	WAKE                : [0.482434164917712, 0.741580796578158, 0.909243946964481, 0.9460743276344266, 0.9569736374727803, 0.9619587149321824, 0.9646070896514826, 0.9666236383534225, 0.9680480666481669, 0.9692625023369571, 0.9701001562069282, 0.97121838012041, 0.9715973635405981, 0.9726457234691321, 0.9728226064069624, 0.9732142447835088, 0.9741133928680503, 0.974818074589037, 0.9751038800713542, 0.9750774159103043, 0.9754513097819623, 0.9750702493585265, 0.9753861880096728, 0.9756893606637383, 0.9758294930524094, 0.9761324326013743, 0.976077284783262, 0.9764197677644354, 0.9763623254459788, 0.9764755367527829, 0.9768956479336827, 0.976797358721797, 0.9766832982312834, 0.9768160506374632, 0.9771592938150927, 0.9770788612101813, 0.9772134702779097, 0.9772352670560314, 0.9773609393184214, 0.9772858805109991, 0.9774464709581252, 0.9773514042860384, 0.9775997319157362, 0.977439095918501, 0.9775216893307989, 0.9775647761503155, 0.9777298752148383, 0.9778454999908667, 0.9776493772710797, 0.9778359181783848]
	NREM                : [0.5725886676005439, 0.7811137162190058, 0.8723189940012189, 0.9029521850768386, 0.920216693317357, 0.9291483814857685, 0.9342587253493809, 0.9371421380481973, 0.9394173691301605, 0.9417954826907724, 0.9433125955717547, 0.9449424513683133, 0.9460315729660933, 0.9472132955162431, 0.9480257224229971, 0.9487504424927053, 0.9498874545892355, 0.951343810678849, 0.9517571677666626, 0.9523289162427516, 0.9523119329082852, 0.9527803061213815, 0.9532637938753394, 0.9540420529960616, 0.9543706297358673, 0.9551787770558474, 0.9553933088918831, 0.955791946855854, 0.9562047150653106, 0.9563727108944912, 0.9565270094319315, 0.9568797336419121, 0.9572507126969706, 0.957701833004097, 0.9580933606752507, 0.9578237656054573, 0.9584020646540744, 0.9583023642300593, 0.9589064538008034, 0.9590888318040772, 0.959189297524802, 0.9591431772799258, 0.9596103096869752, 0.9592492179353492, 0.9595592300294361, 0.9599692889943189, 0.9599464255538425, 0.9602880104791763, 0.9601948651855745, 0.9604249036584755]
	REM                 : [0.1360307579641157, 0.25612194179046777, 0.5319867588716402, 0.6453247483069655, 0.7071203015177753, 0.748393924961634, 0.7704543733024574, 0.7851825942483632, 0.7969961454964334, 0.8039198257855207, 0.8106041123919631, 0.8166330747317336, 0.8195285588851116, 0.8271256391940769, 0.8331261617762776, 0.8324488937877118, 0.8389348530101731, 0.8439115154021087, 0.8472982472314093, 0.8507945306725794, 0.8504449600055405, 0.8527113837606343, 0.8564912889969323, 0.8593777240553704, 0.8640504555010512, 0.8664247248887849, 0.8673638894738074, 0.8694114202049781, 0.8715317325192274, 0.872890307739255, 0.8739983550699094, 0.8761040091260833, 0.8780102552012731, 0.8795956208000189, 0.8818717045373939, 0.8820432740651359, 0.8860708439108874, 0.8835864748951496, 0.8877880731765264, 0.8885001249598344, 0.8887170273775387, 0.8905745757665972, 0.8916598187383138, 0.8903371857500297, 0.8915599499672404, 0.8938935120055319, 0.8950950256551328, 0.8967929749739436, 0.8954417826632415, 0.8961740793878528]
	ARTIFACT            : [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
	avg                 : [0.39701786349412393, 0.5929388181958771, 0.7711832332791134, 0.8314504203394103, 0.8614368774359709, 0.879833673793195, 0.889773396101107, 0.8963161235499943, 0.9014871937582537, 0.9049926036044168, 0.9080056213902153, 0.9109313020734856, 0.9123858317972676, 0.9156615527264841, 0.9179914968687458, 0.918137860354642, 0.9209785668224862, 0.9233578002233317, 0.9247197650231421, 0.9260669542752118, 0.926069400898596, 0.9268539797468475, 0.9283804236273149, 0.9297030459050569, 0.9314168594297759, 0.9325786448486689, 0.9329448277163174, 0.9338743782750892, 0.9346995910101722, 0.935246185128843, 0.9358070041451745, 0.9365937004965974, 0.9373147553765091, 0.9380378348138597, 0.9390414530092458, 0.9389819669602582, 0.9405621262809571, 0.9397080353937467, 0.9413518220985836, 0.9416249457583036, 0.941784265286822, 0.9423563857775205, 0.9429566201136751, 0.9423418332012933, 0.9428802897758252, 0.9438091923833888, 0.9442571088079378, 0.9449754951479955, 0.9444286750399652, 0.9448116337415712]
[2024-01-06 20:43:52,264] {result_logger:56} INFO - final F1-scores on valid:
	WAKE                : [0.05318988865482997, 0.7627797745142376, 0.7091821367439742, 0.7097315559742965, 0.7127140177466774, 0.7006495415786801, 0.7499776754391559, 0.9208088027103287, 0.9371650437314774, 0.9191837856946463, 0.9123087531353993, 0.9068394639183186, 0.9159581745333724, 0.73336316404405, 0.7996377152535993, 0.9094025370388302, 0.9393751994893074, 0.9420094334837957, 0.774592669855771, 0.9291860238542083, 0.8394992445499676, 0.9265360277607676, 0.909826285668062, 0.9288874242288065, 0.8204088787606546, 0.92500177576637, 0.9257798790181059, 0.881308129521185, 0.9163980271520822, 0.917511860832894, 0.923738457045608, 0.9264271678339294, 0.9017960807277207, 0.9246939432989691, 0.9202721813449202, 0.9021891010712623, 0.8085581601061478, 0.9131407992518827, 0.9134691283355031, 0.9223752604008657, 0.9171638181231861, 0.923174955549389, 0.9066992351739879, 0.9186598984771575, 0.9142337609859581, 0.9036708754912619, 0.9073512675120103, 0.9181274283602514, 0.9220319909975082, 0.9204232846729986]
	NREM                : [0.589685307833993, 0.14914560201590676, 0.050464439206987385, 0.06148849499064186, 0.8629909694266129, 0.8427027787768379, 0.8735667564447864, 0.8522653696129369, 0.891522496501206, 0.8662052698550635, 0.8478544390368037, 0.8265350984319281, 0.8427181368639336, 0.869410308282255, 0.8852586892279075, 0.8297471715724931, 0.8643543902704214, 0.8694688538918978, 0.8725706450459043, 0.8703004190521159, 0.8477590444434008, 0.8719258927237412, 0.8532859468096227, 0.8653645673637088, 0.8503343314147417, 0.8649389335716413, 0.882962429047662, 0.8836311971883646, 0.8626360554332956, 0.8525483328468777, 0.8684234383971473, 0.8650840323129778, 0.857823401051111, 0.8775534763380366, 0.8658709944915004, 0.8549768571911858, 0.8462512008051112, 0.8471477809325701, 0.8670120898100172, 0.8644329510531444, 0.8608920724733643, 0.8703898532935883, 0.8554934765449677, 0.8657396307839845, 0.8529905639349135, 0.8726417901565197, 0.8549879696464928, 0.8613712425926495, 0.8653808453847661, 0.871729612628581]
	REM                 : [0.14362892223738064, 0.30491264745408386, 0.0, 0.0, 0.3626400305205841, 0.27420728088959984, 0.30878651290756887, 0.672776646300068, 0.7110848184574429, 0.7655527906150017, 0.6651586811981631, 0.6960257787325457, 0.701199040767386, 0.3347169077112654, 0.4006034582801439, 0.6874536005939125, 0.5705421546575661, 0.654477009948911, 0.3629232192414431, 0.6970364927749204, 0.47286932494878753, 0.7370839936608559, 0.7686240891555937, 0.7171393341553638, 0.44249736226432407, 0.7443628071953382, 0.7131275778694354, 0.5589509820473859, 0.7673113957967009, 0.5736650824713447, 0.7719385637193857, 0.7117057834320392, 0.6945625419556947, 0.7882975093824633, 0.7582152061855669, 0.682972992647594, 0.4141522153517132, 0.736322869955157, 0.7161839355031353, 0.7672334366362342, 0.7757892959648827, 0.7667655786350148, 0.7204606525911709, 0.7702944525784936, 0.7493108048021342, 0.670080568073194, 0.7127191346512496, 0.769819929927483, 0.7742321841047138, 0.778588807785888]
	ARTIFACT            : [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
	avg                 : [0.2621680395754012, 0.40561267466140943, 0.2532155253169872, 0.25707335032164613, 0.6461150058979581, 0.6058532004150393, 0.6441103149305037, 0.8152836062077778, 0.846590786230042, 0.8503139487215705, 0.8084406244567887, 0.8098001136942642, 0.8199584507215641, 0.64583012667919, 0.6951666209205501, 0.8088677697350786, 0.7914239148057649, 0.8219850991082015, 0.6700288447143729, 0.8321743118937482, 0.7200425379807186, 0.8451819713817882, 0.8439121072110928, 0.8371304419159596, 0.7044135241465734, 0.8447678388444498, 0.8406232953117344, 0.7746301029189785, 0.8487818261273596, 0.7812417587170387, 0.854700153054047, 0.8344056611929821, 0.8180606745781756, 0.863514976339823, 0.8481194606739958, 0.8133796503033475, 0.6896538587543241, 0.8322038167132032, 0.8322217178828852, 0.8513472160300815, 0.8512817288538109, 0.8534434624926641, 0.8275511214367088, 0.8515646606132119, 0.838845043241002, 0.8154644112403252, 0.8250194572699175, 0.849772866960128, 0.8538816734956627, 0.8569139016958225]
[2024-01-06 20:43:52,396] {logger:50} INFO - 
[2024-01-06 20:43:52,396] {logger:51} INFO - ================================================================================
[2024-01-06 20:43:52,396] {logger:52} INFO - finished training
[2024-01-06 20:43:52,396] {logger:53} INFO - ================================================================================
[2024-01-06 20:43:52,396] {logger:54} INFO - 
[2024-01-06 20:43:52,396] {logger:50} INFO - 
[2024-01-06 20:43:52,396] {logger:51} INFO - ================================================================================
[2024-01-06 20:43:52,397] {logger:52} INFO - best model on epoch: 50 	f1-score: 0.8569
[2024-01-06 20:43:52,397] {logger:53} INFO - ================================================================================
[2024-01-06 20:43:52,397] {logger:54} INFO - 
